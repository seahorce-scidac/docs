<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>REMORA: REMORA Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">REMORA
   </div>
   <div id="projectbrief">Energy Research and Forecasting: An Atmospheric Modeling Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classREMORA.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="classREMORA-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">REMORA Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="REMORA_8H_source.html">REMORA.H</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for REMORA:</div>
<div class="dyncontent">
<div class="center"><img src="classREMORA__inherit__graph.png" border="0" usemap="#aREMORA_inherit__map" alt="Inheritance graph"/></div>
<map name="aREMORA_inherit__map" id="aREMORA_inherit__map">
<area shape="rect" title=" " alt="" coords="31,80,109,107"/>
<area shape="rect" title=" " alt="" coords="5,5,135,32"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for REMORA:</div>
<div class="dyncontent">
<div class="center"><img src="classREMORA__coll__graph.png" border="0" usemap="#aREMORA_coll__map" alt="Collaboration graph"/></div>
<map name="aREMORA_coll__map" id="aREMORA_coll__map">
<area shape="rect" title=" " alt="" coords="925,1411,1004,1437"/>
<area shape="rect" title=" " alt="" coords="551,17,680,44"/>
<area shape="rect" title=" " alt="" coords="489,68,741,95"/>
<area shape="rect" title=" " alt="" coords="530,119,701,161"/>
<area shape="rect" title=" " alt="" coords="502,185,729,212"/>
<area shape="rect" title=" " alt="" coords="237,447,288,473"/>
<area shape="rect" href="structSolverChoice.html" title=" " alt="" coords="562,837,669,864"/>
<area shape="rect" title=" " alt="" coords="222,912,303,939"/>
<area shape="rect" title=" " alt="" coords="208,963,317,989"/>
<area shape="rect" title=" " alt="" coords="243,1080,282,1107"/>
<area shape="rect" title=" " alt="" coords="237,757,288,784"/>
<area shape="rect" title=" " alt="" coords="219,1173,306,1200"/>
<area shape="rect" title=" " alt="" coords="5,1166,144,1207"/>
<area shape="rect" title=" " alt="" coords="193,1013,332,1040"/>
<area shape="rect" title=" " alt="" coords="214,861,311,888"/>
<area shape="rect" title=" " alt="" coords="536,1307,695,1333"/>
<area shape="rect" title=" " alt="" coords="533,1358,698,1399"/>
<area shape="rect" title=" " alt="" coords="577,1424,654,1451"/>
<area shape="rect" title=" " alt="" coords="499,1475,732,1517"/>
<area shape="rect" title=" " alt="" coords="529,1604,701,1631"/>
<area shape="rect" title=" " alt="" coords="560,1693,671,1720"/>
<area shape="rect" title=" " alt="" coords="511,1825,720,1852"/>
<area shape="rect" title=" " alt="" coords="525,1877,706,1918"/>
<area shape="rect" title=" " alt="" coords="531,1942,700,1983"/>
<area shape="rect" title=" " alt="" coords="533,2007,698,2049"/>
<area shape="rect" title=" " alt="" coords="547,2073,684,2100"/>
<area shape="rect" title=" " alt="" coords="523,2125,708,2195"/>
<area shape="rect" title=" " alt="" coords="517,2277,714,2318"/>
<area shape="rect" title=" " alt="" coords="523,2342,707,2383"/>
<area shape="rect" title=" " alt="" coords="523,2408,708,2435"/>
<area shape="rect" title=" " alt="" coords="531,2459,700,2501"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8a16e552c794ae05498e4cb0a65399af"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a8a16e552c794ae05498e4cb0a65399af">REMORA</a> ()</td></tr>
<tr class="separator:a8a16e552c794ae05498e4cb0a65399af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5750f77cb36737ece9e118a321a52da"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#af5750f77cb36737ece9e118a321a52da">~REMORA</a> ()</td></tr>
<tr class="separator:af5750f77cb36737ece9e118a321a52da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ea86fcd6c7d853a6c0110cf40f9cb1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a2ea86fcd6c7d853a6c0110cf40f9cb1e">Evolve</a> ()</td></tr>
<tr class="separator:a2ea86fcd6c7d853a6c0110cf40f9cb1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a783db1b357863608197eccb6fe7d4c52"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a783db1b357863608197eccb6fe7d4c52">ErrorEst</a> (int lev, amrex::TagBoxArray &amp;tags, amrex::Real time, int ngrow) override</td></tr>
<tr class="separator:a783db1b357863608197eccb6fe7d4c52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c0d7d3c687b85e71541fc5b5f849089"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a7c0d7d3c687b85e71541fc5b5f849089">InitData</a> ()</td></tr>
<tr class="separator:a7c0d7d3c687b85e71541fc5b5f849089"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4010e1137df2630bdd56327fad98e4a1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a4010e1137df2630bdd56327fad98e4a1">init_only</a> (int lev, amrex::Real time)</td></tr>
<tr class="separator:a4010e1137df2630bdd56327fad98e4a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af82928444cae433cc744c0cf7427e8eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#af82928444cae433cc744c0cf7427e8eb">restart</a> ()</td></tr>
<tr class="separator:af82928444cae433cc744c0cf7427e8eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a697e9a0fc5d32cd8833f68defaa65467"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a697e9a0fc5d32cd8833f68defaa65467">post_timestep</a> (int nstep, amrex::Real time, amrex::Real dt_lev)</td></tr>
<tr class="separator:a697e9a0fc5d32cd8833f68defaa65467"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafa685722589c03eb84d71568feb26bc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#aafa685722589c03eb84d71568feb26bc">sum_integrated_quantities</a> (amrex::Real time)</td></tr>
<tr class="separator:aafa685722589c03eb84d71568feb26bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abeeb495dbfc8b1a3f35556f156d4b3d2"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#abeeb495dbfc8b1a3f35556f156d4b3d2">volWgtSumMF</a> (int lev, const amrex::MultiFab &amp;mf, int comp, bool local, bool finemask)</td></tr>
<tr class="separator:abeeb495dbfc8b1a3f35556f156d4b3d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1343ee03c1a0119736b4afe199019f3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ac1343ee03c1a0119736b4afe199019f3">is_it_time_for_action</a> (int nstep, amrex::Real time, amrex::Real <a class="el" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>, int action_interval, amrex::Real action_per)</td></tr>
<tr class="separator:ac1343ee03c1a0119736b4afe199019f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2006ad0aefc229079ab5a7da054ea8fe"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a2006ad0aefc229079ab5a7da054ea8fe">MakeNewLevelFromCoarse</a> (int lev, amrex::Real time, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm) override</td></tr>
<tr class="separator:a2006ad0aefc229079ab5a7da054ea8fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73eb64a4ad24a247692981eae835caf2"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a73eb64a4ad24a247692981eae835caf2">RemakeLevel</a> (int lev, amrex::Real time, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm) override</td></tr>
<tr class="separator:a73eb64a4ad24a247692981eae835caf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a381f0228efdd9ed40fd9ed0825aa47c2"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a381f0228efdd9ed40fd9ed0825aa47c2">ClearLevel</a> (int lev) override</td></tr>
<tr class="separator:a381f0228efdd9ed40fd9ed0825aa47c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad64e9b244603ae920ed761821753a71f"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ad64e9b244603ae920ed761821753a71f">MakeNewLevelFromScratch</a> (int lev, amrex::Real time, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm) override</td></tr>
<tr class="separator:ad64e9b244603ae920ed761821753a71f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac71630052015782fce4f20e204e42016"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ac71630052015782fce4f20e204e42016">estTimeStep</a> (int lev) const</td></tr>
<tr class="separator:ac71630052015782fce4f20e204e42016"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f50a7999b5955331392139cfb09ad27"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a6f50a7999b5955331392139cfb09ad27">remora_advance</a> (int level, amrex::MultiFab &amp;<a class="el" href="classREMORA.html#abc6ebdcc84239b993b12b3c95425fa88">cons_old</a>, amrex::MultiFab &amp;<a class="el" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>, amrex::MultiFab &amp;<a class="el" href="classREMORA.html#a51594dd103a7eee0f4e0c6e366d9f0ce">xvel_old</a>, amrex::MultiFab &amp;<a class="el" href="classREMORA.html#a9861cf91ee53fb2125f5f49c5cf73155">yvel_old</a>, amrex::MultiFab &amp;<a class="el" href="classREMORA.html#a6a980b1cd1d4d0e1253a641bee00de75">zvel_old</a>, amrex::MultiFab &amp;<a class="el" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>, amrex::MultiFab &amp;<a class="el" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>, amrex::MultiFab &amp;<a class="el" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>, amrex::MultiFab &amp;source, const amrex::Geometry fine_geom, const amrex::Real <a class="el" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>, const amrex::Real time)</td></tr>
<tr class="separator:a6f50a7999b5955331392139cfb09ad27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6577b0c143b8fc44c6f68cad8dec5fd6"><td class="memItemLeft" align="right" valign="top">amrex::MultiFab &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a6577b0c143b8fc44c6f68cad8dec5fd6">build_fine_mask</a> (int lev)</td></tr>
<tr class="separator:a6577b0c143b8fc44c6f68cad8dec5fd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c03ef43eb1e2584973f5a45975f5482"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a6c03ef43eb1e2584973f5a45975f5482">WritePlotFile</a> (int which, amrex::Vector&lt; std::string &gt; plot_var_names)</td></tr>
<tr class="separator:a6c03ef43eb1e2584973f5a45975f5482"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c6fbe147d0a9bc99510fc8ee97aea98"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a8c6fbe147d0a9bc99510fc8ee97aea98">WriteMultiLevelPlotfileWithBathymetry</a> (const std::string &amp;plotfilename, int nlevels, const amrex::Vector&lt; const amrex::MultiFab * &gt; &amp;mf, const amrex::Vector&lt; const amrex::MultiFab * &gt; &amp;mf_nd, const amrex::Vector&lt; std::string &gt; &amp;varnames, amrex::Real time, const amrex::Vector&lt; int &gt; &amp;level_steps, const std::string &amp;versionName=&quot;HyperCLaw-V1.1&quot;, const std::string &amp;levelPrefix=&quot;Level_&quot;, const std::string &amp;mfPrefix=&quot;Cell&quot;, const amrex::Vector&lt; std::string &gt; &amp;extra_dirs=amrex::Vector&lt; std::string &gt;()) const</td></tr>
<tr class="separator:a8c6fbe147d0a9bc99510fc8ee97aea98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76b30b516d67fc5b30bfdfc221d63554"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a76b30b516d67fc5b30bfdfc221d63554">WriteGenericPlotfileHeaderWithBathymetry</a> (std::ostream &amp;HeaderFile, int nlevels, const amrex::Vector&lt; amrex::BoxArray &gt; &amp;bArray, const amrex::Vector&lt; std::string &gt; &amp;varnames, amrex::Real time, const amrex::Vector&lt; int &gt; &amp;level_steps, const std::string &amp;versionName, const std::string &amp;levelPrefix, const std::string &amp;mfPrefix) const</td></tr>
<tr class="separator:a76b30b516d67fc5b30bfdfc221d63554"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a67a95c1bc1f744268a245f4ca4c446"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a9a67a95c1bc1f744268a245f4ca4c446">Advance</a> (int lev, amrex::Real time, amrex::Real dt_lev, int iteration, int ncycle)</td></tr>
<tr class="separator:a9a67a95c1bc1f744268a245f4ca4c446"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9ee5aba5b9cb8e020e6cbc8ff3cff74"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ad9ee5aba5b9cb8e020e6cbc8ff3cff74">setup_step</a> (int lev, amrex::Real time, amrex::Real dt_lev)</td></tr>
<tr class="separator:ad9ee5aba5b9cb8e020e6cbc8ff3cff74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a805863a28beceb70cefd0b6f050d8c2d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a805863a28beceb70cefd0b6f050d8c2d">advance_3d_ml</a> (int lev, amrex::Real dt_lev)</td></tr>
<tr class="separator:a805863a28beceb70cefd0b6f050d8c2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67b92f7c5b82933e953e447bdfc9074c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a67b92f7c5b82933e953e447bdfc9074c">advance_2d_onestep</a> (int lev, amrex::Real dt_lev, amrex::Real dtfast_lev, int my_iif, int nfast_counter)</td></tr>
<tr class="separator:a67b92f7c5b82933e953e447bdfc9074c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2715857d136dc906b96d0e7c0423d50e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a2715857d136dc906b96d0e7c0423d50e">advance_2d</a> (int lev, amrex::MultiFab const *mf_rhoS, amrex::MultiFab const *mf_rhoA, amrex::MultiFab *mf_ru, amrex::MultiFab *mf_rv, amrex::MultiFab *mf_rufrc, amrex::MultiFab *mf_rvfrc, amrex::MultiFab *mf_Zt_avg1, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DU_avg1, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DU_avg2, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DV_avg1, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DV_avg2, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_rubar, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_rvbar, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_rzeta, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_ubar, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_vbar, amrex::MultiFab *mf_zeta, amrex::MultiFab const *mf_h, amrex::MultiFab const *mf_pm, amrex::MultiFab const *mf_pn, amrex::MultiFab const *mf_fcor, amrex::MultiFab const *mf_visc2_p, amrex::MultiFab const *mf_visc2_r, const amrex::Real dtfast_lev, const bool predictor_2d_step, const bool first_2d_step, int my_iif, int &amp;next_indx1)</td></tr>
<tr class="separator:a2715857d136dc906b96d0e7c0423d50e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc5094ee7dbf65109d98ea18ae3252f0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#afc5094ee7dbf65109d98ea18ae3252f0">advance_3d</a> (int lev, amrex::MultiFab &amp;mf_cons, amrex::MultiFab &amp;mf_u, amrex::MultiFab &amp;mf_v, amrex::MultiFab *mf_sstore, amrex::MultiFab *mf_ru, amrex::MultiFab *mf_rv, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DU_avg1, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DU_avg2, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DV_avg1, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DV_avg2, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_ubar, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_vbar, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_Akv, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_Akt, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_Hz, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_Huon, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_Hvom, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_z_w, amrex::MultiFab const *mf_h, amrex::MultiFab const *mf_pm, amrex::MultiFab const *mf_pn, const int N, const amrex::Real dt_lev)</td></tr>
<tr class="separator:afc5094ee7dbf65109d98ea18ae3252f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5e1fd1459f17ce2b00a93b0152c8911"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ab5e1fd1459f17ce2b00a93b0152c8911">prestep</a> (int lev, amrex::MultiFab &amp;mf_uold, amrex::MultiFab &amp;mf_vold, amrex::MultiFab &amp;mf_u, amrex::MultiFab &amp;mf_v, amrex::MultiFab *mf_ru, amrex::MultiFab *mf_rv, amrex::MultiFab &amp;S_old, amrex::MultiFab &amp;S_new, amrex::MultiFab &amp;mf_W, amrex::MultiFab &amp;mf_DC, const amrex::MultiFab *mf_z_r, const amrex::MultiFab *mf_z_w, const amrex::MultiFab *mf_h, const amrex::MultiFab *mf_pm, const amrex::MultiFab *mf_pn, const amrex::MultiFab *mf_sustr, const amrex::MultiFab *mf_svstr, const amrex::MultiFab *mf_bustr, const amrex::MultiFab *mf_bvstr, const int iic, const int nfirst, const int nnew, int nstp, int nrhs, int N, const amrex::Real dt_lev)</td></tr>
<tr class="separator:ab5e1fd1459f17ce2b00a93b0152c8911"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27de127e15dec41e90a2ecc596e7a81d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a27de127e15dec41e90a2ecc596e7a81d">prestep_t_advection</a> (const amrex::Box &amp;tbx, const amrex::Box &amp;gbx, const amrex::Array4&lt; amrex::Real &gt; &amp;tempold, const amrex::Array4&lt; amrex::Real &gt; &amp;tempcache, const amrex::Array4&lt; amrex::Real &gt; &amp;Hz, const amrex::Array4&lt; amrex::Real &gt; &amp;Huon, const amrex::Array4&lt; amrex::Real &gt; &amp;Hvom, const amrex::Array4&lt; amrex::Real &gt; &amp;W, const amrex::Array4&lt; amrex::Real &gt; &amp;DC, const amrex::Array4&lt; amrex::Real &gt; &amp;FC, const amrex::Array4&lt; amrex::Real &gt; &amp;sstore, const amrex::Array4&lt; amrex::Real const &gt; &amp;z_w, const amrex::Array4&lt; amrex::Real const &gt; &amp;h, const amrex::Array4&lt; amrex::Real const &gt; &amp;pm, const amrex::Array4&lt; amrex::Real const &gt; &amp;pn, int iic, int ntfirst, int nrhs, int N, const amrex::Real dt_lev)</td></tr>
<tr class="separator:a27de127e15dec41e90a2ecc596e7a81d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11e1383c91ab5a3df346a41a8b7338e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a11e1383c91ab5a3df346a41a8b7338e0">rhs_t_3d</a> (const amrex::Box &amp;bx, const amrex::Box &amp;gbx, const amrex::Array4&lt; amrex::Real &gt; &amp;t, const amrex::Array4&lt; amrex::Real const &gt; &amp;tempstore, const amrex::Array4&lt; amrex::Real const &gt; &amp;Huon, const amrex::Array4&lt; amrex::Real const &gt; &amp;Hvom, const amrex::Array4&lt; amrex::Real const &gt; &amp;Hz, const amrex::Array4&lt; amrex::Real const &gt; &amp;pn, const amrex::Array4&lt; amrex::Real const &gt; &amp;pm, const amrex::Array4&lt; amrex::Real const &gt; &amp;W, const amrex::Array4&lt; amrex::Real &gt; &amp;FC, int nrhs, int nnew, int N, const amrex::Real dt_lev)</td></tr>
<tr class="separator:a11e1383c91ab5a3df346a41a8b7338e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a717b3cb13872e3c7bf83261bc7c5e1b0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a717b3cb13872e3c7bf83261bc7c5e1b0">rhs_uv_3d</a> (const amrex::Box &amp;xbx, const amrex::Box &amp;ybx, const amrex::Array4&lt; amrex::Real const &gt; &amp;uold, const amrex::Array4&lt; amrex::Real const &gt; &amp;vold, const amrex::Array4&lt; amrex::Real &gt; &amp;ru, const amrex::Array4&lt; amrex::Real &gt; &amp;rv, const amrex::Array4&lt; amrex::Real &gt; &amp;rufrc, const amrex::Array4&lt; amrex::Real &gt; &amp;rvfrc, const amrex::Array4&lt; amrex::Real const &gt; &amp;sustr, const amrex::Array4&lt; amrex::Real const &gt; &amp;svstr, const amrex::Array4&lt; amrex::Real const &gt; &amp;bustr, const amrex::Array4&lt; amrex::Real const &gt; &amp;bvstr, const amrex::Array4&lt; amrex::Real const &gt; &amp;Huon, const amrex::Array4&lt; amrex::Real const &gt; &amp;Hvom, const amrex::Array4&lt; amrex::Real const &gt; &amp;pm, const amrex::Array4&lt; amrex::Real const &gt; &amp;pn, const amrex::Array4&lt; amrex::Real const &gt; &amp;W, const amrex::Array4&lt; amrex::Real &gt; &amp;FC, int nrhs, int N)</td></tr>
<tr class="separator:a717b3cb13872e3c7bf83261bc7c5e1b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08a2748cf44d3e95d08a1b78aef3d15f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a08a2748cf44d3e95d08a1b78aef3d15f">rhs_uv_2d</a> (const amrex::Box &amp;xbx, const amrex::Box &amp;ybx, const amrex::Array4&lt; amrex::Real const &gt; &amp;uold, const amrex::Array4&lt; amrex::Real const &gt; &amp;vold, const amrex::Array4&lt; amrex::Real &gt; &amp;ru, const amrex::Array4&lt; amrex::Real &gt; &amp;rv, const amrex::Array4&lt; amrex::Real const &gt; &amp;Duon, const amrex::Array4&lt; amrex::Real const &gt; &amp;Dvom, const int nrhs)</td></tr>
<tr class="separator:a08a2748cf44d3e95d08a1b78aef3d15f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec60535e082a13276ce2334170205171"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#aec60535e082a13276ce2334170205171">rho_eos</a> (const amrex::Box &amp;bx, const amrex::Array4&lt; amrex::Real const &gt; &amp;state, const amrex::Array4&lt; amrex::Real &gt; &amp;rho, const amrex::Array4&lt; amrex::Real &gt; &amp;rhoA, const amrex::Array4&lt; amrex::Real &gt; &amp;rhoS, const amrex::Array4&lt; amrex::Real const &gt; &amp;Hz, const amrex::Array4&lt; amrex::Real const &gt; &amp;z_w, const amrex::Array4&lt; amrex::Real const &gt; &amp;h, const int N)</td></tr>
<tr class="separator:aec60535e082a13276ce2334170205171"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8928e9ae21348d045cc231d56e1d45a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#af8928e9ae21348d045cc231d56e1d45a">prsgrd</a> (const amrex::Box &amp;bx, const amrex::Box &amp;gbx, const amrex::Box &amp;utbx, const amrex::Box &amp;vtbx, const amrex::Array4&lt; amrex::Real &gt; &amp;ru, const amrex::Array4&lt; amrex::Real &gt; &amp;rv, const amrex::Array4&lt; amrex::Real const &gt; &amp;pn, const amrex::Array4&lt; amrex::Real const &gt; &amp;pm, const amrex::Array4&lt; amrex::Real const &gt; &amp;rho, const amrex::Array4&lt; amrex::Real &gt; &amp;FC, const amrex::Array4&lt; amrex::Real const &gt; &amp;Hz, const amrex::Array4&lt; amrex::Real const &gt; &amp;z_r, const amrex::Array4&lt; amrex::Real const &gt; &amp;z_w, const int nrhs, const int N)</td></tr>
<tr class="separator:af8928e9ae21348d045cc231d56e1d45a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dcfa91810e83ac902f4aba8894a49cf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a0dcfa91810e83ac902f4aba8894a49cf">prestep_diffusion</a> (const amrex::Box &amp;bx, const amrex::Box &amp;gbx, const int ioff, const int joff, const amrex::Array4&lt; amrex::Real &gt; &amp;vel, const amrex::Array4&lt; amrex::Real const &gt; &amp;vel_old, const amrex::Array4&lt; amrex::Real &gt; &amp;rvel, const amrex::Array4&lt; amrex::Real const &gt; &amp;Hz, const amrex::Array4&lt; amrex::Real const &gt; &amp;Akv, const amrex::Array4&lt; amrex::Real &gt; &amp;DC, const amrex::Array4&lt; amrex::Real &gt; &amp;FC, const amrex::Array4&lt; amrex::Real const &gt; &amp;sstr, const amrex::Array4&lt; amrex::Real const &gt; &amp;bstr, const amrex::Array4&lt; amrex::Real const &gt; &amp;z_r, const amrex::Array4&lt; amrex::Real const &gt; &amp;pm, const amrex::Array4&lt; amrex::Real const &gt; &amp;pn, const int iic, const int ntfirst, const int nnew, int nstp, int nrhs, int N, const amrex::Real lambda, const amrex::Real dt_lev)</td></tr>
<tr class="separator:a0dcfa91810e83ac902f4aba8894a49cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac027e24879f2db46f7af0ac0bd7880f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ac027e24879f2db46f7af0ac0bd7880f1">vert_visc_3d</a> (const amrex::Box &amp;bx, const int ioff, const int joff, const amrex::Array4&lt; amrex::Real &gt; &amp;phi, const amrex::Array4&lt; amrex::Real const &gt; &amp;Hz, const amrex::Array4&lt; amrex::Real &gt; &amp;Hzk, const amrex::Array4&lt; amrex::Real &gt; &amp;AK, const amrex::Array4&lt; amrex::Real &gt; &amp;Akv, const amrex::Array4&lt; amrex::Real &gt; &amp;BC, const amrex::Array4&lt; amrex::Real &gt; &amp;DC, const amrex::Array4&lt; amrex::Real &gt; &amp;FC, const amrex::Array4&lt; amrex::Real &gt; &amp;CF, const int nnew, const int N, const amrex::Real dt_lev)</td></tr>
<tr class="separator:ac027e24879f2db46f7af0ac0bd7880f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acea9f8015629ed812b0f2a00ab1f1b70"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#acea9f8015629ed812b0f2a00ab1f1b70">update_massflux_3d</a> (const amrex::Box &amp;bx, const int ioff, const int joff, const amrex::Array4&lt; amrex::Real &gt; &amp;phi, const amrex::Array4&lt; amrex::Real &gt; &amp;phibar, const amrex::Array4&lt; amrex::Real &gt; &amp;Hphi, const amrex::Array4&lt; amrex::Real const &gt; &amp;Hz, const amrex::Array4&lt; amrex::Real const &gt; &amp;pm_or_pn, const amrex::Array4&lt; amrex::Real const &gt; &amp;Dphi1, const amrex::Array4&lt; amrex::Real const &gt; &amp;Dphi2, const amrex::Array4&lt; amrex::Real &gt; &amp;DC, const amrex::Array4&lt; amrex::Real &gt; &amp;FC, const int nnew)</td></tr>
<tr class="separator:acea9f8015629ed812b0f2a00ab1f1b70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a745f57b79548ae8e06b0df3ceb5def44"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a745f57b79548ae8e06b0df3ceb5def44">vert_mean_3d</a> (const amrex::Box &amp;bx, const int ioff, const int joff, const amrex::Array4&lt; amrex::Real &gt; &amp;phi, const amrex::Array4&lt; amrex::Real const &gt; &amp;Hz, const amrex::Array4&lt; amrex::Real const &gt; &amp;Dphi_avg1, const amrex::Array4&lt; amrex::Real &gt; &amp;DC, const amrex::Array4&lt; amrex::Real &gt; &amp;CF, const amrex::Array4&lt; amrex::Real const &gt; &amp;dxlen, const int nnew, const int N)</td></tr>
<tr class="separator:a745f57b79548ae8e06b0df3ceb5def44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e195a7da3e0ada7179455688f4711b5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a5e195a7da3e0ada7179455688f4711b5">uv3dmix</a> (const amrex::Box &amp;xbx, const amrex::Box &amp;ybx, const amrex::Array4&lt; amrex::Real &gt; &amp;u, const amrex::Array4&lt; amrex::Real &gt; &amp;v, const amrex::Array4&lt; amrex::Real const &gt; &amp;uold, const amrex::Array4&lt; amrex::Real const &gt; &amp;vold, const amrex::Array4&lt; amrex::Real &gt; &amp;rufrc, const amrex::Array4&lt; amrex::Real &gt; &amp;rvfrc, const amrex::Array4&lt; amrex::Real const &gt; &amp;visc2_p, const amrex::Array4&lt; amrex::Real const &gt; &amp;visc2_r, const amrex::Array4&lt; amrex::Real const &gt; &amp;Hz, const amrex::Array4&lt; amrex::Real const &gt; &amp;pm, const amrex::Array4&lt; amrex::Real const &gt; &amp;pn, int nrhs, int nnew, const amrex::Real dt_lev)</td></tr>
<tr class="separator:a5e195a7da3e0ada7179455688f4711b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c7e059060888336e41e8a52bf716f06"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a7c7e059060888336e41e8a52bf716f06">t3dmix</a> (const amrex::Box &amp;bx, const amrex::Array4&lt; amrex::Real &gt; &amp;state, const amrex::Array4&lt; amrex::Real const &gt; &amp;diff2, const amrex::Array4&lt; amrex::Real const &gt; &amp;Hz, const amrex::Array4&lt; amrex::Real const &gt; &amp;pm, const amrex::Array4&lt; amrex::Real const &gt; &amp;pn, const amrex::Real dt_lev, const int ncomp)</td></tr>
<tr class="separator:a7c7e059060888336e41e8a52bf716f06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af28f51401edd36aa6014d9536e1393da"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#af28f51401edd36aa6014d9536e1393da">coriolis</a> (const amrex::Box &amp;xbx, const amrex::Box &amp;ybx, const amrex::Array4&lt; amrex::Real const &gt; &amp;uold, const amrex::Array4&lt; amrex::Real const &gt; &amp;vold, const amrex::Array4&lt; amrex::Real &gt; &amp;ru, const amrex::Array4&lt; amrex::Real &gt; &amp;rv, const amrex::Array4&lt; amrex::Real const &gt; &amp;Hz, const amrex::Array4&lt; amrex::Real const &gt; &amp;fomn, int nrhs, int nr)</td></tr>
<tr class="separator:af28f51401edd36aa6014d9536e1393da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9d2fbd8ac171ab10eb09ff189cbb69b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ab9d2fbd8ac171ab10eb09ff189cbb69b">set_2darrays</a> (int lev)</td></tr>
<tr class="separator:ab9d2fbd8ac171ab10eb09ff189cbb69b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97de693d117772818b80fb566720d4c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a97de693d117772818b80fb566720d4c1">set_bathymetry</a> (int lev)</td></tr>
<tr class="separator:a97de693d117772818b80fb566720d4c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43ebfe013ec1e2d1d0a8faaba3ebbbb6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a43ebfe013ec1e2d1d0a8faaba3ebbbb6">set_coriolis</a> (int lev)</td></tr>
<tr class="separator:a43ebfe013ec1e2d1d0a8faaba3ebbbb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20f12090c7b81ca46d953ccf1319c0f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a20f12090c7b81ca46d953ccf1319c0f5">stretch_transform</a> (int lev)</td></tr>
<tr class="separator:a20f12090c7b81ca46d953ccf1319c0f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72df3d34cb4020524bc7aefe66db5aa8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a72df3d34cb4020524bc7aefe66db5aa8">set_vmix</a> (int lev)</td></tr>
<tr class="separator:a72df3d34cb4020524bc7aefe66db5aa8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d4e9bae68124255e7ef6e949949d7ae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a4d4e9bae68124255e7ef6e949949d7ae">set_smflux</a> (int lev, amrex::Real time)</td></tr>
<tr class="separator:a4d4e9bae68124255e7ef6e949949d7ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac61ff34983f1636e08e957c5a2a0ddbc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ac61ff34983f1636e08e957c5a2a0ddbc">set_hmixcoef</a> (int lev)</td></tr>
<tr class="separator:ac61ff34983f1636e08e957c5a2a0ddbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6554e8c3a6e26956493818ff4e9ef1f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a6554e8c3a6e26956493818ff4e9ef1f8">set_drag</a> (int lev)</td></tr>
<tr class="separator:a6554e8c3a6e26956493818ff4e9ef1f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad09828d9cb740f8465f4a794c2d90460"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ad09828d9cb740f8465f4a794c2d90460">set_weights</a> (int lev)</td></tr>
<tr class="separator:ad09828d9cb740f8465f4a794c2d90460"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeac4c75110a1011acdf716c00bc62299"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a> (int lev, amrex::Real time, amrex::MultiFab &amp;mf_to_be_filled, amrex::Vector&lt; amrex::MultiFab * &gt; const &amp;mfs, const int bdy_var_type=<a class="el" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325ab738c65b8fa93b2166002dce928aca27">BdyVars::null</a>)</td></tr>
<tr class="separator:aeac4c75110a1011acdf716c00bc62299"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab33ba40181998f803a89d89c175d561e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ab33ba40181998f803a89d89c175d561e">fill_from_bdyfiles</a> (amrex::MultiFab &amp;mf_to_fill, const amrex::Real time, const int bdy_var_type)</td></tr>
<tr class="separator:ab33ba40181998f803a89d89c175d561e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71e63d1870dd72923c2e110fa4158202"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a71e63d1870dd72923c2e110fa4158202">init_beta_plane_coriolis</a> (int lev)</td></tr>
<tr class="separator:a71e63d1870dd72923c2e110fa4158202"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a331fbdef188eaf70cc72be04b1208020"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a331fbdef188eaf70cc72be04b1208020">writeJobInfo</a> (const std::string &amp;dir) const</td></tr>
<tr class="separator:a331fbdef188eaf70cc72be04b1208020"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a7714f7f51b35f7a425da770fdae443c6"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a7714f7f51b35f7a425da770fdae443c6">writeBuildInfo</a> (std::ostream &amp;os)</td></tr>
<tr class="separator:a7714f7f51b35f7a425da770fdae443c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a9724f153d0c7a89c5d6aec11605959aa"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a9724f153d0c7a89c5d6aec11605959aa">pp_prefix</a> {&quot;remora&quot;}</td></tr>
<tr class="separator:a9724f153d0c7a89c5d6aec11605959aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc6ebdcc84239b993b12b3c95425fa88"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#abc6ebdcc84239b993b12b3c95425fa88">cons_old</a></td></tr>
<tr class="separator:abc6ebdcc84239b993b12b3c95425fa88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51594dd103a7eee0f4e0c6e366d9f0ce"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a51594dd103a7eee0f4e0c6e366d9f0ce">xvel_old</a></td></tr>
<tr class="separator:a51594dd103a7eee0f4e0c6e366d9f0ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9861cf91ee53fb2125f5f49c5cf73155"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a9861cf91ee53fb2125f5f49c5cf73155">yvel_old</a></td></tr>
<tr class="separator:a9861cf91ee53fb2125f5f49c5cf73155"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a980b1cd1d4d0e1253a641bee00de75"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a6a980b1cd1d4d0e1253a641bee00de75">zvel_old</a></td></tr>
<tr class="separator:a6a980b1cd1d4d0e1253a641bee00de75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e6bb5ba18bc44344e75066721820ed5"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a></td></tr>
<tr class="separator:a1e6bb5ba18bc44344e75066721820ed5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d4e5271a8d00e497c4bce0a51dbe63c"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a></td></tr>
<tr class="separator:a6d4e5271a8d00e497c4bce0a51dbe63c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57327a8173b5dd09f9db6ce23f745dd5"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a></td></tr>
<tr class="separator:a57327a8173b5dd09f9db6ce23f745dd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3950916f4ed965bcd10f62e28e08fd76"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a></td></tr>
<tr class="separator:a3950916f4ed965bcd10f62e28e08fd76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a157e7645fedcf8c0b46516dbb625d3bd"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a157e7645fedcf8c0b46516dbb625d3bd">vec_hOfTheConfusingName</a></td></tr>
<tr class="separator:a157e7645fedcf8c0b46516dbb625d3bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a488738b1aea61abbbf086a9d22b4f815"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a488738b1aea61abbbf086a9d22b4f815">vec_Hz</a></td></tr>
<tr class="separator:a488738b1aea61abbbf086a9d22b4f815"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89f042895cd59cc1a1226f2af2d3e04f"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a89f042895cd59cc1a1226f2af2d3e04f">vec_Huon</a></td></tr>
<tr class="separator:a89f042895cd59cc1a1226f2af2d3e04f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd1aab14dfc9155d65e48aad2b34ef42"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#afd1aab14dfc9155d65e48aad2b34ef42">vec_Hvom</a></td></tr>
<tr class="separator:afd1aab14dfc9155d65e48aad2b34ef42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf06acc3074f6a4dd322f9e1ca0c5244"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#aaf06acc3074f6a4dd322f9e1ca0c5244">vec_ru</a></td></tr>
<tr class="separator:aaf06acc3074f6a4dd322f9e1ca0c5244"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4e70f2661f28e3a3a2585540e804486"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ae4e70f2661f28e3a3a2585540e804486">vec_rv</a></td></tr>
<tr class="separator:ae4e70f2661f28e3a3a2585540e804486"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a0dd90f9e35c6055bf3ede53f4229d6"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a5a0dd90f9e35c6055bf3ede53f4229d6">vec_rufrc</a></td></tr>
<tr class="separator:a5a0dd90f9e35c6055bf3ede53f4229d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49ea2c6c379a0fa006e4b6023fd69f88"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a49ea2c6c379a0fa006e4b6023fd69f88">vec_rvfrc</a></td></tr>
<tr class="separator:a49ea2c6c379a0fa006e4b6023fd69f88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad36ee94716ca0cde00d8cad5fe5cce94"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ad36ee94716ca0cde00d8cad5fe5cce94">vec_Akv</a></td></tr>
<tr class="separator:ad36ee94716ca0cde00d8cad5fe5cce94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48c1bf42530780ce02b3655d7cefe592"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a48c1bf42530780ce02b3655d7cefe592">vec_Akt</a></td></tr>
<tr class="separator:a48c1bf42530780ce02b3655d7cefe592"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65281506759b30fbc3c382ba0a64f38f"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a65281506759b30fbc3c382ba0a64f38f">vec_visc2_p</a></td></tr>
<tr class="separator:a65281506759b30fbc3c382ba0a64f38f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86f0a2458c28f42d5be178d7bc5d104b"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a86f0a2458c28f42d5be178d7bc5d104b">vec_visc2_r</a></td></tr>
<tr class="separator:a86f0a2458c28f42d5be178d7bc5d104b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdf4b75f0ec12caf3648dbee5ec7f653"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#afdf4b75f0ec12caf3648dbee5ec7f653">vec_diff2</a></td></tr>
<tr class="separator:afdf4b75f0ec12caf3648dbee5ec7f653"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55ca3c497c355a95a82bfbacf955771e"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a55ca3c497c355a95a82bfbacf955771e">vec_x_r</a></td></tr>
<tr class="separator:a55ca3c497c355a95a82bfbacf955771e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab86841fb3954bcabcb79275416c46253"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ab86841fb3954bcabcb79275416c46253">vec_y_r</a></td></tr>
<tr class="separator:ab86841fb3954bcabcb79275416c46253"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b24784c109d216c5a6cee02af8c5b0f"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a6b24784c109d216c5a6cee02af8c5b0f">vec_z_r</a></td></tr>
<tr class="separator:a6b24784c109d216c5a6cee02af8c5b0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7958bb9cfac605c91f1e74357f344b2"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#af7958bb9cfac605c91f1e74357f344b2">vec_z_w</a></td></tr>
<tr class="separator:af7958bb9cfac605c91f1e74357f344b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc9f775b64d67d4ad85bc493c9c54f4f"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#afc9f775b64d67d4ad85bc493c9c54f4f">vec_s_r</a></td></tr>
<tr class="separator:afc9f775b64d67d4ad85bc493c9c54f4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac956bf3a52181b34d3e98a85ea5ba131"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ac956bf3a52181b34d3e98a85ea5ba131">vec_z_phys_nd</a></td></tr>
<tr class="separator:ac956bf3a52181b34d3e98a85ea5ba131"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adeb60c66ba4665f07c57fbf3b3b8909a"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#adeb60c66ba4665f07c57fbf3b3b8909a">vec_Zt_avg1</a></td></tr>
<tr class="separator:adeb60c66ba4665f07c57fbf3b3b8909a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a347a75f9295217fc66a8b7a4c2a47f9b"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a347a75f9295217fc66a8b7a4c2a47f9b">vec_sustr</a></td></tr>
<tr class="separator:a347a75f9295217fc66a8b7a4c2a47f9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88a26701f7276ea04f5c9ede4ae46981"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a88a26701f7276ea04f5c9ede4ae46981">vec_svstr</a></td></tr>
<tr class="separator:a88a26701f7276ea04f5c9ede4ae46981"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adba780a7c66c2158c914bff64964df60"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#adba780a7c66c2158c914bff64964df60">vec_rdrag</a></td></tr>
<tr class="separator:adba780a7c66c2158c914bff64964df60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd341c53d0813eaea345511b8e14afdd"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#abd341c53d0813eaea345511b8e14afdd">vec_bustr</a></td></tr>
<tr class="separator:abd341c53d0813eaea345511b8e14afdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7d186a8a4d54c28a5b2eecaec6cb978"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ac7d186a8a4d54c28a5b2eecaec6cb978">vec_bvstr</a></td></tr>
<tr class="separator:ac7d186a8a4d54c28a5b2eecaec6cb978"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8e2ff918dcaf20a807b37e88f9fdbb0"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ab8e2ff918dcaf20a807b37e88f9fdbb0">vec_DU_avg1</a></td></tr>
<tr class="separator:ab8e2ff918dcaf20a807b37e88f9fdbb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b2cc0f2f617e846c6261df12aefd110"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a1b2cc0f2f617e846c6261df12aefd110">vec_DU_avg2</a></td></tr>
<tr class="separator:a1b2cc0f2f617e846c6261df12aefd110"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e0560b2f68b9c541583c9c1ff6c87ec"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a9e0560b2f68b9c541583c9c1ff6c87ec">vec_DV_avg1</a></td></tr>
<tr class="separator:a9e0560b2f68b9c541583c9c1ff6c87ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5ba663380c2e7b3857e21fd0d4286f9"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ac5ba663380c2e7b3857e21fd0d4286f9">vec_DV_avg2</a></td></tr>
<tr class="separator:ac5ba663380c2e7b3857e21fd0d4286f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15b7ca3e79155dde5c648ac78d64e6c7"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a15b7ca3e79155dde5c648ac78d64e6c7">vec_rubar</a></td></tr>
<tr class="separator:a15b7ca3e79155dde5c648ac78d64e6c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66a39d31a3a2f027101cfd4052b913f3"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a66a39d31a3a2f027101cfd4052b913f3">vec_rvbar</a></td></tr>
<tr class="separator:a66a39d31a3a2f027101cfd4052b913f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8c001dd94aa7fb806502579324905fd"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ac8c001dd94aa7fb806502579324905fd">vec_rzeta</a></td></tr>
<tr class="separator:ac8c001dd94aa7fb806502579324905fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb214b8bab178b72c44907f5e2aeead8"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#abb214b8bab178b72c44907f5e2aeead8">vec_ubar</a></td></tr>
<tr class="separator:abb214b8bab178b72c44907f5e2aeead8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab70c8d3ac0d8a5f7ac51365571905874"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ab70c8d3ac0d8a5f7ac51365571905874">vec_vbar</a></td></tr>
<tr class="separator:ab70c8d3ac0d8a5f7ac51365571905874"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab60f476961622f8e7f27221595e84956"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ab60f476961622f8e7f27221595e84956">vec_zeta</a></td></tr>
<tr class="separator:ab60f476961622f8e7f27221595e84956"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a173014aa6947dd9d4e0026541211f2be"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a173014aa6947dd9d4e0026541211f2be">vec_pm</a></td></tr>
<tr class="separator:a173014aa6947dd9d4e0026541211f2be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2d61f66b270a3def972bf32478790d8"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ad2d61f66b270a3def972bf32478790d8">vec_pn</a></td></tr>
<tr class="separator:ad2d61f66b270a3def972bf32478790d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13f9894ec6aca96e68687e7a6762e337"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a13f9894ec6aca96e68687e7a6762e337">vec_fcor</a></td></tr>
<tr class="separator:a13f9894ec6aca96e68687e7a6762e337"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d55e55c73497ceabf620dacbe632a3a"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a3d55e55c73497ceabf620dacbe632a3a">vec_sstore</a></td></tr>
<tr class="separator:a3d55e55c73497ceabf620dacbe632a3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae58396940a8e44b9b8aa4b6ec6e878f"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#aae58396940a8e44b9b8aa4b6ec6e878f">vec_visc3d_r</a></td></tr>
<tr class="separator:aae58396940a8e44b9b8aa4b6ec6e878f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8386c899de7b3b3feab286c144f15229"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a8386c899de7b3b3feab286c144f15229">vec_rhoS</a></td></tr>
<tr class="separator:a8386c899de7b3b3feab286c144f15229"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9acf62fad9b709ea10e00e9534d7a7c5"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a9acf62fad9b709ea10e00e9534d7a7c5">vec_rhoA</a></td></tr>
<tr class="separator:a9acf62fad9b709ea10e00e9534d7a7c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab17dd7f0866773488c052d67cb6086b3"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ab17dd7f0866773488c052d67cb6086b3">vec_weight1</a></td></tr>
<tr class="separator:ab17dd7f0866773488c052d67cb6086b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a634b285cb09738ecdc4b191e897744ed"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a634b285cb09738ecdc4b191e897744ed">vec_weight2</a></td></tr>
<tr class="separator:a634b285cb09738ecdc4b191e897744ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:aae1b7a86e03c93dd71e2d68c700d2512"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#aae1b7a86e03c93dd71e2d68c700d2512">ReadParameters</a> ()</td></tr>
<tr class="separator:aae1b7a86e03c93dd71e2d68c700d2512"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc4cc491f4e1714d3d4999290046c82e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#acc4cc491f4e1714d3d4999290046c82e">AverageDown</a> ()</td></tr>
<tr class="separator:acc4cc491f4e1714d3d4999290046c82e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a437491da7d00b192e02dcd409825023e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a437491da7d00b192e02dcd409825023e">init1DArrays</a> ()</td></tr>
<tr class="separator:a437491da7d00b192e02dcd409825023e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fb1bee6b7c41edde86f488eeb440478"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a0fb1bee6b7c41edde86f488eeb440478">init_bcs</a> ()</td></tr>
<tr class="separator:a0fb1bee6b7c41edde86f488eeb440478"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77de1102264f09670fbd00a76aa2c58f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a77de1102264f09670fbd00a76aa2c58f">init_custom</a> (int lev)</td></tr>
<tr class="separator:a77de1102264f09670fbd00a76aa2c58f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98ad64e4a964e4748ebae07a26405286"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a98ad64e4a964e4748ebae07a26405286">init_stuff</a> (int lev, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm)</td></tr>
<tr class="separator:a98ad64e4a964e4748ebae07a26405286"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa91decb04550c58b177e6a18b9d70f0d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#aa91decb04550c58b177e6a18b9d70f0d">resize_stuff</a> (int lev)</td></tr>
<tr class="separator:aa91decb04550c58b177e6a18b9d70f0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a685a244b9590a93bd7272b2261d0ecf3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a685a244b9590a93bd7272b2261d0ecf3">AverageDownTo</a> (int crse_lev)</td></tr>
<tr class="separator:a685a244b9590a93bd7272b2261d0ecf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95cda6dc2401e1e6d3df49eeda4ee6e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a95cda6dc2401e1e6d3df49eeda4ee6e1">FillCoarsePatch</a> (int lev, amrex::Real time, amrex::MultiFab *mf_fine, amrex::MultiFab *mf_crse)</td></tr>
<tr class="separator:a95cda6dc2401e1e6d3df49eeda4ee6e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99e2295484a51457ec8d2c9700261783"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structTimeInterpolatedData.html">TimeInterpolatedData</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a99e2295484a51457ec8d2c9700261783">GetDataAtTime</a> (int lev, amrex::Real time)</td></tr>
<tr class="separator:a99e2295484a51457ec8d2c9700261783"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac88ed7a3bf97eec4dca7f70126a0600d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ac88ed7a3bf97eec4dca7f70126a0600d">timeStep</a> (int lev, amrex::Real time, int iteration)</td></tr>
<tr class="separator:ac88ed7a3bf97eec4dca7f70126a0600d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf259537f6d9c23a0edcf6641381a9d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#acf259537f6d9c23a0edcf6641381a9d0">timeStepML</a> (amrex::Real time, int iteration)</td></tr>
<tr class="separator:acf259537f6d9c23a0edcf6641381a9d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98506141bb44abb0093a766be5d93318"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a98506141bb44abb0093a766be5d93318">initHSE</a> ()</td></tr>
<tr class="memdesc:a98506141bb44abb0093a766be5d93318"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize HSE.  <a href="classREMORA.html#a98506141bb44abb0093a766be5d93318">More...</a><br /></td></tr>
<tr class="separator:a98506141bb44abb0093a766be5d93318"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb0b6f25ef34e41463df97bf33d0cdee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#adb0b6f25ef34e41463df97bf33d0cdee">initRayleigh</a> ()</td></tr>
<tr class="memdesc:adb0b6f25ef34e41463df97bf33d0cdee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize Rayleigh damping profiles.  <a href="classREMORA.html#adb0b6f25ef34e41463df97bf33d0cdee">More...</a><br /></td></tr>
<tr class="separator:adb0b6f25ef34e41463df97bf33d0cdee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7671b889b87ca190f7aba7188074efa3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a7671b889b87ca190f7aba7188074efa3">ComputeDt</a> ()</td></tr>
<tr class="separator:a7671b889b87ca190f7aba7188074efa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4d8c0cbac8976c70668280de6a142c2"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ac4d8c0cbac8976c70668280de6a142c2">PlotFileName</a> (int lev) const</td></tr>
<tr class="separator:ac4d8c0cbac8976c70668280de6a142c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf81b939a430211f29fed95b3d5f06fb"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#adf81b939a430211f29fed95b3d5f06fb">PlotFileVarNames</a> (amrex::Vector&lt; std::string &gt; plot_var_names) const</td></tr>
<tr class="separator:adf81b939a430211f29fed95b3d5f06fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe11d354ade4deed0c57c6f44f85ab41"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#afe11d354ade4deed0c57c6f44f85ab41">setPlotVariables</a> (const std::string &amp;pp_plot_var_names, amrex::Vector&lt; std::string &gt; &amp;plot_var_names)</td></tr>
<tr class="separator:afe11d354ade4deed0c57c6f44f85ab41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec14981d78f55e2e326b1080cfc5656c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#aec14981d78f55e2e326b1080cfc5656c">WriteCheckpointFile</a> () const</td></tr>
<tr class="separator:aec14981d78f55e2e326b1080cfc5656c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a316a6db4c0b9a218e834c054d8c8f437"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a316a6db4c0b9a218e834c054d8c8f437">ReadCheckpointFile</a> ()</td></tr>
<tr class="separator:a316a6db4c0b9a218e834c054d8c8f437"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af25043e75bc350bc40ae56f65649554b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#af25043e75bc350bc40ae56f65649554b">InitializeFromFile</a> ()</td></tr>
<tr class="separator:af25043e75bc350bc40ae56f65649554b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc5dc3d0306ebb6507e6c702241f07a0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#abc5dc3d0306ebb6507e6c702241f07a0">InitializeLevelFromData</a> (int lev, const amrex::MultiFab &amp;initial_data)</td></tr>
<tr class="separator:abc5dc3d0306ebb6507e6c702241f07a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad450c4cc94bef5b7ca2d9fc17d554336"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ad450c4cc94bef5b7ca2d9fc17d554336">post_update</a> (amrex::MultiFab &amp;state_mf, const amrex::Real time, const amrex::Geometry &amp;geom)</td></tr>
<tr class="separator:ad450c4cc94bef5b7ca2d9fc17d554336"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb9088da220a64e077ddb2cc8939ba2d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#abb9088da220a64e077ddb2cc8939ba2d">fill_rhs</a> (amrex::MultiFab &amp;rhs_mf, const amrex::MultiFab &amp;state_mf, const amrex::Real time, const amrex::Geometry &amp;geom)</td></tr>
<tr class="separator:abb9088da220a64e077ddb2cc8939ba2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6da8127bba6a3636d4f5ae30983eaf9c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a6da8127bba6a3636d4f5ae30983eaf9c">refinement_criteria_setup</a> ()</td></tr>
<tr class="separator:a6da8127bba6a3636d4f5ae30983eaf9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3be29f45efb0b259995c494f6dac2b97"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a3be29f45efb0b259995c494f6dac2b97">ComputeGhostCells</a> (const int &amp;spatial_order)</td></tr>
<tr class="separator:a3be29f45efb0b259995c494f6dac2b97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e2c89247c418609b713bdc107696258"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE amrex::YAFluxRegister *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a0e2c89247c418609b713bdc107696258">getAdvFluxReg</a> (int lev)</td></tr>
<tr class="separator:a0e2c89247c418609b713bdc107696258"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82e5140a7b4d9092e8230b7043d0a388"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a82e5140a7b4d9092e8230b7043d0a388">DataLog</a> (int i)</td></tr>
<tr class="separator:a82e5140a7b4d9092e8230b7043d0a388"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe6c7702fc1edcb5bb7d9a1a56d007a9"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#abe6c7702fc1edcb5bb7d9a1a56d007a9">NumDataLogs</a> () noexcept</td></tr>
<tr class="separator:abe6c7702fc1edcb5bb7d9a1a56d007a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79eb0ac9909062422d3b3207a7643dd8"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a79eb0ac9909062422d3b3207a7643dd8">getCPUTime</a> () const</td></tr>
<tr class="separator:a79eb0ac9909062422d3b3207a7643dd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f4ee77d07b875ac526da57e8f0f1e98"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a7f4ee77d07b875ac526da57e8f0f1e98">setRecordDataInfo</a> (int i, const std::string &amp;filename)</td></tr>
<tr class="separator:a7f4ee77d07b875ac526da57e8f0f1e98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8062b4dcb1ea9deba016d427d23480aa"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a8062b4dcb1ea9deba016d427d23480aa">DataLogName</a> (int i) const noexcept</td></tr>
<tr class="memdesc:a8062b4dcb1ea9deba016d427d23480aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">The filename of the ith datalog file.  <a href="classREMORA.html#a8062b4dcb1ea9deba016d427d23480aa">More...</a><br /></td></tr>
<tr class="separator:a8062b4dcb1ea9deba016d427d23480aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a03e3346471b528f47454cd969393786d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a03e3346471b528f47454cd969393786d">GotoNextLine</a> (std::istream &amp;is)</td></tr>
<tr class="separator:a03e3346471b528f47454cd969393786d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a6d28606118c0069a57eb6a3c13685c56"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a6d28606118c0069a57eb6a3c13685c56">num_boxes_at_level</a></td></tr>
<tr class="separator:a6d28606118c0069a57eb6a3c13685c56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66ad489788fb8d0913833d3d6c89b9dd"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a66ad489788fb8d0913833d3d6c89b9dd">num_files_at_level</a></td></tr>
<tr class="separator:a66ad489788fb8d0913833d3d6c89b9dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45b928a121bd6c5e75ec75732a27f774"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Box &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a45b928a121bd6c5e75ec75732a27f774">boxes_at_level</a></td></tr>
<tr class="separator:a45b928a121bd6c5e75ec75732a27f774"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c44493fe1a5743c92f272c91c3aa558"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a></td></tr>
<tr class="separator:a7c44493fe1a5743c92f272c91c3aa558"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7595b63fdb3f613a189cd20936290d2b"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a7595b63fdb3f613a189cd20936290d2b">nsubsteps</a></td></tr>
<tr class="separator:a7595b63fdb3f613a189cd20936290d2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa726a41ea5c80773654850a9444bf7fe"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a></td></tr>
<tr class="separator:aa726a41ea5c80773654850a9444bf7fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae94018d43dcebc3cd70293e6c621c46a"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ae94018d43dcebc3cd70293e6c621c46a">t_old</a></td></tr>
<tr class="separator:ae94018d43dcebc3cd70293e6c621c46a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedae6fd90cb13271f63ea80e59a2aacb"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a></td></tr>
<tr class="separator:aedae6fd90cb13271f63ea80e59a2aacb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75e6e53bc24b47b664fddcafed41dbd1"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; <a class="el" href="classREMORAPhysBCFunct.html">REMORAPhysBCFunct</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a75e6e53bc24b47b664fddcafed41dbd1">physbcs</a></td></tr>
<tr class="separator:a75e6e53bc24b47b664fddcafed41dbd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b32e42c790f2f3ac55ce545c2d03314"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a6b32e42c790f2f3ac55ce545c2d03314">mapfac_m</a></td></tr>
<tr class="separator:a6b32e42c790f2f3ac55ce545c2d03314"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d56f29784bbca12778ba7c58fa0f36d"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a5d56f29784bbca12778ba7c58fa0f36d">mapfac_u</a></td></tr>
<tr class="separator:a5d56f29784bbca12778ba7c58fa0f36d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa30c202e051228d1936a521eedcd6957"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#aa30c202e051228d1936a521eedcd6957">mapfac_v</a></td></tr>
<tr class="separator:aa30c202e051228d1936a521eedcd6957"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87c0b19a10b9aaf727f902e62dad8f77"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a87c0b19a10b9aaf727f902e62dad8f77">sst</a></td></tr>
<tr class="separator:a87c0b19a10b9aaf727f902e62dad8f77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4b94dcbe06a58009a8b64d358b51bfc"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::YAFluxRegister * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#aa4b94dcbe06a58009a8b64d358b51bfc">advflux_reg</a></td></tr>
<tr class="separator:aa4b94dcbe06a58009a8b64d358b51bfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a116e340c1b1afd8b7a64faa108157a0f"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::BCRec &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a></td></tr>
<tr class="separator:a116e340c1b1afd8b7a64faa108157a0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4c01c1be8a352c96a61e03e08c25121"><td class="memItemLeft" align="right" valign="top">amrex::Gpu::DeviceVector&lt; amrex::BCRec &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#af4c01c1be8a352c96a61e03e08c25121">domain_bcs_type_d</a></td></tr>
<tr class="separator:af4c01c1be8a352c96a61e03e08c25121"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac686c83706316dc3388d6c1d6b270a2c"><td class="memItemLeft" align="right" valign="top">amrex::Array&lt; std::string, 2 *AMREX_SPACEDIM &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ac686c83706316dc3388d6c1d6b270a2c">domain_bc_type</a></td></tr>
<tr class="separator:ac686c83706316dc3388d6c1d6b270a2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09a032f4d90f8dd939ab8e2ab5a06e06"><td class="memItemLeft" align="right" valign="top">amrex::Array&lt; amrex::Array&lt; amrex::Real, AMREX_SPACEDIM *2 &gt;, AMREX_SPACEDIM+<a class="el" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a09a032f4d90f8dd939ab8e2ab5a06e06">m_bc_extdir_vals</a></td></tr>
<tr class="separator:a09a032f4d90f8dd939ab8e2ab5a06e06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adac776c0b66cb62bc9a7a03369b6240e"><td class="memItemLeft" align="right" valign="top">amrex::GpuArray&lt; <a class="el" href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325">REMORA_BC</a>, AMREX_SPACEDIM *2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#adac776c0b66cb62bc9a7a03369b6240e">phys_bc_type</a></td></tr>
<tr class="separator:adac776c0b66cb62bc9a7a03369b6240e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1b32ce8d7cfb920dd3c61c002fc9e0f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#aa1b32ce8d7cfb920dd3c61c002fc9e0f">last_plot_file_step_1</a></td></tr>
<tr class="separator:aa1b32ce8d7cfb920dd3c61c002fc9e0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a642013869cd0ee3902d2106b64fa418a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a642013869cd0ee3902d2106b64fa418a">last_plot_file_step_2</a></td></tr>
<tr class="separator:a642013869cd0ee3902d2106b64fa418a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70585b0129bfb5d405b1e10ea97020c5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a70585b0129bfb5d405b1e10ea97020c5">last_check_file_step</a></td></tr>
<tr class="separator:a70585b0129bfb5d405b1e10ea97020c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9ce060b467505349e57dacf4e5553fd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ab9ce060b467505349e57dacf4e5553fd">plot_file_on_restart</a> = 1</td></tr>
<tr class="separator:ab9ce060b467505349e57dacf4e5553fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69c542c1c57e6c6532a20eec60b9a0c3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a69c542c1c57e6c6532a20eec60b9a0c3">max_step</a> = std::numeric_limits&lt;int&gt;::max()</td></tr>
<tr class="separator:a69c542c1c57e6c6532a20eec60b9a0c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2981da216b5811080251dc15b27ca281"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a2981da216b5811080251dc15b27ca281">stop_time</a> = std::numeric_limits&lt;amrex::Real&gt;::max()</td></tr>
<tr class="separator:a2981da216b5811080251dc15b27ca281"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae376daabb97c474de25b283de6bd985d"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a> = &quot;&quot;</td></tr>
<tr class="separator:ae376daabb97c474de25b283de6bd985d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05d2c2f58537f7fdae1bb5088f50e149"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a></td></tr>
<tr class="separator:a05d2c2f58537f7fdae1bb5088f50e149"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c050fd7227b627691a3c074eb104c8d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a2c050fd7227b627691a3c074eb104c8d">do_substep</a></td></tr>
<tr class="separator:a2c050fd7227b627691a3c074eb104c8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d3ceaf421e5e6ec42b4da2fcb2d610c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a5d3ceaf421e5e6ec42b4da2fcb2d610c">regrid_int</a> = 2</td></tr>
<tr class="separator:a5d3ceaf421e5e6ec42b4da2fcb2d610c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a784ba6c1f790c6df29d1e04772193ff0"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a784ba6c1f790c6df29d1e04772193ff0">plot_file_1</a> {&quot;plt_1_&quot;}</td></tr>
<tr class="separator:a784ba6c1f790c6df29d1e04772193ff0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6afd10f4968ef17dfe32806d62c465d4"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a6afd10f4968ef17dfe32806d62c465d4">plot_file_2</a> {&quot;plt_2_&quot;}</td></tr>
<tr class="separator:a6afd10f4968ef17dfe32806d62c465d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a61745803081888ac360f521a623b1b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a3a61745803081888ac360f521a623b1b">plot_int_1</a> = -1</td></tr>
<tr class="separator:a3a61745803081888ac360f521a623b1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1db03ec74ac9a6e94c59ed0e4a187bbb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a1db03ec74ac9a6e94c59ed0e4a187bbb">plot_int_2</a> = -1</td></tr>
<tr class="separator:a1db03ec74ac9a6e94c59ed0e4a187bbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ca794481e17552667b3824252497b6a"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a4ca794481e17552667b3824252497b6a">check_file</a> {&quot;chk&quot;}</td></tr>
<tr class="separator:a4ca794481e17552667b3824252497b6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae12e05882ce5fbae362e87b567d1a05f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ae12e05882ce5fbae362e87b567d1a05f">check_int</a> = -1</td></tr>
<tr class="separator:ae12e05882ce5fbae362e87b567d1a05f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0737e2206f4961852b5cbdc0c9c889f1"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a0737e2206f4961852b5cbdc0c9c889f1">plot_var_names_1</a></td></tr>
<tr class="separator:a0737e2206f4961852b5cbdc0c9c889f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dc73785c2de0224c069e73c5d57e794"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a2dc73785c2de0224c069e73c5d57e794">plot_var_names_2</a></td></tr>
<tr class="separator:a2dc73785c2de0224c069e73c5d57e794"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a006b52a7c7bc31839827318d5ca2dcee"><td class="memItemLeft" align="right" valign="top">const amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a006b52a7c7bc31839827318d5ca2dcee">cons_names</a> {&quot;temp&quot;, &quot;salt&quot;, &quot;scalar&quot;}</td></tr>
<tr class="separator:a006b52a7c7bc31839827318d5ca2dcee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae91017557bdacda7d14418c7f15967e2"><td class="memItemLeft" align="right" valign="top">const amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ae91017557bdacda7d14418c7f15967e2">derived_names</a> {&quot;dpdx&quot;, &quot;dpdy&quot;}</td></tr>
<tr class="separator:ae91017557bdacda7d14418c7f15967e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1a54cdd1292614b340f58125684e7b1"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#aa1a54cdd1292614b340f58125684e7b1">h_havg_density</a></td></tr>
<tr class="separator:aa1a54cdd1292614b340f58125684e7b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c3b580d36c077489568637e56a71d82"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a6c3b580d36c077489568637e56a71d82">h_havg_temperature</a></td></tr>
<tr class="separator:a6c3b580d36c077489568637e56a71d82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81ae77b15e0b8ff1061e8a54a6b820ad"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a81ae77b15e0b8ff1061e8a54a6b820ad">h_havg_pressure</a></td></tr>
<tr class="separator:a81ae77b15e0b8ff1061e8a54a6b820ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa86962216f5ba94d0d6a92b313fe6b91"><td class="memItemLeft" align="right" valign="top">amrex::Gpu::DeviceVector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#aa86962216f5ba94d0d6a92b313fe6b91">d_havg_density</a></td></tr>
<tr class="separator:aa86962216f5ba94d0d6a92b313fe6b91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a815d07375e65ea99f9e99dc3b32cc5c4"><td class="memItemLeft" align="right" valign="top">amrex::Gpu::DeviceVector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a815d07375e65ea99f9e99dc3b32cc5c4">d_havg_temperature</a></td></tr>
<tr class="separator:a815d07375e65ea99f9e99dc3b32cc5c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d8bfb2faf76f5666db1f2e6c3c27c46"><td class="memItemLeft" align="right" valign="top">amrex::Gpu::DeviceVector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a9d8bfb2faf76f5666db1f2e6c3c27c46">d_havg_pressure</a></td></tr>
<tr class="separator:a9d8bfb2faf76f5666db1f2e6c3c27c46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1767264051aeb1f4463f23304214617e"><td class="memItemLeft" align="right" valign="top">amrex::MultiFab&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a1767264051aeb1f4463f23304214617e">fine_mask</a></td></tr>
<tr class="separator:a1767264051aeb1f4463f23304214617e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3530fc80b87c25ce728095929a4ea99"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; std::fstream &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ad3530fc80b87c25ce728095929a4ea99">datalog</a></td></tr>
<tr class="separator:ad3530fc80b87c25ce728095929a4ea99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39048951d6927086a690d57a53754160"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a39048951d6927086a690d57a53754160">datalogname</a></td></tr>
<tr class="separator:a39048951d6927086a690d57a53754160"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:ad3cf3f0d0e6783927e40a57231693fee"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ad3cf3f0d0e6783927e40a57231693fee">cfl</a> = 0.8</td></tr>
<tr class="separator:ad3cf3f0d0e6783927e40a57231693fee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17de9bc2e49fbb1de53a5c57489d36bb"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a17de9bc2e49fbb1de53a5c57489d36bb">init_shrink</a> = 1.0</td></tr>
<tr class="separator:a17de9bc2e49fbb1de53a5c57489d36bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c3a852e766271b0dcf52a99f2ba6500"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a8c3a852e766271b0dcf52a99f2ba6500">change_max</a> = 1.1</td></tr>
<tr class="separator:a8c3a852e766271b0dcf52a99f2ba6500"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c9e94b2bbf3ee8167abb9acd4b86807"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a0c9e94b2bbf3ee8167abb9acd4b86807">fixed_dt</a> = -1.0</td></tr>
<tr class="separator:a0c9e94b2bbf3ee8167abb9acd4b86807"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cdf62f58282022e2d5f79de304d425f"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a5cdf62f58282022e2d5f79de304d425f">fixed_fast_dt</a> = -1.0</td></tr>
<tr class="separator:a5cdf62f58282022e2d5f79de304d425f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc900ee008729de41eb6aa28a36f6a26"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#acc900ee008729de41eb6aa28a36f6a26">fixed_ndtfast_ratio</a> = 0</td></tr>
<tr class="separator:acc900ee008729de41eb6aa28a36f6a26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa88bf20926ca017d05ebabe44f224443"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structSolverChoice.html">SolverChoice</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a></td></tr>
<tr class="separator:aa88bf20926ca017d05ebabe44f224443"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9ed53f5f841397304bf3b16fc82ecd9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ad9ed53f5f841397304bf3b16fc82ecd9">verbose</a> = 0</td></tr>
<tr class="separator:ad9ed53f5f841397304bf3b16fc82ecd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97dfe1e54e1222290a2c76a64cdf7339"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a97dfe1e54e1222290a2c76a64cdf7339">use_tracer_particles</a></td></tr>
<tr class="separator:a97dfe1e54e1222290a2c76a64cdf7339"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a295ab241204aca35cc4c720392bb3fd2"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a295ab241204aca35cc4c720392bb3fd2">sum_interval</a> = -1</td></tr>
<tr class="separator:a295ab241204aca35cc4c720392bb3fd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee90bf7b804b280c88a65dd354d97ee5"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#aee90bf7b804b280c88a65dd354d97ee5">sum_per</a> = -1.0</td></tr>
<tr class="separator:aee90bf7b804b280c88a65dd354d97ee5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a002524d813441c4b5fe1b223b46389fa"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9e">PlotfileType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a002524d813441c4b5fe1b223b46389fa">plotfile_type</a> = <a class="el" href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9eabbe17e876cafcbc06d3ea0d2a23854d3">PlotfileType::amrex</a></td></tr>
<tr class="separator:a002524d813441c4b5fe1b223b46389fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7b7f34b69f804f7acd9a1bc0c7bb5b9"><td class="memItemLeft" align="right" valign="top">static amrex::Vector&lt; amrex::Vector&lt; std::string &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#af7b7f34b69f804f7acd9a1bc0c7bb5b9">nc_init_file</a></td></tr>
<tr class="separator:af7b7f34b69f804f7acd9a1bc0c7bb5b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0ba249e52817855bb895b47cb005227"><td class="memItemLeft" align="right" valign="top">static amrex::Vector&lt; amrex::Vector&lt; std::string &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#af0ba249e52817855bb895b47cb005227">nc_grid_file</a></td></tr>
<tr class="separator:af0ba249e52817855bb895b47cb005227"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade8f2985b433261b76ac1d8f28fa6d0a"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ade8f2985b433261b76ac1d8f28fa6d0a">nc_bdry_file</a></td></tr>
<tr class="separator:ade8f2985b433261b76ac1d8f28fa6d0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef205c3aa9b16521417f944c4f95f401"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#aef205c3aa9b16521417f944c4f95f401">input_sounding_file</a></td></tr>
<tr class="separator:aef205c3aa9b16521417f944c4f95f401"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad280580fcce56885135a6923a2e0239c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ad280580fcce56885135a6923a2e0239c">output_1d_column</a></td></tr>
<tr class="separator:ad280580fcce56885135a6923a2e0239c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0659caeaf0312106700eee623eac075d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a0659caeaf0312106700eee623eac075d">column_interval</a></td></tr>
<tr class="separator:a0659caeaf0312106700eee623eac075d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa757e1f348fcf80e7e05dce9e3bb25b"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#afa757e1f348fcf80e7e05dce9e3bb25b">column_per</a></td></tr>
<tr class="separator:afa757e1f348fcf80e7e05dce9e3bb25b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4006290dea5d963b8c030d48812d18cf"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a4006290dea5d963b8c030d48812d18cf">column_loc_x</a></td></tr>
<tr class="separator:a4006290dea5d963b8c030d48812d18cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4be90b3f9b1c315976a021db1c27382c"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a4be90b3f9b1c315976a021db1c27382c">column_loc_y</a></td></tr>
<tr class="separator:a4be90b3f9b1c315976a021db1c27382c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6b864f6c16bd0320325b81333ca93b3"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#ac6b864f6c16bd0320325b81333ca93b3">column_file_name</a></td></tr>
<tr class="separator:ac6b864f6c16bd0320325b81333ca93b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6266d103134197c8d3847f1033b80736"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a6266d103134197c8d3847f1033b80736">output_bndry_planes</a></td></tr>
<tr class="separator:a6266d103134197c8d3847f1033b80736"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0536244c7b431fbd8cc40557061aadd5"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a0536244c7b431fbd8cc40557061aadd5">bndry_output_planes_interval</a></td></tr>
<tr class="separator:a0536244c7b431fbd8cc40557061aadd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af396dd41bf49d15c3c1a6f6e5ed4fdb6"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#af396dd41bf49d15c3c1a6f6e5ed4fdb6">bndry_output_planes_per</a></td></tr>
<tr class="separator:af396dd41bf49d15c3c1a6f6e5ed4fdb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a9189b0c8dd06cd3a6e1f0e2ec367ac"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a2a9189b0c8dd06cd3a6e1f0e2ec367ac">bndry_output_planes_start_time</a></td></tr>
<tr class="separator:a2a9189b0c8dd06cd3a6e1f0e2ec367ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf556866c1e50658f057b20b323b637a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#acf556866c1e50658f057b20b323b637a">input_bndry_planes</a></td></tr>
<tr class="separator:acf556866c1e50658f057b20b323b637a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a476b854ad74dd35ec1bf21cd9ea1f0b0"><td class="memItemLeft" align="right" valign="top">static amrex::Vector&lt; amrex::AMRErrorTag &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a476b854ad74dd35ec1bf21cd9ea1f0b0">ref_tags</a></td></tr>
<tr class="separator:a476b854ad74dd35ec1bf21cd9ea1f0b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d3e0a094fbd5ed0ef96114162a88478"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a4d3e0a094fbd5ed0ef96114162a88478">startCPUTime</a> = 0.0</td></tr>
<tr class="separator:a4d3e0a094fbd5ed0ef96114162a88478"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13791ab61c74d1c95a4caa544d9ac3d3"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classREMORA.html#a13791ab61c74d1c95a4caa544d9ac3d3">previousCPUTimeUsed</a> = 0.0</td></tr>
<tr class="separator:a13791ab61c74d1c95a4caa544d9ac3d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a8a16e552c794ae05498e4cb0a65399af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a16e552c794ae05498e4cb0a65399af">&#9670;&nbsp;</a></span>REMORA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REMORA::REMORA </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>constructor - reads in parameters from inputs file</p><ul>
<li>sizes multilevel arrays and data structures </li>
</ul>
<div class="fragment"><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;{</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* remora_hash = amrex::buildInfoGetGitHash(1);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* amrex_hash = amrex::buildInfoGetGitHash(2);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgithash = amrex::buildInfoGetBuildGitHash();</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgitname = amrex::buildInfoGetBuildGitName();</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keywordflow">if</span> (strlen(remora_hash) &gt; 0) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;          amrex::Print() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                         &lt;&lt; <span class="stringliteral">&quot;REMORA git hash: &quot;</span> &lt;&lt; remora_hash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordflow">if</span> (strlen(amrex_hash) &gt; 0) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;          amrex::Print() &lt;&lt; <span class="stringliteral">&quot;AMReX git hash: &quot;</span> &lt;&lt; amrex_hash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keywordflow">if</span> (strlen(buildgithash) &gt; 0) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;          amrex::Print() &lt;&lt; buildgitname &lt;&lt; <span class="stringliteral">&quot; git hash: &quot;</span> &lt;&lt; buildgithash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="classREMORA.html#aae1b7a86e03c93dd71e2d68c700d2512">ReadParameters</a>();</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keyword">const</span> std::string&amp; pv1 = <span class="stringliteral">&quot;plot_vars_1&quot;</span>; <a class="code" href="classREMORA.html#afe11d354ade4deed0c57c6f44f85ab41">setPlotVariables</a>(pv1,<a class="code" href="classREMORA.html#a0737e2206f4961852b5cbdc0c9c889f1">plot_var_names_1</a>);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keyword">const</span> std::string&amp; pv2 = <span class="stringliteral">&quot;plot_vars_2&quot;</span>; <a class="code" href="classREMORA.html#afe11d354ade4deed0c57c6f44f85ab41">setPlotVariables</a>(pv2,<a class="code" href="classREMORA.html#a2dc73785c2de0224c069e73c5d57e794">plot_var_names_2</a>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="prob__common_8H.html#afef32e2116829d24b864c64caebf5ea6">amrex_probinit</a>(geom[0].ProbLo(),geom[0].ProbHi());</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">// Geometry on all levels has been defined already.</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// No valid BoxArray and DistributionMapping have been defined.</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// But the arrays for them have been resized.</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">int</span> nlevs_max = max_level + 1;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>.resize(nlevs_max, 0);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="classREMORA.html#a7595b63fdb3f613a189cd20936290d2b">nsubsteps</a>.resize(nlevs_max, 1);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= max_level; ++lev) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <a class="code" href="classREMORA.html#a7595b63fdb3f613a189cd20936290d2b">nsubsteps</a>[lev] = <a class="code" href="classREMORA.html#a2c050fd7227b627691a3c074eb104c8d">do_substep</a> ? MaxRefRatio(lev-1) : 1;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="classREMORA.html#a75e6e53bc24b47b664fddcafed41dbd1">physbcs</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>.resize(nlevs_max, 0.0);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="classREMORA.html#ae94018d43dcebc3cd70293e6c621c46a">t_old</a>.resize(nlevs_max, -1.e100);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>.resize(nlevs_max, 1.e100);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="classREMORA.html#abc6ebdcc84239b993b12b3c95425fa88">cons_old</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="classREMORA.html#a51594dd103a7eee0f4e0c6e366d9f0ce">xvel_old</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="classREMORA.html#a9861cf91ee53fb2125f5f49c5cf73155">yvel_old</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="classREMORA.html#a6a980b1cd1d4d0e1253a641bee00de75">zvel_old</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="classREMORA.html#aa4b94dcbe06a58009a8b64d358b51bfc">advflux_reg</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// Initialize tagging criteria for mesh refinement</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="classREMORA.html#a6da8127bba6a3636d4f5ae30983eaf9c">refinement_criteria_setup</a>();</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">// We have already read in the ref_Ratio (via amr.ref_ratio =) but we need to enforce</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">//     that there is no refinement in the vertical so we test on that here.</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt; max_level; ++lev)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;       amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Refinement ratio at level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; set to be &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;          ref_ratio[lev][0]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ref_ratio[lev][1]  &lt;&lt;  <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ref_ratio[lev][2] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;       <span class="keywordflow">if</span> (ref_ratio[lev][2] != 1)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;       {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;           amrex::Error(<span class="stringliteral">&quot;We don&#39;t allow refinement in the vertical -- make sure to set ref_ratio = 1 in z&quot;</span>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;       }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div>
<div class="ttc" id="aclassREMORA_html_a0737e2206f4961852b5cbdc0c9c889f1"><div class="ttname"><a href="classREMORA.html#a0737e2206f4961852b5cbdc0c9c889f1">REMORA::plot_var_names_1</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; plot_var_names_1</div><div class="ttdef"><b>Definition:</b> REMORA.H:809</div></div>
<div class="ttc" id="aclassREMORA_html_a1e6bb5ba18bc44344e75066721820ed5"><div class="ttname"><a href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">REMORA::cons_new</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab * &gt; cons_new</div><div class="ttdef"><b>Definition:</b> REMORA.H:188</div></div>
<div class="ttc" id="aclassREMORA_html_a2c050fd7227b627691a3c074eb104c8d"><div class="ttname"><a href="classREMORA.html#a2c050fd7227b627691a3c074eb104c8d">REMORA::do_substep</a></div><div class="ttdeci">int do_substep</div><div class="ttdef"><b>Definition:</b> REMORA.H:793</div></div>
<div class="ttc" id="aclassREMORA_html_a2dc73785c2de0224c069e73c5d57e794"><div class="ttname"><a href="classREMORA.html#a2dc73785c2de0224c069e73c5d57e794">REMORA::plot_var_names_2</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; plot_var_names_2</div><div class="ttdef"><b>Definition:</b> REMORA.H:810</div></div>
<div class="ttc" id="aclassREMORA_html_a3950916f4ed965bcd10f62e28e08fd76"><div class="ttname"><a href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">REMORA::zvel_new</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab * &gt; zvel_new</div><div class="ttdef"><b>Definition:</b> REMORA.H:191</div></div>
<div class="ttc" id="aclassREMORA_html_a51594dd103a7eee0f4e0c6e366d9f0ce"><div class="ttname"><a href="classREMORA.html#a51594dd103a7eee0f4e0c6e366d9f0ce">REMORA::xvel_old</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab * &gt; xvel_old</div><div class="ttdef"><b>Definition:</b> REMORA.H:184</div></div>
<div class="ttc" id="aclassREMORA_html_a57327a8173b5dd09f9db6ce23f745dd5"><div class="ttname"><a href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">REMORA::yvel_new</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab * &gt; yvel_new</div><div class="ttdef"><b>Definition:</b> REMORA.H:190</div></div>
<div class="ttc" id="aclassREMORA_html_a6a980b1cd1d4d0e1253a641bee00de75"><div class="ttname"><a href="classREMORA.html#a6a980b1cd1d4d0e1253a641bee00de75">REMORA::zvel_old</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab * &gt; zvel_old</div><div class="ttdef"><b>Definition:</b> REMORA.H:186</div></div>
<div class="ttc" id="aclassREMORA_html_a6d4e5271a8d00e497c4bce0a51dbe63c"><div class="ttname"><a href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">REMORA::xvel_new</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab * &gt; xvel_new</div><div class="ttdef"><b>Definition:</b> REMORA.H:189</div></div>
<div class="ttc" id="aclassREMORA_html_a6da8127bba6a3636d4f5ae30983eaf9c"><div class="ttname"><a href="classREMORA.html#a6da8127bba6a3636d4f5ae30983eaf9c">REMORA::refinement_criteria_setup</a></div><div class="ttdeci">void refinement_criteria_setup()</div><div class="ttdef"><b>Definition:</b> REMORA_Tagging.cpp:39</div></div>
<div class="ttc" id="aclassREMORA_html_a7595b63fdb3f613a189cd20936290d2b"><div class="ttname"><a href="classREMORA.html#a7595b63fdb3f613a189cd20936290d2b">REMORA::nsubsteps</a></div><div class="ttdeci">amrex::Vector&lt; int &gt; nsubsteps</div><div class="ttdef"><b>Definition:</b> REMORA.H:730</div></div>
<div class="ttc" id="aclassREMORA_html_a75e6e53bc24b47b664fddcafed41dbd1"><div class="ttname"><a href="classREMORA.html#a75e6e53bc24b47b664fddcafed41dbd1">REMORA::physbcs</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; REMORAPhysBCFunct &gt; &gt; physbcs</div><div class="ttdef"><b>Definition:</b> REMORA.H:737</div></div>
<div class="ttc" id="aclassREMORA_html_a7c44493fe1a5743c92f272c91c3aa558"><div class="ttname"><a href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">REMORA::istep</a></div><div class="ttdeci">amrex::Vector&lt; int &gt; istep</div><div class="ttdef"><b>Definition:</b> REMORA.H:729</div></div>
<div class="ttc" id="aclassREMORA_html_a9861cf91ee53fb2125f5f49c5cf73155"><div class="ttname"><a href="classREMORA.html#a9861cf91ee53fb2125f5f49c5cf73155">REMORA::yvel_old</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab * &gt; yvel_old</div><div class="ttdef"><b>Definition:</b> REMORA.H:185</div></div>
<div class="ttc" id="aclassREMORA_html_aa4b94dcbe06a58009a8b64d358b51bfc"><div class="ttname"><a href="classREMORA.html#aa4b94dcbe06a58009a8b64d358b51bfc">REMORA::advflux_reg</a></div><div class="ttdeci">amrex::Vector&lt; amrex::YAFluxRegister * &gt; advflux_reg</div><div class="ttdef"><b>Definition:</b> REMORA.H:748</div></div>
<div class="ttc" id="aclassREMORA_html_aa726a41ea5c80773654850a9444bf7fe"><div class="ttname"><a href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">REMORA::t_new</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; t_new</div><div class="ttdef"><b>Definition:</b> REMORA.H:733</div></div>
<div class="ttc" id="aclassREMORA_html_aae1b7a86e03c93dd71e2d68c700d2512"><div class="ttname"><a href="classREMORA.html#aae1b7a86e03c93dd71e2d68c700d2512">REMORA::ReadParameters</a></div><div class="ttdeci">void ReadParameters()</div><div class="ttdef"><b>Definition:</b> REMORA.cpp:484</div></div>
<div class="ttc" id="aclassREMORA_html_abc6ebdcc84239b993b12b3c95425fa88"><div class="ttname"><a href="classREMORA.html#abc6ebdcc84239b993b12b3c95425fa88">REMORA::cons_old</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab * &gt; cons_old</div><div class="ttdef"><b>Definition:</b> REMORA.H:183</div></div>
<div class="ttc" id="aclassREMORA_html_ae94018d43dcebc3cd70293e6c621c46a"><div class="ttname"><a href="classREMORA.html#ae94018d43dcebc3cd70293e6c621c46a">REMORA::t_old</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; t_old</div><div class="ttdef"><b>Definition:</b> REMORA.H:734</div></div>
<div class="ttc" id="aclassREMORA_html_aedae6fd90cb13271f63ea80e59a2aacb"><div class="ttname"><a href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">REMORA::dt</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; dt</div><div class="ttdef"><b>Definition:</b> REMORA.H:735</div></div>
<div class="ttc" id="aclassREMORA_html_afe11d354ade4deed0c57c6f44f85ab41"><div class="ttname"><a href="classREMORA.html#afe11d354ade4deed0c57c6f44f85ab41">REMORA::setPlotVariables</a></div><div class="ttdeci">void setPlotVariables(const std::string &amp;pp_plot_var_names, amrex::Vector&lt; std::string &gt; &amp;plot_var_names)</div><div class="ttdef"><b>Definition:</b> Plotfile.cpp:9</div></div>
<div class="ttc" id="aprob__common_8H_html_afef32e2116829d24b864c64caebf5ea6"><div class="ttname"><a href="prob__common_8H.html#afef32e2116829d24b864c64caebf5ea6">amrex_probinit</a></div><div class="ttdeci">void amrex_probinit(const amrex_real *problo, const amrex_real *probhi)</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classREMORA_a8a16e552c794ae05498e4cb0a65399af_cgraph.png" border="0" usemap="#aclassREMORA_a8a16e552c794ae05498e4cb0a65399af_cgraph" alt=""/></div>
<map name="aclassREMORA_a8a16e552c794ae05498e4cb0a65399af_cgraph" id="aclassREMORA_a8a16e552c794ae05498e4cb0a65399af_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,149,32"/>
<area shape="rect" href="prob__common_8H.html#afef32e2116829d24b864c64caebf5ea6" title=" " alt="" coords="197,5,319,32"/>
</map>
</div>

</div>
</div>
<a id="af5750f77cb36737ece9e118a321a52da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5750f77cb36737ece9e118a321a52da">&#9670;&nbsp;</a></span>~REMORA()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">REMORA::~REMORA </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;{</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a9a67a95c1bc1f744268a245f4ca4c446"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a67a95c1bc1f744268a245f4ca4c446">&#9670;&nbsp;</a></span>Advance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::Advance </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iteration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncycle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>advance a single level for a single time step </p>
<div class="fragment"><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;{</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;REMORA::Advance()&quot;</span>);</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160; </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <a class="code" href="classREMORA.html#ad9ee5aba5b9cb8e020e6cbc8ff3cff74">setup_step</a>(lev, time, dt_lev);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a2a6fbf7ebea6ac5d9faddcbfe36771bd">use_barotropic</a>)</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        <span class="keywordtype">int</span> nfast_counter=<a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a> + 1;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        <span class="comment">//***************************************************</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        <span class="comment">//Compute fast timestep from dt_lev and ratio</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        <span class="comment">//***************************************************</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dtfast_lev=dt_lev/<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(<a class="code" href="classREMORA.html#acc900ee008729de41eb6aa28a36f6a26">fixed_ndtfast_ratio</a>);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        <span class="comment">//***************************************************</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        <span class="comment">//Advance nfast_counter steps of the 2d integrator</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        <span class="comment">//***************************************************</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> my_iif = 0; my_iif &lt; nfast_counter; my_iif++) {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;            <a class="code" href="classREMORA.html#a67b92f7c5b82933e953e447bdfc9074c">advance_2d_onestep</a>(lev, dt_lev, dtfast_lev, my_iif, nfast_counter);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        }</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    }</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">//***************************************************</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">//Advance one step of the 3d integrator</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">//***************************************************</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="classREMORA.html#a805863a28beceb70cefd0b6f050d8c2d">advance_3d_ml</a>(lev, dt_lev);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;}</div>
<div class="ttc" id="aDataStruct_8H_html_aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1"><div class="ttname"><a href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">IC_BC_Type::Real</a></div><div class="ttdeci">@ Real</div></div>
<div class="ttc" id="aclassREMORA_html_a05d2c2f58537f7fdae1bb5088f50e149"><div class="ttname"><a href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">REMORA::nfast</a></div><div class="ttdeci">int nfast</div><div class="ttdef"><b>Definition:</b> REMORA.H:790</div></div>
<div class="ttc" id="aclassREMORA_html_a67b92f7c5b82933e953e447bdfc9074c"><div class="ttname"><a href="classREMORA.html#a67b92f7c5b82933e953e447bdfc9074c">REMORA::advance_2d_onestep</a></div><div class="ttdeci">void advance_2d_onestep(int lev, amrex::Real dt_lev, amrex::Real dtfast_lev, int my_iif, int nfast_counter)</div><div class="ttdef"><b>Definition:</b> REMORA_advance_2d_onestep.cpp:6</div></div>
<div class="ttc" id="aclassREMORA_html_a805863a28beceb70cefd0b6f050d8c2d"><div class="ttname"><a href="classREMORA.html#a805863a28beceb70cefd0b6f050d8c2d">REMORA::advance_3d_ml</a></div><div class="ttdeci">void advance_3d_ml(int lev, amrex::Real dt_lev)</div><div class="ttdef"><b>Definition:</b> REMORA_advance_3d_ml.cpp:6</div></div>
<div class="ttc" id="aclassREMORA_html_aa88bf20926ca017d05ebabe44f224443"><div class="ttname"><a href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">REMORA::solverChoice</a></div><div class="ttdeci">static SolverChoice solverChoice</div><div class="ttdef"><b>Definition:</b> REMORA.H:822</div></div>
<div class="ttc" id="aclassREMORA_html_acc900ee008729de41eb6aa28a36f6a26"><div class="ttname"><a href="classREMORA.html#acc900ee008729de41eb6aa28a36f6a26">REMORA::fixed_ndtfast_ratio</a></div><div class="ttdeci">static int fixed_ndtfast_ratio</div><div class="ttdef"><b>Definition:</b> REMORA.H:789</div></div>
<div class="ttc" id="aclassREMORA_html_ad9ee5aba5b9cb8e020e6cbc8ff3cff74"><div class="ttname"><a href="classREMORA.html#ad9ee5aba5b9cb8e020e6cbc8ff3cff74">REMORA::setup_step</a></div><div class="ttdeci">void setup_step(int lev, amrex::Real time, amrex::Real dt_lev)</div><div class="ttdef"><b>Definition:</b> REMORA_setup_step.cpp:7</div></div>
<div class="ttc" id="astructSolverChoice_html_a2a6fbf7ebea6ac5d9faddcbfe36771bd"><div class="ttname"><a href="structSolverChoice.html#a2a6fbf7ebea6ac5d9faddcbfe36771bd">SolverChoice::use_barotropic</a></div><div class="ttdeci">bool use_barotropic</div><div class="ttdef"><b>Definition:</b> DataStruct.H:200</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2715857d136dc906b96d0e7c0423d50e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2715857d136dc906b96d0e7c0423d50e">&#9670;&nbsp;</a></span>advance_2d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::advance_2d </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab const *&#160;</td>
          <td class="paramname"><em>mf_rhoS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab const *&#160;</td>
          <td class="paramname"><em>mf_rhoA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_ru</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_rv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_rufrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_rvfrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_Zt_avg1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_DU_avg1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_DU_avg2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_DV_avg1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_DV_avg2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_rubar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_rvbar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_rzeta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_ubar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_vbar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_zeta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab const *&#160;</td>
          <td class="paramname"><em>mf_h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab const *&#160;</td>
          <td class="paramname"><em>mf_pm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab const *&#160;</td>
          <td class="paramname"><em>mf_pn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab const *&#160;</td>
          <td class="paramname"><em>mf_fcor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab const *&#160;</td>
          <td class="paramname"><em>mf_visc2_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab const *&#160;</td>
          <td class="paramname"><em>mf_visc2_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dtfast_lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>predictor_2d_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>first_2d_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>my_iif</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>next_indx1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Perform a 2D predictor (predictor_2d_step=True) or corrector (predictor_2d_step=False) step</p>
<p>Function that coordinates the evolution across levels &ndash; this calls Advance to do the actual advance at this level, then recursively calls itself at finer levels</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lev</td><td>level of refinement (coarsest level is 0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_rhoS</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_rhoA</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_ru</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_rv</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_rufrc</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_rvfrc</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_Zt_avg1</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_DU_avg1</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_DU_avg2</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_DV_avg1</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_DV_avg2</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_rubar</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_rvbar</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_zeta</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_h</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_visc2_p</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_visc2_f</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dtfast_lev</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">predictor_2d_step</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">first_2d_step</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">my_iif</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">next_indx1</td><td></td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;{</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordtype">int</span> iic = <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[lev];</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nnew  = 0;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nstp  = 0;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordtype">int</span> ntfirst = 0;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordtype">int</span> knew = 3;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordtype">int</span> krhs = (my_iif + iic) % 2 + 1;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordtype">int</span> kstp = my_iif &lt;=1 ? iic % 2 + 1 : (iic % 2 + my_iif % 2 + 1) % 2 + 1;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordtype">int</span> indx1 = krhs;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">if</span> (predictor_2d_step) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        next_indx1 = 3 - indx1;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        knew = next_indx1;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        kstp = 3 - knew;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        krhs = 3;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="comment">//If it&#39;s not the auxiliary time step, set indx1 to next_indx1</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="comment">// NOTE: should this ever not execute?</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordflow">if</span> (my_iif&lt;<a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>+1)</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            indx1=next_indx1;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordtype">int</span> ptsk = 3-kstp;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    knew-=1;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    krhs-=1;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    kstp-=1;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    indx1-=1;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    ptsk-=1;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keyword">auto</span> ba = mf_h-&gt;boxArray();</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keyword">auto</span> dm = mf_h-&gt;DistributionMap();</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    MultiFab mf_DUon(convert(ba,IntVect(1,0,0)),dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    MultiFab mf_DVom(convert(ba,IntVect(0,1,0)),dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(*mf_rhoS, TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a> = mf_ubar-&gt;array(mfi);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a> = mf_vbar-&gt;array(mfi);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a63be12014785e028dafaa0104fad32fc">zeta</a> = mf_zeta-&gt;array(mfi);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; h    = mf_h-&gt;const_array(mfi);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; pm   = mf_pm-&gt;const_array(mfi);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; pn   = mf_pn-&gt;const_array(mfi);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        Box bx = mfi.tilebox();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        Box gbx = mfi.growntilebox();</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        Box gbx1 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        Box gbx2 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        Box xgbx2 = mfi.grownnodaltilebox(0, IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        Box ygbx2 = mfi.grownnodaltilebox(1, IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        Box tbxp1 = bx;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        Box tbxp11 = bx;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        Box tbxp2 = bx;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        Box tbxp3 = bx;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        tbxp1.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        tbxp2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        tbxp11.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1));</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        tbxp3.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0));</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        Box bxD   = bx  ;   bxD.makeSlab(2,0);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        Box gbxD  = gbx ;  gbxD.makeSlab(2,0);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        Box gbx1D = gbx1; gbx1D.makeSlab(2,0);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        Box gbx2D = gbx2; gbx2D.makeSlab(2,0);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        Box tbxp2D = tbxp2;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        tbxp2D.makeSlab(2,0);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="comment">// step2d work arrays</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        FArrayBox fab_Drhs(tbxp3,1,The_Async_Arena());</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keyword">auto</span> Drhs=fab_Drhs.array();</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keyword">auto</span> DUon = mf_DUon.array(mfi);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keyword">auto</span> DVom = mf_DVom.array(mfi);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        ParallelFor(makeSlab(tbxp3,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            Drhs(i,j,0)=<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a63be12014785e028dafaa0104fad32fc">zeta</a>(i,j,0,krhs)+h(i,j,0);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        });</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        ParallelFor(makeSlab(xgbx2,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> on_u = 2.0_rt / (pn(i,j,0)+pn(i-1,j,0));</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1= 0.5_rt * on_u *(Drhs(i,j,0)+Drhs(i-1,j,0));</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            DUon(i,j,0)=<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i,j,0,krhs)*cff1;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        });</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        ParallelFor(makeSlab(ygbx2,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> om_v = 2.0_rt / (pm(i,j,0)+pm(i,j-1,0));</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1= 0.5_rt * om_v * (Drhs(i,j,0)+Drhs(i,j-1,0));</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            DVom(i,j,0)=<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i,j,0,krhs)*cff1;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        });</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">// These are needed to pass the tests with bathymetry but I don&#39;t quite see why</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    mf_DUon.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    mf_DVom.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(*mf_rhoS, TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; rhoS = mf_rhoS-&gt;const_array(mfi);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; rhoA = mf_rhoA-&gt;const_array(mfi);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; h    = mf_h-&gt;const_array(mfi);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; rufrc   = mf_rufrc-&gt;array(mfi);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; rvfrc   = mf_rvfrc-&gt;array(mfi);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; Zt_avg1 = mf_Zt_avg1-&gt;array(mfi);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>    = mf_ubar-&gt;array(mfi);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>    = mf_vbar-&gt;array(mfi);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a63be12014785e028dafaa0104fad32fc">zeta</a> = mf_zeta-&gt;array(mfi);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; DU_avg1 = (mf_DU_avg1)-&gt;array(mfi);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; DU_avg2 = (mf_DU_avg2)-&gt;array(mfi);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; DV_avg1 = (mf_DV_avg1)-&gt;array(mfi);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; DV_avg2 = (mf_DV_avg2)-&gt;array(mfi);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; ru = (mf_ru)-&gt;array(mfi);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; rv = (mf_rv)-&gt;array(mfi);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; rubar = (mf_rubar)-&gt;array(mfi);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; rvbar = (mf_rvbar)-&gt;array(mfi);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; rzeta = (mf_rzeta)-&gt;array(mfi);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; visc2_p = mf_visc2_p-&gt;const_array(mfi);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; visc2_r = mf_visc2_r-&gt;const_array(mfi);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; pm   = mf_pm-&gt;const_array(mfi);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; pn   = mf_pn-&gt;const_array(mfi);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; fcor = mf_fcor-&gt;const_array(mfi);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        Box bx = mfi.tilebox();</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        Box gbx = mfi.growntilebox();</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        Box gbx1 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        Box gbx2 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        Box gbx3 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0));</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        Box xgbx2 = mfi.grownnodaltilebox(0, IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        Box ygbx2 = mfi.grownnodaltilebox(1, IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        Box xbxD = mfi.nodaltilebox(0);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        xbxD.makeSlab(2,0);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        Box ybxD = mfi.nodaltilebox(1);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        ybxD.makeSlab(2,0);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        Box tbxp1  = bx;  tbxp1.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        Box tbxp11 = bx; tbxp11.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1));</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        Box tbxp2  = bx;  tbxp2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        Box tbxp3  = bx;  tbxp3.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0));</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        Box bxD   = bx;   bxD.makeSlab(2,0);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        Box gbxD  = gbx;  gbxD.makeSlab(2,0);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        Box gbx1D = gbx1; gbx1D.makeSlab(2,0);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        Box gbx2D = gbx2; gbx2D.makeSlab(2,0);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        Box tbxp2D = tbxp2;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        tbxp2D.makeSlab(2,0);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        FArrayBox fab_fomn(tbxp2,1,The_Async_Arena());</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="comment">//step2d work arrays</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        FArrayBox fab_Drhs(tbxp3,1,The_Async_Arena());</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        FArrayBox fab_Dnew(tbxp2,1,The_Async_Arena());</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        FArrayBox fab_zwrk(tbxp1,1,The_Async_Arena());</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        FArrayBox fab_gzeta(tbxp1,1,The_Async_Arena());</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        FArrayBox fab_gzeta2(tbxp1,1,The_Async_Arena());</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        FArrayBox fab_gzetaSA(tbxp1,1,The_Async_Arena());</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        FArrayBox fab_Dstp(tbxp3,1,The_Async_Arena());</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        FArrayBox &amp; fab_DUon=mf_DUon[mfi];</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        FArrayBox &amp; fab_DVom=mf_DVom[mfi];</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        FArrayBox fab_rhs_ubar(xbxD,1,The_Async_Arena());</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        FArrayBox fab_rhs_vbar(ybxD,1,The_Async_Arena());</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        FArrayBox fab_rhs_zeta(tbxp1,1,The_Async_Arena());</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        FArrayBox fab_zeta_new(tbxp1,1,The_Async_Arena());</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keyword">auto</span> fomn=fab_fomn.array();</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keyword">auto</span> Drhs = fab_Drhs.array();</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keyword">auto</span> Drhs_const = fab_Drhs.const_array();</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keyword">auto</span> Dnew=fab_Dnew.array();</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keyword">auto</span> zwrk=fab_zwrk.array();</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keyword">auto</span> gzeta=fab_gzeta.array();</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keyword">auto</span> gzeta2=fab_gzeta2.array();</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keyword">auto</span> gzetaSA=fab_gzetaSA.array();</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keyword">auto</span> Dstp=fab_Dstp.array();</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keyword">auto</span> DUon=fab_DUon.array();</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keyword">auto</span> DVom=fab_DVom.array();</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="keyword">auto</span> rhs_ubar=fab_rhs_ubar.array();</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keyword">auto</span> rhs_vbar=fab_rhs_vbar.array();</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keyword">auto</span> rhs_zeta=fab_rhs_zeta.array();</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keyword">auto</span> zeta_new=fab_zeta_new.array();</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keyword">auto</span> weight1 = <a class="code" href="classREMORA.html#ab17dd7f0866773488c052d67cb6086b3">vec_weight1</a>.dataPtr();</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keyword">auto</span> weight2 = <a class="code" href="classREMORA.html#a634b285cb09738ecdc4b191e897744ed">vec_weight2</a>.dataPtr();</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="comment">//From ana_grid.h and metrics.F</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        ParallelFor(xbxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;              rhs_ubar(i,j,0)=0.0_rt;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        });</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        ParallelFor(ybxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;              rhs_vbar(i,j,0)=0.0_rt;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        });</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a9e86533aa6df5bf6408d91f0dfd23606">use_coriolis</a>) {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            ParallelFor(tbxp2D, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>  )</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                fomn(i,j,0) = fcor(i,j,0)*(1.0/(pm(i,j,0)*pn(i,j,0)));</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            });</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        ParallelFor(makeSlab(tbxp3,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            Drhs(i,j,0)=<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a63be12014785e028dafaa0104fad32fc">zeta</a>(i,j,0,krhs)+h(i,j,0);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        });</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keywordflow">if</span>(predictor_2d_step)</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="keywordflow">if</span>(first_2d_step) {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2=(-1.0_rt/12.0_rt)*weight2[my_iif+1];</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                ParallelFor(makeSlab(gbx3,2,0),</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                    Zt_avg1(i,j,0)=0.0_rt;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                });</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                ParallelFor(makeSlab(xgbx2,2,0),</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                    DU_avg1(i,j,0)=0.0_rt;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                    DU_avg2(i,j,0)=cff2*DUon(i,j,0);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                });</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                ParallelFor(makeSlab(ygbx2,2,0),</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                    DV_avg1(i,j,0)=0.0_rt;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                    DV_avg2(i,j,0)=cff2*DVom(i,j,0);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                });</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1_wt1 = weight1[my_iif-1];</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2_wt1 = (8.0_rt/12.0_rt)*weight2[my_iif]-</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                (1.0_rt/12.0_rt)*weight2[my_iif+1];</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                ParallelFor(makeSlab(gbx3,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                    Zt_avg1(i,j,0) += cff1_wt1*<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a63be12014785e028dafaa0104fad32fc">zeta</a>(i,j,0,krhs);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                });</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                ParallelFor(makeSlab(xgbx2,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                    DU_avg1(i,j,0) += cff1_wt1*DUon(i,j,0);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                    DU_avg2(i,j,0) += cff2_wt1*DUon(i,j,0);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                });</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                ParallelFor(makeSlab(ygbx2,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                    DV_avg1(i,j,0) += cff1_wt1*DVom(i,j,0);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                    DV_avg2(i,j,0) += cff2_wt1*DVom(i,j,0);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                });</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2_wt2;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="keywordflow">if</span> (first_2d_step) {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                cff2_wt2=weight2[my_iif];</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                cff2_wt2=5.0_rt/12.0_rt*weight2[my_iif];</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            ParallelFor(makeSlab(xgbx2,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                DU_avg2(i,j,0)=DU_avg2(i,j,0)+cff2_wt2*DUon(i,j,0);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            });</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            ParallelFor(makeSlab(ygbx2,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                DV_avg2(i,j,0)=DV_avg2(i,j,0)+cff2_wt2*DVom(i,j,0);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            });</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="comment">//  Do not perform the actual time stepping during the auxiliary</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="comment">//  (nfast(ng)+1) time step. Jump to next box</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordflow">if</span> (my_iif&gt;=<a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>) {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="comment">//Load new free-surface values into shared array at both predictor</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="comment">//and corrector steps</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="comment">//  Time step free-surface equation.</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="comment">//  During the first time-step, the predictor step is Forward-Euler</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="comment">//  and the corrector step is Backward-Euler. Otherwise, the predictor</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="comment">//  step is Leap-frog and the corrector step is Adams-Moulton.</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="comment">// todo: gzeta</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="comment">// todo: HACKHACKHACK Should use rho0 from prob.H</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> fac=1000.0_rt/1025.0_rt;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <span class="keywordflow">if</span> (my_iif==0) {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=dtfast_lev;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            ParallelFor(tbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                rhs_zeta(i,j,0) = (DUon(i,j,0)-DUon(i+1,j,0))+</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                                  (DVom(i,j,0)-DVom(i,j+1,0));</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                zeta_new(i,j,0) = <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a63be12014785e028dafaa0104fad32fc">zeta</a>(i,j,0,kstp)+ pm(i,j,0)*pn(i,j,0)*cff1*rhs_zeta(i,j,0);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                Dnew(i,j,0) = zeta_new(i,j,0)+h(i,j,0);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                <span class="comment">//Pressure gradient terms:</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                zwrk(i,j,0)=0.5_rt*(<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a63be12014785e028dafaa0104fad32fc">zeta</a>(i,j,0,kstp)+zeta_new(i,j,0));</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                gzeta(i,j,0)=(fac+rhoS(i,j,0))*zwrk(i,j,0);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                gzeta2(i,j,0)=gzeta(i,j,0)*zwrk(i,j,0);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                gzetaSA(i,j,0)=zwrk(i,j,0)*(rhoS(i,j,0)-rhoA(i,j,0));</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            });</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (predictor_2d_step) {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=2.0_rt * dtfast_lev;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff4=4.0_rt / 25.0_rt;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff5=1.0_rt - 2.0_rt*cff4;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            ParallelFor(tbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                rhs_zeta(i,j,0)=(DUon(i,j,0)-DUon(i+1,j,0))+</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                                (DVom(i,j,0)-DVom(i,j+1,0));</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                zeta_new(i,j,0)=<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a63be12014785e028dafaa0104fad32fc">zeta</a>(i,j,0,kstp)+</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                                pm(i,j,0)*pn(i,j,0)*cff1*rhs_zeta(i,j,0);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                Dnew(i,j,0)=zeta_new(i,j,0)+h(i,j,0);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                <span class="comment">//Pressure gradient terms</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                zwrk(i,j,0)=cff5*<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a63be12014785e028dafaa0104fad32fc">zeta</a>(i,j,0,krhs)+</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                    cff4*(<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a63be12014785e028dafaa0104fad32fc">zeta</a>(i,j,0,kstp)+zeta_new(i,j,0));</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                gzeta(i,j,0)=(fac+rhoS(i,j,0))*zwrk(i,j,0);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                gzeta2(i,j,0)=gzeta(i,j,0)*zwrk(i,j,0);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                gzetaSA(i,j,0)=zwrk(i,j,0)*(rhoS(i,j,0)-rhoA(i,j,0));</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            });</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!predictor_2d_step) { <span class="comment">//AKA if(corrector_2d_step)</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=dtfast_lev * 5.0_rt/12.0_rt;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2=dtfast_lev * 8.0_rt/12.0_rt;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff3=dtfast_lev * 1.0_rt/12.0_rt;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff4=2.0_rt/5.0_rt;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff5=1.0_rt-cff4;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            ParallelFor(tbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff=cff1*((DUon(i,j,0)-DUon(i+1,j,0))+</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                               (DVom(i,j,0)-DVom(i,j+1,0)));</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                zeta_new(i,j,0)=<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a63be12014785e028dafaa0104fad32fc">zeta</a>(i,j,0,kstp)+</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                    pm(i,j,0)*pn(i,j,0)*(cff+</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                                         cff2*rzeta(i,j,0,kstp)-</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                                         cff3*rzeta(i,j,0,ptsk));</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                Dnew(i,j,0)=zeta_new(i,j,0)+h(i,j,0);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                <span class="comment">//Pressure gradient terms</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                zwrk(i,j,0)=cff5*zeta_new(i,j,0)+cff4*<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a63be12014785e028dafaa0104fad32fc">zeta</a>(i,j,0,krhs);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                gzeta(i,j,0)=(fac+rhoS(i,j,0))*zwrk(i,j,0);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                gzeta2(i,j,0)=gzeta(i,j,0)*zwrk(i,j,0);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                gzetaSA(i,j,0)=zwrk(i,j,0)*(rhoS(i,j,0)-rhoA(i,j,0));</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            });</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="comment">//  Load new free-surface values into shared array at both predictor</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="comment">//  and corrector steps.</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">        //// zeta(knew) only valid at zeta_new, i.e. tbxp1</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment"></span>        ParallelFor(gbx1,</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a63be12014785e028dafaa0104fad32fc">zeta</a>(i,j,0,knew) = zeta_new(i,j,0);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        });</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="comment">//  If predictor step, load right-side-term into shared array.</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="keywordflow">if</span> (predictor_2d_step) {</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            ParallelFor(gbx1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                rzeta(i,j,0,krhs)=rhs_zeta(i,j,0);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            });</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="comment">//  Compute right-hand-side for the 2D momentum equations.</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">!  Compute pressure gradient terms.</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1 = 0.5_rt * <a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#aeee9d0099e1ac4105829345280a4f03c">g</a>; <span class="comment">// Should be the variable gravitational field strength</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2 = 1.0_rt / 3.0_rt;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        ParallelFor(xbxD,</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> on_u = 2.0_rt / (pn(i,j,0)+pn(i-1,j,0));</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;          rhs_ubar(i,j,0)=cff1 * on_u *</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                        ((    h(i-1,j,0) +     h(i,j,0))*</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                         (gzeta(i-1,j,0) - gzeta(i,j,0))+</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                         (    h(i-1,j,0) -     h(i,j,0))*</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                         (      gzetaSA(i-1,j,0) + gzetaSA(i,j,0)+</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                          cff2*(   rhoA(i-1,j,0) -    rhoA(i,j,0))*</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                               (   zwrk(i-1,j,0) -    zwrk(i,j,0)))+</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                         (gzeta2(i-1,j,0)- gzeta2(i  ,j,0)));</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        });</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        ParallelFor(ybxD,</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> om_v = 2.0_rt / (pm(i,j,0)+pm(i,j-1,0));</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            rhs_vbar(i,j,0) = cff1*om_v *</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                          ((    h(i,j-1,0) +     h(i,j,0))*</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                           (gzeta(i,j-1,0) - gzeta(i,j,0))+</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                           (    h(i,j-1,0) -     h(i,j,0))*</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                           (gzetaSA(i,j-1,0)+ gzetaSA(i,j  ,0)+</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                            cff2*(rhoA(i,j-1,0)- rhoA(i,j  ,0))*</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                                 (zwrk(i,j-1,0)- zwrk(i,j  ,0)))+</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                           (gzeta2(i,j-1,0)- gzeta2(i,j  ,0)));</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        });</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;       <span class="comment">// Advection terms for 2d ubar, vbar added to rhs_ubar and rhs_vbar</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;       <span class="comment">//</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;       <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;       <span class="comment">// rhs_uv_2d</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;       <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;       <span class="comment">//</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;       Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; ubar_const = mf_ubar-&gt;const_array(mfi);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;       Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; vbar_const = mf_vbar-&gt;const_array(mfi);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;       <a class="code" href="classREMORA.html#a08a2748cf44d3e95d08a1b78aef3d15f">rhs_uv_2d</a>(xbxD, ybxD, ubar_const, vbar_const, rhs_ubar, rhs_vbar, DUon, DVom, krhs);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;       <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;       <span class="comment">// Add Coriolis forcing</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;       <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;       <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a9e86533aa6df5bf6408d91f0dfd23606">use_coriolis</a>) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            <span class="comment">// Coriolis terms for 2d ubar, vbar added to rhs_ubar and rhs_vbar</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            <span class="comment">// coriolis</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            <a class="code" href="classREMORA.html#af28f51401edd36aa6014d9536e1393da">coriolis</a>(xbxD, ybxD, ubar_const, vbar_const, rhs_ubar, rhs_vbar, Drhs, fomn, krhs, 0);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;       }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;       <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;       <span class="comment">//Add in horizontal harmonic viscosity.</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;       <span class="comment">// Consider generalizing or copying uv3dmix, where Drhs is used instead of Hz and u=&gt;ubar v=&gt;vbar, drop dt terms</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;       <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;       <a class="code" href="classREMORA.html#a5e195a7da3e0ada7179455688f4711b5">uv3dmix</a>(xbxD, ybxD, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>, rhs_ubar, rhs_vbar,</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;               visc2_p, visc2_r, Drhs_const,</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;               pn, pm, krhs, nnew, 0.0_rt);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;       <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;       <span class="comment">// Coupling from 3d to 2d</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;       <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;       <span class="keywordflow">if</span> (first_2d_step&amp;&amp;predictor_2d_step)</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;       {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            <span class="keywordflow">if</span> (iic==ntfirst) {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                ParallelFor(xbxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                {</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                    rufrc(i,j,0)    -= rhs_ubar(i,j,0);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                    rhs_ubar(i,j,0) += rufrc(i,j,0);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                    ru(i,j,-1,nstp)  = rufrc(i,j,0);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                });</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                ParallelFor(ybxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                    rvfrc(i,j,0)    -= rhs_vbar(i,j,0);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                    rhs_vbar(i,j,0) += rvfrc(i,j,0);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                    rv(i,j,-1,nstp)  = rvfrc(i,j,0);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                });</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iic==(ntfirst+1)) {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                ParallelFor(xbxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                {</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                    rufrc(i,j,0)=rufrc(i,j,0)-rhs_ubar(i,j,0);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                    rhs_ubar(i,j,0)=rhs_ubar(i,j,0)+1.5_rt*rufrc(i,j,0)-0.5_rt*ru(i,j,-1,0);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                    ru(i,j,-1,1)=rufrc(i,j,0);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> r_swap= ru(i,j,-1,1);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                    ru(i,j,-1,1) = ru(i,j,-1,0);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                    ru(i,j,-1,0) = r_swap;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                });</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                ParallelFor(ybxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                {</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                    rvfrc(i,j,0)=rvfrc(i,j,0)-rhs_vbar(i,j,0);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                    rhs_vbar(i,j,0)=rhs_vbar(i,j,0)+1.5_rt*rvfrc(i,j,0)-0.5_rt*rv(i,j,-1,0);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                    rv(i,j,-1,1)=rvfrc(i,j,0);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> r_swap= rv(i,j,-1,1);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                    rv(i,j,-1,1) = rv(i,j,-1,0);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                    rv(i,j,-1,0) = r_swap;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                });</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                cff1=23.0_rt/12.0_rt;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                cff2=16.0_rt/12.0_rt;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff3= 5.0_rt/12.0_rt;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                ParallelFor(xbxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                    rufrc(i,j,0)=rufrc(i,j,0)-rhs_ubar(i,j,0);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                    rhs_ubar(i,j,0)=rhs_ubar(i,j,0)+</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                        cff1*rufrc(i,j,0)-</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                        cff2*ru(i,j,-1,0)+</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                        cff3*ru(i,j,-1,1);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                    ru(i,j,-1,1)=rufrc(i,j,0);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> r_swap= ru(i,j,-1,1);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                    ru(i,j,-1,1) = ru(i,j,-1,0);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                    ru(i,j,-1,0) = r_swap;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                });</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                ParallelFor(ybxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                {</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                    rvfrc(i,j,0)=rvfrc(i,j,0)-rhs_vbar(i,j,0);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                    rhs_vbar(i,j,0)=rhs_vbar(i,j,0)+</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                          cff1*rvfrc(i,j,0)-</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                          cff2*rv(i,j,-1,0)+</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                          cff3*rv(i,j,-1,1);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                    rv(i,j,-1,1)=rvfrc(i,j,0);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> r_swap= rv(i,j,-1,1);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                    rv(i,j,-1,1) = rv(i,j,-1,0);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                    rv(i,j,-1,0) = r_swap;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                });</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            }</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;       } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            ParallelFor(xbxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                rhs_ubar(i,j,0) += rufrc(i,j,0);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            });</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            ParallelFor(ybxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                rhs_vbar(i,j,0) += rvfrc(i,j,0);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            });</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160; </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="comment">//  Time step 2D momentum equations.</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="comment">//  Compute total water column depth.</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        ParallelFor(makeSlab(tbxp3,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        {</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;              Dstp(i,j,0)=<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a63be12014785e028dafaa0104fad32fc">zeta</a>(i,j,0,kstp)+h(i,j,0);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        });</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="comment">//  During the first time-step, the predictor step is Forward-Euler</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <span class="comment">//  and the corrector step is Backward-Euler. Otherwise, the predictor</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <span class="comment">//  step is Leap-frog and the corrector step is Adams-Moulton.</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <span class="keywordflow">if</span> (my_iif==0) {</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            cff1=0.5_rt*dtfast_lev;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            ParallelFor(xbxD,</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff=(pm(i,j,0)+pm(i-1,j,0))*(pn(i,j,0)+pn(i-1,j,0));</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Dnew_avg =1.0_rt/(Dnew(i,j,0)+Dnew(i-1,j,0));</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i,j,0,knew)=(<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i,j,0,kstp)*</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                                 (Dstp(i,j,0)+Dstp(i-1,j,0))+</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                                  cff*cff1*rhs_ubar(i,j,0))*Dnew_avg;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            });</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            ParallelFor(ybxD,</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff=(pm(i,j,0)+pm(i,j-1,0))*(pn(i,j,0)+pn(i,j-1,0));</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Dnew_avg=1.0_rt/(Dnew(i,j,0)+Dnew(i,j-1,0));</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i,j,0,knew)=(<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i,j,0,kstp)*</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                                 (Dstp(i,j,0)+Dstp(i,j-1,0))+</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                                  cff*cff1*rhs_vbar(i,j,0))*Dnew_avg;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            });</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (predictor_2d_step) {</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            cff1=dtfast_lev;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            ParallelFor(xbxD,</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            {</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff=(pm(i,j,0)+pm(i-1,j,0))*(pn(i,j,0)+pn(i-1,j,0));</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Dnew_avg=1.0_rt/(Dnew(i,j,0)+Dnew(i-1,j,0));</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i,j,0,knew)=(<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i,j,0,kstp)*</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                                 (Dstp(i,j,0)+Dstp(i-1,j,0))+</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                                  cff*cff1*rhs_ubar(i,j,0))*Dnew_avg;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            });</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            ParallelFor(ybxD,</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff=(pm(i,j,0)+pm(i,j-1,0))*(pn(i,j,0)+pn(i,j-1,0));</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Dnew_avg=1.0_rt/(Dnew(i,j,0)+Dnew(i,j-1,0));</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i,j,0,knew)=(<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i,j,0,kstp)*</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                                 (Dstp(i,j,0)+Dstp(i,j-1,0))+</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                                  cff*cff1*rhs_vbar(i,j,0))*Dnew_avg;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            });</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((!predictor_2d_step)) {</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            cff1=0.5_rt*dtfast_lev*5.0_rt/12.0_rt;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            cff2=0.5_rt*dtfast_lev*8.0_rt/12.0_rt;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff3=0.5_rt*dtfast_lev*1.0_rt/12.0_rt;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            ParallelFor(xbxD,</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            {</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff=(pm(i,j,0)+pm(i-1,j,0))*(pn(i,j,0)+pn(i-1,j,0));</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Dnew_avg=1.0_rt/(Dnew(i,j,0)+Dnew(i-1,j,0));</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i,j,0,knew)=(<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i,j,0,kstp)*</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                                 (Dstp(i,j,0)+Dstp(i-1,j,0))+</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                                 cff*(cff1*rhs_ubar(i,j,0)+</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                                      cff2*rubar(i,j,0,kstp)-</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                                      cff3*rubar(i,j,0,ptsk)))*Dnew_avg;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            });</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            ParallelFor(ybxD,</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            {</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff=(pm(i,j,0)+pm(i,j-1,0))*(pn(i,j,0)+pn(i,j-1,0));</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Dnew_avg=1.0_rt/(Dnew(i,j,0)+Dnew(i,j-1,0));</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i,j,0,knew)=(<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i,j,0,kstp)*</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                                 (Dstp(i,j,0)+Dstp(i,j-1,0))+</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                                 cff*(cff1*rhs_vbar(i,j,0)+</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                                      cff2*rvbar(i,j,0,kstp)-</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                                      cff3*rvbar(i,j,0,ptsk)))*Dnew_avg;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            });</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <span class="comment">//store rhs_ubar and rhs_vbar to save later</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <span class="comment">//  If predictor step, load right-side-term into shared arrays for</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="comment">//  future use during the subsequent corrector step.</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="keywordflow">if</span> (predictor_2d_step) {</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            ParallelFor(xbxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                rubar(i,j,0,krhs)=rhs_ubar(i,j,0);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            });</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            ParallelFor(ybxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            {</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                rvbar(i,j,0,krhs)=rhs_vbar(i,j,0);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            });</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        }</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    }</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;}</div>
<div class="ttc" id="aIndexDefines_8H_html_a124da9e47fb1b1f3debaf49368f42e38"><div class="ttname"><a href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a></div><div class="ttdeci">#define NGROW</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:13</div></div>
<div class="ttc" id="aclassREMORA_html_a08a2748cf44d3e95d08a1b78aef3d15f"><div class="ttname"><a href="classREMORA.html#a08a2748cf44d3e95d08a1b78aef3d15f">REMORA::rhs_uv_2d</a></div><div class="ttdeci">void rhs_uv_2d(const amrex::Box &amp;xbx, const amrex::Box &amp;ybx, const amrex::Array4&lt; amrex::Real const &gt; &amp;uold, const amrex::Array4&lt; amrex::Real const &gt; &amp;vold, const amrex::Array4&lt; amrex::Real &gt; &amp;ru, const amrex::Array4&lt; amrex::Real &gt; &amp;rv, const amrex::Array4&lt; amrex::Real const &gt; &amp;Duon, const amrex::Array4&lt; amrex::Real const &gt; &amp;Dvom, const int nrhs)</div><div class="ttdef"><b>Definition:</b> REMORA_rhs_uv_2d.cpp:20</div></div>
<div class="ttc" id="aclassREMORA_html_a5e195a7da3e0ada7179455688f4711b5"><div class="ttname"><a href="classREMORA.html#a5e195a7da3e0ada7179455688f4711b5">REMORA::uv3dmix</a></div><div class="ttdeci">void uv3dmix(const amrex::Box &amp;xbx, const amrex::Box &amp;ybx, const amrex::Array4&lt; amrex::Real &gt; &amp;u, const amrex::Array4&lt; amrex::Real &gt; &amp;v, const amrex::Array4&lt; amrex::Real const &gt; &amp;uold, const amrex::Array4&lt; amrex::Real const &gt; &amp;vold, const amrex::Array4&lt; amrex::Real &gt; &amp;rufrc, const amrex::Array4&lt; amrex::Real &gt; &amp;rvfrc, const amrex::Array4&lt; amrex::Real const &gt; &amp;visc2_p, const amrex::Array4&lt; amrex::Real const &gt; &amp;visc2_r, const amrex::Array4&lt; amrex::Real const &gt; &amp;Hz, const amrex::Array4&lt; amrex::Real const &gt; &amp;pm, const amrex::Array4&lt; amrex::Real const &gt; &amp;pn, int nrhs, int nnew, const amrex::Real dt_lev)</div><div class="ttdef"><b>Definition:</b> REMORA_uv3dmix.cpp:6</div></div>
<div class="ttc" id="aclassREMORA_html_a634b285cb09738ecdc4b191e897744ed"><div class="ttname"><a href="classREMORA.html#a634b285cb09738ecdc4b191e897744ed">REMORA::vec_weight2</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; vec_weight2</div><div class="ttdef"><b>Definition:</b> REMORA.H:299</div></div>
<div class="ttc" id="aclassREMORA_html_ab17dd7f0866773488c052d67cb6086b3"><div class="ttname"><a href="classREMORA.html#ab17dd7f0866773488c052d67cb6086b3">REMORA::vec_weight1</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; vec_weight1</div><div class="ttdef"><b>Definition:</b> REMORA.H:298</div></div>
<div class="ttc" id="aclassREMORA_html_af28f51401edd36aa6014d9536e1393da"><div class="ttname"><a href="classREMORA.html#af28f51401edd36aa6014d9536e1393da">REMORA::coriolis</a></div><div class="ttdeci">void coriolis(const amrex::Box &amp;xbx, const amrex::Box &amp;ybx, const amrex::Array4&lt; amrex::Real const &gt; &amp;uold, const amrex::Array4&lt; amrex::Real const &gt; &amp;vold, const amrex::Array4&lt; amrex::Real &gt; &amp;ru, const amrex::Array4&lt; amrex::Real &gt; &amp;rv, const amrex::Array4&lt; amrex::Real const &gt; &amp;Hz, const amrex::Array4&lt; amrex::Real const &gt; &amp;fomn, int nrhs, int nr)</div><div class="ttdef"><b>Definition:</b> REMORA_coriolis.cpp:10</div></div>
<div class="ttc" id="anamespaceBdyVars_html_a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945"><div class="ttname"><a href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">BdyVars::vbar</a></div><div class="ttdeci">@ vbar</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:39</div></div>
<div class="ttc" id="anamespaceBdyVars_html_a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a"><div class="ttname"><a href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">BdyVars::ubar</a></div><div class="ttdeci">@ ubar</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:38</div></div>
<div class="ttc" id="anamespaceBdyVars_html_a0860568d9ad7e1487cd6567de76e0325a63be12014785e028dafaa0104fad32fc"><div class="ttname"><a href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a63be12014785e028dafaa0104fad32fc">BdyVars::zeta</a></div><div class="ttdeci">@ zeta</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:40</div></div>
<div class="ttc" id="astructSolverChoice_html_a9e86533aa6df5bf6408d91f0dfd23606"><div class="ttname"><a href="structSolverChoice.html#a9e86533aa6df5bf6408d91f0dfd23606">SolverChoice::use_coriolis</a></div><div class="ttdeci">bool use_coriolis</div><div class="ttdef"><b>Definition:</b> DataStruct.H:194</div></div>
<div class="ttc" id="astructSolverChoice_html_aeee9d0099e1ac4105829345280a4f03c"><div class="ttname"><a href="structSolverChoice.html#aeee9d0099e1ac4105829345280a4f03c">SolverChoice::g</a></div><div class="ttdeci">amrex::Real g</div><div class="ttdef"><b>Definition:</b> DataStruct.H:234</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a67b92f7c5b82933e953e447bdfc9074c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67b92f7c5b82933e953e447bdfc9074c">&#9670;&nbsp;</a></span>advance_2d_onestep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::advance_2d_onestep </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dtfast_lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>my_iif</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nfast_counter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>2D advance, one predictor/corrector step </p>
<div class="fragment"><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;{</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    <span class="keywordtype">bool</span> first_2d_step=(my_iif==0);</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    <span class="comment">// These are needed to pass ctests</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dummy_time = 0.0;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, dummy_time, *<a class="code" href="classREMORA.html#abb214b8bab178b72c44907f5e2aeead8">vec_ubar</a>[lev], GetVecOfPtrs(<a class="code" href="classREMORA.html#abb214b8bab178b72c44907f5e2aeead8">vec_ubar</a>), <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">BdyVars::ubar</a>);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, dummy_time, *<a class="code" href="classREMORA.html#ab70c8d3ac0d8a5f7ac51365571905874">vec_vbar</a>[lev], GetVecOfPtrs(<a class="code" href="classREMORA.html#ab70c8d3ac0d8a5f7ac51365571905874">vec_vbar</a>), <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">BdyVars::vbar</a>);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="comment">//Predictor</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keywordtype">bool</span> predictor_2d_step=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keywordtype">int</span> next_indx1 = 0;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <a class="code" href="classREMORA.html#a2715857d136dc906b96d0e7c0423d50e">advance_2d</a>(lev,</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;               <a class="code" href="classREMORA.html#a8386c899de7b3b3feab286c144f15229">vec_rhoS</a>[lev].get() , <a class="code" href="classREMORA.html#a9acf62fad9b709ea10e00e9534d7a7c5">vec_rhoA</a>[lev].get(),</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;               <a class="code" href="classREMORA.html#aaf06acc3074f6a4dd322f9e1ca0c5244">vec_ru</a>[lev].get()   , <a class="code" href="classREMORA.html#ae4e70f2661f28e3a3a2585540e804486">vec_rv</a>[lev].get(),</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;               <a class="code" href="classREMORA.html#a5a0dd90f9e35c6055bf3ede53f4229d6">vec_rufrc</a>[lev].get(), <a class="code" href="classREMORA.html#a49ea2c6c379a0fa006e4b6023fd69f88">vec_rvfrc</a>[lev].get(),</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;               <a class="code" href="classREMORA.html#adeb60c66ba4665f07c57fbf3b3b8909a">vec_Zt_avg1</a>[lev].get(),</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;               <a class="code" href="classREMORA.html#ab8e2ff918dcaf20a807b37e88f9fdbb0">vec_DU_avg1</a>[lev], <a class="code" href="classREMORA.html#a1b2cc0f2f617e846c6261df12aefd110">vec_DU_avg2</a>[lev],</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;               <a class="code" href="classREMORA.html#a9e0560b2f68b9c541583c9c1ff6c87ec">vec_DV_avg1</a>[lev], <a class="code" href="classREMORA.html#ac5ba663380c2e7b3857e21fd0d4286f9">vec_DV_avg2</a>[lev],</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;               <a class="code" href="classREMORA.html#a15b7ca3e79155dde5c648ac78d64e6c7">vec_rubar</a>[lev], <a class="code" href="classREMORA.html#a66a39d31a3a2f027101cfd4052b913f3">vec_rvbar</a>[lev], <a class="code" href="classREMORA.html#ac8c001dd94aa7fb806502579324905fd">vec_rzeta</a>[lev],</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                <a class="code" href="classREMORA.html#abb214b8bab178b72c44907f5e2aeead8">vec_ubar</a>[lev],  <a class="code" href="classREMORA.html#ab70c8d3ac0d8a5f7ac51365571905874">vec_vbar</a>[lev],  <a class="code" href="classREMORA.html#ab60f476961622f8e7f27221595e84956">vec_zeta</a>[lev].get(),</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;               <a class="code" href="classREMORA.html#a157e7645fedcf8c0b46516dbb625d3bd">vec_hOfTheConfusingName</a>[lev].get(),</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;               <a class="code" href="classREMORA.html#a173014aa6947dd9d4e0026541211f2be">vec_pm</a>[lev].get(), <a class="code" href="classREMORA.html#ad2d61f66b270a3def972bf32478790d8">vec_pn</a>[lev].get(),</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;               <a class="code" href="classREMORA.html#a13f9894ec6aca96e68687e7a6762e337">vec_fcor</a>[lev].get(),</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;               <a class="code" href="classREMORA.html#a65281506759b30fbc3c382ba0a64f38f">vec_visc2_p</a>[lev].get(), <a class="code" href="classREMORA.html#a86f0a2458c28f42d5be178d7bc5d104b">vec_visc2_r</a>[lev].get(),</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;               dtfast_lev, predictor_2d_step, first_2d_step, my_iif, next_indx1);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">//Corrector. Skip it on last fast step</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    predictor_2d_step=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">if</span> (my_iif &lt; nfast_counter - 1) {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="comment">// These are needed to pass ctests</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, dummy_time, *<a class="code" href="classREMORA.html#abb214b8bab178b72c44907f5e2aeead8">vec_ubar</a>[lev], GetVecOfPtrs(<a class="code" href="classREMORA.html#abb214b8bab178b72c44907f5e2aeead8">vec_ubar</a>), <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">BdyVars::ubar</a>);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, dummy_time, *<a class="code" href="classREMORA.html#ab70c8d3ac0d8a5f7ac51365571905874">vec_vbar</a>[lev], GetVecOfPtrs(<a class="code" href="classREMORA.html#ab70c8d3ac0d8a5f7ac51365571905874">vec_vbar</a>), <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">BdyVars::vbar</a>);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <a class="code" href="classREMORA.html#a2715857d136dc906b96d0e7c0423d50e">advance_2d</a>(lev,</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                   <a class="code" href="classREMORA.html#a8386c899de7b3b3feab286c144f15229">vec_rhoS</a>[lev].get(), <a class="code" href="classREMORA.html#a9acf62fad9b709ea10e00e9534d7a7c5">vec_rhoA</a>[lev].get(),</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                   <a class="code" href="classREMORA.html#aaf06acc3074f6a4dd322f9e1ca0c5244">vec_ru</a>[lev].get(), <a class="code" href="classREMORA.html#ae4e70f2661f28e3a3a2585540e804486">vec_rv</a>[lev].get(),</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                   <a class="code" href="classREMORA.html#a5a0dd90f9e35c6055bf3ede53f4229d6">vec_rufrc</a>[lev].get(), <a class="code" href="classREMORA.html#a49ea2c6c379a0fa006e4b6023fd69f88">vec_rvfrc</a>[lev].get(),</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                   <a class="code" href="classREMORA.html#adeb60c66ba4665f07c57fbf3b3b8909a">vec_Zt_avg1</a>[lev].get(),</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                   <a class="code" href="classREMORA.html#ab8e2ff918dcaf20a807b37e88f9fdbb0">vec_DU_avg1</a>[lev], <a class="code" href="classREMORA.html#a1b2cc0f2f617e846c6261df12aefd110">vec_DU_avg2</a>[lev],</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                   <a class="code" href="classREMORA.html#a9e0560b2f68b9c541583c9c1ff6c87ec">vec_DV_avg1</a>[lev], <a class="code" href="classREMORA.html#ac5ba663380c2e7b3857e21fd0d4286f9">vec_DV_avg2</a>[lev],</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                   <a class="code" href="classREMORA.html#a15b7ca3e79155dde5c648ac78d64e6c7">vec_rubar</a>[lev], <a class="code" href="classREMORA.html#a66a39d31a3a2f027101cfd4052b913f3">vec_rvbar</a>[lev], <a class="code" href="classREMORA.html#ac8c001dd94aa7fb806502579324905fd">vec_rzeta</a>[lev],</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                    <a class="code" href="classREMORA.html#abb214b8bab178b72c44907f5e2aeead8">vec_ubar</a>[lev],  <a class="code" href="classREMORA.html#ab70c8d3ac0d8a5f7ac51365571905874">vec_vbar</a>[lev],  <a class="code" href="classREMORA.html#ab60f476961622f8e7f27221595e84956">vec_zeta</a>[lev].get(),</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                   <a class="code" href="classREMORA.html#a157e7645fedcf8c0b46516dbb625d3bd">vec_hOfTheConfusingName</a>[lev].get(),</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                   <a class="code" href="classREMORA.html#a173014aa6947dd9d4e0026541211f2be">vec_pm</a>[lev].get(), <a class="code" href="classREMORA.html#ad2d61f66b270a3def972bf32478790d8">vec_pn</a>[lev].get(),</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                    <a class="code" href="classREMORA.html#a13f9894ec6aca96e68687e7a6762e337">vec_fcor</a>[lev].get(),</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                   <a class="code" href="classREMORA.html#a65281506759b30fbc3c382ba0a64f38f">vec_visc2_p</a>[lev].get(), <a class="code" href="classREMORA.html#a86f0a2458c28f42d5be178d7bc5d104b">vec_visc2_r</a>[lev].get(),</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                   dtfast_lev, predictor_2d_step, first_2d_step, my_iif, next_indx1);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;}</div>
<div class="ttc" id="aclassREMORA_html_a13f9894ec6aca96e68687e7a6762e337"><div class="ttname"><a href="classREMORA.html#a13f9894ec6aca96e68687e7a6762e337">REMORA::vec_fcor</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_fcor</div><div class="ttdef"><b>Definition:</b> REMORA.H:288</div></div>
<div class="ttc" id="aclassREMORA_html_a157e7645fedcf8c0b46516dbb625d3bd"><div class="ttname"><a href="classREMORA.html#a157e7645fedcf8c0b46516dbb625d3bd">REMORA::vec_hOfTheConfusingName</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_hOfTheConfusingName</div><div class="ttdef"><b>Definition:</b> REMORA.H:197</div></div>
<div class="ttc" id="aclassREMORA_html_a15b7ca3e79155dde5c648ac78d64e6c7"><div class="ttname"><a href="classREMORA.html#a15b7ca3e79155dde5c648ac78d64e6c7">REMORA::vec_rubar</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_rubar</div><div class="ttdef"><b>Definition:</b> REMORA.H:269</div></div>
<div class="ttc" id="aclassREMORA_html_a173014aa6947dd9d4e0026541211f2be"><div class="ttname"><a href="classREMORA.html#a173014aa6947dd9d4e0026541211f2be">REMORA::vec_pm</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_pm</div><div class="ttdef"><b>Definition:</b> REMORA.H:282</div></div>
<div class="ttc" id="aclassREMORA_html_a1b2cc0f2f617e846c6261df12aefd110"><div class="ttname"><a href="classREMORA.html#a1b2cc0f2f617e846c6261df12aefd110">REMORA::vec_DU_avg2</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_DU_avg2</div><div class="ttdef"><b>Definition:</b> REMORA.H:263</div></div>
<div class="ttc" id="aclassREMORA_html_a2715857d136dc906b96d0e7c0423d50e"><div class="ttname"><a href="classREMORA.html#a2715857d136dc906b96d0e7c0423d50e">REMORA::advance_2d</a></div><div class="ttdeci">void advance_2d(int lev, amrex::MultiFab const *mf_rhoS, amrex::MultiFab const *mf_rhoA, amrex::MultiFab *mf_ru, amrex::MultiFab *mf_rv, amrex::MultiFab *mf_rufrc, amrex::MultiFab *mf_rvfrc, amrex::MultiFab *mf_Zt_avg1, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DU_avg1, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DU_avg2, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DV_avg1, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DV_avg2, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_rubar, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_rvbar, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_rzeta, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_ubar, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_vbar, amrex::MultiFab *mf_zeta, amrex::MultiFab const *mf_h, amrex::MultiFab const *mf_pm, amrex::MultiFab const *mf_pn, amrex::MultiFab const *mf_fcor, amrex::MultiFab const *mf_visc2_p, amrex::MultiFab const *mf_visc2_r, const amrex::Real dtfast_lev, const bool predictor_2d_step, const bool first_2d_step, int my_iif, int &amp;next_indx1)</div><div class="ttdef"><b>Definition:</b> REMORA_advance_2d.cpp:37</div></div>
<div class="ttc" id="aclassREMORA_html_a49ea2c6c379a0fa006e4b6023fd69f88"><div class="ttname"><a href="classREMORA.html#a49ea2c6c379a0fa006e4b6023fd69f88">REMORA::vec_rvfrc</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_rvfrc</div><div class="ttdef"><b>Definition:</b> REMORA.H:212</div></div>
<div class="ttc" id="aclassREMORA_html_a5a0dd90f9e35c6055bf3ede53f4229d6"><div class="ttname"><a href="classREMORA.html#a5a0dd90f9e35c6055bf3ede53f4229d6">REMORA::vec_rufrc</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_rufrc</div><div class="ttdef"><b>Definition:</b> REMORA.H:210</div></div>
<div class="ttc" id="aclassREMORA_html_a65281506759b30fbc3c382ba0a64f38f"><div class="ttname"><a href="classREMORA.html#a65281506759b30fbc3c382ba0a64f38f">REMORA::vec_visc2_p</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_visc2_p</div><div class="ttdef"><b>Definition:</b> REMORA.H:218</div></div>
<div class="ttc" id="aclassREMORA_html_a66a39d31a3a2f027101cfd4052b913f3"><div class="ttname"><a href="classREMORA.html#a66a39d31a3a2f027101cfd4052b913f3">REMORA::vec_rvbar</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_rvbar</div><div class="ttdef"><b>Definition:</b> REMORA.H:271</div></div>
<div class="ttc" id="aclassREMORA_html_a8386c899de7b3b3feab286c144f15229"><div class="ttname"><a href="classREMORA.html#a8386c899de7b3b3feab286c144f15229">REMORA::vec_rhoS</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_rhoS</div><div class="ttdef"><b>Definition:</b> REMORA.H:295</div></div>
<div class="ttc" id="aclassREMORA_html_a86f0a2458c28f42d5be178d7bc5d104b"><div class="ttname"><a href="classREMORA.html#a86f0a2458c28f42d5be178d7bc5d104b">REMORA::vec_visc2_r</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_visc2_r</div><div class="ttdef"><b>Definition:</b> REMORA.H:220</div></div>
<div class="ttc" id="aclassREMORA_html_a9acf62fad9b709ea10e00e9534d7a7c5"><div class="ttname"><a href="classREMORA.html#a9acf62fad9b709ea10e00e9534d7a7c5">REMORA::vec_rhoA</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_rhoA</div><div class="ttdef"><b>Definition:</b> REMORA.H:296</div></div>
<div class="ttc" id="aclassREMORA_html_a9e0560b2f68b9c541583c9c1ff6c87ec"><div class="ttname"><a href="classREMORA.html#a9e0560b2f68b9c541583c9c1ff6c87ec">REMORA::vec_DV_avg1</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_DV_avg1</div><div class="ttdef"><b>Definition:</b> REMORA.H:265</div></div>
<div class="ttc" id="aclassREMORA_html_aaf06acc3074f6a4dd322f9e1ca0c5244"><div class="ttname"><a href="classREMORA.html#aaf06acc3074f6a4dd322f9e1ca0c5244">REMORA::vec_ru</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_ru</div><div class="ttdef"><b>Definition:</b> REMORA.H:206</div></div>
<div class="ttc" id="aclassREMORA_html_ab60f476961622f8e7f27221595e84956"><div class="ttname"><a href="classREMORA.html#ab60f476961622f8e7f27221595e84956">REMORA::vec_zeta</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_zeta</div><div class="ttdef"><b>Definition:</b> REMORA.H:279</div></div>
<div class="ttc" id="aclassREMORA_html_ab70c8d3ac0d8a5f7ac51365571905874"><div class="ttname"><a href="classREMORA.html#ab70c8d3ac0d8a5f7ac51365571905874">REMORA::vec_vbar</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_vbar</div><div class="ttdef"><b>Definition:</b> REMORA.H:277</div></div>
<div class="ttc" id="aclassREMORA_html_ab8e2ff918dcaf20a807b37e88f9fdbb0"><div class="ttname"><a href="classREMORA.html#ab8e2ff918dcaf20a807b37e88f9fdbb0">REMORA::vec_DU_avg1</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_DU_avg1</div><div class="ttdef"><b>Definition:</b> REMORA.H:261</div></div>
<div class="ttc" id="aclassREMORA_html_abb214b8bab178b72c44907f5e2aeead8"><div class="ttname"><a href="classREMORA.html#abb214b8bab178b72c44907f5e2aeead8">REMORA::vec_ubar</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_ubar</div><div class="ttdef"><b>Definition:</b> REMORA.H:275</div></div>
<div class="ttc" id="aclassREMORA_html_ac5ba663380c2e7b3857e21fd0d4286f9"><div class="ttname"><a href="classREMORA.html#ac5ba663380c2e7b3857e21fd0d4286f9">REMORA::vec_DV_avg2</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_DV_avg2</div><div class="ttdef"><b>Definition:</b> REMORA.H:267</div></div>
<div class="ttc" id="aclassREMORA_html_ac8c001dd94aa7fb806502579324905fd"><div class="ttname"><a href="classREMORA.html#ac8c001dd94aa7fb806502579324905fd">REMORA::vec_rzeta</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_rzeta</div><div class="ttdef"><b>Definition:</b> REMORA.H:273</div></div>
<div class="ttc" id="aclassREMORA_html_ad2d61f66b270a3def972bf32478790d8"><div class="ttname"><a href="classREMORA.html#ad2d61f66b270a3def972bf32478790d8">REMORA::vec_pn</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_pn</div><div class="ttdef"><b>Definition:</b> REMORA.H:285</div></div>
<div class="ttc" id="aclassREMORA_html_adeb60c66ba4665f07c57fbf3b3b8909a"><div class="ttname"><a href="classREMORA.html#adeb60c66ba4665f07c57fbf3b3b8909a">REMORA::vec_Zt_avg1</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_Zt_avg1</div><div class="ttdef"><b>Definition:</b> REMORA.H:243</div></div>
<div class="ttc" id="aclassREMORA_html_ae4e70f2661f28e3a3a2585540e804486"><div class="ttname"><a href="classREMORA.html#ae4e70f2661f28e3a3a2585540e804486">REMORA::vec_rv</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_rv</div><div class="ttdef"><b>Definition:</b> REMORA.H:208</div></div>
<div class="ttc" id="aclassREMORA_html_aeac4c75110a1011acdf716c00bc62299"><div class="ttname"><a href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">REMORA::FillPatch</a></div><div class="ttdeci">void FillPatch(int lev, amrex::Real time, amrex::MultiFab &amp;mf_to_be_filled, amrex::Vector&lt; amrex::MultiFab * &gt; const &amp;mfs, const int bdy_var_type=BdyVars::null)</div><div class="ttdef"><b>Definition:</b> REMORA_FillPatch.cpp:16</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afc5094ee7dbf65109d98ea18ae3252f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc5094ee7dbf65109d98ea18ae3252f0">&#9670;&nbsp;</a></span>advance_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::advance_3d </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf_cons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_sstore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_ru</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_rv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_DU_avg1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_DU_avg2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_DV_avg1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_DV_avg2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_ubar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_vbar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_Akv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_Akt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_Huon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_Hvom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_z_w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab const *&#160;</td>
          <td class="paramname"><em>mf_h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab const *&#160;</td>
          <td class="paramname"><em>mf_pm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab const *&#160;</td>
          <td class="paramname"><em>mf_pn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Advance the 3D variables </p>
<div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;{</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nrhs  = 0;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nnew  = 0;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordtype">int</span> iic = <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[lev];</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordtype">int</span> ntfirst = 0;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">// Because zeta may have changed</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="classREMORA.html#a20f12090c7b81ca46d953ccf1319c0f5">stretch_transform</a>(lev);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">// These temporaries used to be made in advance_3d_ml and passed in;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// now we make them here</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keyword">const</span> BoxArray&amp;            ba = mf_cons.boxArray();</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keyword">const</span> DistributionMapping&amp; dm = mf_cons.DistributionMap();</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">//Only used locally, probably should be rearranged into FArrayBox declaration</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    MultiFab mf_AK (ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));       <span class="comment">//2d missing j coordinate</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    MultiFab mf_DC (ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1)); <span class="comment">//2d missing j coordinate</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    MultiFab mf_Hzk(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1)); <span class="comment">//2d missing j coordinate</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(mf_cons, TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">u</a> = mf_u.array(mfi);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a> = mf_v.array(mfi);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; ru = mf_ru-&gt;array(mfi);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; rv = mf_rv-&gt;array(mfi);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; AK = mf_AK.array(mfi);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; DC = mf_DC.array(mfi);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; Hzk = mf_Hzk.array(mfi);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; Akv = mf_Akv-&gt;array(mfi);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; Hz  = mf_Hz-&gt;const_array(mfi);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; DU_avg1  = mf_DU_avg1-&gt;const_array(mfi);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; DV_avg1  = mf_DV_avg1-&gt;const_array(mfi);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; DU_avg2  = mf_DU_avg2-&gt;array(mfi);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; DV_avg2  = mf_DV_avg2-&gt;array(mfi);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a> = mf_ubar-&gt;array(mfi);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a> = mf_vbar-&gt;array(mfi);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Huon = mf_Huon-&gt;array(mfi);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Hvom = mf_Hvom-&gt;array(mfi);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; pm  = mf_pm-&gt;const_array(mfi);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; pn  = mf_pn-&gt;const_array(mfi);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        Box bx = mfi.tilebox();</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        Box gbx2 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        Box gbx21 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1));</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        Box xbx = mfi.nodaltilebox(0);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        Box ybx = mfi.nodaltilebox(1);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        Box gbx2D = gbx2;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        gbx2D.makeSlab(2,0);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        Box tbxp1 = bx;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        Box tbxp11 = bx;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        Box tbxp2 = bx;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        tbxp1.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        tbxp2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        tbxp11.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1));</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        FArrayBox fab_FC(gbx2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        FArrayBox fab_BC(gbx2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        FArrayBox fab_CF(gbx21,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        FArrayBox fab_W(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keyword">auto</span> FC = fab_FC.array();</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keyword">auto</span> BC = fab_BC.array();</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keyword">auto</span> CF = fab_CF.array();</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordflow">if</span> (iic==ntfirst) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;          cff=0.25*dt_lev;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iic==ntfirst+1) {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;          cff=0.25*dt_lev*3.0/2.0;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;          cff=0.25*dt_lev*23.0/12.0;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        ParallelFor(xbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">u</a>(i,j,k) += cff * (pm(i,j,0)+pm(i-1,j,0)) * (pn(i,j,0)+pn(i-1,j,0)) * ru(i,j,k,nrhs);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">u</a>(i,j,k) *= 2.0 / (Hz(i-1,j,k) + Hz(i,j,k));</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        });</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        ParallelFor(ybx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a>(i,j,k) += cff * (pm(i,j,0)+pm(i,j-1,0)) * (pn(i,j,0)+pn(i,j-1,0)) * rv(i,j,k,nrhs);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a>(i,j,k) *= 2.0 / (Hz(i,j-1,k) + Hz(i,j,k));</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        });</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="comment">// NOTE: DC is only used as scratch in vert_visc_3d -- no need to pass or return a value</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="comment">// NOTE: may not actually need to set these to zero</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="comment">// Reset to zero on the box on which they&#39;ll be used</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        mf_DC[mfi].template setVal&lt;RunOn::Device&gt;(0.,xbx);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        fab_CF.template     setVal&lt;RunOn::Device&gt;(0.,xbx);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <a class="code" href="classREMORA.html#ac027e24879f2db46f7af0ac0bd7880f1">vert_visc_3d</a>(xbx,1,0,<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">u</a>,Hz,Hzk,AK,Akv,BC,DC,FC,CF,nnew,N,dt_lev);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="comment">// Reset to zero on the box on which they&#39;ll be used</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        mf_DC[mfi].template setVal&lt;RunOn::Device&gt;(0.,ybx);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        fab_CF.template     setVal&lt;RunOn::Device&gt;(0.,ybx);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <a class="code" href="classREMORA.html#ac027e24879f2db46f7af0ac0bd7880f1">vert_visc_3d</a>(ybx,0,1,<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a>,Hz,Hzk,AK,Akv,BC,DC,FC,CF,nnew,N,dt_lev);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="comment">// Reset to zero on the box on which they&#39;ll be used</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        mf_DC[mfi].template setVal&lt;RunOn::Device&gt;(0.,xbx);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        fab_CF.template     setVal&lt;RunOn::Device&gt;(0.,xbx);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <a class="code" href="classREMORA.html#a745f57b79548ae8e06b0df3ceb5def44">vert_mean_3d</a>(xbx,1,0,<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">u</a>,Hz,DU_avg1,DC,CF,pm,nnew,N);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="comment">// Reset to zero on the box on which they&#39;ll be used</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        mf_DC[mfi].template setVal&lt;RunOn::Device&gt;(0.,ybx);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        fab_CF.template     setVal&lt;RunOn::Device&gt;(0.,ybx);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <a class="code" href="classREMORA.html#a745f57b79548ae8e06b0df3ceb5def44">vert_mean_3d</a>(ybx,0,1,<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a>,Hz,DV_avg1,DC,CF,pn,nnew,N);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="comment">// Reset to zero on the box on which they&#39;ll be used</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        mf_DC[mfi].template setVal&lt;RunOn::Device&gt;(0.,grow(xbx,IntVect(0,0,1)));</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        fab_CF.template     setVal&lt;RunOn::Device&gt;(0.,grow(xbx,IntVect(0,0,1)));</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <a class="code" href="classREMORA.html#acea9f8015629ed812b0f2a00ab1f1b70">update_massflux_3d</a>(xbx,1,0,<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">u</a>,<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>,Huon,Hz,pn,DU_avg1,DU_avg2,DC,FC,nnew);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="comment">// Reset to zero on the box on which they&#39;ll be used</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        mf_DC[mfi].template setVal&lt;RunOn::Device&gt;(0.,grow(ybx,IntVect(0,0,1)));</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        fab_CF.template     setVal&lt;RunOn::Device&gt;(0.,grow(ybx,IntVect(0,0,1)));</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <a class="code" href="classREMORA.html#acea9f8015629ed812b0f2a00ab1f1b70">update_massflux_3d</a>(ybx,0,1,<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a>,<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>,Hvom,Hz,pm,DV_avg1,DV_avg2,DC,FC,nnew);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="comment">// Reset to zero on the box on which they&#39;ll be used</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        fab_FC.template setVal&lt;RunOn::Device&gt;(0.,gbx2);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        mf_DC[mfi].template setVal&lt;RunOn::Device&gt;(0.,grow(gbx2,IntVect(0,0,1)));</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <a class="code" href="classREMORA.html#acea9f8015629ed812b0f2a00ab1f1b70">update_massflux_3d</a>(gbx2,1,0,<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">u</a>,<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>,Huon,Hz,pn,DU_avg1,DU_avg2,DC,FC,nnew);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="comment">// Reset to zero on the box on which they&#39;ll be used</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        fab_FC.template     setVal&lt;RunOn::Device&gt;(0.,gbx2);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        mf_DC[mfi].template setVal&lt;RunOn::Device&gt;(0.,grow(gbx2,IntVect(0,0,1)));</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <a class="code" href="classREMORA.html#acea9f8015629ed812b0f2a00ab1f1b70">update_massflux_3d</a>(gbx2,0,1,<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a>,<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>,Hvom,Hz,pm,DV_avg1,DV_avg2,DC,FC,nnew);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// WE BELIEVE THESE VALUES SHOULD ALREADY BE FILLED</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">// mf_Huon-&gt;FillBoundary(geom[lev].periodicity());</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// mf_Hvom-&gt;FillBoundary(geom[lev].periodicity());</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">// ************************************************************************</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">// This should fill both temp and salt with temp/salt currently in cons_old</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">// ************************************************************************</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(mf_cons, TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Hz  = mf_Hz-&gt;array(mfi);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Huon = mf_Huon-&gt;array(mfi);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Hvom = mf_Hvom-&gt;array(mfi);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; z_w = mf_z_w-&gt;const_array(mfi);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; h   = mf_h-&gt;const_array(mfi);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; pm  = mf_pm-&gt;const_array(mfi);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; pn  = mf_pn-&gt;const_array(mfi);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        Box bx = mfi.tilebox();</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        Box gbx = mfi.growntilebox();</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        Box gbx1 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        Box gbx2 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        Box gbx21 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1));</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        Box tbxp1 = bx;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        Box tbxp11 = bx;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        Box tbxp2 = bx;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        tbxp1.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        tbxp2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        tbxp11.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1));</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        FArrayBox fab_FC(gbx2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        FArrayBox fab_BC(gbx2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        FArrayBox fab_CF(gbx21,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        FArrayBox fab_W(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keyword">auto</span> FC  = fab_FC.array();</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keyword">auto</span> W   = fab_W.array();</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="comment">//------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="comment">//  Vertically integrate horizontal mass flux divergence.</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="comment">//------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="comment">//Should really use gbx3uneven</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="comment">//TODO: go over these boxes and compare to other spots where we do the same thing</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        Box gbx1D = gbx1;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        gbx1D.makeSlab(2,0);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="comment">//  Starting with zero vertical velocity at the bottom, integrate</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="comment">//  from the bottom (k=0) to the free-surface (k=N).  The w(:,:,N(ng))</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="comment">//  contains the vertical velocity at the free-surface, d(zeta)/d(t).</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="comment">//  Notice that barotropic mass flux divergence is not used directly.</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        ParallelFor(gbx1D, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            W(i,j,0) = - (Huon(i+1,j,0)-Huon(i,j,0)) - (Hvom(i,j+1,0)-Hvom(i,j,0));</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=1; k&lt;=N; k++) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                W(i,j,k) = W(i,j,k-1) - (Huon(i+1,j,k)-Huon(i,j,k)) - (Hvom(i,j+1,k)-Hvom(i,j,k));</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        });</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="comment">//  Starting with zero vertical velocity at the bottom, integrate</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="comment">//  from the bottom (k=0) to the free-surface (k=N).  The w(:,:,N(ng))</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="comment">//  contains the vertical velocity at the free-surface, d(zeta)/d(t).</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="comment">//  Notice that barotropic mass flux divergence is not used directly.</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        ParallelFor(gbx1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> wrk_ij = W(i,j,N) / (z_w(i,j,N)+h(i,j,0,0));</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <span class="keywordflow">if</span>(k!=N) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                W(i,j,k) -=  wrk_ij * (z_w(i,j,k)+h(i,j,0,0));</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        });</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        ParallelFor(makeSlab(gbx1,2,N), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            W(i,j,N) = 0.0;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        });</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="comment">// rhs_t_3d</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_comp=0; i_comp &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i_comp++)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            Array4&lt;Real&gt; <span class="keyword">const</span>&amp; sstore = mf_sstore-&gt;array(mfi, i_comp);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <a class="code" href="classREMORA.html#a11e1383c91ab5a3df346a41a8b7338e0">rhs_t_3d</a>(bx, gbx, mf_cons.array(mfi,i_comp), sstore, Huon, Hvom,</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                     Hz, pn, pm, W, FC, nrhs, nnew, N,dt_lev);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev], mf_cons, <a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325abd1c55aaa78d7bcedd3a0e21005f2955">BdyVars::t</a>);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(mf_cons, TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; AK = mf_AK.array(mfi);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; DC = mf_DC.array(mfi);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Hzk = mf_Hzk.array(mfi);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; Hz  = mf_Hz-&gt;const_array(mfi);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        Box bx = mfi.tilebox();</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="comment">// Copy the tilebox</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        Box tbxp1 = bx;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        Box tbxp11 = bx;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        Box tbxp2 = bx;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        Box tbxp21 = bx;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="comment">//make only gbx be grown to match multifabs</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        tbxp21.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1));</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        tbxp2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        tbxp1.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        tbxp11.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1));</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        FArrayBox fab_FC(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        FArrayBox fab_BC(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        FArrayBox fab_CF(tbxp21,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        FArrayBox fab_W(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keyword">auto</span> FC = fab_FC.array();</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keyword">auto</span> BC = fab_BC.array();</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keyword">auto</span> CF = fab_CF.array();</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_comp=0; i_comp &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i_comp++) {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <a class="code" href="classREMORA.html#ac027e24879f2db46f7af0ac0bd7880f1">vert_visc_3d</a>(bx,0,0,mf_cons.array(mfi,i_comp),Hz,Hzk,</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                    AK,mf_Akt-&gt;array(mfi,i_comp),BC,DC,FC,CF,nnew,N,dt_lev);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    } <span class="comment">// MFiter</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;}</div>
<div class="ttc" id="aIndexDefines_8H_html_ae3f12540307d28407f8d7dd4a169e325"><div class="ttname"><a href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a></div><div class="ttdeci">#define NCONS</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:11</div></div>
<div class="ttc" id="aclassREMORA_html_a11e1383c91ab5a3df346a41a8b7338e0"><div class="ttname"><a href="classREMORA.html#a11e1383c91ab5a3df346a41a8b7338e0">REMORA::rhs_t_3d</a></div><div class="ttdeci">void rhs_t_3d(const amrex::Box &amp;bx, const amrex::Box &amp;gbx, const amrex::Array4&lt; amrex::Real &gt; &amp;t, const amrex::Array4&lt; amrex::Real const &gt; &amp;tempstore, const amrex::Array4&lt; amrex::Real const &gt; &amp;Huon, const amrex::Array4&lt; amrex::Real const &gt; &amp;Hvom, const amrex::Array4&lt; amrex::Real const &gt; &amp;Hz, const amrex::Array4&lt; amrex::Real const &gt; &amp;pn, const amrex::Array4&lt; amrex::Real const &gt; &amp;pm, const amrex::Array4&lt; amrex::Real const &gt; &amp;W, const amrex::Array4&lt; amrex::Real &gt; &amp;FC, int nrhs, int nnew, int N, const amrex::Real dt_lev)</div><div class="ttdef"><b>Definition:</b> REMORA_rhs_t_3d.cpp:25</div></div>
<div class="ttc" id="aclassREMORA_html_a20f12090c7b81ca46d953ccf1319c0f5"><div class="ttname"><a href="classREMORA.html#a20f12090c7b81ca46d953ccf1319c0f5">REMORA::stretch_transform</a></div><div class="ttdeci">void stretch_transform(int lev)</div><div class="ttdef"><b>Definition:</b> DepthStretchTransform.H:12</div></div>
<div class="ttc" id="aclassREMORA_html_a745f57b79548ae8e06b0df3ceb5def44"><div class="ttname"><a href="classREMORA.html#a745f57b79548ae8e06b0df3ceb5def44">REMORA::vert_mean_3d</a></div><div class="ttdeci">void vert_mean_3d(const amrex::Box &amp;bx, const int ioff, const int joff, const amrex::Array4&lt; amrex::Real &gt; &amp;phi, const amrex::Array4&lt; amrex::Real const &gt; &amp;Hz, const amrex::Array4&lt; amrex::Real const &gt; &amp;Dphi_avg1, const amrex::Array4&lt; amrex::Real &gt; &amp;DC, const amrex::Array4&lt; amrex::Real &gt; &amp;CF, const amrex::Array4&lt; amrex::Real const &gt; &amp;dxlen, const int nnew, const int N)</div><div class="ttdef"><b>Definition:</b> REMORA_vert_mean_3d.cpp:10</div></div>
<div class="ttc" id="aclassREMORA_html_ac027e24879f2db46f7af0ac0bd7880f1"><div class="ttname"><a href="classREMORA.html#ac027e24879f2db46f7af0ac0bd7880f1">REMORA::vert_visc_3d</a></div><div class="ttdeci">void vert_visc_3d(const amrex::Box &amp;bx, const int ioff, const int joff, const amrex::Array4&lt; amrex::Real &gt; &amp;phi, const amrex::Array4&lt; amrex::Real const &gt; &amp;Hz, const amrex::Array4&lt; amrex::Real &gt; &amp;Hzk, const amrex::Array4&lt; amrex::Real &gt; &amp;AK, const amrex::Array4&lt; amrex::Real &gt; &amp;Akv, const amrex::Array4&lt; amrex::Real &gt; &amp;BC, const amrex::Array4&lt; amrex::Real &gt; &amp;DC, const amrex::Array4&lt; amrex::Real &gt; &amp;FC, const amrex::Array4&lt; amrex::Real &gt; &amp;CF, const int nnew, const int N, const amrex::Real dt_lev)</div><div class="ttdef"><b>Definition:</b> REMORA_vert_visc_3d.cpp:10</div></div>
<div class="ttc" id="aclassREMORA_html_acea9f8015629ed812b0f2a00ab1f1b70"><div class="ttname"><a href="classREMORA.html#acea9f8015629ed812b0f2a00ab1f1b70">REMORA::update_massflux_3d</a></div><div class="ttdeci">void update_massflux_3d(const amrex::Box &amp;bx, const int ioff, const int joff, const amrex::Array4&lt; amrex::Real &gt; &amp;phi, const amrex::Array4&lt; amrex::Real &gt; &amp;phibar, const amrex::Array4&lt; amrex::Real &gt; &amp;Hphi, const amrex::Array4&lt; amrex::Real const &gt; &amp;Hz, const amrex::Array4&lt; amrex::Real const &gt; &amp;pm_or_pn, const amrex::Array4&lt; amrex::Real const &gt; &amp;Dphi1, const amrex::Array4&lt; amrex::Real const &gt; &amp;Dphi2, const amrex::Array4&lt; amrex::Real &gt; &amp;DC, const amrex::Array4&lt; amrex::Real &gt; &amp;FC, const int nnew)</div><div class="ttdef"><b>Definition:</b> REMORA_update_massflux_3d.cpp:23</div></div>
<div class="ttc" id="anamespaceBdyVars_html_a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16"><div class="ttname"><a href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">BdyVars::u</a></div><div class="ttdeci">@ u</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:34</div></div>
<div class="ttc" id="anamespaceBdyVars_html_a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922"><div class="ttname"><a href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">BdyVars::v</a></div><div class="ttdeci">@ v</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:35</div></div>
<div class="ttc" id="anamespaceBdyVars_html_a0860568d9ad7e1487cd6567de76e0325abd1c55aaa78d7bcedd3a0e21005f2955"><div class="ttname"><a href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325abd1c55aaa78d7bcedd3a0e21005f2955">BdyVars::t</a></div><div class="ttdeci">@ t</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:36</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a805863a28beceb70cefd0b6f050d8c2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a805863a28beceb70cefd0b6f050d8c2d">&#9670;&nbsp;</a></span>advance_3d_ml()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::advance_3d_ml </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>3D advance on a single level </p>
<div class="fragment"><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;{</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    <span class="comment">// Fill in three ways: 1) interpolate from coarse grid if lev &gt; 0; 2) fill from physical boundaries;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    <span class="comment">//                     3) fine-fine fill of ghost cells with FillBoundary call</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev], *<a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev], <a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325abd1c55aaa78d7bcedd3a0e21005f2955">BdyVars::t</a>);</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev], *<a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev], <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">BdyVars::u</a>);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev], *<a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev], <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">BdyVars::v</a>);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev], *<a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[lev], <a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325ab738c65b8fa93b2166002dce928aca27">BdyVars::null</a>);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev], *<a class="code" href="classREMORA.html#a3d55e55c73497ceabf620dacbe632a3a">vec_sstore</a>[lev], GetVecOfPtrs(<a class="code" href="classREMORA.html#a3d55e55c73497ceabf620dacbe632a3a">vec_sstore</a>), <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325abd1c55aaa78d7bcedd3a0e21005f2955">BdyVars::t</a>);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keyword">auto</span> N = Geom(lev).Domain().size()[2]-1; <span class="comment">// Number of vertical &quot;levs&quot; aka, NZ</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <a class="code" href="classREMORA.html#afc5094ee7dbf65109d98ea18ae3252f0">advance_3d</a>(lev, *<a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev], *<a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev], *<a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev],</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;               <a class="code" href="classREMORA.html#a3d55e55c73497ceabf620dacbe632a3a">vec_sstore</a>[lev].get(),</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;               <a class="code" href="classREMORA.html#aaf06acc3074f6a4dd322f9e1ca0c5244">vec_ru</a>[lev].get(), <a class="code" href="classREMORA.html#ae4e70f2661f28e3a3a2585540e804486">vec_rv</a>[lev].get(),</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;               <a class="code" href="classREMORA.html#ab8e2ff918dcaf20a807b37e88f9fdbb0">vec_DU_avg1</a>[lev], <a class="code" href="classREMORA.html#a1b2cc0f2f617e846c6261df12aefd110">vec_DU_avg2</a>[lev],</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;               <a class="code" href="classREMORA.html#a9e0560b2f68b9c541583c9c1ff6c87ec">vec_DV_avg1</a>[lev], <a class="code" href="classREMORA.html#ac5ba663380c2e7b3857e21fd0d4286f9">vec_DV_avg2</a>[lev],</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;               <a class="code" href="classREMORA.html#abb214b8bab178b72c44907f5e2aeead8">vec_ubar</a>[lev],  <a class="code" href="classREMORA.html#ab70c8d3ac0d8a5f7ac51365571905874">vec_vbar</a>[lev],</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;               <a class="code" href="classREMORA.html#ad36ee94716ca0cde00d8cad5fe5cce94">vec_Akv</a>[lev], <a class="code" href="classREMORA.html#a48c1bf42530780ce02b3655d7cefe592">vec_Akt</a>[lev], <a class="code" href="classREMORA.html#a488738b1aea61abbbf086a9d22b4f815">vec_Hz</a>[lev], <a class="code" href="classREMORA.html#a89f042895cd59cc1a1226f2af2d3e04f">vec_Huon</a>[lev], <a class="code" href="classREMORA.html#afd1aab14dfc9155d65e48aad2b34ef42">vec_Hvom</a>[lev],</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;               <a class="code" href="classREMORA.html#af7958bb9cfac605c91f1e74357f344b2">vec_z_w</a>[lev], <a class="code" href="classREMORA.html#a157e7645fedcf8c0b46516dbb625d3bd">vec_hOfTheConfusingName</a>[lev].get(),</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;               <a class="code" href="classREMORA.html#a173014aa6947dd9d4e0026541211f2be">vec_pm</a>[lev].get(), <a class="code" href="classREMORA.html#ad2d61f66b270a3def972bf32478790d8">vec_pn</a>[lev].get(),</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;               N, dt_lev);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev], *<a class="code" href="classREMORA.html#abb214b8bab178b72c44907f5e2aeead8">vec_ubar</a>[lev], GetVecOfPtrs(<a class="code" href="classREMORA.html#abb214b8bab178b72c44907f5e2aeead8">vec_ubar</a>), <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">BdyVars::ubar</a>);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev], *<a class="code" href="classREMORA.html#ab70c8d3ac0d8a5f7ac51365571905874">vec_vbar</a>[lev], GetVecOfPtrs(<a class="code" href="classREMORA.html#ab70c8d3ac0d8a5f7ac51365571905874">vec_vbar</a>), <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">BdyVars::vbar</a>);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev], *<a class="code" href="classREMORA.html#a3d55e55c73497ceabf620dacbe632a3a">vec_sstore</a>[lev], GetVecOfPtrs(<a class="code" href="classREMORA.html#a3d55e55c73497ceabf620dacbe632a3a">vec_sstore</a>), <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325abd1c55aaa78d7bcedd3a0e21005f2955">BdyVars::t</a>);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// Fill in three ways: 1) interpolate from coarse grid if lev &gt; 0; 2) fill from physical boundaries;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="comment">//                     3) fine-fine fill of ghost cells with FillBoundary call</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="comment">// Note that we need the fine-fine and physical bc&#39;s in order to correctly move the particles</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev], *<a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev], <a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325abd1c55aaa78d7bcedd3a0e21005f2955">BdyVars::t</a>);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev], *<a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev], <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">BdyVars::u</a>);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev], *<a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev], <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">BdyVars::v</a>);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev], *<a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[lev], <a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325ab738c65b8fa93b2166002dce928aca27">BdyVars::null</a>);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_PARTICLES</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">//***************************************************</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">//Advance particles</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">//***************************************************</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    particleData.advance_particles(lev, dt_lev, <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev], <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev], <a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[lev], <a class="code" href="classREMORA.html#ac956bf3a52181b34d3e98a85ea5ba131">vec_z_phys_nd</a>);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div>
<div class="ttc" id="aclassREMORA_html_a3d55e55c73497ceabf620dacbe632a3a"><div class="ttname"><a href="classREMORA.html#a3d55e55c73497ceabf620dacbe632a3a">REMORA::vec_sstore</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_sstore</div><div class="ttdef"><b>Definition:</b> REMORA.H:291</div></div>
<div class="ttc" id="aclassREMORA_html_a488738b1aea61abbbf086a9d22b4f815"><div class="ttname"><a href="classREMORA.html#a488738b1aea61abbbf086a9d22b4f815">REMORA::vec_Hz</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_Hz</div><div class="ttdef"><b>Definition:</b> REMORA.H:200</div></div>
<div class="ttc" id="aclassREMORA_html_a48c1bf42530780ce02b3655d7cefe592"><div class="ttname"><a href="classREMORA.html#a48c1bf42530780ce02b3655d7cefe592">REMORA::vec_Akt</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_Akt</div><div class="ttdef"><b>Definition:</b> REMORA.H:216</div></div>
<div class="ttc" id="aclassREMORA_html_a89f042895cd59cc1a1226f2af2d3e04f"><div class="ttname"><a href="classREMORA.html#a89f042895cd59cc1a1226f2af2d3e04f">REMORA::vec_Huon</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_Huon</div><div class="ttdef"><b>Definition:</b> REMORA.H:202</div></div>
<div class="ttc" id="aclassREMORA_html_ac956bf3a52181b34d3e98a85ea5ba131"><div class="ttname"><a href="classREMORA.html#ac956bf3a52181b34d3e98a85ea5ba131">REMORA::vec_z_phys_nd</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_z_phys_nd</div><div class="ttdef"><b>Definition:</b> REMORA.H:240</div></div>
<div class="ttc" id="aclassREMORA_html_ad36ee94716ca0cde00d8cad5fe5cce94"><div class="ttname"><a href="classREMORA.html#ad36ee94716ca0cde00d8cad5fe5cce94">REMORA::vec_Akv</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_Akv</div><div class="ttdef"><b>Definition:</b> REMORA.H:214</div></div>
<div class="ttc" id="aclassREMORA_html_af7958bb9cfac605c91f1e74357f344b2"><div class="ttname"><a href="classREMORA.html#af7958bb9cfac605c91f1e74357f344b2">REMORA::vec_z_w</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_z_w</div><div class="ttdef"><b>Definition:</b> REMORA.H:234</div></div>
<div class="ttc" id="aclassREMORA_html_afc5094ee7dbf65109d98ea18ae3252f0"><div class="ttname"><a href="classREMORA.html#afc5094ee7dbf65109d98ea18ae3252f0">REMORA::advance_3d</a></div><div class="ttdeci">void advance_3d(int lev, amrex::MultiFab &amp;mf_cons, amrex::MultiFab &amp;mf_u, amrex::MultiFab &amp;mf_v, amrex::MultiFab *mf_sstore, amrex::MultiFab *mf_ru, amrex::MultiFab *mf_rv, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DU_avg1, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DU_avg2, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DV_avg1, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DV_avg2, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_ubar, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_vbar, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_Akv, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_Akt, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_Hz, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_Huon, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_Hvom, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_z_w, amrex::MultiFab const *mf_h, amrex::MultiFab const *mf_pm, amrex::MultiFab const *mf_pn, const int N, const amrex::Real dt_lev)</div><div class="ttdef"><b>Definition:</b> REMORA_advance_3d.cpp:10</div></div>
<div class="ttc" id="aclassREMORA_html_afd1aab14dfc9155d65e48aad2b34ef42"><div class="ttname"><a href="classREMORA.html#afd1aab14dfc9155d65e48aad2b34ef42">REMORA::vec_Hvom</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_Hvom</div><div class="ttdef"><b>Definition:</b> REMORA.H:204</div></div>
<div class="ttc" id="anamespaceBdyVars_html_a0860568d9ad7e1487cd6567de76e0325ab738c65b8fa93b2166002dce928aca27"><div class="ttname"><a href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325ab738c65b8fa93b2166002dce928aca27">BdyVars::null</a></div><div class="ttdeci">@ null</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:33</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acc4cc491f4e1714d3d4999290046c82e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc4cc491f4e1714d3d4999290046c82e">&#9670;&nbsp;</a></span>AverageDown()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::AverageDown </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>set covered coarse cells to be the average of overlying fine cells </p>
<div class="fragment"><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;{</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = finest_level-1; lev &gt;= 0; --lev)</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <a class="code" href="classREMORA.html#a685a244b9590a93bd7272b2261d0ecf3">AverageDownTo</a>(lev);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    }</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;}</div>
<div class="ttc" id="aclassREMORA_html_a685a244b9590a93bd7272b2261d0ecf3"><div class="ttname"><a href="classREMORA.html#a685a244b9590a93bd7272b2261d0ecf3">REMORA::AverageDownTo</a></div><div class="ttdeci">void AverageDownTo(int crse_lev)</div><div class="ttdef"><b>Definition:</b> REMORA.cpp:641</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a685a244b9590a93bd7272b2261d0ecf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a685a244b9590a93bd7272b2261d0ecf3">&#9670;&nbsp;</a></span>AverageDownTo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::AverageDownTo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>crse_lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>more flexible version of <a class="el" href="classREMORA.html#acc4cc491f4e1714d3d4999290046c82e">AverageDown()</a> that lets you average down across multiple levels </p>
<div class="fragment"><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;{</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    average_down(*<a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[crse_lev+1], *<a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[crse_lev],</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                 0, <a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[crse_lev]-&gt;nComp(), refRatio(crse_lev));</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    Array&lt;MultiFab*,AMREX_SPACEDIM&gt;  faces_crse;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    Array&lt;MultiFab*,AMREX_SPACEDIM&gt;  faces_fine;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    faces_crse[0] = <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[crse_lev];</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    faces_crse[1] = <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[crse_lev];</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    faces_crse[2] = <a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[crse_lev];</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    faces_fine[0] = <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[crse_lev+1];</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    faces_fine[1] = <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[crse_lev+1];</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    faces_fine[2] = <a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[crse_lev+1];</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    average_down_faces(GetArrOfConstPtrs(faces_fine), faces_crse,</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                       refRatio(crse_lev),geom[crse_lev]);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6577b0c143b8fc44c6f68cad8dec5fd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6577b0c143b8fc44c6f68cad8dec5fd6">&#9670;&nbsp;</a></span>build_fine_mask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MultiFab &amp; REMORA::build_fine_mask </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Make mask to zero out covered cells </p>
<div class="fragment"><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;{</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// Mask for zeroing covered cells</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    AMREX_ASSERT(level &gt; 0);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keyword">const</span> BoxArray&amp; cba = grids[level-1];</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keyword">const</span> DistributionMapping&amp; cdm = dmap[level-1];</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">// TODO -- we should make a vector of these a member of REMORA class</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="classREMORA.html#a1767264051aeb1f4463f23304214617e">fine_mask</a>.define(cba, cdm, 1, 0, MFInfo());</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="classREMORA.html#a1767264051aeb1f4463f23304214617e">fine_mask</a>.setVal(1.0);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    BoxArray fba = grids[level];</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    iMultiFab ifine_mask = makeFineMask(cba, cdm, fba, ref_ratio[level-1], 1, 0);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>  fma =  <a class="code" href="classREMORA.html#a1767264051aeb1f4463f23304214617e">fine_mask</a>.arrays();</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> ifma = ifine_mask.arrays();</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    ParallelFor(<a class="code" href="classREMORA.html#a1767264051aeb1f4463f23304214617e">fine_mask</a>, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> bno, <span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        fma[bno](i,j,k) = ifma[bno](i,j,k);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    });</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    Gpu::synchronize();</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classREMORA.html#a1767264051aeb1f4463f23304214617e">fine_mask</a>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;}</div>
<div class="ttc" id="aclassREMORA_html_a1767264051aeb1f4463f23304214617e"><div class="ttname"><a href="classREMORA.html#a1767264051aeb1f4463f23304214617e">REMORA::fine_mask</a></div><div class="ttdeci">amrex::MultiFab fine_mask</div><div class="ttdef"><b>Definition:</b> REMORA.H:886</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a381f0228efdd9ed40fd9ed0825aa47c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a381f0228efdd9ed40fd9ed0825aa47c2">&#9670;&nbsp;</a></span>ClearLevel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::ClearLevel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Delete level data Overrides the pure virtual function in AmrCore </p>
<div class="fragment"><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;{</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev]; <span class="keyword">delete</span> <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev];  <span class="keyword">delete</span> <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev];  <span class="keyword">delete</span> <a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[lev];</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classREMORA.html#abc6ebdcc84239b993b12b3c95425fa88">cons_old</a>[lev]; <span class="keyword">delete</span> <a class="code" href="classREMORA.html#a51594dd103a7eee0f4e0c6e366d9f0ce">xvel_old</a>[lev];  <span class="keyword">delete</span> <a class="code" href="classREMORA.html#a9861cf91ee53fb2125f5f49c5cf73155">yvel_old</a>[lev];  <span class="keyword">delete</span> <a class="code" href="classREMORA.html#a6a980b1cd1d4d0e1253a641bee00de75">zvel_old</a>[lev];</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7671b889b87ca190f7aba7188074efa3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7671b889b87ca190f7aba7188074efa3">&#9670;&nbsp;</a></span>ComputeDt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::ComputeDt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>a wrapper for <a class="el" href="classREMORA.html#ac71630052015782fce4f20e204e42016">estTimeStep()</a> </p>
<div class="fragment"><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;{</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    Vector&lt;Real&gt; dt_tmp(finest_level+1);</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    {</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        dt_tmp[lev] = <a class="code" href="classREMORA.html#ac71630052015782fce4f20e204e42016">estTimeStep</a>(lev);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    }</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    ParallelDescriptor::ReduceRealMin(&amp;dt_tmp[0], dt_tmp.size());</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dt_0 = dt_tmp[0];</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keywordtype">int</span> n_factor = 1;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        dt_tmp[lev] = amrex::min(dt_tmp[lev], <a class="code" href="classREMORA.html#a8c3a852e766271b0dcf52a99f2ba6500">change_max</a>*<a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[lev]);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        n_factor *= <a class="code" href="classREMORA.html#a7595b63fdb3f613a189cd20936290d2b">nsubsteps</a>[lev];</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        dt_0 = amrex::min(dt_0, n_factor*dt_tmp[lev]);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    }</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="comment">// Limit dt&#39;s by the value of stop_time.</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> eps = 1.e-3*dt_0;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[0] + dt_0 &gt; <a class="code" href="classREMORA.html#a2981da216b5811080251dc15b27ca281">stop_time</a> - eps) {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        dt_0 = <a class="code" href="classREMORA.html#a2981da216b5811080251dc15b27ca281">stop_time</a> - <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[0];</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    }</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[0] = dt_0;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[lev] = <a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[lev-1] / <a class="code" href="classREMORA.html#a7595b63fdb3f613a189cd20936290d2b">nsubsteps</a>[lev];</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    }</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;}</div>
<div class="ttc" id="aclassREMORA_html_a2981da216b5811080251dc15b27ca281"><div class="ttname"><a href="classREMORA.html#a2981da216b5811080251dc15b27ca281">REMORA::stop_time</a></div><div class="ttdeci">amrex::Real stop_time</div><div class="ttdef"><b>Definition:</b> REMORA.H:776</div></div>
<div class="ttc" id="aclassREMORA_html_a8c3a852e766271b0dcf52a99f2ba6500"><div class="ttname"><a href="classREMORA.html#a8c3a852e766271b0dcf52a99f2ba6500">REMORA::change_max</a></div><div class="ttdeci">static amrex::Real change_max</div><div class="ttdef"><b>Definition:</b> REMORA.H:784</div></div>
<div class="ttc" id="aclassREMORA_html_ac71630052015782fce4f20e204e42016"><div class="ttname"><a href="classREMORA.html#ac71630052015782fce4f20e204e42016">REMORA::estTimeStep</a></div><div class="ttdeci">amrex::Real estTimeStep(int lev) const</div><div class="ttdef"><b>Definition:</b> REMORA_ComputeTimestep.cpp:40</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3be29f45efb0b259995c494f6dac2b97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3be29f45efb0b259995c494f6dac2b97">&#9670;&nbsp;</a></span>ComputeGhostCells()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE int REMORA::ComputeGhostCells </td>
          <td>(</td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>spatial_order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                                                {</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      <span class="keywordtype">int</span> nGhostCells;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      <span class="keywordflow">switch</span> (spatial_order) {</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;          nGhostCells = 2; <span class="comment">// We need this many to compute the eddy viscosity in the ghost cells</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;          nGhostCells = 2;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;          nGhostCells = 2;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <span class="keywordflow">case</span> 5:</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;          nGhostCells = 3;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        <span class="keywordflow">case</span> 6:</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;          nGhostCells = 3;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;          amrex::Error(<span class="stringliteral">&quot;Must specify spatial order to be 2,3,4,5 or 6&quot;</span>);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      }</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160; </div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <span class="keywordflow">return</span> nGhostCells;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af28f51401edd36aa6014d9536e1393da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af28f51401edd36aa6014d9536e1393da">&#9670;&nbsp;</a></span>coriolis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::coriolis </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>xbx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>ybx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>uold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>vold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>ru</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>rv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>fomn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;{</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="comment">//  Add in Coriolis terms.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    ParallelFor(xbx,</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    {</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> UFx_i   = 0.5 * Hz(i  ,j,k) * fomn(i  ,j,0) * (vold(i  ,j,k,nrhs)+vold(i  ,j+1,k,nrhs));</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> UFx_im1 = 0.5 * Hz(i-1,j,k) * fomn(i-1,j,0) * (vold(i-1,j,k,nrhs)+vold(i-1,j+1,k,nrhs));</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        ru(i,j,k,nr) += 0.5*(UFx_i + UFx_im1);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    });</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    ParallelFor(ybx,</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> VFe_j   = 0.5 * Hz(i,j  ,k) * fomn(i,j  ,0) * (uold(i,j  ,k,nrhs)+uold(i+1,j  ,k,nrhs));</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> VFe_jm1 = 0.5 * Hz(i,j-1,k) * fomn(i,j-1,0) * (uold(i,j-1,k,nrhs)+uold(i+1,j-1,k,nrhs));</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        rv(i,j,k,nr) -= 0.5*(VFe_j + VFe_jm1);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    });</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a82e5140a7b4d9092e8230b7043d0a388"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82e5140a7b4d9092e8230b7043d0a388">&#9670;&nbsp;</a></span>DataLog()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE std::ostream&amp; REMORA::DataLog </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    {</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        <span class="keywordflow">return</span> *<a class="code" href="classREMORA.html#ad3530fc80b87c25ce728095929a4ea99">datalog</a>[i];</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    }</div>
<div class="ttc" id="aclassREMORA_html_ad3530fc80b87c25ce728095929a4ea99"><div class="ttname"><a href="classREMORA.html#ad3530fc80b87c25ce728095929a4ea99">REMORA::datalog</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; std::fstream &gt; &gt; datalog</div><div class="ttdef"><b>Definition:</b> REMORA.H:967</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8062b4dcb1ea9deba016d427d23480aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8062b4dcb1ea9deba016d427d23480aa">&#9670;&nbsp;</a></span>DataLogName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string REMORA::DataLogName </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The filename of the ith datalog file. </p>
<div class="fragment"><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classREMORA.html#a39048951d6927086a690d57a53754160">datalogname</a>[i]; }</div>
<div class="ttc" id="aclassREMORA_html_a39048951d6927086a690d57a53754160"><div class="ttname"><a href="classREMORA.html#a39048951d6927086a690d57a53754160">REMORA::datalogname</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; datalogname</div><div class="ttdef"><b>Definition:</b> REMORA.H:968</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a783db1b357863608197eccb6fe7d4c52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a783db1b357863608197eccb6fe7d4c52">&#9670;&nbsp;</a></span>ErrorEst()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::ErrorEst </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::TagBoxArray &amp;&#160;</td>
          <td class="paramname"><em>tags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ngrow</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Tag cells for refinement</p>
<p>Function to tag cells for refinement &ndash; this overrides the pure virtual function in AmrCore</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">level</td><td>level of refinement (0 is coarsest leve) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tags</td><td>array of tagged cells </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">time</td><td>current time </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;{</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> clearval = TagBox::CLEAR;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>   tagval = TagBox::SET;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; <a class="code" href="classREMORA.html#a476b854ad74dd35ec1bf21cd9ea1f0b0">ref_tags</a>.size(); ++j)</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    {</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        std::unique_ptr&lt;MultiFab&gt; mf;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        <span class="comment">// This allows dynamic refinement based on the value of the scalar</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a476b854ad74dd35ec1bf21cd9ea1f0b0">ref_tags</a>[j].Field() == <span class="stringliteral">&quot;scalar&quot;</span>)</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;            mf = std::make_unique&lt;MultiFab&gt;(grids[level], dmap[level], 1, 0);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;            MultiFab::Copy(*mf,*<a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[level],<a class="code" href="IndexDefines_8H.html#a4dd1335cac3e63bb654450bb807978a4">Scalar_comp</a>,0,1,0);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        }</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <a class="code" href="classREMORA.html#a476b854ad74dd35ec1bf21cd9ea1f0b0">ref_tags</a>[j](tags,mf.get(),clearval,tagval,time,level,geom[level]);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  }</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;}</div>
<div class="ttc" id="aIndexDefines_8H_html_a4dd1335cac3e63bb654450bb807978a4"><div class="ttname"><a href="IndexDefines_8H.html#a4dd1335cac3e63bb654450bb807978a4">Scalar_comp</a></div><div class="ttdeci">#define Scalar_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:10</div></div>
<div class="ttc" id="aclassREMORA_html_a476b854ad74dd35ec1bf21cd9ea1f0b0"><div class="ttname"><a href="classREMORA.html#a476b854ad74dd35ec1bf21cd9ea1f0b0">REMORA::ref_tags</a></div><div class="ttdeci">static amrex::Vector&lt; amrex::AMRErrorTag &gt; ref_tags</div><div class="ttdef"><b>Definition:</b> REMORA.H:880</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac71630052015782fce4f20e204e42016"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac71630052015782fce4f20e204e42016">&#9670;&nbsp;</a></span>estTimeStep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> REMORA::estTimeStep </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>compute dt from CFL considerations </p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  BL_PROFILE(<span class="stringliteral">&quot;REMORA::estTimeStep()&quot;</span>);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  amrex::Real estdt_lowM = 1.e20;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> dxinv = geom[level].InvCellSizeArray();</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  MultiFab ccvel(grids[level],dmap[level],3,0);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  average_face_to_cellcenter(ccvel,0,</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      Array&lt;const MultiFab*,3&gt;{<a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[level], <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[level], <a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[level]});</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> estdt_lowM_inv = amrex::ReduceMax(ccvel, 0,</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;       [=] AMREX_GPU_HOST_DEVICE (Box <span class="keyword">const</span>&amp; b,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                                  Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">u</a>) -&gt; <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;       {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;           <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> new_lm_dt = -1.e100;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;           amrex::Loop(b, [=,&amp;new_lm_dt] (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;           {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;               new_lm_dt = amrex::max(((amrex::Math::abs(<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">u</a>(i,j,k,0)))*dxinv[0]),</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                      ((amrex::Math::abs(<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">u</a>(i,j,k,1)))*dxinv[1]),</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                                      ((amrex::Math::abs(<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">u</a>(i,j,k,2)))*dxinv[2]), new_lm_dt);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;           });</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;           <span class="keywordflow">return</span> new_lm_dt;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;       });</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;   ParallelDescriptor::ReduceRealMax(estdt_lowM_inv);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   <span class="keywordflow">if</span> (estdt_lowM_inv &gt; 0.0_rt)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;       estdt_lowM = <a class="code" href="classREMORA.html#ad3cf3f0d0e6783927e40a57231693fee">cfl</a> / estdt_lowM_inv;;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#ad9ed53f5f841397304bf3b16fc82ecd9">verbose</a>) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a0c9e94b2bbf3ee8167abb9acd4b86807">fixed_dt</a> &lt;= 0.0) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Using cfl = &quot;</span> &lt;&lt; <a class="code" href="classREMORA.html#ad3cf3f0d0e6783927e40a57231693fee">cfl</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">if</span> (estdt_lowM_inv &gt; 0.0_rt) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Slow  dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot;:  &quot;</span> &lt;&lt; estdt_lowM &lt;&lt; std::endl;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Slow  dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot;: undefined &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a0c9e94b2bbf3ee8167abb9acd4b86807">fixed_dt</a> &gt; 0.0) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Based on cfl of 1.0 &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">if</span> (estdt_lowM_inv &gt; 0.0_rt) {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Slow  dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot; would be:  &quot;</span> &lt;&lt; estdt_lowM/<a class="code" href="classREMORA.html#ad3cf3f0d0e6783927e40a57231693fee">cfl</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Slow  dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot; would be undefined &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Fixed dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot;       is:  &quot;</span> &lt;&lt; <a class="code" href="classREMORA.html#a0c9e94b2bbf3ee8167abb9acd4b86807">fixed_dt</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a0c9e94b2bbf3ee8167abb9acd4b86807">fixed_dt</a> &gt; 0.0) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classREMORA.html#a0c9e94b2bbf3ee8167abb9acd4b86807">fixed_dt</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordflow">return</span> estdt_lowM;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;}</div>
<div class="ttc" id="aclassREMORA_html_a0c9e94b2bbf3ee8167abb9acd4b86807"><div class="ttname"><a href="classREMORA.html#a0c9e94b2bbf3ee8167abb9acd4b86807">REMORA::fixed_dt</a></div><div class="ttdeci">static amrex::Real fixed_dt</div><div class="ttdef"><b>Definition:</b> REMORA.H:787</div></div>
<div class="ttc" id="aclassREMORA_html_ad3cf3f0d0e6783927e40a57231693fee"><div class="ttname"><a href="classREMORA.html#ad3cf3f0d0e6783927e40a57231693fee">REMORA::cfl</a></div><div class="ttdeci">static amrex::Real cfl</div><div class="ttdef"><b>Definition:</b> REMORA.H:782</div></div>
<div class="ttc" id="aclassREMORA_html_ad9ed53f5f841397304bf3b16fc82ecd9"><div class="ttname"><a href="classREMORA.html#ad9ed53f5f841397304bf3b16fc82ecd9">REMORA::verbose</a></div><div class="ttdeci">static int verbose</div><div class="ttdef"><b>Definition:</b> REMORA.H:829</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2ea86fcd6c7d853a6c0110cf40f9cb1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ea86fcd6c7d853a6c0110cf40f9cb1e">&#9670;&nbsp;</a></span>Evolve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::Evolve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Advance solution to final time </p>
<div class="fragment"><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;{</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cur_time = <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[0];</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">// Take one coarse timestep by calling timeStep -- which recursively calls timeStep</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">//      for finer levels (with or without subcycling)</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> step = <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[0]; step &lt; <a class="code" href="classREMORA.html#a69c542c1c57e6c6532a20eec60b9a0c3">max_step</a> &amp;&amp; cur_time &lt; <a class="code" href="classREMORA.html#a2981da216b5811080251dc15b27ca281">stop_time</a>; ++step)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;\nCoarse STEP &quot;</span> &lt;&lt; step+1 &lt;&lt; <span class="stringliteral">&quot; starts ...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <a class="code" href="classREMORA.html#a7671b889b87ca190f7aba7188074efa3">ComputeDt</a>();</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordtype">int</span> iteration = 1;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">if</span> (max_level == 0) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <a class="code" href="classREMORA.html#ac88ed7a3bf97eec4dca7f70126a0600d">timeStep</a>(lev, cur_time, iteration);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <a class="code" href="classREMORA.html#acf259537f6d9c23a0edcf6641381a9d0">timeStepML</a>(cur_time, iteration);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        cur_time  += <a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[0];</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Coarse STEP &quot;</span> &lt;&lt; step+1 &lt;&lt; <span class="stringliteral">&quot; ends.&quot;</span> &lt;&lt; <span class="stringliteral">&quot; TIME = &quot;</span> &lt;&lt; cur_time</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot; DT = &quot;</span> &lt;&lt; <a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[0]  &lt;&lt; std::endl;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a3a61745803081888ac360f521a623b1b">plot_int_1</a> &gt; 0 &amp;&amp; (step+1) % <a class="code" href="classREMORA.html#a3a61745803081888ac360f521a623b1b">plot_int_1</a> == 0) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <a class="code" href="classREMORA.html#aa1b32ce8d7cfb920dd3c61c002fc9e0f">last_plot_file_step_1</a> = step+1;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a002524d813441c4b5fe1b223b46389fa">plotfile_type</a> == <a class="code" href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9eabbe17e876cafcbc06d3ea0d2a23854d3">PlotfileType::amrex</a>)</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                <a class="code" href="classREMORA.html#a6c03ef43eb1e2584973f5a45975f5482">WritePlotFile</a>(1,<a class="code" href="classREMORA.html#a0737e2206f4961852b5cbdc0c9c889f1">plot_var_names_1</a>);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_NETCDF</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a002524d813441c4b5fe1b223b46389fa">plotfile_type</a> == <a class="code" href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9eac2e0f73e7b066a47b743d6ce8213e684">PlotfileType::netcdf</a>)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                WriteNCPlotFile(step);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a1db03ec74ac9a6e94c59ed0e4a187bbb">plot_int_2</a> &gt; 0 &amp;&amp; (step+1) % <a class="code" href="classREMORA.html#a1db03ec74ac9a6e94c59ed0e4a187bbb">plot_int_2</a> == 0) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <a class="code" href="classREMORA.html#a642013869cd0ee3902d2106b64fa418a">last_plot_file_step_2</a> = step+1;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a002524d813441c4b5fe1b223b46389fa">plotfile_type</a> == <a class="code" href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9eabbe17e876cafcbc06d3ea0d2a23854d3">PlotfileType::amrex</a>)</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                <a class="code" href="classREMORA.html#a6c03ef43eb1e2584973f5a45975f5482">WritePlotFile</a>(2,<a class="code" href="classREMORA.html#a2dc73785c2de0224c069e73c5d57e794">plot_var_names_2</a>);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_NETCDF</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a002524d813441c4b5fe1b223b46389fa">plotfile_type</a> == <a class="code" href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9eac2e0f73e7b066a47b743d6ce8213e684">PlotfileType::netcdf</a>)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                WriteNCPlotFile(step);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#ae12e05882ce5fbae362e87b567d1a05f">check_int</a> &gt; 0 &amp;&amp; (step+1) % <a class="code" href="classREMORA.html#ae12e05882ce5fbae362e87b567d1a05f">check_int</a> == 0) {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <a class="code" href="classREMORA.html#a70585b0129bfb5d405b1e10ea97020c5">last_check_file_step</a> = step+1;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <a class="code" href="classREMORA.html#aec14981d78f55e2e326b1080cfc5656c">WriteCheckpointFile</a>();</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <a class="code" href="classREMORA.html#a697e9a0fc5d32cd8833f68defaa65467">post_timestep</a>(step, cur_time, <a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[0]);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="preprocessor">#ifdef AMREX_MEM_PROFILING</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            std::ostringstream ss;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            ss &lt;&lt; <span class="stringliteral">&quot;[STEP &quot;</span> &lt;&lt; step+1 &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            MemProfiler::report(ss.str());</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keywordflow">if</span> (cur_time &gt;= <a class="code" href="classREMORA.html#a2981da216b5811080251dc15b27ca281">stop_time</a> - 1.e-6*<a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[0]) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a3a61745803081888ac360f521a623b1b">plot_int_1</a> &gt; 0 &amp;&amp; <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[0] &gt; <a class="code" href="classREMORA.html#aa1b32ce8d7cfb920dd3c61c002fc9e0f">last_plot_file_step_1</a>) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a002524d813441c4b5fe1b223b46389fa">plotfile_type</a> == <a class="code" href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9eabbe17e876cafcbc06d3ea0d2a23854d3">PlotfileType::amrex</a>)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <a class="code" href="classREMORA.html#a6c03ef43eb1e2584973f5a45975f5482">WritePlotFile</a>(1,<a class="code" href="classREMORA.html#a0737e2206f4961852b5cbdc0c9c889f1">plot_var_names_1</a>);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_NETCDF</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a002524d813441c4b5fe1b223b46389fa">plotfile_type</a> == <a class="code" href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9eac2e0f73e7b066a47b743d6ce8213e684">PlotfileType::netcdf</a>)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            WriteNCPlotFile(<a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[0]);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a1db03ec74ac9a6e94c59ed0e4a187bbb">plot_int_2</a> &gt; 0 &amp;&amp; <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[0] &gt; <a class="code" href="classREMORA.html#a642013869cd0ee3902d2106b64fa418a">last_plot_file_step_2</a>) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a002524d813441c4b5fe1b223b46389fa">plotfile_type</a> == <a class="code" href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9eabbe17e876cafcbc06d3ea0d2a23854d3">PlotfileType::amrex</a>)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <a class="code" href="classREMORA.html#a6c03ef43eb1e2584973f5a45975f5482">WritePlotFile</a>(2,<a class="code" href="classREMORA.html#a2dc73785c2de0224c069e73c5d57e794">plot_var_names_2</a>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_NETCDF</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a002524d813441c4b5fe1b223b46389fa">plotfile_type</a> == <a class="code" href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9eac2e0f73e7b066a47b743d6ce8213e684">PlotfileType::netcdf</a>)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            WriteNCPlotFile(<a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[0]);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#ae12e05882ce5fbae362e87b567d1a05f">check_int</a> &gt; 0 &amp;&amp; <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[0] &gt; <a class="code" href="classREMORA.html#a70585b0129bfb5d405b1e10ea97020c5">last_check_file_step</a>) {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <a class="code" href="classREMORA.html#aec14981d78f55e2e326b1080cfc5656c">WriteCheckpointFile</a>();</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;}</div>
<div class="ttc" id="aDataStruct_8H_html_a4036964f680afc43cfce078311111a9eabbe17e876cafcbc06d3ea0d2a23854d3"><div class="ttname"><a href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9eabbe17e876cafcbc06d3ea0d2a23854d3">PlotfileType::amrex</a></div><div class="ttdeci">@ amrex</div></div>
<div class="ttc" id="aDataStruct_8H_html_a4036964f680afc43cfce078311111a9eac2e0f73e7b066a47b743d6ce8213e684"><div class="ttname"><a href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9eac2e0f73e7b066a47b743d6ce8213e684">PlotfileType::netcdf</a></div><div class="ttdeci">@ netcdf</div></div>
<div class="ttc" id="aclassREMORA_html_a002524d813441c4b5fe1b223b46389fa"><div class="ttname"><a href="classREMORA.html#a002524d813441c4b5fe1b223b46389fa">REMORA::plotfile_type</a></div><div class="ttdeci">static PlotfileType plotfile_type</div><div class="ttdef"><b>Definition:</b> REMORA.H:839</div></div>
<div class="ttc" id="aclassREMORA_html_a1db03ec74ac9a6e94c59ed0e4a187bbb"><div class="ttname"><a href="classREMORA.html#a1db03ec74ac9a6e94c59ed0e4a187bbb">REMORA::plot_int_2</a></div><div class="ttdeci">int plot_int_2</div><div class="ttdef"><b>Definition:</b> REMORA.H:803</div></div>
<div class="ttc" id="aclassREMORA_html_a3a61745803081888ac360f521a623b1b"><div class="ttname"><a href="classREMORA.html#a3a61745803081888ac360f521a623b1b">REMORA::plot_int_1</a></div><div class="ttdeci">int plot_int_1</div><div class="ttdef"><b>Definition:</b> REMORA.H:802</div></div>
<div class="ttc" id="aclassREMORA_html_a642013869cd0ee3902d2106b64fa418a"><div class="ttname"><a href="classREMORA.html#a642013869cd0ee3902d2106b64fa418a">REMORA::last_plot_file_step_2</a></div><div class="ttdeci">int last_plot_file_step_2</div><div class="ttdef"><b>Definition:</b> REMORA.H:766</div></div>
<div class="ttc" id="aclassREMORA_html_a697e9a0fc5d32cd8833f68defaa65467"><div class="ttname"><a href="classREMORA.html#a697e9a0fc5d32cd8833f68defaa65467">REMORA::post_timestep</a></div><div class="ttdeci">void post_timestep(int nstep, amrex::Real time, amrex::Real dt_lev)</div><div class="ttdef"><b>Definition:</b> REMORA.cpp:231</div></div>
<div class="ttc" id="aclassREMORA_html_a69c542c1c57e6c6532a20eec60b9a0c3"><div class="ttname"><a href="classREMORA.html#a69c542c1c57e6c6532a20eec60b9a0c3">REMORA::max_step</a></div><div class="ttdeci">int max_step</div><div class="ttdef"><b>Definition:</b> REMORA.H:775</div></div>
<div class="ttc" id="aclassREMORA_html_a6c03ef43eb1e2584973f5a45975f5482"><div class="ttname"><a href="classREMORA.html#a6c03ef43eb1e2584973f5a45975f5482">REMORA::WritePlotFile</a></div><div class="ttdeci">void WritePlotFile(int which, amrex::Vector&lt; std::string &gt; plot_var_names)</div><div class="ttdef"><b>Definition:</b> Plotfile.cpp:99</div></div>
<div class="ttc" id="aclassREMORA_html_a70585b0129bfb5d405b1e10ea97020c5"><div class="ttname"><a href="classREMORA.html#a70585b0129bfb5d405b1e10ea97020c5">REMORA::last_check_file_step</a></div><div class="ttdeci">int last_check_file_step</div><div class="ttdef"><b>Definition:</b> REMORA.H:768</div></div>
<div class="ttc" id="aclassREMORA_html_a7671b889b87ca190f7aba7188074efa3"><div class="ttname"><a href="classREMORA.html#a7671b889b87ca190f7aba7188074efa3">REMORA::ComputeDt</a></div><div class="ttdeci">void ComputeDt()</div><div class="ttdef"><b>Definition:</b> REMORA_ComputeTimestep.cpp:8</div></div>
<div class="ttc" id="aclassREMORA_html_aa1b32ce8d7cfb920dd3c61c002fc9e0f"><div class="ttname"><a href="classREMORA.html#aa1b32ce8d7cfb920dd3c61c002fc9e0f">REMORA::last_plot_file_step_1</a></div><div class="ttdeci">int last_plot_file_step_1</div><div class="ttdef"><b>Definition:</b> REMORA.H:765</div></div>
<div class="ttc" id="aclassREMORA_html_ac88ed7a3bf97eec4dca7f70126a0600d"><div class="ttname"><a href="classREMORA.html#ac88ed7a3bf97eec4dca7f70126a0600d">REMORA::timeStep</a></div><div class="ttdeci">void timeStep(int lev, amrex::Real time, int iteration)</div><div class="ttdef"><b>Definition:</b> REMORA_TimeStep.cpp:9</div></div>
<div class="ttc" id="aclassREMORA_html_acf259537f6d9c23a0edcf6641381a9d0"><div class="ttname"><a href="classREMORA.html#acf259537f6d9c23a0edcf6641381a9d0">REMORA::timeStepML</a></div><div class="ttdeci">void timeStepML(amrex::Real time, int iteration)</div><div class="ttdef"><b>Definition:</b> REMORA_TimeStepML.cpp:9</div></div>
<div class="ttc" id="aclassREMORA_html_ae12e05882ce5fbae362e87b567d1a05f"><div class="ttname"><a href="classREMORA.html#ae12e05882ce5fbae362e87b567d1a05f">REMORA::check_int</a></div><div class="ttdeci">int check_int</div><div class="ttdef"><b>Definition:</b> REMORA.H:807</div></div>
<div class="ttc" id="aclassREMORA_html_aec14981d78f55e2e326b1080cfc5656c"><div class="ttname"><a href="classREMORA.html#aec14981d78f55e2e326b1080cfc5656c">REMORA::WriteCheckpointFile</a></div><div class="ttdeci">void WriteCheckpointFile() const</div><div class="ttdef"><b>Definition:</b> Checkpoint.cpp:15</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classREMORA_a2ea86fcd6c7d853a6c0110cf40f9cb1e_icgraph.png" border="0" usemap="#aclassREMORA_a2ea86fcd6c7d853a6c0110cf40f9cb1e_icgraph" alt=""/></div>
<map name="aclassREMORA_a2ea86fcd6c7d853a6c0110cf40f9cb1e_icgraph" id="aclassREMORA_a2ea86fcd6c7d853a6c0110cf40f9cb1e_icgraph">
<area shape="rect" title=" " alt="" coords="108,5,239,32"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="ab33ba40181998f803a89d89c175d561e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab33ba40181998f803a89d89c175d561e">&#9670;&nbsp;</a></span>fill_from_bdyfiles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::fill_from_bdyfiles </td>
          <td>(</td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf_to_fill</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>bdy_var_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="abb9088da220a64e077ddb2cc8939ba2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb9088da220a64e077ddb2cc8939ba2d">&#9670;&nbsp;</a></span>fill_rhs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::fill_rhs </td>
          <td>(</td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>rhs_mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>state_mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Geometry &amp;&#160;</td>
          <td class="paramname"><em>geom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a95cda6dc2401e1e6d3df49eeda4ee6e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95cda6dc2401e1e6d3df49eeda4ee6e1">&#9670;&nbsp;</a></span>FillCoarsePatch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::FillCoarsePatch </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_fine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_crse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>fill an entire multifab by interpolating from the coarser level this comes into play when a new level of refinement appears </p>
<div class="fragment"><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;{</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    BL_PROFILE_VAR(<span class="stringliteral">&quot;FillCoarsePatch()&quot;</span>,<a class="code" href="classREMORA.html#a95cda6dc2401e1e6d3df49eeda4ee6e1">FillCoarsePatch</a>);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    AMREX_ASSERT(lev &gt; 0);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordtype">int</span> bccomp = 0;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordtype">int</span>  icomp = 0;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordtype">int</span>  ncomp = 1;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    amrex::Interpolater* mapper = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    Box box_mf = ((*mf_to_fill)[0]).box();</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">if</span> (box_mf.ixType() == IndexType(IntVect(0,0,0)))</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        bccomp = 0;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        mapper = &amp;cell_cons_interp;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        ncomp = <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (box_mf.ixType() == IndexType(IntVect(1,0,0)))</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        bccomp = <a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        mapper = &amp;face_linear_interp;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (box_mf.ixType() == IndexType(IntVect(0,1,0)))</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        bccomp = <a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        mapper = &amp;face_linear_interp;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (box_mf.ixType() == IndexType(IntVect(0,0,1)))</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        bccomp = <a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        mapper = &amp;face_linear_interp;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;          amrex::Abort(<span class="stringliteral">&quot;Dont recognize this box type in REMORA_FillPatch&quot;</span>);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="structTimeInterpolatedData.html">TimeInterpolatedData</a> cdata = <a class="code" href="classREMORA.html#a99e2295484a51457ec8d2c9700261783">GetDataAtTime</a>(lev-1, time);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="structTimeInterpolatedData.html">TimeInterpolatedData</a> fdata = <a class="code" href="classREMORA.html#a99e2295484a51457ec8d2c9700261783">GetDataAtTime</a>(lev  , time);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    Vector&lt;Real&gt; ctime = {cdata.<a class="code" href="structTimeInterpolatedData.html#a3f1217eba0582186b1ea1b43babcc5f4">get_time</a>()};</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    Vector&lt;MultiFab*&gt; cmf = {mf_crse};</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    Vector&lt;Real&gt; ctime = {time};</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="classREMORAPhysBCFunct.html">REMORAPhysBCFunct</a> cphysbc(lev-1,geom[lev-1],</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                             <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>,<a class="code" href="classREMORA.html#af4c01c1be8a352c96a61e03e08c25121">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                             cdata,</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                             <a class="code" href="classREMORA.html#a09a032f4d90f8dd939ab8e2ab5a06e06">m_bc_extdir_vals</a></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;#ifdef REMORA_USE_NETCDF</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                            ,ic_bc_type,bdy_data_xlo,bdy_data_xhi,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                             bdy_data_ylo,bdy_data_yhi,bdy_time_interval</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;#endif</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                            );</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="classREMORAPhysBCFunct.html">REMORAPhysBCFunct</a> fphysbc(lev,geom[lev],</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                             <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>,<a class="code" href="classREMORA.html#af4c01c1be8a352c96a61e03e08c25121">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                             fdata,</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                             <a class="code" href="classREMORA.html#a09a032f4d90f8dd939ab8e2ab5a06e06">m_bc_extdir_vals</a></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;#ifdef REMORA_USE_NETCDF</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                            ,ic_bc_type,bdy_data_xlo,bdy_data_xhi,</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                             bdy_data_ylo,bdy_data_yhi,bdy_time_interval</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;#endif</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                            );</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">//  amrex::InterpFromCoarseLevel(mf, time, *cmf[0], 0, icomp, ncomp, geom[lev-1], geom[lev],</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">//                               cphysbc, 0, fphysbc, 0, refRatio(lev-1),</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">//                               mapper, domain_bcs_type, bccomp);</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    amrex::InterpFromCoarseLevel(*mf_to_fill, time, mf_crse[lev-1], 0, icomp, ncomp, geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                                 <a class="code" href="REMORA__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, 0, <a class="code" href="REMORA__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, 0, refRatio(lev-1),</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                                 mapper, <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>, bccomp);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;}</div>
<div class="ttc" id="aREMORA__FillPatch_8cpp_html_a85a7293fad1a59ed566bcea306373abc"><div class="ttname"><a href="REMORA__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a></div><div class="ttdeci">PhysBCFunctNoOp null_bc</div><div class="ttdef"><b>Definition:</b> REMORA_FillPatch.cpp:8</div></div>
<div class="ttc" id="aclassREMORAPhysBCFunct_html"><div class="ttname"><a href="classREMORAPhysBCFunct.html">REMORAPhysBCFunct</a></div><div class="ttdef"><b>Definition:</b> REMORA_PhysBCFunct.H:34</div></div>
<div class="ttc" id="aclassREMORA_html_a09a032f4d90f8dd939ab8e2ab5a06e06"><div class="ttname"><a href="classREMORA.html#a09a032f4d90f8dd939ab8e2ab5a06e06">REMORA::m_bc_extdir_vals</a></div><div class="ttdeci">amrex::Array&lt; amrex::Array&lt; amrex::Real, AMREX_SPACEDIM *2 &gt;, AMREX_SPACEDIM+NCONS &gt; m_bc_extdir_vals</div><div class="ttdef"><b>Definition:</b> REMORA.H:760</div></div>
<div class="ttc" id="aclassREMORA_html_a116e340c1b1afd8b7a64faa108157a0f"><div class="ttname"><a href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">REMORA::domain_bcs_type</a></div><div class="ttdeci">amrex::Vector&lt; amrex::BCRec &gt; domain_bcs_type</div><div class="ttdef"><b>Definition:</b> REMORA.H:753</div></div>
<div class="ttc" id="aclassREMORA_html_a95cda6dc2401e1e6d3df49eeda4ee6e1"><div class="ttname"><a href="classREMORA.html#a95cda6dc2401e1e6d3df49eeda4ee6e1">REMORA::FillCoarsePatch</a></div><div class="ttdeci">void FillCoarsePatch(int lev, amrex::Real time, amrex::MultiFab *mf_fine, amrex::MultiFab *mf_crse)</div><div class="ttdef"><b>Definition:</b> REMORA_FillPatch.cpp:176</div></div>
<div class="ttc" id="aclassREMORA_html_a99e2295484a51457ec8d2c9700261783"><div class="ttname"><a href="classREMORA.html#a99e2295484a51457ec8d2c9700261783">REMORA::GetDataAtTime</a></div><div class="ttdeci">TimeInterpolatedData GetDataAtTime(int lev, amrex::Real time)</div><div class="ttdef"><b>Definition:</b> REMORA_FillPatch.cpp:115</div></div>
<div class="ttc" id="aclassREMORA_html_af4c01c1be8a352c96a61e03e08c25121"><div class="ttname"><a href="classREMORA.html#af4c01c1be8a352c96a61e03e08c25121">REMORA::domain_bcs_type_d</a></div><div class="ttdeci">amrex::Gpu::DeviceVector&lt; amrex::BCRec &gt; domain_bcs_type_d</div><div class="ttdef"><b>Definition:</b> REMORA.H:754</div></div>
<div class="ttc" id="anamespaceBCVars_html_a6fd8f72c3055242c4af20c780f391073a03b35ec9e83f34bb1349a86965d34e34"><div class="ttname"><a href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a></div><div class="ttdeci">@ zvel_bc</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:23</div></div>
<div class="ttc" id="anamespaceBCVars_html_a6fd8f72c3055242c4af20c780f391073a98ad22810fdfe9e585bc6481fc12454e"><div class="ttname"><a href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a></div><div class="ttdeci">@ yvel_bc</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:22</div></div>
<div class="ttc" id="anamespaceBCVars_html_a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4"><div class="ttname"><a href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a></div><div class="ttdeci">@ xvel_bc</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:21</div></div>
<div class="ttc" id="astructTimeInterpolatedData_html"><div class="ttname"><a href="structTimeInterpolatedData.html">TimeInterpolatedData</a></div><div class="ttdef"><b>Definition:</b> TimeInterpolatedData.H:8</div></div>
<div class="ttc" id="astructTimeInterpolatedData_html_a3f1217eba0582186b1ea1b43babcc5f4"><div class="ttname"><a href="structTimeInterpolatedData.html#a3f1217eba0582186b1ea1b43babcc5f4">TimeInterpolatedData::get_time</a></div><div class="ttdeci">amrex::Real get_time()</div><div class="ttdef"><b>Definition:</b> TimeInterpolatedData.H:21</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classREMORA_a95cda6dc2401e1e6d3df49eeda4ee6e1_cgraph.png" border="0" usemap="#aclassREMORA_a95cda6dc2401e1e6d3df49eeda4ee6e1_cgraph" alt=""/></div>
<map name="aclassREMORA_a95cda6dc2401e1e6d3df49eeda4ee6e1_cgraph" id="aclassREMORA_a95cda6dc2401e1e6d3df49eeda4ee6e1_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,192,39"/>
<area shape="rect" href="structTimeInterpolatedData.html#a3f1217eba0582186b1ea1b43babcc5f4" title=" " alt="" coords="240,5,405,47"/>
</map>
</div>

</div>
</div>
<a id="aeac4c75110a1011acdf716c00bc62299"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeac4c75110a1011acdf716c00bc62299">&#9670;&nbsp;</a></span>FillPatch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::FillPatch </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf_to_be_filled</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::MultiFab * &gt; const &amp;&#160;</td>
          <td class="paramname"><em>mfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>bdy_var_type</em> = <code><a class="el" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325ab738c65b8fa93b2166002dce928aca27">BdyVars::null</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    BL_PROFILE_VAR(<span class="stringliteral">&quot;REMORA::FillPatch()&quot;</span>,REMORA_FillPatch);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordtype">int</span> bccomp;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    amrex::Interpolater* mapper = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> icomp = 0;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> ncomp = mf_to_fill.nComp();</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    Box mf_box(mf_to_fill.boxArray()[0]);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordflow">if</span> (mf_box.ixType() == IndexType(IntVect(0,0,0)))</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        bccomp = 0;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        mapper = &amp;cell_cons_interp;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    }</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mf_box.ixType() == IndexType(IntVect(1,0,0)))</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        bccomp = <a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        mapper = &amp;face_linear_interp;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mf_box.ixType() == IndexType(IntVect(0,1,0)))</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        bccomp = <a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        mapper = &amp;face_linear_interp;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    }</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mf_box.ixType() == IndexType(IntVect(0,0,1)))</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        bccomp = <a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        mapper = &amp;face_linear_interp;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        amrex::Abort(<span class="stringliteral">&quot;Dont recognize this box type in REMORA_FillPatch&quot;</span>);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">if</span> (lev == 0)</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        Vector&lt;MultiFab*&gt; fmf = {mfs[lev], mfs[lev]};</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        Vector&lt;Real&gt; ftime    = {<a class="code" href="classREMORA.html#ae94018d43dcebc3cd70293e6c621c46a">t_old</a>[lev], <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev]};</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        amrex::FillPatchSingleLevel(mf_to_fill, time, fmf, ftime, icomp, icomp, ncomp,</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                    geom[lev], <a class="code" href="REMORA__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, bccomp);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        Vector&lt;MultiFab*&gt; fmf = {mfs[lev], mfs[lev]};</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        Vector&lt;Real&gt; ftime    = {<a class="code" href="classREMORA.html#ae94018d43dcebc3cd70293e6c621c46a">t_old</a>[lev], <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev]};</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        Vector&lt;MultiFab*&gt; cmf = {mfs[lev-1], mfs[lev-1]};</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        Vector&lt;Real&gt; ctime    = {<a class="code" href="classREMORA.html#ae94018d43dcebc3cd70293e6c621c46a">t_old</a>[lev-1], <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev-1]};</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        amrex::FillPatchTwoLevels(mf_to_fill, time, cmf, ctime, fmf, ftime,</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                                  0, icomp, ncomp, geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                                  <a class="code" href="REMORA__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, bccomp, <a class="code" href="REMORA__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, bccomp, refRatio(lev-1),</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                                  mapper, <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>, bccomp);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    } <span class="comment">// lev &gt; 0</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">// Physical bc&#39;s at domain boundary</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_NETCDF</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// Fill the data which is stored in the boundary data read from netcdf files</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordflow">if</span> ( (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a345dba1135888a3a3e422c9b6a010ebf">ic_bc_type</a> == <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">IC_BC_Type::Real</a>) &amp;&amp; (lev==0) &amp;&amp;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;         (bdy_var_type != <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325ab738c65b8fa93b2166002dce928aca27">BdyVars::null</a>) )</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="classREMORA.html#ab33ba40181998f803a89d89c175d561e">fill_from_bdyfiles</a> (mf_to_fill,time,bdy_var_type);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">// Enforce physical boundary conditions</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    (*<a class="code" href="classREMORA.html#a75e6e53bc24b47b664fddcafed41dbd1">physbcs</a>[lev])(mf_to_fill,0,ncomp,mf_to_fill.nGrowVect(),time,bccomp);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// Also enforce free-slip at top boundary (on xvel or yvel)</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">if</span> ( (mf_box.ixType() == IndexType(IntVect(1,0,0))) ||</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;         (mf_box.ixType() == IndexType(IntVect(0,1,0))) )</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordtype">int</span> khi = geom[lev].Domain().bigEnd(2);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">for</span> (MFIter mfi(mf_to_fill); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            Box gbx  = mfi.growntilebox(); <span class="comment">// Note this is face-centered since vel is</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            gbx.setSmall(2,khi+1);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <span class="keywordflow">if</span> (gbx.ok()) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                Array4&lt;Real&gt; vel_arr = mf_to_fill.array(mfi);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                ParallelFor(gbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                    vel_arr(i,j,k) = vel_arr(i,j,khi);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                });</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;}</div>
<div class="ttc" id="aclassREMORA_html_ab33ba40181998f803a89d89c175d561e"><div class="ttname"><a href="classREMORA.html#ab33ba40181998f803a89d89c175d561e">REMORA::fill_from_bdyfiles</a></div><div class="ttdeci">void fill_from_bdyfiles(amrex::MultiFab &amp;mf_to_fill, const amrex::Real time, const int bdy_var_type)</div></div>
<div class="ttc" id="astructSolverChoice_html_a345dba1135888a3a3e422c9b6a010ebf"><div class="ttname"><a href="structSolverChoice.html#a345dba1135888a3a3e422c9b6a010ebf">SolverChoice::ic_bc_type</a></div><div class="ttdeci">IC_BC_Type ic_bc_type</div><div class="ttdef"><b>Definition:</b> DataStruct.H:208</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e2c89247c418609b713bdc107696258"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e2c89247c418609b713bdc107696258">&#9670;&nbsp;</a></span>getAdvFluxReg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE amrex::YAFluxRegister* REMORA::getAdvFluxReg </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    {</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classREMORA.html#aa4b94dcbe06a58009a8b64d358b51bfc">advflux_reg</a>[lev];</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a79eb0ac9909062422d3b3207a7643dd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79eb0ac9909062422d3b3207a7643dd8">&#9670;&nbsp;</a></span>getCPUTime()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real REMORA::getCPUTime </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    {</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      <span class="keywordtype">int</span> numCores = amrex::ParallelDescriptor::NProcs();</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      numCores = numCores * omp_get_max_threads();</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      amrex::Real T =</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        numCores * (amrex::ParallelDescriptor::second() - <a class="code" href="classREMORA.html#a4d3e0a094fbd5ed0ef96114162a88478">startCPUTime</a>) +</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        <a class="code" href="classREMORA.html#a13791ab61c74d1c95a4caa544d9ac3d3">previousCPUTimeUsed</a>;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      <span class="keywordflow">return</span> T;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    }</div>
<div class="ttc" id="aclassREMORA_html_a13791ab61c74d1c95a4caa544d9ac3d3"><div class="ttname"><a href="classREMORA.html#a13791ab61c74d1c95a4caa544d9ac3d3">REMORA::previousCPUTimeUsed</a></div><div class="ttdeci">static amrex::Real previousCPUTimeUsed</div><div class="ttdef"><b>Definition:</b> REMORA.H:937</div></div>
<div class="ttc" id="aclassREMORA_html_a4d3e0a094fbd5ed0ef96114162a88478"><div class="ttname"><a href="classREMORA.html#a4d3e0a094fbd5ed0ef96114162a88478">REMORA::startCPUTime</a></div><div class="ttdeci">static amrex::Real startCPUTime</div><div class="ttdef"><b>Definition:</b> REMORA.H:936</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classREMORA.html#a331fbdef188eaf70cc72be04b1208020">writeJobInfo()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classREMORA_a79eb0ac9909062422d3b3207a7643dd8_icgraph.png" border="0" usemap="#aclassREMORA_a79eb0ac9909062422d3b3207a7643dd8_icgraph" alt=""/></div>
<map name="aclassREMORA_a79eb0ac9909062422d3b3207a7643dd8_icgraph" id="aclassREMORA_a79eb0ac9909062422d3b3207a7643dd8_icgraph">
<area shape="rect" title=" " alt="" coords="219,5,387,32"/>
<area shape="rect" href="classREMORA.html#a331fbdef188eaf70cc72be04b1208020" title=" " alt="" coords="5,5,171,32"/>
</map>
</div>

</div>
</div>
<a id="a99e2295484a51457ec8d2c9700261783"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99e2295484a51457ec8d2c9700261783">&#9670;&nbsp;</a></span>GetDataAtTime()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structTimeInterpolatedData.html">TimeInterpolatedData</a> REMORA::GetDataAtTime </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>utility to copy in data from old and/or new state into another multifab </p>
<div class="fragment"><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;{</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    BL_PROFILE_VAR(<span class="stringliteral">&quot;GetDataAtTime()&quot;</span>,<a class="code" href="classREMORA.html#a99e2295484a51457ec8d2c9700261783">GetDataAtTime</a>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="structTimeInterpolatedData.html">TimeInterpolatedData</a> data;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">// HACK HACK HACK</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> teps = (<a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev] - <a class="code" href="classREMORA.html#ae94018d43dcebc3cd70293e6c621c46a">t_old</a>[lev]) * 1.e-3;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">if</span> (time &gt; <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev] - teps &amp;&amp; time &lt; <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev] + teps)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a0b88b0a3a03a3e787a7b27717ec64de7">Vars::NumTypes</a>; ++i) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            data.<a class="code" href="structTimeInterpolatedData.html#a3b9292eb3012672361abacc2ab7d9b2c">add_var</a>(&amp;vars_new[lev][i], data.<a class="code" href="structTimeInterpolatedData.html#a39ab53c6a67f3b87c895483a89e2fc0f">non_owning</a>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        data.<a class="code" href="structTimeInterpolatedData.html#a0d6dcefbf7407a24669d2a37c7f558d4">set_time</a>(<a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev]);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (time &gt; <a class="code" href="classREMORA.html#ae94018d43dcebc3cd70293e6c621c46a">t_old</a>[lev] - teps &amp;&amp; time &lt; <a class="code" href="classREMORA.html#ae94018d43dcebc3cd70293e6c621c46a">t_old</a>[lev] + teps)</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a0b88b0a3a03a3e787a7b27717ec64de7">Vars::NumTypes</a>; ++i) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            data.<a class="code" href="structTimeInterpolatedData.html#a3b9292eb3012672361abacc2ab7d9b2c">add_var</a>(&amp;vars_old[lev][i], data.<a class="code" href="structTimeInterpolatedData.html#a39ab53c6a67f3b87c895483a89e2fc0f">non_owning</a>);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        data.<a class="code" href="structTimeInterpolatedData.html#a0d6dcefbf7407a24669d2a37c7f558d4">set_time</a>(<a class="code" href="classREMORA.html#ae94018d43dcebc3cd70293e6c621c46a">t_old</a>[lev]);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (time &gt; <a class="code" href="classREMORA.html#ae94018d43dcebc3cd70293e6c621c46a">t_old</a>[lev] &amp;&amp; time &lt; <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev])</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="comment">// do first order interpolation in time between [t_old[lev], t_new[lev]]</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="comment">// time interpolation includes the ghost cells</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a0b88b0a3a03a3e787a7b27717ec64de7">Vars::NumTypes</a>; ++i) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            MultiFab* mf_tmp = <span class="keyword">new</span> MultiFab(vars_new[lev][i].boxArray(),</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                            vars_new[lev][i].DistributionMap(),</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                            vars_new[lev][i].nComp(), vars_new[lev][i].nGrowVect());</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            mf_tmp-&gt;setVal(0.0_rt);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dt_fraction = (time - <a class="code" href="classREMORA.html#ae94018d43dcebc3cd70293e6c621c46a">t_old</a>[lev]) / (<a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev] - <a class="code" href="classREMORA.html#ae94018d43dcebc3cd70293e6c621c46a">t_old</a>[lev]);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            MultiFab::Saxpy(*mf_tmp, 1.0_rt - dt_fraction, vars_old[lev][i], 0, 0, mf_tmp-&gt;nComp(), mf_tmp-&gt;nGrowVect());</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            MultiFab::Saxpy(*mf_tmp,          dt_fraction, vars_new[lev][i], 0, 0, mf_tmp-&gt;nComp(), mf_tmp-&gt;nGrowVect());</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            data.<a class="code" href="structTimeInterpolatedData.html#a3b9292eb3012672361abacc2ab7d9b2c">add_var</a>(mf_tmp, data.<a class="code" href="structTimeInterpolatedData.html#af9c5a331c09d13db10c98ad3033114d8">owning</a>);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        data.<a class="code" href="structTimeInterpolatedData.html#a0d6dcefbf7407a24669d2a37c7f558d4">set_time</a>(time);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        amrex::Error(<span class="stringliteral">&quot;Requested data at a time outside the interval [t_old, t_new]&quot;</span>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">// We need to make sure to fill these before we compute the viscosity</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a0b88b0a3a03a3e787a7b27717ec64de7">Vars::NumTypes</a>; ++i) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        data.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(Vars::xvel).FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        data.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(Vars::yvel).FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        data.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(Vars::zvel).FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        data.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(Vars::cons).FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">return</span> data;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;}</div>
<div class="ttc" id="anamespaceBCVars_html_a6fd8f72c3055242c4af20c780f391073a0b88b0a3a03a3e787a7b27717ec64de7"><div class="ttname"><a href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a0b88b0a3a03a3e787a7b27717ec64de7">BCVars::NumTypes</a></div><div class="ttdeci">@ NumTypes</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:24</div></div>
<div class="ttc" id="astructTimeInterpolatedData_html_a0d6dcefbf7407a24669d2a37c7f558d4"><div class="ttname"><a href="structTimeInterpolatedData.html#a0d6dcefbf7407a24669d2a37c7f558d4">TimeInterpolatedData::set_time</a></div><div class="ttdeci">void set_time(amrex::Real time)</div><div class="ttdef"><b>Definition:</b> TimeInterpolatedData.H:17</div></div>
<div class="ttc" id="astructTimeInterpolatedData_html_a39ab53c6a67f3b87c895483a89e2fc0f"><div class="ttname"><a href="structTimeInterpolatedData.html#a39ab53c6a67f3b87c895483a89e2fc0f">TimeInterpolatedData::non_owning</a></div><div class="ttdeci">const int non_owning</div><div class="ttdef"><b>Definition:</b> TimeInterpolatedData.H:50</div></div>
<div class="ttc" id="astructTimeInterpolatedData_html_a3b9292eb3012672361abacc2ab7d9b2c"><div class="ttname"><a href="structTimeInterpolatedData.html#a3b9292eb3012672361abacc2ab7d9b2c">TimeInterpolatedData::add_var</a></div><div class="ttdeci">void add_var(amrex::MultiFab *var_data, int own_data)</div><div class="ttdef"><b>Definition:</b> TimeInterpolatedData.H:23</div></div>
<div class="ttc" id="astructTimeInterpolatedData_html_a65f3edf3f03a779a931f5c58bd438602"><div class="ttname"><a href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">TimeInterpolatedData::get_var</a></div><div class="ttdeci">amrex::MultiFab &amp; get_var(int var_idx)</div><div class="ttdef"><b>Definition:</b> TimeInterpolatedData.H:28</div></div>
<div class="ttc" id="astructTimeInterpolatedData_html_af9c5a331c09d13db10c98ad3033114d8"><div class="ttname"><a href="structTimeInterpolatedData.html#af9c5a331c09d13db10c98ad3033114d8">TimeInterpolatedData::owning</a></div><div class="ttdeci">const int owning</div><div class="ttdef"><b>Definition:</b> TimeInterpolatedData.H:49</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classREMORA_a99e2295484a51457ec8d2c9700261783_cgraph.png" border="0" usemap="#aclassREMORA_a99e2295484a51457ec8d2c9700261783_cgraph" alt=""/></div>
<map name="aclassREMORA_a99e2295484a51457ec8d2c9700261783_cgraph" id="aclassREMORA_a99e2295484a51457ec8d2c9700261783_cgraph">
<area shape="rect" title=" " alt="" coords="5,78,193,105"/>
<area shape="rect" href="structTimeInterpolatedData.html#a3b9292eb3012672361abacc2ab7d9b2c" title=" " alt="" coords="241,5,407,47"/>
<area shape="rect" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602" title=" " alt="" coords="241,71,407,112"/>
<area shape="rect" href="structTimeInterpolatedData.html#a0d6dcefbf7407a24669d2a37c7f558d4" title=" " alt="" coords="241,136,407,177"/>
</map>
</div>

</div>
</div>
<a id="a03e3346471b528f47454cd969393786d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03e3346471b528f47454cd969393786d">&#9670;&nbsp;</a></span>GotoNextLine()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::GotoNextLine </td>
          <td>(</td>
          <td class="paramtype">std::istream &amp;&#160;</td>
          <td class="paramname"><em>is</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;{</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    constexpr std::streamsize bl_ignore_max { 100000 };</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    is.ignore(bl_ignore_max, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a437491da7d00b192e02dcd409825023e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a437491da7d00b192e02dcd409825023e">&#9670;&nbsp;</a></span>init1DArrays()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::init1DArrays </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0fb1bee6b7c41edde86f488eeb440478"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fb1bee6b7c41edde86f488eeb440478">&#9670;&nbsp;</a></span>init_bcs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::init_bcs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <span class="keyword">auto</span> f = [<span class="keyword">this</span>] (std::string <span class="keyword">const</span>&amp; bcid, Orientation ori)</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    {</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        <span class="comment">// These are simply defaults for Dirichlet faces -- they should be over-written below</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        <a class="code" href="classREMORA.html#a09a032f4d90f8dd939ab8e2ab5a06e06">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a0d8c9f8308d3e1a0dedf68c3765d2205">BCVars::Temp_bc_comp</a>  ][ori] = 1.e19;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        <a class="code" href="classREMORA.html#a09a032f4d90f8dd939ab8e2ab5a06e06">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab284ea9b749e574cd1d0493de25e459e">BCVars::Salt_bc_comp</a>  ][ori] = 1.e20;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        <a class="code" href="classREMORA.html#a09a032f4d90f8dd939ab8e2ab5a06e06">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a59e20f7c1b74c9cbdbc9300394bbc335">BCVars::Scalar_bc_comp</a>][ori] = 1.e21;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        <a class="code" href="classREMORA.html#a09a032f4d90f8dd939ab8e2ab5a06e06">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>][ori] = 0.0; <span class="comment">// default</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        <a class="code" href="classREMORA.html#a09a032f4d90f8dd939ab8e2ab5a06e06">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>][ori] = 0.0;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        <a class="code" href="classREMORA.html#a09a032f4d90f8dd939ab8e2ab5a06e06">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>][ori] = 0.0;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        ParmParse pp(bcid);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        std::string bc_type_in = <span class="stringliteral">&quot;null&quot;</span>;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        pp.query(<span class="stringliteral">&quot;type&quot;</span>, bc_type_in);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        std::string bc_type = amrex::toLower(bc_type_in);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;symmetry&quot;</span>)</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;            <a class="code" href="classREMORA.html#adac776c0b66cb62bc9a7a03369b6240e">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325a40e712f30d56083318ab20a2402921d2">REMORA_BC::symmetry</a>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;            <a class="code" href="classREMORA.html#ac686c83706316dc3388d6c1d6b270a2c">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;Symmetry&quot;</span>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        }</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;outflow&quot;</span>)</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;            <a class="code" href="classREMORA.html#adac776c0b66cb62bc9a7a03369b6240e">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325acac0c32caf84a889ec9b2b4cb2d56972">REMORA_BC::outflow</a>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;            <a class="code" href="classREMORA.html#ac686c83706316dc3388d6c1d6b270a2c">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;Outflow&quot;</span>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        }</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;inflow&quot;</span>)</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            <a class="code" href="classREMORA.html#adac776c0b66cb62bc9a7a03369b6240e">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325ad37e67db17cfd059f2852e2673b9e8ef">REMORA_BC::inflow</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;            <a class="code" href="classREMORA.html#ac686c83706316dc3388d6c1d6b270a2c">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;Inflow&quot;</span>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;            std::vector&lt;Real&gt; <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;            pp.getarr(<span class="stringliteral">&quot;velocity&quot;</span>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a>, 0, AMREX_SPACEDIM);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;            <a class="code" href="classREMORA.html#a09a032f4d90f8dd939ab8e2ab5a06e06">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>][ori] = <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a>[0];</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            <a class="code" href="classREMORA.html#a09a032f4d90f8dd939ab8e2ab5a06e06">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>][ori] = <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a>[1];</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            <a class="code" href="classREMORA.html#a09a032f4d90f8dd939ab8e2ab5a06e06">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>][ori] = <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a>[2];</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> scalar_in = 0.;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            <span class="keywordflow">if</span> (pp.query(<span class="stringliteral">&quot;scalar&quot;</span>, scalar_in))</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            <a class="code" href="classREMORA.html#a09a032f4d90f8dd939ab8e2ab5a06e06">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a59e20f7c1b74c9cbdbc9300394bbc335">BCVars::Scalar_bc_comp</a>][ori] = scalar_in;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;noslipwall&quot;</span>)</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            <a class="code" href="classREMORA.html#adac776c0b66cb62bc9a7a03369b6240e">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325acb8c716b8d9b499d9bc323d8f8a410d3">REMORA_BC::no_slip_wall</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            <a class="code" href="classREMORA.html#ac686c83706316dc3388d6c1d6b270a2c">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;NoSlipWall&quot;</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            std::vector&lt;Real&gt; <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            <span class="comment">// The values of m_bc_extdir_vals default to 0.</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            <span class="comment">// But if we find &quot;velocity&quot; in the inputs file, use those values instead.</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            <span class="keywordflow">if</span> (pp.queryarr(<span class="stringliteral">&quot;velocity&quot;</span>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a>, 0, AMREX_SPACEDIM))</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a>[ori.coordDir()] = 0.0;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                <a class="code" href="classREMORA.html#a09a032f4d90f8dd939ab8e2ab5a06e06">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>][ori] = <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a>[0];</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                <a class="code" href="classREMORA.html#a09a032f4d90f8dd939ab8e2ab5a06e06">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>][ori] = <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a>[1];</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                <a class="code" href="classREMORA.html#a09a032f4d90f8dd939ab8e2ab5a06e06">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>][ori] = <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a>[2];</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;slipwall&quot;</span>)</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <a class="code" href="classREMORA.html#adac776c0b66cb62bc9a7a03369b6240e">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325a03ee6de9fd100444c5c0567ea01bd538">REMORA_BC::slip_wall</a>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <a class="code" href="classREMORA.html#ac686c83706316dc3388d6c1d6b270a2c">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;SlipWall&quot;</span>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <a class="code" href="classREMORA.html#adac776c0b66cb62bc9a7a03369b6240e">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325a5e543256c480ac577d30f76f9120eb74">REMORA_BC::undefined</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordflow">if</span> (geom[0].isPeriodic(ori.coordDir()))</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <a class="code" href="classREMORA.html#ac686c83706316dc3388d6c1d6b270a2c">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;Periodic&quot;</span>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#adac776c0b66cb62bc9a7a03369b6240e">phys_bc_type</a>[ori] == <a class="code" href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325a5e543256c480ac577d30f76f9120eb74">REMORA_BC::undefined</a>)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                <a class="code" href="classREMORA.html#adac776c0b66cb62bc9a7a03369b6240e">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325ae6ffdec5e14fce371eb7ae99edebbbee">REMORA_BC::periodic</a>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                amrex::Abort(<span class="stringliteral">&quot;Wrong BC type for periodic boundary&quot;</span>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#adac776c0b66cb62bc9a7a03369b6240e">phys_bc_type</a>[ori] == <a class="code" href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325a5e543256c480ac577d30f76f9120eb74">REMORA_BC::undefined</a>)</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;             amrex::Print() &lt;&lt; <span class="stringliteral">&quot;BC Type specified for face &quot;</span> &lt;&lt; bcid &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt; bc_type_in &lt;&lt; std::endl;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;             amrex::Abort(<span class="stringliteral">&quot;This BC type is unknown&quot;</span>);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    };</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    f(<span class="stringliteral">&quot;xlo&quot;</span>, Orientation(Direction::x,Orientation::low));</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    f(<span class="stringliteral">&quot;xhi&quot;</span>, Orientation(Direction::x,Orientation::high));</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    f(<span class="stringliteral">&quot;ylo&quot;</span>, Orientation(Direction::y,Orientation::low));</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    f(<span class="stringliteral">&quot;yhi&quot;</span>, Orientation(Direction::y,Orientation::high));</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    f(<span class="stringliteral">&quot;zlo&quot;</span>, Orientation(Direction::z,Orientation::low));</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    f(<span class="stringliteral">&quot;zhi&quot;</span>, Orientation(Direction::z,Orientation::high));</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// *****************************************************************************</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">// Here we translate the physical boundary conditions -- one type per face --</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">//     into logical boundary conditions for each velocity component</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// *****************************************************************************</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>.resize(AMREX_SPACEDIM+<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <a class="code" href="classREMORA.html#af4c01c1be8a352c96a61e03e08c25121">domain_bcs_type_d</a>.resize(AMREX_SPACEDIM+<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordflow">for</span> (OrientationIter oit; oit; ++oit) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            Orientation ori = oit();</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <span class="keywordtype">int</span> dir = ori.coordDir();</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            Orientation::Side side = ori.faceDir();</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <span class="keyword">auto</span> <span class="keyword">const</span> bct = <a class="code" href="classREMORA.html#adac776c0b66cb62bc9a7a03369b6240e">phys_bc_type</a>[ori];</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="keywordflow">if</span> ( bct == <a class="code" href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325a40e712f30d56083318ab20a2402921d2">REMORA_BC::symmetry</a> )</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                        <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346aaf8c10264d04dea51594afe39fd3c8a1">REMORABCType::reflect_even</a>);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                    <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+dir].setLo(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346a9d34de510d9acde35ba5ebe70aa11cde">REMORABCType::reflect_odd</a>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                        <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346aaf8c10264d04dea51594afe39fd3c8a1">REMORABCType::reflect_even</a>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                    <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+dir].setHi(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346a9d34de510d9acde35ba5ebe70aa11cde">REMORABCType::reflect_odd</a>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325acac0c32caf84a889ec9b2b4cb2d56972">REMORA_BC::outflow</a>)</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                        <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346af756bb6d63add06a5624fa131cc82407">REMORABCType::foextrap</a>);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                        <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346af756bb6d63add06a5624fa131cc82407">REMORABCType::foextrap</a>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325ad37e67db17cfd059f2852e2673b9e8ef">REMORA_BC::inflow</a>)</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                        <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346aab9d214a2442d0f956923d15f0392cf0">REMORABCType::ext_dir</a>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                    }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                        <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346aab9d214a2442d0f956923d15f0392cf0">REMORABCType::ext_dir</a>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                    }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325acb8c716b8d9b499d9bc323d8f8a410d3">REMORA_BC::no_slip_wall</a>)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                        <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346aab9d214a2442d0f956923d15f0392cf0">REMORABCType::ext_dir</a>);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                        <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346aab9d214a2442d0f956923d15f0392cf0">REMORABCType::ext_dir</a>);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325a03ee6de9fd100444c5c0567ea01bd538">REMORA_BC::slip_wall</a>)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                        <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346af756bb6d63add06a5624fa131cc82407">REMORABCType::foextrap</a>);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                    <span class="comment">// Only normal direction has ext_dir</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                    <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+dir].setLo(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346aab9d214a2442d0f956923d15f0392cf0">REMORABCType::ext_dir</a>);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                        <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346af756bb6d63add06a5624fa131cc82407">REMORABCType::foextrap</a>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                    <span class="comment">// Only normal direction has ext_dir</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                    <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+dir].setHi(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346aab9d214a2442d0f956923d15f0392cf0">REMORABCType::ext_dir</a>);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325ae6ffdec5e14fce371eb7ae99edebbbee">REMORA_BC::periodic</a>)</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                        <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346a223988127b7e8a66aabbc3a1f98dddf0">REMORABCType::int_dir</a>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                        <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346a223988127b7e8a66aabbc3a1f98dddf0">REMORABCType::int_dir</a>);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// *****************************************************************************</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// Here we translate the physical boundary conditions -- one type per face --</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">//     into logical boundary conditions for each cell-centered variable</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">// *****************************************************************************</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordflow">for</span> (OrientationIter oit; oit; ++oit) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            Orientation ori = oit();</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <span class="keywordtype">int</span> dir = ori.coordDir();</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            Orientation::Side side = ori.faceDir();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="keyword">auto</span> <span class="keyword">const</span> bct = <a class="code" href="classREMORA.html#adac776c0b66cb62bc9a7a03369b6240e">phys_bc_type</a>[ori];</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="keywordflow">if</span> ( bct == <a class="code" href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325a40e712f30d56083318ab20a2402921d2">REMORA_BC::symmetry</a> )</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i++)</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                        <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346aaf8c10264d04dea51594afe39fd3c8a1">REMORABCType::reflect_even</a>);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i++)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                        <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346aaf8c10264d04dea51594afe39fd3c8a1">REMORABCType::reflect_even</a>);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( bct == <a class="code" href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325acac0c32caf84a889ec9b2b4cb2d56972">REMORA_BC::outflow</a> )</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i++)</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                        <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346af756bb6d63add06a5624fa131cc82407">REMORABCType::foextrap</a>);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i++)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                        <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346af756bb6d63add06a5624fa131cc82407">REMORABCType::foextrap</a>);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( bct == <a class="code" href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325acb8c716b8d9b499d9bc323d8f8a410d3">REMORA_BC::no_slip_wall</a>)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i++)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                        <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346af756bb6d63add06a5624fa131cc82407">REMORABCType::foextrap</a>);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i++)</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                        <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346af756bb6d63add06a5624fa131cc82407">REMORABCType::foextrap</a>);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325a03ee6de9fd100444c5c0567ea01bd538">REMORA_BC::slip_wall</a>)</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i++)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                        <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346af756bb6d63add06a5624fa131cc82407">REMORABCType::foextrap</a>);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i++)</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                        <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346af756bb6d63add06a5624fa131cc82407">REMORABCType::foextrap</a>);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325ad37e67db17cfd059f2852e2673b9e8ef">REMORA_BC::inflow</a>)</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i++) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                        <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346aab9d214a2442d0f956923d15f0392cf0">REMORABCType::ext_dir</a>);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                    }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i++) {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                        <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346aab9d214a2442d0f956923d15f0392cf0">REMORABCType::ext_dir</a>);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                    }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325ae6ffdec5e14fce371eb7ae99edebbbee">REMORA_BC::periodic</a>)</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i++)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                        <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346a223988127b7e8a66aabbc3a1f98dddf0">REMORABCType::int_dir</a>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i++)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                       <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346a223988127b7e8a66aabbc3a1f98dddf0">REMORABCType::int_dir</a>);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="preprocessor">#ifdef AMREX_USE_GPU</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    Gpu::htod_memcpy</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        (<a class="code" href="classREMORA.html#af4c01c1be8a352c96a61e03e08c25121">domain_bcs_type_d</a>.data(), <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>.data(),</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;         <span class="keyword">sizeof</span>(amrex::BCRec)*(<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>+AMREX_SPACEDIM));</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    std::memcpy</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        (<a class="code" href="classREMORA.html#af4c01c1be8a352c96a61e03e08c25121">domain_bcs_type_d</a>.data(), <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>.data(),</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;         <span class="keyword">sizeof</span>(amrex::BCRec)*(<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>+AMREX_SPACEDIM));</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;}</div>
<div class="ttc" id="aIndexDefines_8H_html_a4a23ce64320a8ee19b456144f4deb325a03ee6de9fd100444c5c0567ea01bd538"><div class="ttname"><a href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325a03ee6de9fd100444c5c0567ea01bd538">REMORA_BC::slip_wall</a></div><div class="ttdeci">@ slip_wall</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a4a23ce64320a8ee19b456144f4deb325a40e712f30d56083318ab20a2402921d2"><div class="ttname"><a href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325a40e712f30d56083318ab20a2402921d2">REMORA_BC::symmetry</a></div><div class="ttdeci">@ symmetry</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a4a23ce64320a8ee19b456144f4deb325a5e543256c480ac577d30f76f9120eb74"><div class="ttname"><a href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325a5e543256c480ac577d30f76f9120eb74">REMORA_BC::undefined</a></div><div class="ttdeci">@ undefined</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a4a23ce64320a8ee19b456144f4deb325acac0c32caf84a889ec9b2b4cb2d56972"><div class="ttname"><a href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325acac0c32caf84a889ec9b2b4cb2d56972">REMORA_BC::outflow</a></div><div class="ttdeci">@ outflow</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a4a23ce64320a8ee19b456144f4deb325acb8c716b8d9b499d9bc323d8f8a410d3"><div class="ttname"><a href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325acb8c716b8d9b499d9bc323d8f8a410d3">REMORA_BC::no_slip_wall</a></div><div class="ttdeci">@ no_slip_wall</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a4a23ce64320a8ee19b456144f4deb325ad37e67db17cfd059f2852e2673b9e8ef"><div class="ttname"><a href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325ad37e67db17cfd059f2852e2673b9e8ef">REMORA_BC::inflow</a></div><div class="ttdeci">@ inflow</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a4a23ce64320a8ee19b456144f4deb325ae6ffdec5e14fce371eb7ae99edebbbee"><div class="ttname"><a href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325ae6ffdec5e14fce371eb7ae99edebbbee">REMORA_BC::periodic</a></div><div class="ttdeci">@ periodic</div></div>
<div class="ttc" id="aclassREMORA_html_ac686c83706316dc3388d6c1d6b270a2c"><div class="ttname"><a href="classREMORA.html#ac686c83706316dc3388d6c1d6b270a2c">REMORA::domain_bc_type</a></div><div class="ttdeci">amrex::Array&lt; std::string, 2 *AMREX_SPACEDIM &gt; domain_bc_type</div><div class="ttdef"><b>Definition:</b> REMORA.H:757</div></div>
<div class="ttc" id="aclassREMORA_html_adac776c0b66cb62bc9a7a03369b6240e"><div class="ttname"><a href="classREMORA.html#adac776c0b66cb62bc9a7a03369b6240e">REMORA::phys_bc_type</a></div><div class="ttdeci">amrex::GpuArray&lt; REMORA_BC, AMREX_SPACEDIM *2 &gt; phys_bc_type</div><div class="ttdef"><b>Definition:</b> REMORA.H:763</div></div>
<div class="ttc" id="anamespaceBCVars_html_a6fd8f72c3055242c4af20c780f391073a0d8c9f8308d3e1a0dedf68c3765d2205"><div class="ttname"><a href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a0d8c9f8308d3e1a0dedf68c3765d2205">BCVars::Temp_bc_comp</a></div><div class="ttdeci">@ Temp_bc_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:18</div></div>
<div class="ttc" id="anamespaceBCVars_html_a6fd8f72c3055242c4af20c780f391073a59e20f7c1b74c9cbdbc9300394bbc335"><div class="ttname"><a href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a59e20f7c1b74c9cbdbc9300394bbc335">BCVars::Scalar_bc_comp</a></div><div class="ttdeci">@ Scalar_bc_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:20</div></div>
<div class="ttc" id="anamespaceBCVars_html_a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec"><div class="ttname"><a href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a></div><div class="ttdeci">@ cons_bc</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:17</div></div>
<div class="ttc" id="anamespaceBCVars_html_a6fd8f72c3055242c4af20c780f391073ab284ea9b749e574cd1d0493de25e459e"><div class="ttname"><a href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab284ea9b749e574cd1d0493de25e459e">BCVars::Salt_bc_comp</a></div><div class="ttdeci">@ Salt_bc_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:19</div></div>
<div class="ttc" id="anamespaceREMORABCType_html_ac0d18d4bb218d5950db1000ef1abf346a223988127b7e8a66aabbc3a1f98dddf0"><div class="ttname"><a href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346a223988127b7e8a66aabbc3a1f98dddf0">REMORABCType::int_dir</a></div><div class="ttdeci">@ int_dir</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:55</div></div>
<div class="ttc" id="anamespaceREMORABCType_html_ac0d18d4bb218d5950db1000ef1abf346a9d34de510d9acde35ba5ebe70aa11cde"><div class="ttname"><a href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346a9d34de510d9acde35ba5ebe70aa11cde">REMORABCType::reflect_odd</a></div><div class="ttdeci">@ reflect_odd</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:54</div></div>
<div class="ttc" id="anamespaceREMORABCType_html_ac0d18d4bb218d5950db1000ef1abf346aab9d214a2442d0f956923d15f0392cf0"><div class="ttname"><a href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346aab9d214a2442d0f956923d15f0392cf0">REMORABCType::ext_dir</a></div><div class="ttdeci">@ ext_dir</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:58</div></div>
<div class="ttc" id="anamespaceREMORABCType_html_ac0d18d4bb218d5950db1000ef1abf346aaf8c10264d04dea51594afe39fd3c8a1"><div class="ttname"><a href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346aaf8c10264d04dea51594afe39fd3c8a1">REMORABCType::reflect_even</a></div><div class="ttdeci">@ reflect_even</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:56</div></div>
<div class="ttc" id="anamespaceREMORABCType_html_ac0d18d4bb218d5950db1000ef1abf346af756bb6d63add06a5624fa131cc82407"><div class="ttname"><a href="namespaceREMORABCType.html#ac0d18d4bb218d5950db1000ef1abf346af756bb6d63add06a5624fa131cc82407">REMORABCType::foextrap</a></div><div class="ttdeci">@ foextrap</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:57</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a71e63d1870dd72923c2e110fa4158202"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71e63d1870dd72923c2e110fa4158202">&#9670;&nbsp;</a></span>init_beta_plane_coriolis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::init_beta_plane_coriolis </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_fcor = <a class="code" href="classREMORA.html#a13f9894ec6aca96e68687e7a6762e337">vec_fcor</a>[lev];</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keyword">auto</span> geomdata  = Geom(lev).data();</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(*<a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keyword">auto</span> fcor_arr = (mf_fcor)-&gt;array(mfi);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> coriolis_f0 = <a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a3a0b717e880c818de989b2e92c199d34">coriolis_f0</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> coriolis_beta = <a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a0d7c9053be4054e355768bf3c17bf029">coriolis_beta</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Esize = geomdata.ProbHi()[1] - geomdata.ProbLo()[1];</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> prob_lo = geomdata.ProbLo()[1];</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dx = geomdata.CellSize()[1];</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        ParallelFor(Box(fcor_arr), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01a415290769594460e2e485922904f345d">y</a> = prob_lo + (j + 0.5) * dx;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            fcor_arr(i,j,0) = coriolis_f0 + coriolis_beta * (<a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01a415290769594460e2e485922904f345d">y</a> - 0.5 * Esize);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        });</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    } <span class="comment">//mfi</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="classREMORA.html#a13f9894ec6aca96e68687e7a6762e337">vec_fcor</a>[lev]-&gt;FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;}</div>
<div class="ttc" id="aDataStruct_8H_html_a627f1f843904477f763577ad1460de01a415290769594460e2e485922904f345d"><div class="ttname"><a href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01a415290769594460e2e485922904f345d">Coord::y</a></div><div class="ttdeci">@ y</div></div>
<div class="ttc" id="astructSolverChoice_html_a0d7c9053be4054e355768bf3c17bf029"><div class="ttname"><a href="structSolverChoice.html#a0d7c9053be4054e355768bf3c17bf029">SolverChoice::coriolis_beta</a></div><div class="ttdeci">amrex::Real coriolis_beta</div><div class="ttdef"><b>Definition:</b> DataStruct.H:231</div></div>
<div class="ttc" id="astructSolverChoice_html_a3a0b717e880c818de989b2e92c199d34"><div class="ttname"><a href="structSolverChoice.html#a3a0b717e880c818de989b2e92c199d34">SolverChoice::coriolis_f0</a></div><div class="ttdeci">amrex::Real coriolis_f0</div><div class="ttdef"><b>Definition:</b> DataStruct.H:230</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a77de1102264f09670fbd00a76aa2c58f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77de1102264f09670fbd00a76aa2c58f">&#9670;&nbsp;</a></span>init_custom()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::init_custom </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;{</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_z_w = <a class="code" href="classREMORA.html#af7958bb9cfac605c91f1e74357f344b2">vec_z_w</a>[lev];</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_z_r = <a class="code" href="classREMORA.html#a6b24784c109d216c5a6cee02af8c5b0f">vec_z_r</a>[lev];</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_Hz  = <a class="code" href="classREMORA.html#a488738b1aea61abbbf086a9d22b4f815">vec_Hz</a>[lev];</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_h  = <a class="code" href="classREMORA.html#a157e7645fedcf8c0b46516dbb625d3bd">vec_hOfTheConfusingName</a>[lev];</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_Zt_avg1  = <a class="code" href="classREMORA.html#adeb60c66ba4665f07c57fbf3b3b8909a">vec_Zt_avg1</a>[lev];</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(*<a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <span class="keyword">const</span> Box &amp;bx = mfi.tilebox();</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;cons_arr = <a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;xvel_arr = <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;yvel_arr = <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;zvel_arr = <a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        Array4&lt;const Real&gt; <span class="keyword">const</span>&amp; z_w_arr = (mf_z_w)-&gt;array(mfi);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        Array4&lt;const Real&gt; <span class="keyword">const</span>&amp; z_r_arr = (mf_z_r)-&gt;array(mfi);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        Array4&lt;const Real&gt; <span class="keyword">const</span>&amp; Hz_arr  = (mf_Hz)-&gt;array(mfi);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        Array4&lt;const Real&gt; <span class="keyword">const</span>&amp; h_arr  = (mf_h)-&gt;array(mfi);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        Array4&lt;const Real&gt; <span class="keyword">const</span>&amp; Zt_avg1_arr  = mf_Zt_avg1-&gt;const_array(mfi);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <a class="code" href="prob__common_8H.html#adbedc34f482b6a491593d88706d948da">init_custom_prob</a>(bx, cons_arr, xvel_arr, yvel_arr, zvel_arr,</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                         z_w_arr, z_r_arr, Hz_arr, h_arr, Zt_avg1_arr, geom[lev].data(),</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                         <a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    } <span class="comment">//mfi</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">// Initialize the &quot;pm&quot; and &quot;pn&quot; arrays</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> dxi = Geom(lev).InvCellSize();</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="classREMORA.html#a173014aa6947dd9d4e0026541211f2be">vec_pm</a>[lev]-&gt;setVal(dxi[0]); <a class="code" href="classREMORA.html#a173014aa6947dd9d4e0026541211f2be">vec_pm</a>[lev]-&gt;FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="classREMORA.html#ad2d61f66b270a3def972bf32478790d8">vec_pn</a>[lev]-&gt;setVal(dxi[1]); <a class="code" href="classREMORA.html#ad2d61f66b270a3def972bf32478790d8">vec_pn</a>[lev]-&gt;FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="classREMORA.html#ab9d2fbd8ac171ab10eb09ff189cbb69b">set_2darrays</a>(lev);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;}</div>
<div class="ttc" id="aclassREMORA_html_a6b24784c109d216c5a6cee02af8c5b0f"><div class="ttname"><a href="classREMORA.html#a6b24784c109d216c5a6cee02af8c5b0f">REMORA::vec_z_r</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_z_r</div><div class="ttdef"><b>Definition:</b> REMORA.H:231</div></div>
<div class="ttc" id="aclassREMORA_html_ab9d2fbd8ac171ab10eb09ff189cbb69b"><div class="ttname"><a href="classREMORA.html#ab9d2fbd8ac171ab10eb09ff189cbb69b">REMORA::set_2darrays</a></div><div class="ttdeci">void set_2darrays(int lev)</div><div class="ttdef"><b>Definition:</b> REMORA_init.cpp:82</div></div>
<div class="ttc" id="aprob__common_8H_html_adbedc34f482b6a491593d88706d948da"><div class="ttname"><a href="prob__common_8H.html#adbedc34f482b6a491593d88706d948da">init_custom_prob</a></div><div class="ttdeci">void init_custom_prob(const amrex::Box &amp;bx, amrex::Array4&lt; amrex::Real &gt; const &amp;state, amrex::Array4&lt; amrex::Real &gt; const &amp;x_vel, amrex::Array4&lt; amrex::Real &gt; const &amp;y_vel, amrex::Array4&lt; amrex::Real &gt; const &amp;z_vel, amrex::Array4&lt; amrex::Real const &gt; const &amp;z_w, amrex::Array4&lt; amrex::Real const &gt; const &amp;z_r, amrex::Array4&lt; amrex::Real const &gt; const &amp;Hz, amrex::Array4&lt; amrex::Real const &gt; const &amp;h, amrex::Array4&lt; amrex::Real const &gt; const &amp;Zt_avg1, amrex::GeometryData const &amp;geomdata, SolverChoice const &amp;m_solverChoice)</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classREMORA_a77de1102264f09670fbd00a76aa2c58f_cgraph.png" border="0" usemap="#aclassREMORA_a77de1102264f09670fbd00a76aa2c58f_cgraph" alt=""/></div>
<map name="aclassREMORA_a77de1102264f09670fbd00a76aa2c58f_cgraph" id="aclassREMORA_a77de1102264f09670fbd00a76aa2c58f_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,168,32"/>
<area shape="rect" href="prob__common_8H.html#adbedc34f482b6a491593d88706d948da" title=" " alt="" coords="216,5,351,32"/>
</map>
</div>

</div>
</div>
<a id="a4010e1137df2630bdd56327fad98e4a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4010e1137df2630bdd56327fad98e4a1">&#9670;&nbsp;</a></span>init_only()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::init_only </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Init (NOT restart or regrid) </p>
<div class="fragment"><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;{</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev] = time;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="classREMORA.html#ae94018d43dcebc3cd70293e6c621c46a">t_old</a>[lev] = time - 1.e200;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a345dba1135888a3a3e422c9b6a010ebf">ic_bc_type</a> == <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a90589c47f06eb971d548591f23c285af">IC_BC_Type::Custom</a>)</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <a class="code" href="classREMORA.html#a77de1102264f09670fbd00a76aa2c58f">init_custom</a>(lev);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_NETCDF</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a345dba1135888a3a3e422c9b6a010ebf">ic_bc_type</a> == <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">IC_BC_Type::Real</a>) {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Calling init_data_from_netcdf &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        init_data_from_netcdf(lev);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Initial data loaded from netcdf file \n &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Calling init_bdry_from_netcdf &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        init_bdry_from_netcdf();</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Boundary data loaded from netcdf file \n &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        Abort(<span class="stringliteral">&quot;Need to specify ic_bc_type&quot;</span>);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">// Ensure that the face-based data are the same on both sides of a periodic domain.</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">// The data associated with the lower grid ID is considered the correct value.</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev]-&gt;OverrideSync(geom[lev].periodicity());</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev]-&gt;OverrideSync(geom[lev].periodicity());</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[lev]-&gt;OverrideSync(geom[lev].periodicity());</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;}</div>
<div class="ttc" id="aDataStruct_8H_html_aa307030d99f8c225e1a1adb20224ed36a90589c47f06eb971d548591f23c285af"><div class="ttname"><a href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a90589c47f06eb971d548591f23c285af">IC_BC_Type::Custom</a></div><div class="ttdeci">@ Custom</div></div>
<div class="ttc" id="aclassREMORA_html_a77de1102264f09670fbd00a76aa2c58f"><div class="ttname"><a href="classREMORA.html#a77de1102264f09670fbd00a76aa2c58f">REMORA::init_custom</a></div><div class="ttdeci">void init_custom(int lev)</div><div class="ttdef"><b>Definition:</b> REMORA_init.cpp:13</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a98ad64e4a964e4748ebae07a26405286"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98ad64e4a964e4748ebae07a26405286">&#9670;&nbsp;</a></span>init_stuff()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::init_stuff </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::BoxArray &amp;&#160;</td>
          <td class="paramname"><em>ba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::DistributionMapping &amp;&#160;</td>
          <td class="paramname"><em>dm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;{</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">// Initialize the boundary conditions</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="classREMORA.html#a75e6e53bc24b47b664fddcafed41dbd1">physbcs</a>[lev] = std::make_unique&lt;REMORAPhysBCFunct&gt; (lev, geom[lev], <a class="code" href="classREMORA.html#a116e340c1b1afd8b7a64faa108157a0f">domain_bcs_type</a>, <a class="code" href="classREMORA.html#af4c01c1be8a352c96a61e03e08c25121">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                                                       <a class="code" href="classREMORA.html#a09a032f4d90f8dd939ab8e2ab5a06e06">m_bc_extdir_vals</a>);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    BoxList bl2d = ba.boxList();</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; b : bl2d) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        b.setRange(2,0);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    BoxArray ba2d(std::move(bl2d));</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    BoxList bl1d = ba.boxList();</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; b : bl1d) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        b.setRange(0,0);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        b.setRange(1,0);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    BoxArray ba1d(std::move(bl1d));</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">// Map factors</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="classREMORA.html#a6b32e42c790f2f3ac55ce545c2d03314">mapfac_m</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba2d,dm,1,0));</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="classREMORA.html#a5d56f29784bbca12778ba7c58fa0f36d">mapfac_u</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(1,0,0)),dm,1,0));</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="classREMORA.html#aa30c202e051228d1936a521eedcd6957">mapfac_v</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(0,1,0)),dm,1,0));</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="classREMORA.html#a6b32e42c790f2f3ac55ce545c2d03314">mapfac_m</a>[lev]-&gt;setVal(1.);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="classREMORA.html#a5d56f29784bbca12778ba7c58fa0f36d">mapfac_u</a>[lev]-&gt;setVal(1.);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="classREMORA.html#aa30c202e051228d1936a521eedcd6957">mapfac_v</a>[lev]-&gt;setVal(1.);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    BoxArray ba_nd(ba);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    ba_nd.surroundingNodes();</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    BoxArray ba_w(ba);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    ba_w.surroundingNodes(2);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="classREMORA.html#ac956bf3a52181b34d3e98a85ea5ba131">vec_z_phys_nd</a>[lev].reset          (<span class="keyword">new</span> MultiFab(ba_nd,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">// z at psi points (nodes) MIGHT NEED NGROW+1</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="classREMORA.html#a157e7645fedcf8c0b46516dbb625d3bd">vec_hOfTheConfusingName</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba2d ,dm,2,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0))); <span class="comment">//2d, depth (double check if negative)</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="classREMORA.html#adeb60c66ba4665f07c57fbf3b3b8909a">vec_Zt_avg1</a>[lev].reset            (<span class="keyword">new</span> MultiFab(ba2d ,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0))); <span class="comment">//2d, average of the free surface (zeta)</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="classREMORA.html#a55ca3c497c355a95a82bfbacf955771e">vec_x_r</a>[lev].reset                (<span class="keyword">new</span> MultiFab(ba2d,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0))); <span class="comment">// x at r points (cell center)</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <a class="code" href="classREMORA.html#ab86841fb3954bcabcb79275416c46253">vec_y_r</a>[lev].reset                (<span class="keyword">new</span> MultiFab(ba2d,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0))); <span class="comment">// y at r points (cell center)</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="classREMORA.html#afc9f775b64d67d4ad85bc493c9c54f4f">vec_s_r</a>[lev].reset                (<span class="keyword">new</span> MultiFab(ba1d,dm,1,IntVect(    0,    0,0))); <span class="comment">// scaled vertical coordinate [0,1] , transforms to z</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="classREMORA.html#af7958bb9cfac605c91f1e74357f344b2">vec_z_w</a>[lev].reset                (<span class="keyword">new</span> MultiFab(ba_w,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0))); <span class="comment">// z at w points (cell faces)</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <a class="code" href="classREMORA.html#a6b24784c109d216c5a6cee02af8c5b0f">vec_z_r</a>[lev].reset                (<span class="keyword">new</span> MultiFab(ba  ,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0))); <span class="comment">// z at r points (cell center)</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <a class="code" href="classREMORA.html#a488738b1aea61abbbf086a9d22b4f815">vec_Hz</a>[lev].reset                 (<span class="keyword">new</span> MultiFab(ba  ,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1))); <span class="comment">// like in ROMS, thickness of cell in z</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="classREMORA.html#a89f042895cd59cc1a1226f2af2d3e04f">vec_Huon</a>[lev].reset               (<span class="keyword">new</span> MultiFab(convert(ba,IntVect(1,0,0)),dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">// mass flux for u component</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="classREMORA.html#afd1aab14dfc9155d65e48aad2b34ef42">vec_Hvom</a>[lev].reset               (<span class="keyword">new</span> MultiFab(convert(ba,IntVect(0,1,0)),dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">// mass flux for v component</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <a class="code" href="classREMORA.html#ad36ee94716ca0cde00d8cad5fe5cce94">vec_Akv</a>[lev].reset                (<span class="keyword">new</span> MultiFab(ba  ,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">// vertical mixing coefficient (.in)</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="classREMORA.html#a48c1bf42530780ce02b3655d7cefe592">vec_Akt</a>[lev].reset                (<span class="keyword">new</span> MultiFab(ba  ,dm,<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">// vertical mixing coefficient (.in)</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="classREMORA.html#aae58396940a8e44b9b8aa4b6ec6e878f">vec_visc3d_r</a>[lev].reset           (<span class="keyword">new</span> MultiFab(ba  ,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">// not used</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">// check dimensionality</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="classREMORA.html#a65281506759b30fbc3c382ba0a64f38f">vec_visc2_p</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">// harmonic viscosity at psi points -- difference to 3d?</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="classREMORA.html#a86f0a2458c28f42d5be178d7bc5d104b">vec_visc2_r</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">// harmonic viscosity at rho points</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="classREMORA.html#afdf4b75f0ec12caf3648dbee5ec7f653">vec_diff2</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba,dm,<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">// harmonic diffusivity temperature/salt</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="classREMORA.html#aaf06acc3074f6a4dd322f9e1ca0c5244">vec_ru</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba,IntVect(1,0,0)),dm,2,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>))); <span class="comment">// RHS u (incl horizontal and vertical advection)</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="classREMORA.html#ae4e70f2661f28e3a3a2585540e804486">vec_rv</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba,IntVect(0,1,0)),dm,2,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>))); <span class="comment">// RHS v</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">//2d, (incl advection terms and surface/bottom stresses, integral over the whole columnn, k=0)</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="classREMORA.html#a5a0dd90f9e35c6055bf3ede53f4229d6">vec_rufrc</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(1,0,0)),dm,2,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="classREMORA.html#a49ea2c6c379a0fa006e4b6023fd69f88">vec_rvfrc</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(0,1,0)),dm,2,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">//2d, same as above but v</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="classREMORA.html#a347a75f9295217fc66a8b7a4c2a47f9b">vec_sustr</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(1,0,0)),dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">//2d, surface stress</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="classREMORA.html#a88a26701f7276ea04f5c9ede4ae46981">vec_svstr</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(0,1,0)),dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">//2d</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">//2d, linear drag coefficient [m/s], defined at rho, somehow related to rdrg</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <a class="code" href="classREMORA.html#adba780a7c66c2158c914bff64964df60">vec_rdrag</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba2d,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="classREMORA.html#abd341c53d0813eaea345511b8e14afdd">vec_bustr</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(1,0,0)),dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">//2d, bottom stress</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="classREMORA.html#ac7d186a8a4d54c28a5b2eecaec6cb978">vec_bvstr</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(0,1,0)),dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">//all 2d -- all associated with the 2D advance</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">//2d DU: sum(height[incl free surface?] * u)</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <a class="code" href="classREMORA.html#ab8e2ff918dcaf20a807b37e88f9fdbb0">vec_DU_avg1</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(1,0,0)),dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">//2d like above, but correct(or)?</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <a class="code" href="classREMORA.html#a1b2cc0f2f617e846c6261df12aefd110">vec_DU_avg2</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(1,0,0)),dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="classREMORA.html#a9e0560b2f68b9c541583c9c1ff6c87ec">vec_DV_avg1</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(0,1,0)),dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="classREMORA.html#ac5ba663380c2e7b3857e21fd0d4286f9">vec_DV_avg2</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(0,1,0)),dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="classREMORA.html#a15b7ca3e79155dde5c648ac78d64e6c7">vec_rubar</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(1,0,0)),dm,4,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">// 2d RHS ubar</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="classREMORA.html#a66a39d31a3a2f027101cfd4052b913f3">vec_rvbar</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(0,1,0)),dm,4,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <a class="code" href="classREMORA.html#ac8c001dd94aa7fb806502579324905fd">vec_rzeta</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba2d,dm,4,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">// 2d RHS zeta</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">// starts off kind of like a depth-averaged u, but exists at more points and more timesteps (b/c fast 2D update) than full u</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <a class="code" href="classREMORA.html#abb214b8bab178b72c44907f5e2aeead8">vec_ubar</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(1,0,0)),dm,3,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="classREMORA.html#ab70c8d3ac0d8a5f7ac51365571905874">vec_vbar</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(0,1,0)),dm,3,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <a class="code" href="classREMORA.html#ab60f476961622f8e7f27221595e84956">vec_zeta</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba2d,dm,3,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0)));  <span class="comment">// 2d free surface</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="classREMORA.html#a173014aa6947dd9d4e0026541211f2be">vec_pm</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba2d,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+2,0)));</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="classREMORA.html#ad2d61f66b270a3def972bf32478790d8">vec_pn</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba2d,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+2,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0)));</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="classREMORA.html#a13f9894ec6aca96e68687e7a6762e337">vec_fcor</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba2d,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0)));</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">// tempstore, saltstore, etc</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <a class="code" href="classREMORA.html#a3d55e55c73497ceabf620dacbe632a3a">vec_sstore</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba,dm,<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <a class="code" href="classREMORA.html#a8386c899de7b3b3feab286c144f15229">vec_rhoS</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="classREMORA.html#a9acf62fad9b709ea10e00e9534d7a7c5">vec_rhoA</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="classREMORA.html#a97de693d117772818b80fb566720d4c1">set_bathymetry</a>(lev);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <a class="code" href="classREMORA.html#a20f12090c7b81ca46d953ccf1319c0f5">stretch_transform</a>(lev);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <a class="code" href="classREMORA.html#a72df3d34cb4020524bc7aefe66db5aa8">set_vmix</a>(lev);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="classREMORA.html#ac61ff34983f1636e08e957c5a2a0ddbc">set_hmixcoef</a>(lev);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="classREMORA.html#a43ebfe013ec1e2d1d0a8faaba3ebbbb6">set_coriolis</a>(lev);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="classREMORA.html#ad09828d9cb740f8465f4a794c2d90460">set_weights</a>(lev);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">//consider tracking ru and rv indexes more specifically or more similarly to indx</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="classREMORA.html#aaf06acc3074f6a4dd322f9e1ca0c5244">vec_ru</a>[lev]-&gt;setVal(0.0_rt);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <a class="code" href="classREMORA.html#ae4e70f2661f28e3a3a2585540e804486">vec_rv</a>[lev]-&gt;setVal(0.0_rt);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <a class="code" href="classREMORA.html#ab8e2ff918dcaf20a807b37e88f9fdbb0">vec_DU_avg1</a>[lev]-&gt;setVal(0.0_rt);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="classREMORA.html#a1b2cc0f2f617e846c6261df12aefd110">vec_DU_avg2</a>[lev]-&gt;setVal(0.0_rt);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="classREMORA.html#a9e0560b2f68b9c541583c9c1ff6c87ec">vec_DV_avg1</a>[lev]-&gt;setVal(0.0_rt);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="classREMORA.html#ac5ba663380c2e7b3857e21fd0d4286f9">vec_DV_avg2</a>[lev]-&gt;setVal(0.0_rt);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="classREMORA.html#a15b7ca3e79155dde5c648ac78d64e6c7">vec_rubar</a>[lev]-&gt;setVal(0.0_rt);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="classREMORA.html#a66a39d31a3a2f027101cfd4052b913f3">vec_rvbar</a>[lev]-&gt;setVal(0.0_rt);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="classREMORA.html#ac8c001dd94aa7fb806502579324905fd">vec_rzeta</a>[lev]-&gt;setVal(0.0_rt);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <a class="code" href="classREMORA.html#abb214b8bab178b72c44907f5e2aeead8">vec_ubar</a>[lev]-&gt;setVal(0.0_rt);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="classREMORA.html#ab70c8d3ac0d8a5f7ac51365571905874">vec_vbar</a>[lev]-&gt;setVal(0.0_rt);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <a class="code" href="classREMORA.html#ab60f476961622f8e7f27221595e84956">vec_zeta</a>[lev]-&gt;setVal(0.0_rt);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">// Set initial linear drag coefficient</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="classREMORA.html#adba780a7c66c2158c914bff64964df60">vec_rdrag</a>[lev]-&gt;setVal(<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab32c6e7161ddf37e8051743fae717cf5">rdrag</a>);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;}</div>
<div class="ttc" id="aclassREMORA_html_a347a75f9295217fc66a8b7a4c2a47f9b"><div class="ttname"><a href="classREMORA.html#a347a75f9295217fc66a8b7a4c2a47f9b">REMORA::vec_sustr</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_sustr</div><div class="ttdef"><b>Definition:</b> REMORA.H:246</div></div>
<div class="ttc" id="aclassREMORA_html_a43ebfe013ec1e2d1d0a8faaba3ebbbb6"><div class="ttname"><a href="classREMORA.html#a43ebfe013ec1e2d1d0a8faaba3ebbbb6">REMORA::set_coriolis</a></div><div class="ttdeci">void set_coriolis(int lev)</div><div class="ttdef"><b>Definition:</b> REMORA.cpp:396</div></div>
<div class="ttc" id="aclassREMORA_html_a55ca3c497c355a95a82bfbacf955771e"><div class="ttname"><a href="classREMORA.html#a55ca3c497c355a95a82bfbacf955771e">REMORA::vec_x_r</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_x_r</div><div class="ttdef"><b>Definition:</b> REMORA.H:225</div></div>
<div class="ttc" id="aclassREMORA_html_a5d56f29784bbca12778ba7c58fa0f36d"><div class="ttname"><a href="classREMORA.html#a5d56f29784bbca12778ba7c58fa0f36d">REMORA::mapfac_u</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; mapfac_u</div><div class="ttdef"><b>Definition:</b> REMORA.H:742</div></div>
<div class="ttc" id="aclassREMORA_html_a6b32e42c790f2f3ac55ce545c2d03314"><div class="ttname"><a href="classREMORA.html#a6b32e42c790f2f3ac55ce545c2d03314">REMORA::mapfac_m</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; mapfac_m</div><div class="ttdef"><b>Definition:</b> REMORA.H:741</div></div>
<div class="ttc" id="aclassREMORA_html_a72df3d34cb4020524bc7aefe66db5aa8"><div class="ttname"><a href="classREMORA.html#a72df3d34cb4020524bc7aefe66db5aa8">REMORA::set_vmix</a></div><div class="ttdeci">void set_vmix(int lev)</div><div class="ttdef"><b>Definition:</b> REMORA.cpp:418</div></div>
<div class="ttc" id="aclassREMORA_html_a88a26701f7276ea04f5c9ede4ae46981"><div class="ttname"><a href="classREMORA.html#a88a26701f7276ea04f5c9ede4ae46981">REMORA::vec_svstr</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_svstr</div><div class="ttdef"><b>Definition:</b> REMORA.H:249</div></div>
<div class="ttc" id="aclassREMORA_html_a97de693d117772818b80fb566720d4c1"><div class="ttname"><a href="classREMORA.html#a97de693d117772818b80fb566720d4c1">REMORA::set_bathymetry</a></div><div class="ttdeci">void set_bathymetry(int lev)</div><div class="ttdef"><b>Definition:</b> REMORA.cpp:372</div></div>
<div class="ttc" id="aclassREMORA_html_aa30c202e051228d1936a521eedcd6957"><div class="ttname"><a href="classREMORA.html#aa30c202e051228d1936a521eedcd6957">REMORA::mapfac_v</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; mapfac_v</div><div class="ttdef"><b>Definition:</b> REMORA.H:743</div></div>
<div class="ttc" id="aclassREMORA_html_aae58396940a8e44b9b8aa4b6ec6e878f"><div class="ttname"><a href="classREMORA.html#aae58396940a8e44b9b8aa4b6ec6e878f">REMORA::vec_visc3d_r</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_visc3d_r</div><div class="ttdef"><b>Definition:</b> REMORA.H:293</div></div>
<div class="ttc" id="aclassREMORA_html_ab86841fb3954bcabcb79275416c46253"><div class="ttname"><a href="classREMORA.html#ab86841fb3954bcabcb79275416c46253">REMORA::vec_y_r</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_y_r</div><div class="ttdef"><b>Definition:</b> REMORA.H:228</div></div>
<div class="ttc" id="aclassREMORA_html_abd341c53d0813eaea345511b8e14afdd"><div class="ttname"><a href="classREMORA.html#abd341c53d0813eaea345511b8e14afdd">REMORA::vec_bustr</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_bustr</div><div class="ttdef"><b>Definition:</b> REMORA.H:255</div></div>
<div class="ttc" id="aclassREMORA_html_ac61ff34983f1636e08e957c5a2a0ddbc"><div class="ttname"><a href="classREMORA.html#ac61ff34983f1636e08e957c5a2a0ddbc">REMORA::set_hmixcoef</a></div><div class="ttdeci">void set_hmixcoef(int lev)</div><div class="ttdef"><b>Definition:</b> REMORA.cpp:427</div></div>
<div class="ttc" id="aclassREMORA_html_ac7d186a8a4d54c28a5b2eecaec6cb978"><div class="ttname"><a href="classREMORA.html#ac7d186a8a4d54c28a5b2eecaec6cb978">REMORA::vec_bvstr</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_bvstr</div><div class="ttdef"><b>Definition:</b> REMORA.H:258</div></div>
<div class="ttc" id="aclassREMORA_html_ad09828d9cb740f8465f4a794c2d90460"><div class="ttname"><a href="classREMORA.html#ad09828d9cb740f8465f4a794c2d90460">REMORA::set_weights</a></div><div class="ttdeci">void set_weights(int lev)</div><div class="ttdef"><b>Definition:</b> REMORA_set_weights.cpp:10</div></div>
<div class="ttc" id="aclassREMORA_html_adba780a7c66c2158c914bff64964df60"><div class="ttname"><a href="classREMORA.html#adba780a7c66c2158c914bff64964df60">REMORA::vec_rdrag</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_rdrag</div><div class="ttdef"><b>Definition:</b> REMORA.H:252</div></div>
<div class="ttc" id="aclassREMORA_html_afc9f775b64d67d4ad85bc493c9c54f4f"><div class="ttname"><a href="classREMORA.html#afc9f775b64d67d4ad85bc493c9c54f4f">REMORA::vec_s_r</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_s_r</div><div class="ttdef"><b>Definition:</b> REMORA.H:237</div></div>
<div class="ttc" id="aclassREMORA_html_afdf4b75f0ec12caf3648dbee5ec7f653"><div class="ttname"><a href="classREMORA.html#afdf4b75f0ec12caf3648dbee5ec7f653">REMORA::vec_diff2</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_diff2</div><div class="ttdef"><b>Definition:</b> REMORA.H:222</div></div>
<div class="ttc" id="astructSolverChoice_html_ab32c6e7161ddf37e8051743fae717cf5"><div class="ttname"><a href="structSolverChoice.html#ab32c6e7161ddf37e8051743fae717cf5">SolverChoice::rdrag</a></div><div class="ttdeci">amrex::Real rdrag</div><div class="ttdef"><b>Definition:</b> DataStruct.H:219</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c0d7d3c687b85e71541fc5b5f849089"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c0d7d3c687b85e71541fc5b5f849089">&#9670;&nbsp;</a></span>InitData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::InitData </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize multilevel data </p>
<div class="fragment"><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;{</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">// Initialize the start time for our CPU-time tracker</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <a class="code" href="classREMORA.html#a4d3e0a094fbd5ed0ef96114162a88478">startCPUTime</a> = ParallelDescriptor::second();</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">// Map the words in the inputs file to BC types, then translate</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">//     those types into what they mean for each variable</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="classREMORA.html#a0fb1bee6b7c41edde86f488eeb440478">init_bcs</a>();</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="classREMORA.html#aa1b32ce8d7cfb920dd3c61c002fc9e0f">last_plot_file_step_1</a> = -1;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <a class="code" href="classREMORA.html#a642013869cd0ee3902d2106b64fa418a">last_plot_file_step_2</a> = -1;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <a class="code" href="classREMORA.html#a70585b0129bfb5d405b1e10ea97020c5">last_check_file_step</a> = -1;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a> == <span class="stringliteral">&quot;&quot;</span>) {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="comment">// start simulation from the beginning</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> time = 0.0;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        InitFromScratch(time);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <a class="code" href="classREMORA.html#a4010e1137df2630bdd56327fad98e4a1">init_only</a>(lev, time);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == <a class="code" href="DataStruct_8H.html#ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815">CouplingType::TwoWay</a>) {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <a class="code" href="classREMORA.html#acc4cc491f4e1714d3d4999290046c82e">AverageDown</a>();</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_PARTICLES</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        particleData.init_particles((ParGDBBase*)GetParGDB(),<a class="code" href="classREMORA.html#ac956bf3a52181b34d3e98a85ea5ba131">vec_z_phys_nd</a>);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// Restart from a checkpoint</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <a class="code" href="classREMORA.html#af82928444cae433cc744c0cf7427e8eb">restart</a>();</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">// Initialize flux registers (whether we start from scratch or restart)</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == <a class="code" href="DataStruct_8H.html#ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815">CouplingType::TwoWay</a>) {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <a class="code" href="classREMORA.html#aa4b94dcbe06a58009a8b64d358b51bfc">advflux_reg</a>[0] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <a class="code" href="classREMORA.html#aa4b94dcbe06a58009a8b64d358b51bfc">advflux_reg</a>[lev] = <span class="keyword">new</span> YAFluxRegister(grids[lev], grids[lev-1],</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                                   dmap[lev],  dmap[lev-1],</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                                   geom[lev],  geom[lev-1],</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                                              ref_ratio[lev-1], lev, <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a> == <span class="stringliteral">&quot;&quot;</span> &amp;&amp; <a class="code" href="classREMORA.html#ae12e05882ce5fbae362e87b567d1a05f">check_int</a> &gt; 0)</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <a class="code" href="classREMORA.html#aec14981d78f55e2e326b1080cfc5656c">WriteCheckpointFile</a>();</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <a class="code" href="classREMORA.html#a70585b0129bfb5d405b1e10ea97020c5">last_check_file_step</a> = 0;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">if</span> ( (<a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a> == <span class="stringliteral">&quot;&quot;</span>) ||</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;         (<a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a> != <span class="stringliteral">&quot;&quot;</span> &amp;&amp; <a class="code" href="classREMORA.html#ab9ce060b467505349e57dacf4e5553fd">plot_file_on_restart</a>) )</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a3a61745803081888ac360f521a623b1b">plot_int_1</a> &gt; 0)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a002524d813441c4b5fe1b223b46389fa">plotfile_type</a> == <a class="code" href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9eabbe17e876cafcbc06d3ea0d2a23854d3">PlotfileType::amrex</a>)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                <a class="code" href="classREMORA.html#a6c03ef43eb1e2584973f5a45975f5482">WritePlotFile</a>(1,<a class="code" href="classREMORA.html#a0737e2206f4961852b5cbdc0c9c889f1">plot_var_names_1</a>);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_NETCDF</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a002524d813441c4b5fe1b223b46389fa">plotfile_type</a> == <a class="code" href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9eac2e0f73e7b066a47b743d6ce8213e684">PlotfileType::netcdf</a>) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                <span class="keywordtype">int</span> step0 = 0;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                WriteNCPlotFile(step0);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <a class="code" href="classREMORA.html#aa1b32ce8d7cfb920dd3c61c002fc9e0f">last_plot_file_step_1</a> = <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[0];</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a1db03ec74ac9a6e94c59ed0e4a187bbb">plot_int_2</a> &gt; 0)</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <a class="code" href="classREMORA.html#a6c03ef43eb1e2584973f5a45975f5482">WritePlotFile</a>(2,<a class="code" href="classREMORA.html#a2dc73785c2de0224c069e73c5d57e794">plot_var_names_2</a>);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <a class="code" href="classREMORA.html#a642013869cd0ee3902d2106b64fa418a">last_plot_file_step_2</a> = <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[0];</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#ac1343ee03c1a0119736b4afe199019f3">is_it_time_for_action</a>(<a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[0], <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[0], <a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[0], <a class="code" href="classREMORA.html#a295ab241204aca35cc4c720392bb3fd2">sum_interval</a>, <a class="code" href="classREMORA.html#aee90bf7b804b280c88a65dd354d97ee5">sum_per</a>)) {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <a class="code" href="classREMORA.html#aafa685722589c03eb84d71568feb26bc">sum_integrated_quantities</a>(<a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[0]);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <a class="code" href="classREMORA.html#a7671b889b87ca190f7aba7188074efa3">ComputeDt</a>();</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">// Fill ghost cells/faces</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev], *<a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev], <a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325abd1c55aaa78d7bcedd3a0e21005f2955">BdyVars::t</a>);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev], *<a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev], <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">BdyVars::u</a>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev], *<a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev], <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">BdyVars::v</a>);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev], *<a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[lev], <a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325ab738c65b8fa93b2166002dce928aca27">BdyVars::null</a>);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="comment">// Copy from new into old just in case</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="keywordtype">int</span> ngs   = <a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev]-&gt;nGrow();</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keywordtype">int</span> ngvel = <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev]-&gt;nGrow();</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        MultiFab::Copy(*<a class="code" href="classREMORA.html#abc6ebdcc84239b993b12b3c95425fa88">cons_old</a>[lev],*<a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev],0,0,<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>,ngs);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        MultiFab::Copy(*<a class="code" href="classREMORA.html#a51594dd103a7eee0f4e0c6e366d9f0ce">xvel_old</a>[lev],*<a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev],0,0,1,ngvel);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        MultiFab::Copy(*<a class="code" href="classREMORA.html#a9861cf91ee53fb2125f5f49c5cf73155">yvel_old</a>[lev],*<a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev],0,0,1,ngvel);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        MultiFab::Copy(*<a class="code" href="classREMORA.html#a6a980b1cd1d4d0e1253a641bee00de75">zvel_old</a>[lev],*<a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[lev],0,0,1,IntVect(ngvel,ngvel,0));</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    } <span class="comment">// lev</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;}</div>
<div class="ttc" id="aDataStruct_8H_html_ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815"><div class="ttname"><a href="DataStruct_8H.html#ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815">CouplingType::TwoWay</a></div><div class="ttdeci">@ TwoWay</div></div>
<div class="ttc" id="aclassREMORA_html_a0fb1bee6b7c41edde86f488eeb440478"><div class="ttname"><a href="classREMORA.html#a0fb1bee6b7c41edde86f488eeb440478">REMORA::init_bcs</a></div><div class="ttdeci">void init_bcs()</div><div class="ttdef"><b>Definition:</b> REMORA_init_bcs.cpp:9</div></div>
<div class="ttc" id="aclassREMORA_html_a295ab241204aca35cc4c720392bb3fd2"><div class="ttname"><a href="classREMORA.html#a295ab241204aca35cc4c720392bb3fd2">REMORA::sum_interval</a></div><div class="ttdeci">static int sum_interval</div><div class="ttdef"><b>Definition:</b> REMORA.H:835</div></div>
<div class="ttc" id="aclassREMORA_html_a4010e1137df2630bdd56327fad98e4a1"><div class="ttname"><a href="classREMORA.html#a4010e1137df2630bdd56327fad98e4a1">REMORA::init_only</a></div><div class="ttdeci">void init_only(int lev, amrex::Real time)</div><div class="ttdef"><b>Definition:</b> REMORA.cpp:447</div></div>
<div class="ttc" id="aclassREMORA_html_aafa685722589c03eb84d71568feb26bc"><div class="ttname"><a href="classREMORA.html#aafa685722589c03eb84d71568feb26bc">REMORA::sum_integrated_quantities</a></div><div class="ttdeci">void sum_integrated_quantities(amrex::Real time)</div><div class="ttdef"><b>Definition:</b> REMORA_SumIQ.cpp:9</div></div>
<div class="ttc" id="aclassREMORA_html_ab9ce060b467505349e57dacf4e5553fd"><div class="ttname"><a href="classREMORA.html#ab9ce060b467505349e57dacf4e5553fd">REMORA::plot_file_on_restart</a></div><div class="ttdeci">int plot_file_on_restart</div><div class="ttdef"><b>Definition:</b> REMORA.H:769</div></div>
<div class="ttc" id="aclassREMORA_html_ac1343ee03c1a0119736b4afe199019f3"><div class="ttname"><a href="classREMORA.html#ac1343ee03c1a0119736b4afe199019f3">REMORA::is_it_time_for_action</a></div><div class="ttdeci">bool is_it_time_for_action(int nstep, amrex::Real time, amrex::Real dt, int action_interval, amrex::Real action_per)</div><div class="ttdef"><b>Definition:</b> REMORA_SumIQ.cpp:143</div></div>
<div class="ttc" id="aclassREMORA_html_acc4cc491f4e1714d3d4999290046c82e"><div class="ttname"><a href="classREMORA.html#acc4cc491f4e1714d3d4999290046c82e">REMORA::AverageDown</a></div><div class="ttdeci">void AverageDown()</div><div class="ttdef"><b>Definition:</b> REMORA.cpp:631</div></div>
<div class="ttc" id="aclassREMORA_html_ae376daabb97c474de25b283de6bd985d"><div class="ttname"><a href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">REMORA::restart_chkfile</a></div><div class="ttdeci">std::string restart_chkfile</div><div class="ttdef"><b>Definition:</b> REMORA.H:779</div></div>
<div class="ttc" id="aclassREMORA_html_aee90bf7b804b280c88a65dd354d97ee5"><div class="ttname"><a href="classREMORA.html#aee90bf7b804b280c88a65dd354d97ee5">REMORA::sum_per</a></div><div class="ttdeci">static amrex::Real sum_per</div><div class="ttdef"><b>Definition:</b> REMORA.H:836</div></div>
<div class="ttc" id="aclassREMORA_html_af82928444cae433cc744c0cf7427e8eb"><div class="ttname"><a href="classREMORA.html#af82928444cae433cc744c0cf7427e8eb">REMORA::restart</a></div><div class="ttdeci">void restart()</div><div class="ttdef"><b>Definition:</b> REMORA.cpp:363</div></div>
<div class="ttc" id="astructSolverChoice_html_af976afa61859c07e6249963edc367c2d"><div class="ttname"><a href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">SolverChoice::coupling_type</a></div><div class="ttdeci">CouplingType coupling_type</div><div class="ttdef"><b>Definition:</b> DataStruct.H:205</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classREMORA_a7c0d7d3c687b85e71541fc5b5f849089_icgraph.png" border="0" usemap="#aclassREMORA_a7c0d7d3c687b85e71541fc5b5f849089_icgraph" alt=""/></div>
<map name="aclassREMORA_a7c0d7d3c687b85e71541fc5b5f849089_icgraph" id="aclassREMORA_a7c0d7d3c687b85e71541fc5b5f849089_icgraph">
<area shape="rect" title=" " alt="" coords="108,5,247,32"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="a98506141bb44abb0093a766be5d93318"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98506141bb44abb0093a766be5d93318">&#9670;&nbsp;</a></span>initHSE()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::initHSE </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize HSE. </p>

</div>
</div>
<a id="af25043e75bc350bc40ae56f65649554b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af25043e75bc350bc40ae56f65649554b">&#9670;&nbsp;</a></span>InitializeFromFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::InitializeFromFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="abc5dc3d0306ebb6507e6c702241f07a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc5dc3d0306ebb6507e6c702241f07a0">&#9670;&nbsp;</a></span>InitializeLevelFromData()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::InitializeLevelFromData </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>initial_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="adb0b6f25ef34e41463df97bf33d0cdee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb0b6f25ef34e41463df97bf33d0cdee">&#9670;&nbsp;</a></span>initRayleigh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::initRayleigh </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize Rayleigh damping profiles. </p>

</div>
</div>
<a id="ac1343ee03c1a0119736b4afe199019f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1343ee03c1a0119736b4afe199019f3">&#9670;&nbsp;</a></span>is_it_time_for_action()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool REMORA::is_it_time_for_action </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nstep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>action_interval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>action_per</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;{</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordtype">bool</span> int_test = (action_interval &gt; 0 &amp;&amp; nstep % action_interval == 0);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordtype">bool</span> per_test = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">if</span> (action_per &gt; 0.0) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_per_old = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(amrex::Math::floor((time - dtlev) / action_per));</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_per_new = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(amrex::Math::floor((time) / action_per));</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">if</span> (num_per_old != num_per_new) {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      per_test = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordflow">return</span> int_test || per_test;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2006ad0aefc229079ab5a7da054ea8fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2006ad0aefc229079ab5a7da054ea8fe">&#9670;&nbsp;</a></span>MakeNewLevelFromCoarse()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::MakeNewLevelFromCoarse </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::BoxArray &amp;&#160;</td>
          <td class="paramname"><em>ba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::DistributionMapping &amp;&#160;</td>
          <td class="paramname"><em>dm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Make a new level using provided BoxArray and DistributionMapping and fill with interpolated coarse level data. Overrides the pure virtual function in AmrCore </p>
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev]-&gt;define(ba, dm, <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>, <a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev-1]-&gt;nGrowVect());</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <a class="code" href="classREMORA.html#abc6ebdcc84239b993b12b3c95425fa88">cons_old</a>[lev]-&gt;define(ba, dm, <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>, <a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev-1]-&gt;nGrowVect());</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev]-&gt;define(convert(ba, IntVect(1,0,0)), dm, 1, <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev-1]-&gt;nGrowVect());</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <a class="code" href="classREMORA.html#a51594dd103a7eee0f4e0c6e366d9f0ce">xvel_old</a>[lev]-&gt;define(convert(ba, IntVect(1,0,0)), dm, 1, <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev-1]-&gt;nGrowVect());</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev]-&gt;define(convert(ba, IntVect(0,1,0)), dm, 1, <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev-1]-&gt;nGrowVect());</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="classREMORA.html#a9861cf91ee53fb2125f5f49c5cf73155">yvel_old</a>[lev]-&gt;define(convert(ba, IntVect(0,1,0)), dm, 1, <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev-1]-&gt;nGrowVect());</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[lev]-&gt;define(convert(ba, IntVect(0,0,1)), dm, 1, <a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[lev-1]-&gt;nGrowVect());</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="classREMORA.html#a6a980b1cd1d4d0e1253a641bee00de75">zvel_old</a>[lev]-&gt;define(convert(ba, IntVect(0,0,1)), dm, 1, <a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[lev-1]-&gt;nGrowVect());</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="classREMORA.html#aa91decb04550c58b177e6a18b9d70f0d">resize_stuff</a>(lev);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      <a class="code" href="classREMORA.html#a98ad64e4a964e4748ebae07a26405286">init_stuff</a>(lev, ba, dm);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev] = time;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="classREMORA.html#ae94018d43dcebc3cd70293e6c621c46a">t_old</a>[lev] = time - 1.e200;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="classREMORA.html#a95cda6dc2401e1e6d3df49eeda4ee6e1">FillCoarsePatch</a>(lev, time, <a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev], <a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev-1]);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="classREMORA.html#a95cda6dc2401e1e6d3df49eeda4ee6e1">FillCoarsePatch</a>(lev, time, <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev], <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev-1]);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="classREMORA.html#a95cda6dc2401e1e6d3df49eeda4ee6e1">FillCoarsePatch</a>(lev, time, <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev], <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev-1]);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="classREMORA.html#a95cda6dc2401e1e6d3df49eeda4ee6e1">FillCoarsePatch</a>(lev, time, <a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[lev], <a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[lev-1]);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;}</div>
<div class="ttc" id="aclassREMORA_html_a98ad64e4a964e4748ebae07a26405286"><div class="ttname"><a href="classREMORA.html#a98ad64e4a964e4748ebae07a26405286">REMORA::init_stuff</a></div><div class="ttdeci">void init_stuff(int lev, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm)</div><div class="ttdef"><b>Definition:</b> REMORA_make_new_level.cpp:191</div></div>
<div class="ttc" id="aclassREMORA_html_aa91decb04550c58b177e6a18b9d70f0d"><div class="ttname"><a href="classREMORA.html#aa91decb04550c58b177e6a18b9d70f0d">REMORA::resize_stuff</a></div><div class="ttdeci">void resize_stuff(int lev)</div><div class="ttdef"><b>Definition:</b> REMORA_make_new_level.cpp:137</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad64e9b244603ae920ed761821753a71f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad64e9b244603ae920ed761821753a71f">&#9670;&nbsp;</a></span>MakeNewLevelFromScratch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::MakeNewLevelFromScratch </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::BoxArray &amp;&#160;</td>
          <td class="paramname"><em>ba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::DistributionMapping &amp;&#160;</td>
          <td class="paramname"><em>dm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Make a new level from scratch using provided BoxArray and DistributionMapping. Only used during initialization. Overrides the pure virtual function in AmrCore </p>
<div class="fragment"><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;{</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// Set BoxArray grids and DistributionMapping dmap in AMReX_AmrMesh.H class</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    SetBoxArray(lev, ba);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    SetDistributionMap(lev, dm);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;GRIDS AT LEVEL &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; ARE &quot;</span> &lt;&lt; ba &lt;&lt; std::endl;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// The number of ghost cells for density must be 1 greater than that for velocity</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">//     so that we can go back in forth between velocity and momentum on all faces</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">#if NGROW==2</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordtype">int</span> ngrow_state = <a class="code" href="classREMORA.html#a3be29f45efb0b259995c494f6dac2b97">ComputeGhostCells</a>(<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8e053ce39997ed619ac81aa4d5a1fd44">spatial_order</a>)+1;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordtype">int</span> ngrow_vels  = <a class="code" href="classREMORA.html#a3be29f45efb0b259995c494f6dac2b97">ComputeGhostCells</a>(<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8e053ce39997ed619ac81aa4d5a1fd44">spatial_order</a>)+1;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordtype">int</span> ngrow_state = <a class="code" href="classREMORA.html#a3be29f45efb0b259995c494f6dac2b97">ComputeGhostCells</a>(<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8e053ce39997ed619ac81aa4d5a1fd44">spatial_order</a>)+2;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordtype">int</span> ngrow_vels  = <a class="code" href="classREMORA.html#a3be29f45efb0b259995c494f6dac2b97">ComputeGhostCells</a>(<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8e053ce39997ed619ac81aa4d5a1fd44">spatial_order</a>)+2;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="classREMORA.html#abc6ebdcc84239b993b12b3c95425fa88">cons_old</a>[lev] = <span class="keyword">new</span> MultiFab(ba, dm, <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>, ngrow_state);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev] = <span class="keyword">new</span> MultiFab(ba, dm, <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>, ngrow_state);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev] = <span class="keyword">new</span> MultiFab(convert(ba, IntVect(1,0,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="classREMORA.html#a51594dd103a7eee0f4e0c6e366d9f0ce">xvel_old</a>[lev] = <span class="keyword">new</span> MultiFab(convert(ba, IntVect(1,0,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev] = <span class="keyword">new</span> MultiFab(convert(ba, IntVect(0,1,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="classREMORA.html#a9861cf91ee53fb2125f5f49c5cf73155">yvel_old</a>[lev] = <span class="keyword">new</span> MultiFab(convert(ba, IntVect(0,1,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[lev] = <span class="keyword">new</span> MultiFab(convert(ba, IntVect(0,0,1)), dm, 1, IntVect(ngrow_vels,ngrow_vels,0));</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="classREMORA.html#a6a980b1cd1d4d0e1253a641bee00de75">zvel_old</a>[lev] = <span class="keyword">new</span> MultiFab(convert(ba, IntVect(0,0,1)), dm, 1, IntVect(ngrow_vels,ngrow_vels,0));</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="classREMORA.html#aa91decb04550c58b177e6a18b9d70f0d">resize_stuff</a>(lev);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <a class="code" href="classREMORA.html#a98ad64e4a964e4748ebae07a26405286">init_stuff</a>(lev, ba, dm);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;}</div>
<div class="ttc" id="aclassREMORA_html_a3be29f45efb0b259995c494f6dac2b97"><div class="ttname"><a href="classREMORA.html#a3be29f45efb0b259995c494f6dac2b97">REMORA::ComputeGhostCells</a></div><div class="ttdeci">AMREX_FORCE_INLINE int ComputeGhostCells(const int &amp;spatial_order)</div><div class="ttdef"><b>Definition:</b> REMORA.H:890</div></div>
<div class="ttc" id="astructSolverChoice_html_a8e053ce39997ed619ac81aa4d5a1fd44"><div class="ttname"><a href="structSolverChoice.html#a8e053ce39997ed619ac81aa4d5a1fd44">SolverChoice::spatial_order</a></div><div class="ttdeci">int spatial_order</div><div class="ttdef"><b>Definition:</b> DataStruct.H:237</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abe6c7702fc1edcb5bb7d9a1a56d007a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe6c7702fc1edcb5bb7d9a1a56d007a9">&#9670;&nbsp;</a></span>NumDataLogs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE int REMORA::NumDataLogs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    {</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classREMORA.html#ad3530fc80b87c25ce728095929a4ea99">datalog</a>.size();</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac4d8c0cbac8976c70668280de6a142c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4d8c0cbac8976c70668280de6a142c2">&#9670;&nbsp;</a></span>PlotFileName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string REMORA::PlotFileName </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>get plotfile name </p>

</div>
</div>
<a id="adf81b939a430211f29fed95b3d5f06fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf81b939a430211f29fed95b3d5f06fb">&#9670;&nbsp;</a></span>PlotFileVarNames()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vector&lt; std::string &gt; REMORA::PlotFileVarNames </td>
          <td>(</td>
          <td class="paramtype">amrex::Vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>plot_var_names</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>set plotfile variables names </p>
<div class="fragment"><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;{</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    Vector&lt;std::string&gt; names;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    names.insert(names.end(), plot_var_names.begin(), plot_var_names.end());</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">return</span> names;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a697e9a0fc5d32cd8833f68defaa65467"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a697e9a0fc5d32cd8833f68defaa65467">&#9670;&nbsp;</a></span>post_timestep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::post_timestep </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nstep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called after every level 0 timestep </p>
<div class="fragment"><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;{</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;REMORA::post_timestep()&quot;</span>);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_PARTICLES</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    particleData.Redistribute();</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == <a class="code" href="DataStruct_8H.html#ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815">CouplingType::TwoWay</a>)</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = finest_level-1; lev &gt;= 0; lev--)</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <span class="comment">// This call refluxes from the lev/lev+1 interface onto lev</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <a class="code" href="classREMORA.html#a0e2c89247c418609b713bdc107696258">getAdvFluxReg</a>(lev+1)-&gt;Reflux(*<a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev], 0, 0, <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            <span class="comment">// We need to do this before anything else because refluxing changes the</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <span class="comment">// values of coarse cells underneath fine grids with the assumption they&#39;ll</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            <span class="comment">// be over-written by averaging down</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <a class="code" href="classREMORA.html#a685a244b9590a93bd7272b2261d0ecf3">AverageDownTo</a>(lev);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#ac1343ee03c1a0119736b4afe199019f3">is_it_time_for_action</a>(nstep, time, dt_lev0, <a class="code" href="classREMORA.html#a295ab241204aca35cc4c720392bb3fd2">sum_interval</a>, <a class="code" href="classREMORA.html#aee90bf7b804b280c88a65dd354d97ee5">sum_per</a>)) {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <a class="code" href="classREMORA.html#aafa685722589c03eb84d71568feb26bc">sum_integrated_quantities</a>(time);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;}</div>
<div class="ttc" id="aclassREMORA_html_a0e2c89247c418609b713bdc107696258"><div class="ttname"><a href="classREMORA.html#a0e2c89247c418609b713bdc107696258">REMORA::getAdvFluxReg</a></div><div class="ttdeci">AMREX_FORCE_INLINE amrex::YAFluxRegister * getAdvFluxReg(int lev)</div><div class="ttdef"><b>Definition:</b> REMORA.H:917</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad450c4cc94bef5b7ca2d9fc17d554336"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad450c4cc94bef5b7ca2d9fc17d554336">&#9670;&nbsp;</a></span>post_update()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::post_update </td>
          <td>(</td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>state_mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Geometry &amp;&#160;</td>
          <td class="paramname"><em>geom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ab5e1fd1459f17ce2b00a93b0152c8911"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5e1fd1459f17ce2b00a93b0152c8911">&#9670;&nbsp;</a></span>prestep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::prestep </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf_uold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf_vold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_ru</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_rv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>S_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>S_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf_W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf_DC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_z_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_z_w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_pm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_pn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_sustr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_svstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_bustr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_bvstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nfirst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nstp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Wrapper function for prestep</p>
<p>prestep</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_vold</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_u</td><td>(looks like reset in update_vel &lt;- prestep_uv_3d, so maybe just out </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_v</td><td>maybe just out </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_ru</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_rv</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">S_old</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">S_new</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">mf_W</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">[none</td><td>] mf_DC (temp) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_z_r</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_z_w</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_h</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_sustr</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_svstr</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_bustr</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_bvstr</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iic</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ntfirst</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnew</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nstp</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nrhs</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt_lev</td><td></td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;{</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keyword">const</span> BoxArray&amp;            ba = S_old.boxArray();</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keyword">const</span> DistributionMapping&amp; dm = S_old.DistributionMap();</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="comment">// Maybe not the best way to do this, but need to cache salt and temp since</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">// they get rewritten by prestep_t</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    MultiFab mf_saltcache(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    MultiFab mf_tempcache(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    MultiFab mf_scalarcache(ba,dm,<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    MultiFab::Copy(mf_scalarcache,S_new,0,0,<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    MultiFab::Copy(mf_saltcache,S_new,<a class="code" href="IndexDefines_8H.html#ab84ceec196f4b00670dab4fa7794d1cf">Salt_comp</a>,0,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    MultiFab::Copy(mf_tempcache,S_new,<a class="code" href="IndexDefines_8H.html#a2439ff23f4449b8ffa90ddc5bcb36173">Temp_comp</a>,0,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(S_new, TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; DC = mf_DC.array(mfi);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Akv   = <a class="code" href="classREMORA.html#ad36ee94716ca0cde00d8cad5fe5cce94">vec_Akv</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Akt   = <a class="code" href="classREMORA.html#a48c1bf42530780ce02b3655d7cefe592">vec_Akt</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Hz    = <a class="code" href="classREMORA.html#a488738b1aea61abbbf086a9d22b4f815">vec_Hz</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Huon  = <a class="code" href="classREMORA.html#a89f042895cd59cc1a1226f2af2d3e04f">vec_Huon</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Hvom  = <a class="code" href="classREMORA.html#afd1aab14dfc9155d65e48aad2b34ef42">vec_Hvom</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; uold  = mf_uold.const_array(mfi);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; vold = mf_vold.const_array(mfi);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">u</a> = (mf_u).array(mfi);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a> = (mf_v).array(mfi);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; z_r   = mf_z_r-&gt;const_array(mfi);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; z_w   = mf_z_w-&gt;const_array(mfi);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; h     = mf_h-&gt;const_array(mfi);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; pm    = mf_pm-&gt;const_array(mfi);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; pn    = mf_pn-&gt;const_array(mfi);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; ru = mf_ru-&gt;array(mfi);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; rv = mf_rv-&gt;array(mfi);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; W = (mf_W).array(mfi);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; sustr = mf_sustr-&gt;const_array(mfi);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; svstr = mf_svstr-&gt;const_array(mfi);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; bustr = mf_bustr-&gt;const_array(mfi);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; bvstr = mf_bvstr-&gt;const_array(mfi);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> lambda = 1.0_rt;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        Box bx = mfi.tilebox();</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        Box gbx = mfi.growntilebox();</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        Box gbx1 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        Box gbx2 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="comment">//Box gbx11 = mfi.growntilebox(IntVect(NGROW-1,NGROW-1,NGROW-1));</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="comment">//copy the tilebox</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        Box tbxp1 = bx;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        Box tbxp11 = bx;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        Box tbxp2 = bx;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="comment">//TODO: adjust for tiling</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="comment">//Box gbx3uneven(IntVect(AMREX_D_DECL(bx.smallEnd(0)-3,bx.smallEnd(1)-3,bx.smallEnd(2))),</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="comment">//               IntVect(AMREX_D_DECL(bx.bigEnd(0)+2,bx.bigEnd(1)+2,bx.bigEnd(2))));</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="comment">//Box gbx2uneven(IntVect(AMREX_D_DECL(bx.smallEnd(0)-2,bx.smallEnd(1)-2,bx.smallEnd(2))),</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="comment">//               IntVect(AMREX_D_DECL(bx.bigEnd(0)+1,bx.bigEnd(1)+1,bx.bigEnd(2))));</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="comment">//make only gbx be grown to match multifabs</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        tbxp2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        tbxp1.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        tbxp11.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1));</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        Box bxD = bx;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        bxD.makeSlab(2,0);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        Box gbx1D = gbx1;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        gbx1D.makeSlab(2,0);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        Box gbx2D = gbx2;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        gbx2D.makeSlab(2,0);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        Box tbxp1D = tbxp1;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        tbxp1D.makeSlab(2,0);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        Box tbxp2D = tbxp2;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        tbxp2D.makeSlab(2,0);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        FArrayBox fab_FC(tbxp2,1,amrex::The_Async_Arena()); <span class="comment">//3D</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keyword">auto</span> FC=fab_FC.array();</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="comment">//From ini_fields and .in file</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="comment">//fab_Akt.setVal(1e-6);</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        FArrayBox fab_stflux(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keyword">auto</span> stflux= fab_stflux.array();</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        FArrayBox fab_btflux(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keyword">auto</span> btflux= fab_btflux.array();</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="comment">//From ini_fields and .in file</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="comment">//fab_stflux.setVal(0.0_rt);</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="comment">//also set btflux=0 (as in ana_btflux.H)</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        ParallelFor(tbxp2,</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            stflux(i,j,k)=0.0_rt;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            btflux(i,j,k)=0.0_rt;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        });</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_comp=0; i_comp &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i_comp++) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            Array4&lt;Real&gt; <span class="keyword">const</span>&amp; sstore = (<a class="code" href="classREMORA.html#a3d55e55c73497ceabf620dacbe632a3a">vec_sstore</a>[lev])-&gt;array(mfi,i_comp);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <a class="code" href="classREMORA.html#a27de127e15dec41e90a2ecc596e7a81d">prestep_t_advection</a>(bx, gbx, S_old.array(mfi,i_comp),</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                                mf_scalarcache.array(mfi,i_comp), Hz, Huon, Hvom,</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                                W, DC, FC, sstore, z_w, h, pm, pn, iic, ntfirst,</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                nrhs, N, dt_lev);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="comment">// Only do diffusion for salt and temperature, not other tracer(s)</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_comp=0; i_comp &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i_comp++) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <a class="code" href="classREMORA.html#a0dcfa91810e83ac902f4aba8894a49cf">prestep_diffusion</a>(bx,gbx,0,0,S_new.array(mfi,i_comp), S_old.array(mfi,i_comp), ru,</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                              Hz, Akt, DC, FC, stflux, btflux, z_r, pm, pn, iic, iic, nnew, nstp,</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                              nrhs, N, lambda, dt_lev);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="comment">// prestep_uv_3d</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="comment">//updates u,v,ru,rv (ru and rv have multiple components)</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <a class="code" href="classREMORA.html#a0dcfa91810e83ac902f4aba8894a49cf">prestep_diffusion</a>(tbxp1, gbx, 1, 0, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">u</a>, uold, ru, Hz, Akv, DC, FC,</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                          sustr, bustr, z_r, pm, pn, iic, ntfirst, nnew, nstp, nrhs, N, lambda, dt_lev);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <a class="code" href="classREMORA.html#a0dcfa91810e83ac902f4aba8894a49cf">prestep_diffusion</a>(tbxp1, gbx, 0, 1, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a>, vold, rv, Hz, Akv, DC, FC,</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                          svstr, bvstr, z_r, pm, pn, iic, ntfirst, nnew, nstp, nrhs, N, lambda, dt_lev);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;}</div>
<div class="ttc" id="aIndexDefines_8H_html_a2439ff23f4449b8ffa90ddc5bcb36173"><div class="ttname"><a href="IndexDefines_8H.html#a2439ff23f4449b8ffa90ddc5bcb36173">Temp_comp</a></div><div class="ttdeci">#define Temp_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:8</div></div>
<div class="ttc" id="aIndexDefines_8H_html_ab84ceec196f4b00670dab4fa7794d1cf"><div class="ttname"><a href="IndexDefines_8H.html#ab84ceec196f4b00670dab4fa7794d1cf">Salt_comp</a></div><div class="ttdeci">#define Salt_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:9</div></div>
<div class="ttc" id="aclassREMORA_html_a0dcfa91810e83ac902f4aba8894a49cf"><div class="ttname"><a href="classREMORA.html#a0dcfa91810e83ac902f4aba8894a49cf">REMORA::prestep_diffusion</a></div><div class="ttdeci">void prestep_diffusion(const amrex::Box &amp;bx, const amrex::Box &amp;gbx, const int ioff, const int joff, const amrex::Array4&lt; amrex::Real &gt; &amp;vel, const amrex::Array4&lt; amrex::Real const &gt; &amp;vel_old, const amrex::Array4&lt; amrex::Real &gt; &amp;rvel, const amrex::Array4&lt; amrex::Real const &gt; &amp;Hz, const amrex::Array4&lt; amrex::Real const &gt; &amp;Akv, const amrex::Array4&lt; amrex::Real &gt; &amp;DC, const amrex::Array4&lt; amrex::Real &gt; &amp;FC, const amrex::Array4&lt; amrex::Real const &gt; &amp;sstr, const amrex::Array4&lt; amrex::Real const &gt; &amp;bstr, const amrex::Array4&lt; amrex::Real const &gt; &amp;z_r, const amrex::Array4&lt; amrex::Real const &gt; &amp;pm, const amrex::Array4&lt; amrex::Real const &gt; &amp;pn, const int iic, const int ntfirst, const int nnew, int nstp, int nrhs, int N, const amrex::Real lambda, const amrex::Real dt_lev)</div><div class="ttdef"><b>Definition:</b> REMORA_prestep_diffusion.cpp:19</div></div>
<div class="ttc" id="aclassREMORA_html_a27de127e15dec41e90a2ecc596e7a81d"><div class="ttname"><a href="classREMORA.html#a27de127e15dec41e90a2ecc596e7a81d">REMORA::prestep_t_advection</a></div><div class="ttdeci">void prestep_t_advection(const amrex::Box &amp;tbx, const amrex::Box &amp;gbx, const amrex::Array4&lt; amrex::Real &gt; &amp;tempold, const amrex::Array4&lt; amrex::Real &gt; &amp;tempcache, const amrex::Array4&lt; amrex::Real &gt; &amp;Hz, const amrex::Array4&lt; amrex::Real &gt; &amp;Huon, const amrex::Array4&lt; amrex::Real &gt; &amp;Hvom, const amrex::Array4&lt; amrex::Real &gt; &amp;W, const amrex::Array4&lt; amrex::Real &gt; &amp;DC, const amrex::Array4&lt; amrex::Real &gt; &amp;FC, const amrex::Array4&lt; amrex::Real &gt; &amp;sstore, const amrex::Array4&lt; amrex::Real const &gt; &amp;z_w, const amrex::Array4&lt; amrex::Real const &gt; &amp;h, const amrex::Array4&lt; amrex::Real const &gt; &amp;pm, const amrex::Array4&lt; amrex::Real const &gt; &amp;pn, int iic, int ntfirst, int nrhs, int N, const amrex::Real dt_lev)</div><div class="ttdef"><b>Definition:</b> REMORA_prestep_t_advection.cpp:10</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0dcfa91810e83ac902f4aba8894a49cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dcfa91810e83ac902f4aba8894a49cf">&#9670;&nbsp;</a></span>prestep_diffusion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::prestep_diffusion </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>gbx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ioff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>joff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>vel_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>rvel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>Akv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>DC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>FC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>sstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>bstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>z_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>pm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>pn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ntfirst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nstp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Update velocities or tracers with diffusion/viscosity as the last part of the prestep </p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;{</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    BoxArray ba_gbxvel = intersect(BoxArray(vel_bx), gbx);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    AMREX_ASSERT((ba_gbxvel.size() == 1));</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    Box gbxvel = ba_gbxvel[0];</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">//  Weighting coefficient for the newest (implicit) time step derivatives</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">//  using either a Crank-Nicolson implicit scheme (lambda=0.5) or a</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">//  backward implicit scheme (lambda=1.0).</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> oml_dt = dt_lev*(1.0-lambda);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">//N is one less than ROMS</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">//  Except the commented out part means lambda is always 1.0</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#ad9ed53f5f841397304bf3b16fc82ecd9">verbose</a> &gt; 1) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;in update_vel_3d with box &quot;</span> &lt;&lt; vel_bx &lt;&lt; std::endl;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;vel old &quot;</span> &lt;&lt; Box(vel_old) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;Akv &quot;</span> &lt;&lt; Box(Akv) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    ParallelFor(vel_bx,</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordflow">if</span>(k+1&lt;=N&amp;&amp;k&gt;=0)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = 1.0 / ( z_r(i,j,k+1)+z_r(i-ioff,j-joff,k+1)</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                              -z_r(i,j,k  )-z_r(i-ioff,j-joff,k  ));</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            FC(i,j,k) = oml_dt * cff * (vel_old(i,j,k+1,nstp)-vel_old(i,j,k,nstp)) *</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                                           (Akv(i,j,k)     +Akv(i-ioff,j-joff,k));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k==-1)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            FC(i,j,-1) = dt_lev*bstr(i,j,0);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k==N)</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            FC(i,j, N) = dt_lev*sstr(i,j,0);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        DC(i,j,k) = 0.25 * dt_lev * (pm(i,j,0)+pm(i-ioff,j-joff,0))</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                                  * (pn(i,j,0)+pn(i-ioff,j-joff,0));</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    });</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    ParallelFor(gbxvel,</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff3=dt_lev*(1.0-lambda);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1 = 0.0, cff2 = 0.0, cff4;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordtype">int</span> indx=0; <span class="comment">//nrhs-3</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordflow">if</span> (iic==ntfirst)</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="keywordflow">if</span> (k+1&lt;=N &amp;&amp; k&gt;=1)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                cff1=vel_old(i,j,k,nstp)*0.5*(Hz(i,j,k)+Hz(i-ioff,j-joff,k));</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                cff2=FC(i,j,k)-FC(i,j,k-1);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                vel(i,j,k,nnew)=cff1+cff2;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(k==0)</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                cff1=vel_old(i,j,k,nstp)*0.5*(Hz(i,j,k)+Hz(i-ioff,j-joff,k));</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                cff2=FC(i,j,k)-dt_lev*bstr(i,j,0);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                vel(i,j,k,nnew)=cff1+cff2;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(k==N)</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                cff1=vel_old(i,j,k,nstp)*0.5*(Hz(i,j,k)+Hz(i-ioff,j-joff,k));</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                cff2=dt_lev*sstr(i,j,0)-FC(i,j,k-1); <span class="comment">//or: -FC(i,j,k-1)+dt_lev*sstr(i,j,0);</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                vel(i,j,k,nnew)=cff1+cff2;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(iic==ntfirst+1) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="keywordflow">if</span> (k&lt;N &amp;&amp; k&gt;0) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                cff1=vel_old(i,j,k,nstp)*0.5*(Hz(i,j,k)+Hz(i-ioff,j-joff,k));</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                cff2=FC(i,j,k)-FC(i,j,k-1);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(k==0) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                cff1=vel_old(i,j,k,nstp)*0.5*(Hz(i,j,k)+Hz(i-ioff,j-joff,k));</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                cff2=FC(i,j,k)-dt_lev*bstr(i,j,0);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(k==N) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                cff1=vel_old(i,j,k,nstp)*0.5*(Hz(i,j,k)+Hz(i-ioff,j-joff,k));</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                cff2=dt_lev*sstr(i,j,0)-FC(i,j,k-1); <span class="comment">//or: -FC(i,j,k-1)+dt_lev*sstr(i,j,0);</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            cff3=0.5*DC(i,j,k);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <span class="keywordflow">if</span> (ioff==0&amp;&amp;joff==0) {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                vel(i,j,k,nnew)=cff1 + cff2;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                indx=nrhs ? 0 : 1;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> r_swap= rvel(i,j,k,indx);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                rvel(i,j,k,indx) = rvel(i,j,k,nrhs);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                rvel(i,j,k,nrhs) = r_swap;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                vel(i,j,k,nnew)=cff1- cff3*rvel(i,j,k,indx)+ cff2;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            cff1 =  5.0/12.0;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            cff2 = 16.0/12.0;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="keywordflow">if</span> (k==0) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                cff3=vel_old(i,j,k,nstp)*0.5*(Hz(i,j,k)+Hz(i-ioff,j-joff,k));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                cff4=FC(i,j,k)-dt_lev*bstr(i,j,0);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                <span class="comment">//cff4=FC(i,j,k)-FC(i,j,k-1);//-bustr(i,j,0);</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == N) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                cff3=vel_old(i,j,k,nstp)*0.5*(Hz(i,j,k)+Hz(i-ioff,j-joff,k));</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                cff4=dt_lev*sstr(i,j,0)-FC(i,j,k-1);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                cff3=vel_old(i,j,k,nstp)*0.5*(Hz(i,j,k)+Hz(i-ioff,j-joff,k));</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                cff4=FC(i,j,k)-FC(i,j,k-1);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <span class="keywordflow">if</span> (ioff==0 &amp;&amp; joff==0) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                vel(i,j,k,nnew) = cff3 + cff4;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                indx=nrhs ? 0 : 1;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> r_swap= rvel(i,j,k,indx);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                rvel(i,j,k,indx) = rvel(i,j,k,nrhs);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                rvel(i,j,k,nrhs) = r_swap;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                vel(i,j,k,nnew) = cff3 + DC(i,j,k)*(cff1*rvel(i,j,k,nrhs)-</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                                    cff2*rvel(i,j,k,indx))+</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                    cff4;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                rvel(i,j,k,nrhs) = 0.0;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    });</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a27de127e15dec41e90a2ecc596e7a81d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27de127e15dec41e90a2ecc596e7a81d">&#9670;&nbsp;</a></span>prestep_t_advection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::prestep_t_advection </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>tbx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>gbx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>tempold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>tempcache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>Huon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>Hvom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>DC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>FC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>sstore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>z_w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>pm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>pn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ntfirst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Prestep calculations for the tracers </p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;{</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="comment">//copy the tilebox</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    Box gbx1 = tbx;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    Box gbx2 = tbx;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    Box tbxp1 = tbx;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    Box tbxp2 = tbx;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    tbxp1.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    tbxp2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    FArrayBox fab_FX(tbxp2,1,amrex::The_Async_Arena()); <span class="comment">//3D</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    FArrayBox fab_FE(tbxp2,1,amrex::The_Async_Arena()); <span class="comment">//3D</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    FArrayBox fab_curv(tbxp2,1,amrex::The_Async_Arena()); <span class="comment">//fab_curv.setVal(0.0_rt);</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    FArrayBox fab_grad(tbxp2,1,amrex::The_Async_Arena()); <span class="comment">//fab_curv.setVal(0.0_rt);</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keyword">auto</span> FX=fab_FX.array();</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keyword">auto</span> FE=fab_FE.array();</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keyword">auto</span> curv=fab_curv.array();</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keyword">auto</span> grad=fab_grad.array();</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    ParallelFor(tbxp2,</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        grad(i,j,k)=0.0_rt;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        curv(i,j,k)=0.0_rt;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        FX(i,j,k)=0.0_rt;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        FE(i,j,k)=0.0_rt;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    });</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    Box ubx = surroundingNodes(tbx,0);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    Box vbx = surroundingNodes(tbx,1);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    Box utbxp1 = surroundingNodes(tbxp1,0);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    Box vtbxp1 = surroundingNodes(tbxp1,1);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    Box gbx3uneven_init(IntVect(AMREX_D_DECL(tbx.smallEnd(0)-3,tbx.smallEnd(1)-3,tbx.smallEnd(2))),</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                   IntVect(AMREX_D_DECL(tbx.bigEnd(0)+2,tbx.bigEnd(1)+2,tbx.bigEnd(2))));</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    BoxArray ba_gbx3uneven = intersect(BoxArray(gbx3uneven_init), gbx);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    AMREX_ASSERT((ba_gbx3uneven.size() == 1));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    Box gbx3uneven = ba_gbx3uneven[0];</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    gbx2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    BoxArray ba_gbx2 = intersect(BoxArray(gbx2), gbx);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    AMREX_ASSERT((ba_gbx2.size() == 1));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    gbx2 = ba_gbx2[0];</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    gbx1.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    BoxArray ba_gbx1 = intersect(BoxArray(gbx1), gbx);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    AMREX_ASSERT((ba_gbx1.size() == 1));</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    gbx1 = ba_gbx1[0];</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">//------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">//  Vertically integrate horizontal mass flux divergence.</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">//------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">//Should really use gbx3uneven</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    Box gbx3unevenD = gbx3uneven;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    gbx3unevenD.makeSlab(2,0);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    Box gbx1D = gbx1;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    gbx1D.makeSlab(2,0);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    ParallelFor(gbx1D,</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="comment">//  Starting with zero vertical velocity at the bottom, integrate</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="comment">//  from the bottom (k=0) to the free-surface (k=N).  The w(:,:,N(ng))</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="comment">//  contains the vertical velocity at the free-surface, d(zeta)/d(t).</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="comment">//  Notice that barotropic mass flux divergence is not used directly.</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="comment">//W(i,j,-1)=0.0_rt;</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordtype">int</span> k=0;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        W(i,j,k) = -(Huon(i+1,j,k)-Huon(i,j,k)) - (Hvom(i,j+1,k)-Hvom(i,j,k));</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordflow">for</span>(k=1;k&lt;=N;k++) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            W(i,j,k) = W(i,j,k-1) - (Huon(i+1,j,k)-Huon(i,j,k)) - (Hvom(i,j+1,k)-Hvom(i,j,k));</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    });</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    ParallelFor(gbx1,</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="comment">//  Starting with zero vertical velocity at the bottom, integrate</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="comment">//  from the bottom (k=0) to the free-surface (k=N).  The w(:,:,N(ng))</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="comment">//  contains the vertical velocity at the free-surface, d(zeta)/d(t).</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="comment">//  Notice that barotropic mass flux divergence is not used directly.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> wrk_i=W(i,j,N)/(z_w(i,j,N)+h(i,j,0,0));</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">if</span>(k!=N) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            W(i,j,k) = W(i,j,k)- wrk_i*(z_w(i,j,k)+h(i,j,0,0));</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    });</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    ParallelFor(gbx1,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">if</span> (k == N) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            W(i,j,N) = 0.0_rt;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    });</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">//From ini_fields and .in file</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">//fab_Akt.setVal(1e-6);</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    FArrayBox fab_stflux(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keyword">auto</span> stflux= fab_stflux.array();</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    FArrayBox fab_btflux(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keyword">auto</span> btflux= fab_btflux.array();</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">//From ini_fields and .in file</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">//fab_stflux.setVal(0.0_rt);</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">//also set btflux=0 (as in ana_btflux.H)</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    ParallelFor(tbxp2, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        stflux(i,j,k)=0.0_rt;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        btflux(i,j,k)=0.0_rt;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    });</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">//Use FC and DC as intermediate arrays for FX and FE</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">//First pass do centered 2d terms</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a57e1d7e053fa63774c4c44980272031a">flat_bathymetry</a>) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        ParallelFor(tbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            FX(i,j,k)=Box(tempold).contains(i-1,j,k) ? Huon(i,j,k)*</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                        0.5_rt*(tempold(i-1,j,k)+tempold(i  ,j,k)) : 1e34;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        });</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        ParallelFor(tbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            FE(i,j,k)=Box(tempold).contains(i,j-1,k) ? Hvom(i,j,k)*</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                        0.5_rt*(tempold(i,j-1,k)+tempold(i,j,k)) : 1e34;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        });</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        ParallelFor(utbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="comment">//should be t index 3</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            FX(i,j,k)=tempold(i,j,k,nrhs)-tempold(i-1,j,k,nrhs);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        });</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        ParallelFor(vtbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <span class="comment">//should be t index 3</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            FE(i,j,k)=tempold(i,j,k,nrhs)-tempold(i,j-1,k,nrhs);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        });</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cffa=1.0_rt/6.0_rt;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cffb=1.0_rt/3.0_rt;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">Hadv_scheme</a> == <a class="code" href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca5b2d34872c0b46cfbabc832368e6ec7d">AdvectionScheme::upstream3</a>)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            ParallelFor(tbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                <span class="comment">//Upstream3</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                curv(i,j,k)=-FX(i,j,k)+FX(i+1,j,k);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            });</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            ParallelFor(tbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> max_Huon = std::max(Huon(i,j,k),0.0_rt);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> min_Huon = std::min(Huon(i,j,k),0.0_rt);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                FX(i,j,k)=Huon(i,j,k)*0.5_rt*(tempold(i,j,k)+tempold(i-1,j,k))-</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                    cffa*(curv(i,j,k)*min_Huon+ curv(i-1,j,k)*max_Huon);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            });</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">Hadv_scheme</a> == <a class="code" href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca6d779455e4a7eebf97d6bcb893dd5235">AdvectionScheme::centered4</a>) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            ParallelFor(tbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                <span class="comment">//Centered4</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                grad(i,j,k)=0.5_rt*(FX(i,j,k)+FX(i+1,j,k));</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            });</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            ParallelFor(ubx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                FX(i,j,k)=Huon(i,j,k)*0.5_rt*(tempold(i,j,k)+tempold(i-1,j,k)-</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                                           cffb*(grad(i,j,k)-grad(i-1,j,k)));</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            });</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;           Error(<span class="stringliteral">&quot;Not a valid horizontal advection scheme&quot;</span>);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">Hadv_scheme</a> == <a class="code" href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca5b2d34872c0b46cfbabc832368e6ec7d">AdvectionScheme::upstream3</a>)</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            ParallelFor(tbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                curv(i,j,k)=-FE(i,j,k)+FE(i,j+1,k);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            });</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            ParallelFor(tbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> max_Hvom = std::max(Hvom(i,j,k),0.0_rt);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> min_Hvom = std::min(Hvom(i,j,k),0.0_rt);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                FE(i,j,k)=Hvom(i,j,k)*0.5_rt*(tempold(i,j,k)+tempold(i,j-1,k))-</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                    cffa*(curv(i,j,k)*min_Hvom+ curv(i,j-1,k)*max_Hvom);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            });</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">Hadv_scheme</a> == <a class="code" href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca6d779455e4a7eebf97d6bcb893dd5235">AdvectionScheme::centered4</a>) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            ParallelFor(tbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                grad(i,j,k)=0.5_rt*(FE(i,j,k)+FE(i,j+1,k));</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            });</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            ParallelFor(vbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                FE(i,j,k)=Hvom(i,j,k)*0.5_rt*(tempold(i,j,k)+tempold(i,j-1,k)-</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                                           cffb*(grad(i,j,k)- grad(i,j-1,k)));</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            });</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            Error(<span class="stringliteral">&quot;Not a valid horizontal advection scheme&quot;</span>);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    } <span class="comment">// not flat</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">//Intermediate tracer at 3</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">//  Time-step horizontal advection (m Tunits).</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1 = 0.0_rt, cff2 = 0.0_rt, cff;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> GammaT = 1.0_rt/6.0_rt;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">if</span> (iic==ntfirst)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        cff=0.5_rt*dt_lev;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        cff1=1.0_rt;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        cff2=0.0_rt;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        cff=(1.0_rt-GammaT)*dt_lev;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        cff1=0.5_rt+GammaT;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        cff2=0.5_rt-GammaT;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    ParallelFor(tbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        tempstore(i,j,k)=Hz(i,j,k)*( cff1 * tempold(i,j,k)+</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                                     cff2 * tempcache(i,j,k) )-</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                                     cff  * pm(i,j,0)*pn(i,j,0) * (FX(i+1,j,k)-FX(i,j,k)+</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                                                                   FE(i,j+1,k)-FE(i,j,k));</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    });</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">// Time-step vertical advection of tracers (Tunits). Impose artificial</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// continuity equation.</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    ParallelFor(tbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;          <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;          <span class="comment">//  Add in vertical advection.</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;          <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> c1=0.5_rt;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> c2=7.0_rt/12.0_rt;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> c3=1.0_rt/12.0_rt;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;          <span class="keywordflow">if</span> (k&gt;=1 &amp;&amp; k&lt;=N-2)</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;          {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                  FC(i,j,k)=( c2*(tempold(i  ,j,k  ,nrhs)+ tempold(i,j,k+1,nrhs))</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                             -c3*(tempold(i  ,j,k-1,nrhs)+ tempold(i,j,k+2,nrhs)) )*</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                                ( W(i,j,k));</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;          }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;          <span class="keywordflow">else</span> <span class="comment">// this needs to be split up so that the following can be concurrent</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;          {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;              FC(i,j,N)=0.0_rt;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;              FC(i,j,N-1) = ( c2*tempold(i,j,N-1,nrhs)+ c1*tempold(i,j,N,nrhs)-c3*tempold(i,j,N-2,nrhs) )</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                          * W(i,j,N-1);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;              FC(i,j,  0) = ( c2*tempold(i,j,  1,nrhs)+ c1*tempold(i,j,0,nrhs)-c3*tempold(i,j,2,nrhs) )</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                          * W(i,j,0);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;          }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    });</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    ParallelFor(tbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordflow">if</span>(k-1&gt;=0) {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        DC(i,j,k)=1.0_rt/(Hz(i,j,k)-</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                        cff*pm(i,j,0)*pn(i,j,0)*</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                        (Huon(i+1,j,k)-Huon(i,j,k)+</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                         Hvom(i,j+1,k)-Hvom(i,j,k)+</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                         (W(i,j,k)-W(i,j,k-1))));</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        DC(i,j,k)=1.0_rt/(Hz(i,j,k)-</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                        cff*pm(i,j,0)*pn(i,j,0)*</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                        (Huon(i+1,j,k)-Huon(i,j,k)+</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                         Hvom(i,j+1,k)-Hvom(i,j,k)+</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                         (W(i,j,k))));</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    });</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    ParallelFor(tbx,</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> c1 = cff*pm(i,j,0)*pn(i,j,0);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> c4 = (k&gt;0) ? FC(i,j,k)-FC(i,j,k-1) : FC(i,j,k);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        tempstore(i,j,k) = DC(i,j,k)*(tempstore(i,j,k)-c1*c4);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    });</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;}</div>
<div class="ttc" id="aDataStruct_8H_html_a3ffde1e69b7cc5344b53bf310e4a212ca5b2d34872c0b46cfbabc832368e6ec7d"><div class="ttname"><a href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca5b2d34872c0b46cfbabc832368e6ec7d">AdvectionScheme::upstream3</a></div><div class="ttdeci">@ upstream3</div></div>
<div class="ttc" id="aDataStruct_8H_html_a3ffde1e69b7cc5344b53bf310e4a212ca6d779455e4a7eebf97d6bcb893dd5235"><div class="ttname"><a href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca6d779455e4a7eebf97d6bcb893dd5235">AdvectionScheme::centered4</a></div><div class="ttdeci">@ centered4</div></div>
<div class="ttc" id="astructSolverChoice_html_a4f1fced24fb1c3e55bc9b7333f211b9f"><div class="ttname"><a href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">SolverChoice::Hadv_scheme</a></div><div class="ttdeci">AdvectionScheme Hadv_scheme</div><div class="ttdef"><b>Definition:</b> DataStruct.H:202</div></div>
<div class="ttc" id="astructSolverChoice_html_a57e1d7e053fa63774c4c44980272031a"><div class="ttname"><a href="structSolverChoice.html#a57e1d7e053fa63774c4c44980272031a">SolverChoice::flat_bathymetry</a></div><div class="ttdeci">bool flat_bathymetry</div><div class="ttdef"><b>Definition:</b> DataStruct.H:189</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af8928e9ae21348d045cc231d56e1d45a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8928e9ae21348d045cc231d56e1d45a">&#9670;&nbsp;</a></span>prsgrd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::prsgrd </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>gbx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>utbx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>vtbx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>ru</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>rv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>pn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>pm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>FC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>z_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>z_w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nrhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;{</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keyword">auto</span> phi_bxD=phi_bx;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    phi_bxD.makeSlab(2,0);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keyword">auto</span> phi_gbxD=phi_gbx &amp; phi_bx;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    phi_gbxD.makeSlab(2,0);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    Box phi_ubx = surroundingNodes(phi_bx,0);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    Box phi_vbx = surroundingNodes(phi_bx,1);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keyword">auto</span> utbxD = utbx;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keyword">auto</span> vtbxD = vtbx;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    utbxD.makeSlab(2,0);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    vtbxD.makeSlab(2,0);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> OneFifth = 0.2_rt;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> OneTwelfth = 1.0_rt/12.0_rt;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> eps = 1.0E-10_rt;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> GRho     = <a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#aeee9d0099e1ac4105829345280a4f03c">g</a>/<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a87396b485f47a76010673143372cca17">rho0</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> GRho0    = 1000.0_rt * GRho;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> HalfGRho = 0.5_rt    * GRho;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    FArrayBox fab_P(phi_bx,1,The_Async_Arena());</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    FArrayBox fab_aux(Box(z_r),1,The_Async_Arena());</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    FArrayBox fab_dR(phi_bx,1,The_Async_Arena());</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    FArrayBox fab_dZ(phi_bx,1,The_Async_Arena());</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    FArrayBox fab_dRx(phi_bx,1,The_Async_Arena());</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    FArrayBox fab_dZx(phi_bx,1,The_Async_Arena());</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keyword">auto</span> P=fab_P.array();</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keyword">auto</span> aux=fab_aux.array();</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keyword">auto</span> dR=fab_dR.array();</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keyword">auto</span> dZ=fab_dZ.array();</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keyword">auto</span> dRx=fab_dRx.array();</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keyword">auto</span> dZx=fab_dZx.array();</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">// Derivatives in the z direction</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    ParallelFor(phi_bx,</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordflow">if</span>(k&gt;=0&amp;&amp;k&lt;N) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            dR(i,j,k)=rho(i,j,k+1)-rho(i,j,k);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            dZ(i,j,k)=z_r(i,j,k+1)-z_r(i,j,k);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            dR(i,j,N)=rho(i,j,N)-rho(i,j,N-1);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            dZ(i,j,N)=z_r(i,j,N)-z_r(i,j,N-1);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    });</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    ParallelFor(phi_bxD,</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=N;k&gt;=0;k--) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff= k&gt;0 ? 2.0*dR(i,j,k)*dR(i,j,k-1) : 2.0*dR(i,j,k)*dR(i,j,k);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <span class="keywordflow">if</span> (cff&gt;eps) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                dR(i,j,k)= k&gt;0 ? cff/(dR(i,j,k)+dR(i,j,k-1)) : cff/(dR(i,j,k)+dR(i,j,k));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                dR(i,j,k)=0.0;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            dZ(i,j,k)= k&gt;0 ? 2.0_rt*dZ(i,j,k)*dZ(i,j,k-1)/(dZ(i,j,k)+dZ(i,j,k-1)) :</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                             2.0_rt*dZ(i,j,k)*dZ(i,j,k)/(dZ(i,j,k)+dZ(i,j,k));</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    });</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    ParallelFor(phi_bxD,</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=1.0_rt/(z_r(i,j,N)-z_r(i,j,N-1));</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2=0.5_rt*(rho(i,j,N)-rho(i,j,N-1))*(z_w(i,j,N)-z_r(i,j,N))*cff1;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        P(i,j,N)=GRho0*z_w(i,j,N)+GRho*(rho(i,j,N)+cff2)*(z_w(i,j,N)-z_r(i,j,N));</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=N-1;k&gt;=0;k--)</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> rho_diff = rho(i,j,k+1)-rho(i,j,k) - OneTwelfth* (dR(i,j,k+1)+dR(i,j,k));</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>   z_diff = z_r(i,j,k+1)-z_r(i,j,k) - OneTwelfth* (dZ(i,j,k+1)+dZ(i,j,k));</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>   rz_avg = (rho(i,j,k+1)+rho(i,j,k)) * (z_r(i,j,k+1)-z_r(i,j,k));</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            P(i,j,k) = P(i,j,k+1) + HalfGRho * ( rz_avg -</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                          OneFifth* ( (dR(i,j,k+1)-dR(i,j,k)) *  z_diff -</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                                      (dZ(i,j,k+1)-dZ(i,j,k)) * rho_diff ) );</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;         }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    });</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">//This should be nodal</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// Derivatives in the x direction</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    ParallelFor(phi_ubx,</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        FC(i,j,k)=rho(i,j,k)-rho(i-1,j,k);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        aux(i,j,k)=z_r(i,j,k)-z_r(i-1,j,k);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    });</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">//This should be nodal aux and FC need wider boxes above</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">//dZx and dRx may have index mismatch issues at k=2 and k=N</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    ParallelFor(phi_bxD,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=N;k&gt;=0;k--) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff= 2.0*aux(i,j,k)*aux(i+1,j,k);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="keywordflow">if</span> (cff&gt;eps) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1= 1.0_rt/(aux(i+1,j,k)+aux(i,j,k));</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                dZx(i,j,k)=cff*cff1;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                dZx(i,j,k)=0.0;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1= 2.0*FC(i,j,k)*FC(i+1,j,k);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="keywordflow">if</span> (cff1&gt;eps) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2= 1.0_rt/(FC(i,j,k)+FC(i+1,j,k));</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                dRx(i,j,k)=cff1*cff2;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                dRx(i,j,k)=0.0;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    });</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">//This should be nodal aux and FC need wider boxes above</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    ParallelFor(utbxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=N;k&gt;=0;k--)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> rho_diff   = rho(i,j,k)-rho(i-1,j,k)- OneTwelfth* (dRx(i,j,k)+dRx(i-1,j,k));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> z_r_diff   = z_r(i,j,k)-z_r(i-1,j,k)- OneTwelfth* (dZx(i,j,k)+dZx(i-1,j,k));</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>   Hz_avg   = 0.5_rt * (Hz(i,j,k)+Hz(i-1,j,k));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> on_u = 2.0_rt / (pn(i-1,j,0)+pn(i,j,0));</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            ru(i,j,k,nrhs) = on_u * Hz_avg * (</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                            P(i-1,j,k) - P(i,j,k) - HalfGRho *</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                            ( (rho(i,j,k)+rho(i-1,j,k))*(z_r(i,j,k)-z_r(i-1,j,k))-</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                              OneFifth * ( (dRx(i,j,k)-dRx(i-1,j,k)) * z_r_diff -</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                           (dZx(i,j,k)-dZx(i-1,j,k)) * rho_diff ) ) );</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    });</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">//This should be nodal</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    ParallelFor(phi_vbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        FC(i,j,k)= rho(i,j,k)-rho(i,j-1,k);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        aux(i,j,k)= z_r(i,j,k)-z_r(i,j-1,k);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    });</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">//This should be nodal aux and FC need wider boxes above</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">//dZx and dRx may have index mismatch issues at k=2 and k=N</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    ParallelFor(phi_bxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=N;k&gt;=0;k--) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff= 2.0*aux(i,j,k)*aux(i,j+1,k);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="keywordflow">if</span> (cff&gt;eps) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1= 1.0_rt/(aux(i,j+1,k)+aux(i,j,k));</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                dZx(i,j,k)=cff*cff1;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                dZx(i,j,k)=0.0;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1= 2.0*FC(i,j,k)*FC(i,j+1,k);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="keywordflow">if</span> (cff1&gt;eps) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2= 1.0_rt/(FC(i,j,k)+FC(i,j+1,k));</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                dRx(i,j,k)=cff1*cff2;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                dRx(i,j,k)=0.0;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    });</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">//This should be nodal aux and FC need wider boxes above</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    ParallelFor(vtbxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=N;k&gt;=0;k--)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> rho_diff   = rho(i,j,k)-rho(i,j-1,k)- OneTwelfth* (dRx(i,j,k)+dRx(i,j-1,k));</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> z_r_diff   = z_r(i,j,k)-z_r(i,j-1,k)- OneTwelfth* (dZx(i,j,k)+dZx(i,j-1,k));</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>   Hz_avg   = 0.5_rt * (Hz(i,j,k)+Hz(i,j-1,k));</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> om_v = 2.0_rt / (pm(i,j-1,0)+pm(i,j,0));</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            rv(i,j,k,nrhs) = om_v * Hz_avg * (</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                            P(i,j-1,k) - P(i,j,k) - HalfGRho *</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                            ( (rho(i,j,k)+rho(i,j-1,k))*(z_r(i,j,k)-z_r(i,j-1,k))-</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                              OneFifth * ( (dRx(i,j,k)-dRx(i,j-1,k)) * z_r_diff -</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                           (dZx(i,j,k)-dZx(i,j-1,k)) * rho_diff ) ) );</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        } <span class="comment">// k</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    });</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;}</div>
<div class="ttc" id="astructSolverChoice_html_a87396b485f47a76010673143372cca17"><div class="ttname"><a href="structSolverChoice.html#a87396b485f47a76010673143372cca17">SolverChoice::rho0</a></div><div class="ttdeci">amrex::Real rho0</div><div class="ttdef"><b>Definition:</b> DataStruct.H:227</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a316a6db4c0b9a218e834c054d8c8f437"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a316a6db4c0b9a218e834c054d8c8f437">&#9670;&nbsp;</a></span>ReadCheckpointFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::ReadCheckpointFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;{</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Restart from checkpoint &quot;</span> &lt;&lt; <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">// Header</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    std::string File(<a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a> + <span class="stringliteral">&quot;/Header&quot;</span>);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    VisMF::IO_Buffer io_buffer(VisMF::GetIOBufferSize());</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    Vector&lt;char&gt; fileCharPtr;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    ParallelDescriptor::ReadAndBcastFile(File, fileCharPtr);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    std::string fileCharPtrString(fileCharPtr.dataPtr());</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    std::istringstream is(fileCharPtrString, std::istringstream::in);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    std::string line, word;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordtype">int</span> chk_ncomp;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">// read in title line</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    std::getline(is, line);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">// read in finest_level</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    is &gt;&gt; finest_level;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <a class="code" href="classREMORA.html#a03e3346471b528f47454cd969393786d">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">// read the number of components</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">// for each variable we store</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">// conservative, cell-centered vars</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="classREMORA.html#a03e3346471b528f47454cd969393786d">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    AMREX_ASSERT(chk_ncomp == <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">// x-velocity on faces</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="classREMORA.html#a03e3346471b528f47454cd969393786d">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    AMREX_ASSERT(chk_ncomp == 1);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">// y-velocity on faces</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="classREMORA.html#a03e3346471b528f47454cd969393786d">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    AMREX_ASSERT(chk_ncomp == 1);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">// z-velocity on faces</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="classREMORA.html#a03e3346471b528f47454cd969393786d">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    AMREX_ASSERT(chk_ncomp == 1);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <a class="code" href="classREMORA.html#a03e3346471b528f47454cd969393786d">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    AMREX_ASSERT(chk_ncomp == 2);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="classREMORA.html#a03e3346471b528f47454cd969393786d">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    AMREX_ASSERT(chk_ncomp == 2);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <a class="code" href="classREMORA.html#a03e3346471b528f47454cd969393786d">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    AMREX_ASSERT(chk_ncomp == 3);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="classREMORA.html#a03e3346471b528f47454cd969393786d">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    AMREX_ASSERT(chk_ncomp == 3);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">// read in array of istep</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    std::getline(is, line);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        std::istringstream lis(line);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keywordflow">while</span> (lis &gt;&gt; word) {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[i++] = std::stoi(word);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">// read in array of dt</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    std::getline(is, line);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        std::istringstream lis(line);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keywordflow">while</span> (lis &gt;&gt; word) {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[i++] = std::stod(word);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">// read in array of t_new</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    std::getline(is, line);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        std::istringstream lis(line);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordflow">while</span> (lis &gt;&gt; word) {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[i++] = std::stod(word);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="comment">// read in level &#39;lev&#39; BoxArray from Header</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        BoxArray ba;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        ba.readFrom(is);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <a class="code" href="classREMORA.html#a03e3346471b528f47454cd969393786d">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="comment">// create a distribution mapping</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        DistributionMapping dm { ba, ParallelDescriptor::NProcs() };</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <a class="code" href="classREMORA.html#ad64e9b244603ae920ed761821753a71f">MakeNewLevelFromScratch</a> (lev, <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev], ba, dm);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">// read in the MultiFab data</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    {</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        BoxList bl2d = grids[lev].boxList();</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; b : bl2d) {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            b.setRange(2,0);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        BoxArray ba2d(std::move(bl2d));</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        MultiFab cons(grids[lev],dmap[lev],<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>,0);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        VisMF::Read(cons, amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Cell&quot;</span>));</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        MultiFab::Copy(*<a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev],cons,0,0,<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>,0);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        MultiFab xvel(convert(grids[lev],IntVect(1,0,0)),dmap[lev],1,0);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        VisMF::Read(xvel, amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;XFace&quot;</span>));</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        MultiFab::Copy(*<a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev],xvel,0,0,1,0);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        MultiFab yvel(convert(grids[lev],IntVect(0,1,0)),dmap[lev],1,0);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        VisMF::Read(yvel, amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;YFace&quot;</span>));</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        MultiFab::Copy(*<a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev],yvel,0,0,1,0);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        MultiFab zvel(convert(grids[lev],IntVect(0,0,1)),dmap[lev],1,0);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        VisMF::Read(zvel, amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;ZFace&quot;</span>));</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        MultiFab::Copy(*<a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[lev],zvel,0,0,1,0);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;       MultiFab mf_ru(grids[lev],dmap[lev],2,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;       VisMF::Read(mf_ru, amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;XRHS&quot;</span>));</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;       MultiFab::Copy(*(<a class="code" href="classREMORA.html#aaf06acc3074f6a4dd322f9e1ca0c5244">vec_ru</a>[lev]),mf_ru,0,0,2,(<a class="code" href="classREMORA.html#aaf06acc3074f6a4dd322f9e1ca0c5244">vec_ru</a>[lev])-&gt;nGrowVect());</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;       MultiFab mf_rv(grids[lev],dmap[lev],2,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;       VisMF::Read(mf_rv, amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;YRHS&quot;</span>));</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;       MultiFab::Copy(*(<a class="code" href="classREMORA.html#ae4e70f2661f28e3a3a2585540e804486">vec_rv</a>[lev]),mf_rv,0,0,2,(<a class="code" href="classREMORA.html#ae4e70f2661f28e3a3a2585540e804486">vec_rv</a>[lev])-&gt;nGrowVect());</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;       MultiFab mf_ubar(ba2d,dmap[lev],3,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;       VisMF::Read(mf_ubar, amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;XBar&quot;</span>));</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;       MultiFab::Copy(*(<a class="code" href="classREMORA.html#abb214b8bab178b72c44907f5e2aeead8">vec_ubar</a>[lev]),mf_ubar,0,0,3,(<a class="code" href="classREMORA.html#abb214b8bab178b72c44907f5e2aeead8">vec_ubar</a>[lev])-&gt;nGrowVect());</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;       MultiFab mf_vbar(ba2d,dmap[lev],3,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;       VisMF::Read(mf_vbar, amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;YBar&quot;</span>));</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;       MultiFab::Copy(*(<a class="code" href="classREMORA.html#ab70c8d3ac0d8a5f7ac51365571905874">vec_vbar</a>[lev]),mf_vbar,0,0,3,(<a class="code" href="classREMORA.html#ab70c8d3ac0d8a5f7ac51365571905874">vec_vbar</a>[lev])-&gt;nGrowVect());</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;       VisMF::Read(*(<a class="code" href="classREMORA.html#a5a0dd90f9e35c6055bf3ede53f4229d6">vec_rufrc</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;rufrc&quot;</span>));</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;       VisMF::Read(*(<a class="code" href="classREMORA.html#a49ea2c6c379a0fa006e4b6023fd69f88">vec_rvfrc</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;rvfrc&quot;</span>));</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;       VisMF::Read(*(<a class="code" href="classREMORA.html#a347a75f9295217fc66a8b7a4c2a47f9b">vec_sustr</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;sustr&quot;</span>));</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;       VisMF::Read(*(<a class="code" href="classREMORA.html#a88a26701f7276ea04f5c9ede4ae46981">vec_svstr</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;svstr&quot;</span>));</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;       VisMF::Read(*(<a class="code" href="classREMORA.html#adba780a7c66c2158c914bff64964df60">vec_rdrag</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;rdrag&quot;</span>));</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;       VisMF::Read(*(<a class="code" href="classREMORA.html#abd341c53d0813eaea345511b8e14afdd">vec_bustr</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;bustr&quot;</span>));</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;       VisMF::Read(*(<a class="code" href="classREMORA.html#ac7d186a8a4d54c28a5b2eecaec6cb978">vec_bvstr</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;bvstr&quot;</span>));</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;       VisMF::Read(*(<a class="code" href="classREMORA.html#ab8e2ff918dcaf20a807b37e88f9fdbb0">vec_DU_avg1</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;DU_avg1&quot;</span>));</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;       VisMF::Read(*(<a class="code" href="classREMORA.html#a1b2cc0f2f617e846c6261df12aefd110">vec_DU_avg2</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;DU_avg2&quot;</span>));</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;       VisMF::Read(*(<a class="code" href="classREMORA.html#a9e0560b2f68b9c541583c9c1ff6c87ec">vec_DV_avg1</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;DV_avg1&quot;</span>));</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;       VisMF::Read(*(<a class="code" href="classREMORA.html#ac5ba663380c2e7b3857e21fd0d4286f9">vec_DV_avg2</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;DV_avg2&quot;</span>));</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;       VisMF::Read(*(<a class="code" href="classREMORA.html#ab60f476961622f8e7f27221595e84956">vec_zeta</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;zeta&quot;</span>));</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;       VisMF::Read(*(<a class="code" href="classREMORA.html#adeb60c66ba4665f07c57fbf3b3b8909a">vec_Zt_avg1</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Zt_avg1&quot;</span>));</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_PARTICLES</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;   particleData.Restart((amrex::ParGDBBase*)GetParGDB(),<a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_NETCDF</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">// Read bdy_data files</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a345dba1135888a3a3e422c9b6a010ebf">ic_bc_type</a> == <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">IC_BC_Type::Real</a>)</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordtype">int</span> ioproc = ParallelDescriptor::IOProcessorNumber();  <span class="comment">// I/O rank</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keywordtype">int</span> num_time;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keywordtype">int</span> num_var;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        Vector&lt;Box&gt; bx_v;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <span class="comment">// Open header file and read from it</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            std::ifstream bdy_h_file(amrex::MultiFabFileFullPrefix(0, <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;bdy_H&quot;</span>));</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            bdy_h_file &gt;&gt; num_time;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            bdy_h_file &gt;&gt; num_var;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            bdy_h_file &gt;&gt; start_bdy_time;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            bdy_h_file &gt;&gt; bdy_time_interval;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            bdy_h_file &gt;&gt; bdy_width;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            bx_v.resize(4*num_var);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar(0); ivar&lt;num_var; ++ivar) {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                bdy_h_file &gt;&gt; bx_v[4*ivar  ];</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                bdy_h_file &gt;&gt; bx_v[4*ivar+1];</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                bdy_h_file &gt;&gt; bx_v[4*ivar+2];</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                bdy_h_file &gt;&gt; bx_v[4*ivar+3];</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            <span class="comment">// IO size the FABs</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            bdy_data_xlo.resize(num_time);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            bdy_data_xhi.resize(num_time);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            bdy_data_ylo.resize(num_time);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            bdy_data_yhi.resize(num_time);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itime(0); itime&lt;num_time; ++itime) {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                bdy_data_xlo[itime].resize(num_var);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                bdy_data_xhi[itime].resize(num_var);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                bdy_data_ylo[itime].resize(num_var);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                bdy_data_yhi[itime].resize(num_var);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar(0); ivar&lt;num_var; ++ivar) {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                    bdy_data_xlo[itime][ivar].resize(bx_v[4*ivar  ]);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                    bdy_data_xhi[itime][ivar].resize(bx_v[4*ivar+1]);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                    bdy_data_ylo[itime][ivar].resize(bx_v[4*ivar+2]);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                    bdy_data_yhi[itime][ivar].resize(bx_v[4*ivar+3]);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <span class="comment">// Open data file and read from it</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            std::ifstream bdy_d_file(amrex::MultiFabFileFullPrefix(0, <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;bdy_D&quot;</span>));</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itime(0); itime&lt;num_time; ++itime) {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar(0); ivar&lt;num_var; ++ivar) {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                    bdy_data_xlo[itime][ivar].readFrom(bdy_d_file);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                    bdy_data_xhi[itime][ivar].readFrom(bdy_d_file);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                    bdy_data_ylo[itime][ivar].readFrom(bdy_d_file);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                    bdy_data_yhi[itime][ivar].readFrom(bdy_d_file);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        } <span class="comment">// IO</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="comment">// Broadcast the data</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        ParallelDescriptor::Barrier();</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        ParallelDescriptor::Bcast(&amp;start_bdy_time,1,ioproc);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        ParallelDescriptor::Bcast(&amp;bdy_time_interval,1,ioproc);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        ParallelDescriptor::Bcast(&amp;bdy_width,1,ioproc);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        ParallelDescriptor::Bcast(&amp;num_time,1,ioproc);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        ParallelDescriptor::Bcast(&amp;num_var,1,ioproc);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="comment">// Everyone size their boxes</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        bx_v.resize(4*num_var);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        ParallelDescriptor::Bcast(bx_v.dataPtr(),bx_v.size(),ioproc);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="comment">// Everyone but IO size their FABs</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="keywordflow">if</span> (!ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;          bdy_data_xlo.resize(num_time);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;          bdy_data_xhi.resize(num_time);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;          bdy_data_ylo.resize(num_time);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;          bdy_data_yhi.resize(num_time);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itime(0); itime&lt;num_time; ++itime) {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            bdy_data_xlo[itime].resize(num_var);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            bdy_data_xhi[itime].resize(num_var);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            bdy_data_ylo[itime].resize(num_var);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            bdy_data_yhi[itime].resize(num_var);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar(0); ivar&lt;num_var; ++ivar) {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;              bdy_data_xlo[itime][ivar].resize(bx_v[4*ivar  ]);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;              bdy_data_xhi[itime][ivar].resize(bx_v[4*ivar+1]);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;              bdy_data_ylo[itime][ivar].resize(bx_v[4*ivar+2]);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;              bdy_data_yhi[itime][ivar].resize(bx_v[4*ivar+3]);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;          }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itime(0); itime&lt;num_time; ++itime) {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar(0); ivar&lt;num_var; ++ivar) {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                ParallelDescriptor::Bcast(bdy_data_xlo[itime][ivar].dataPtr(),bdy_data_xlo[itime][ivar].box().numPts(),ioproc);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                ParallelDescriptor::Bcast(bdy_data_xhi[itime][ivar].dataPtr(),bdy_data_xhi[itime][ivar].box().numPts(),ioproc);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                ParallelDescriptor::Bcast(bdy_data_ylo[itime][ivar].dataPtr(),bdy_data_ylo[itime][ivar].box().numPts(),ioproc);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                ParallelDescriptor::Bcast(bdy_data_yhi[itime][ivar].dataPtr(),bdy_data_yhi[itime][ivar].box().numPts(),ioproc);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    } <span class="comment">// init real</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;}</div>
<div class="ttc" id="aclassREMORA_html_a03e3346471b528f47454cd969393786d"><div class="ttname"><a href="classREMORA.html#a03e3346471b528f47454cd969393786d">REMORA::GotoNextLine</a></div><div class="ttdeci">static void GotoNextLine(std::istream &amp;is)</div><div class="ttdef"><b>Definition:</b> Checkpoint.cpp:8</div></div>
<div class="ttc" id="aclassREMORA_html_ad64e9b244603ae920ed761821753a71f"><div class="ttname"><a href="classREMORA.html#ad64e9b244603ae920ed761821753a71f">REMORA::MakeNewLevelFromScratch</a></div><div class="ttdeci">virtual void MakeNewLevelFromScratch(int lev, amrex::Real time, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm) override</div><div class="ttdef"><b>Definition:</b> REMORA_make_new_level.cpp:102</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aae1b7a86e03c93dd71e2d68c700d2512"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae1b7a86e03c93dd71e2d68c700d2512">&#9670;&nbsp;</a></span>ReadParameters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::ReadParameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>read in some parameters from inputs file </p>
<div class="fragment"><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;{</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        ParmParse pp;  <span class="comment">// Traditionally, max_step and stop_time do not have prefix.</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        pp.query(<span class="stringliteral">&quot;max_step&quot;</span>, <a class="code" href="classREMORA.html#a69c542c1c57e6c6532a20eec60b9a0c3">max_step</a>);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        pp.query(<span class="stringliteral">&quot;stop_time&quot;</span>, <a class="code" href="classREMORA.html#a2981da216b5811080251dc15b27ca281">stop_time</a>);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    ParmParse pp(<a class="code" href="classREMORA.html#a9724f153d0c7a89c5d6aec11605959aa">pp_prefix</a>);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        pp.query(<span class="stringliteral">&quot;regrid_int&quot;</span>, <a class="code" href="classREMORA.html#a5d3ceaf421e5e6ec42b4da2fcb2d610c">regrid_int</a>);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        pp.query(<span class="stringliteral">&quot;check_file&quot;</span>, <a class="code" href="classREMORA.html#a4ca794481e17552667b3824252497b6a">check_file</a>);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        pp.query(<span class="stringliteral">&quot;check_int&quot;</span>, <a class="code" href="classREMORA.html#ae12e05882ce5fbae362e87b567d1a05f">check_int</a>);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        pp.query(<span class="stringliteral">&quot;restart&quot;</span>, <a class="code" href="classREMORA.html#ae376daabb97c474de25b283de6bd985d">restart_chkfile</a>);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="keywordflow">if</span> (pp.contains(<span class="stringliteral">&quot;data_log&quot;</span>))</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        {</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <span class="keywordtype">int</span> num_datalogs = pp.countval(<span class="stringliteral">&quot;data_log&quot;</span>);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            <a class="code" href="classREMORA.html#ad3530fc80b87c25ce728095929a4ea99">datalog</a>.resize(num_datalogs);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            <a class="code" href="classREMORA.html#a39048951d6927086a690d57a53754160">datalogname</a>.resize(num_datalogs);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            pp.queryarr(<span class="stringliteral">&quot;data_log&quot;</span>,<a class="code" href="classREMORA.html#a39048951d6927086a690d57a53754160">datalogname</a>,0,num_datalogs);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_datalogs; i++)</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                <a class="code" href="classREMORA.html#a7f4ee77d07b875ac526da57e8f0f1e98">setRecordDataInfo</a>(i,<a class="code" href="classREMORA.html#a39048951d6927086a690d57a53754160">datalogname</a>[i]);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <span class="comment">// Verbosity</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        pp.query(<span class="stringliteral">&quot;v&quot;</span>, <a class="code" href="classREMORA.html#ad9ed53f5f841397304bf3b16fc82ecd9">verbose</a>);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="comment">// Frequency of diagnostic output</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        pp.query(<span class="stringliteral">&quot;sum_interval&quot;</span>, <a class="code" href="classREMORA.html#a295ab241204aca35cc4c720392bb3fd2">sum_interval</a>);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        pp.query(<span class="stringliteral">&quot;sum_period&quot;</span>  , <a class="code" href="classREMORA.html#aee90bf7b804b280c88a65dd354d97ee5">sum_per</a>);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="comment">// Time step controls</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        pp.query(<span class="stringliteral">&quot;cfl&quot;</span>, <a class="code" href="classREMORA.html#ad3cf3f0d0e6783927e40a57231693fee">cfl</a>);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        pp.query(<span class="stringliteral">&quot;init_shrink&quot;</span>, <a class="code" href="classREMORA.html#a17de9bc2e49fbb1de53a5c57489d36bb">init_shrink</a>);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        pp.query(<span class="stringliteral">&quot;change_max&quot;</span>, <a class="code" href="classREMORA.html#a8c3a852e766271b0dcf52a99f2ba6500">change_max</a>);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        pp.query(<span class="stringliteral">&quot;fixed_dt&quot;</span>, <a class="code" href="classREMORA.html#a0c9e94b2bbf3ee8167abb9acd4b86807">fixed_dt</a>);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        pp.query(<span class="stringliteral">&quot;fixed_fast_dt&quot;</span>, <a class="code" href="classREMORA.html#a5cdf62f58282022e2d5f79de304d425f">fixed_fast_dt</a>);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        pp.query(<span class="stringliteral">&quot;fixed_ndtfast_ratio&quot;</span>, <a class="code" href="classREMORA.html#acc900ee008729de41eb6aa28a36f6a26">fixed_ndtfast_ratio</a>);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="comment">// If all three are specified, they must be consistent</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a0c9e94b2bbf3ee8167abb9acd4b86807">fixed_dt</a> &gt; 0. &amp;&amp; <a class="code" href="classREMORA.html#a5cdf62f58282022e2d5f79de304d425f">fixed_fast_dt</a> &gt; 0. &amp;&amp;  <a class="code" href="classREMORA.html#acc900ee008729de41eb6aa28a36f6a26">fixed_ndtfast_ratio</a> &gt; 0)</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a0c9e94b2bbf3ee8167abb9acd4b86807">fixed_dt</a> / <a class="code" href="classREMORA.html#a5cdf62f58282022e2d5f79de304d425f">fixed_fast_dt</a> != <a class="code" href="classREMORA.html#acc900ee008729de41eb6aa28a36f6a26">fixed_ndtfast_ratio</a>)</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                amrex::Abort(<span class="stringliteral">&quot;Dt is over-specfied&quot;</span>);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        }</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="comment">// If two are specified, initialize fixed_ndtfast_ratio</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a0c9e94b2bbf3ee8167abb9acd4b86807">fixed_dt</a> &gt; 0. &amp;&amp; <a class="code" href="classREMORA.html#a5cdf62f58282022e2d5f79de304d425f">fixed_fast_dt</a> &gt; 0. &amp;&amp;  <a class="code" href="classREMORA.html#acc900ee008729de41eb6aa28a36f6a26">fixed_ndtfast_ratio</a> &lt;= 0)</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            <a class="code" href="classREMORA.html#acc900ee008729de41eb6aa28a36f6a26">fixed_ndtfast_ratio</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classREMORA.html#a0c9e94b2bbf3ee8167abb9acd4b86807">fixed_dt</a> / <a class="code" href="classREMORA.html#a5cdf62f58282022e2d5f79de304d425f">fixed_fast_dt</a>);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        pp.query(<span class="stringliteral">&quot;do_substep&quot;</span>, <a class="code" href="classREMORA.html#a2c050fd7227b627691a3c074eb104c8d">do_substep</a>);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        AMREX_ASSERT(<a class="code" href="classREMORA.html#ad3cf3f0d0e6783927e40a57231693fee">cfl</a> &gt; 0. || <a class="code" href="classREMORA.html#a0c9e94b2bbf3ee8167abb9acd4b86807">fixed_dt</a> &gt; 0.);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="comment">// We use this to keep track of how many boxes we read in from WRF initialization</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <a class="code" href="classREMORA.html#a66ad489788fb8d0913833d3d6c89b9dd">num_files_at_level</a>.resize(max_level+1,0);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <span class="comment">// We use this to keep track of how many boxes are specified thru the refinement indicators</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <a class="code" href="classREMORA.html#a6d28606118c0069a57eb6a3c13685c56">num_boxes_at_level</a>.resize(max_level+1,0);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            <a class="code" href="classREMORA.html#a45b928a121bd6c5e75ec75732a27f774">boxes_at_level</a>.resize(max_level+1);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="comment">// We always have exactly one file at level 0</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <a class="code" href="classREMORA.html#a6d28606118c0069a57eb6a3c13685c56">num_boxes_at_level</a>[0] = 1;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <a class="code" href="classREMORA.html#a45b928a121bd6c5e75ec75732a27f774">boxes_at_level</a>[0].resize(1);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <a class="code" href="classREMORA.html#a45b928a121bd6c5e75ec75732a27f774">boxes_at_level</a>[0][0] = geom[0].Domain();</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <span class="comment">// Output format</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        std::string plotfile_type_str = <span class="stringliteral">&quot;amrex&quot;</span>;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        pp.query(<span class="stringliteral">&quot;plotfile_type&quot;</span>, plotfile_type_str);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="keywordflow">if</span> (plotfile_type_str == <span class="stringliteral">&quot;amrex&quot;</span>) {</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            <a class="code" href="classREMORA.html#a002524d813441c4b5fe1b223b46389fa">plotfile_type</a> = <a class="code" href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9eabbe17e876cafcbc06d3ea0d2a23854d3">PlotfileType::amrex</a>;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (plotfile_type_str == <span class="stringliteral">&quot;netcdf&quot;</span> || plotfile_type_str == <span class="stringliteral">&quot;NetCDF&quot;</span>) {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            <a class="code" href="classREMORA.html#a002524d813441c4b5fe1b223b46389fa">plotfile_type</a> = <a class="code" href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9eac2e0f73e7b066a47b743d6ce8213e684">PlotfileType::netcdf</a>;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_NETCDF</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            pp.query(<span class="stringliteral">&quot;write_history_file&quot;</span>,write_history_file);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;User selected plotfile_type = &quot;</span> &lt;&lt; plotfile_type_str &lt;&lt; std::endl;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            amrex::Abort(<span class="stringliteral">&quot;Dont know this plotfile_type&quot;</span>);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        }</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="preprocessor">#ifndef REMORA_USE_NETCDF</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a002524d813441c4b5fe1b223b46389fa">plotfile_type</a> == <a class="code" href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9eac2e0f73e7b066a47b743d6ce8213e684">PlotfileType::netcdf</a>)</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            amrex::Abort(<span class="stringliteral">&quot;Please compile with NetCDF in order to enable NetCDF plotfiles&quot;</span>);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_NETCDF</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <a class="code" href="classREMORA.html#af7b7f34b69f804f7acd9a1bc0c7bb5b9">nc_init_file</a>.resize(max_level+1);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <a class="code" href="classREMORA.html#af0ba249e52817855bb895b47cb005227">nc_grid_file</a>.resize(max_level+1);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="comment">// NetCDF initialization files -- possibly multiple files at each of multiple levels</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="comment">//        but we always have exactly one file at level 0</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= max_level; lev++)</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        {</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            <span class="keyword">const</span> std::string nc_file_names = amrex::Concatenate(<span class="stringliteral">&quot;nc_init_file_&quot;</span>,lev,1);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            <span class="keyword">const</span> std::string nc_bathy_file_names = amrex::Concatenate(<span class="stringliteral">&quot;nc_grid_file_&quot;</span>,lev,1);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            <span class="keywordflow">if</span> (pp.contains(nc_file_names.c_str()))</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                <span class="keywordtype">int</span> num_files = pp.countval(nc_file_names.c_str());</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                <span class="keywordtype">int</span> num_bathy_files = pp.countval(nc_bathy_file_names.c_str());</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                <span class="keywordflow">if</span> (num_files != num_bathy_files) {</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                    amrex::Error(<span class="stringliteral">&quot;Must have same number of netcdf files for grid info as for solution&quot;</span>);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                }</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                <a class="code" href="classREMORA.html#a66ad489788fb8d0913833d3d6c89b9dd">num_files_at_level</a>[lev] = num_files;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                <a class="code" href="classREMORA.html#af7b7f34b69f804f7acd9a1bc0c7bb5b9">nc_init_file</a>[lev].resize(num_files);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                <a class="code" href="classREMORA.html#af0ba249e52817855bb895b47cb005227">nc_grid_file</a>[lev].resize(num_files);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                pp.queryarr(nc_file_names.c_str()      , <a class="code" href="classREMORA.html#af7b7f34b69f804f7acd9a1bc0c7bb5b9">nc_init_file</a>[lev]     ,0,num_files);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                pp.queryarr(nc_bathy_file_names.c_str(), <a class="code" href="classREMORA.html#af0ba249e52817855bb895b47cb005227">nc_grid_file</a>[lev],0,num_files);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="comment">// We only read boundary data at level 0</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        pp.query(<span class="stringliteral">&quot;nc_bdry_file&quot;</span>, <a class="code" href="classREMORA.html#ade8f2985b433261b76ac1d8f28fa6d0a">nc_bdry_file</a>);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="comment">// Query the set and total widths for bdy interior ghost cells</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        pp.query(<span class="stringliteral">&quot;bdy_width&quot;</span>, bdy_width);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        pp.query(<span class="stringliteral">&quot;bdy_set_width&quot;</span>, bdy_set_width);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        AMREX_ALWAYS_ASSERT(bdy_width &gt;= 0);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        AMREX_ALWAYS_ASSERT(bdy_set_width &gt;= 0);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        AMREX_ALWAYS_ASSERT(bdy_width &gt;= bdy_set_width);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        pp.query(<span class="stringliteral">&quot;plot_file_1&quot;</span>, <a class="code" href="classREMORA.html#a784ba6c1f790c6df29d1e04772193ff0">plot_file_1</a>);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        pp.query(<span class="stringliteral">&quot;plot_file_2&quot;</span>, <a class="code" href="classREMORA.html#a6afd10f4968ef17dfe32806d62c465d4">plot_file_2</a>);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        pp.query(<span class="stringliteral">&quot;plot_int_1&quot;</span>, <a class="code" href="classREMORA.html#a3a61745803081888ac360f521a623b1b">plot_int_1</a>);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        pp.query(<span class="stringliteral">&quot;plot_int_2&quot;</span>, <a class="code" href="classREMORA.html#a1db03ec74ac9a6e94c59ed0e4a187bbb">plot_int_2</a>);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_PARTICLES</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        particleData.init_particle_params();</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4829661b558b213e32970a02e147077f">init_params</a>();</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;}</div>
<div class="ttc" id="aclassREMORA_html_a17de9bc2e49fbb1de53a5c57489d36bb"><div class="ttname"><a href="classREMORA.html#a17de9bc2e49fbb1de53a5c57489d36bb">REMORA::init_shrink</a></div><div class="ttdeci">static amrex::Real init_shrink</div><div class="ttdef"><b>Definition:</b> REMORA.H:783</div></div>
<div class="ttc" id="aclassREMORA_html_a45b928a121bd6c5e75ec75732a27f774"><div class="ttname"><a href="classREMORA.html#a45b928a121bd6c5e75ec75732a27f774">REMORA::boxes_at_level</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Box &gt; &gt; boxes_at_level</div><div class="ttdef"><b>Definition:</b> REMORA.H:727</div></div>
<div class="ttc" id="aclassREMORA_html_a4ca794481e17552667b3824252497b6a"><div class="ttname"><a href="classREMORA.html#a4ca794481e17552667b3824252497b6a">REMORA::check_file</a></div><div class="ttdeci">std::string check_file</div><div class="ttdef"><b>Definition:</b> REMORA.H:806</div></div>
<div class="ttc" id="aclassREMORA_html_a5cdf62f58282022e2d5f79de304d425f"><div class="ttname"><a href="classREMORA.html#a5cdf62f58282022e2d5f79de304d425f">REMORA::fixed_fast_dt</a></div><div class="ttdeci">static amrex::Real fixed_fast_dt</div><div class="ttdef"><b>Definition:</b> REMORA.H:788</div></div>
<div class="ttc" id="aclassREMORA_html_a5d3ceaf421e5e6ec42b4da2fcb2d610c"><div class="ttname"><a href="classREMORA.html#a5d3ceaf421e5e6ec42b4da2fcb2d610c">REMORA::regrid_int</a></div><div class="ttdeci">int regrid_int</div><div class="ttdef"><b>Definition:</b> REMORA.H:797</div></div>
<div class="ttc" id="aclassREMORA_html_a66ad489788fb8d0913833d3d6c89b9dd"><div class="ttname"><a href="classREMORA.html#a66ad489788fb8d0913833d3d6c89b9dd">REMORA::num_files_at_level</a></div><div class="ttdeci">amrex::Vector&lt; int &gt; num_files_at_level</div><div class="ttdef"><b>Definition:</b> REMORA.H:726</div></div>
<div class="ttc" id="aclassREMORA_html_a6afd10f4968ef17dfe32806d62c465d4"><div class="ttname"><a href="classREMORA.html#a6afd10f4968ef17dfe32806d62c465d4">REMORA::plot_file_2</a></div><div class="ttdeci">std::string plot_file_2</div><div class="ttdef"><b>Definition:</b> REMORA.H:801</div></div>
<div class="ttc" id="aclassREMORA_html_a6d28606118c0069a57eb6a3c13685c56"><div class="ttname"><a href="classREMORA.html#a6d28606118c0069a57eb6a3c13685c56">REMORA::num_boxes_at_level</a></div><div class="ttdeci">amrex::Vector&lt; int &gt; num_boxes_at_level</div><div class="ttdef"><b>Definition:</b> REMORA.H:725</div></div>
<div class="ttc" id="aclassREMORA_html_a784ba6c1f790c6df29d1e04772193ff0"><div class="ttname"><a href="classREMORA.html#a784ba6c1f790c6df29d1e04772193ff0">REMORA::plot_file_1</a></div><div class="ttdeci">std::string plot_file_1</div><div class="ttdef"><b>Definition:</b> REMORA.H:800</div></div>
<div class="ttc" id="aclassREMORA_html_a7f4ee77d07b875ac526da57e8f0f1e98"><div class="ttname"><a href="classREMORA.html#a7f4ee77d07b875ac526da57e8f0f1e98">REMORA::setRecordDataInfo</a></div><div class="ttdeci">void setRecordDataInfo(int i, const std::string &amp;filename)</div><div class="ttdef"><b>Definition:</b> REMORA.H:954</div></div>
<div class="ttc" id="aclassREMORA_html_a9724f153d0c7a89c5d6aec11605959aa"><div class="ttname"><a href="classREMORA.html#a9724f153d0c7a89c5d6aec11605959aa">REMORA::pp_prefix</a></div><div class="ttdeci">std::string pp_prefix</div><div class="ttdef"><b>Definition:</b> REMORA.H:181</div></div>
<div class="ttc" id="aclassREMORA_html_ade8f2985b433261b76ac1d8f28fa6d0a"><div class="ttname"><a href="classREMORA.html#ade8f2985b433261b76ac1d8f28fa6d0a">REMORA::nc_bdry_file</a></div><div class="ttdeci">static std::string nc_bdry_file</div><div class="ttdef"><b>Definition:</b> REMORA.H:846</div></div>
<div class="ttc" id="aclassREMORA_html_af0ba249e52817855bb895b47cb005227"><div class="ttname"><a href="classREMORA.html#af0ba249e52817855bb895b47cb005227">REMORA::nc_grid_file</a></div><div class="ttdeci">static amrex::Vector&lt; amrex::Vector&lt; std::string &gt; &gt; nc_grid_file</div><div class="ttdef"><b>Definition:</b> REMORA.H:843</div></div>
<div class="ttc" id="aclassREMORA_html_af7b7f34b69f804f7acd9a1bc0c7bb5b9"><div class="ttname"><a href="classREMORA.html#af7b7f34b69f804f7acd9a1bc0c7bb5b9">REMORA::nc_init_file</a></div><div class="ttdeci">static amrex::Vector&lt; amrex::Vector&lt; std::string &gt; &gt; nc_init_file</div><div class="ttdef"><b>Definition:</b> REMORA.H:842</div></div>
<div class="ttc" id="astructSolverChoice_html_a4829661b558b213e32970a02e147077f"><div class="ttname"><a href="structSolverChoice.html#a4829661b558b213e32970a02e147077f">SolverChoice::init_params</a></div><div class="ttdeci">void init_params()</div><div class="ttdef"><b>Definition:</b> DataStruct.H:43</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6da8127bba6a3636d4f5ae30983eaf9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6da8127bba6a3636d4f5ae30983eaf9c">&#9670;&nbsp;</a></span>refinement_criteria_setup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::refinement_criteria_setup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to define the refinement criteria based on user input </p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordflow">if</span> (max_level &gt; 0)</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        ParmParse pp(<a class="code" href="classREMORA.html#a9724f153d0c7a89c5d6aec11605959aa">pp_prefix</a>);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        Vector&lt;std::string&gt; refinement_indicators;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        pp.queryarr(<span class="stringliteral">&quot;refinement_indicators&quot;</span>,refinement_indicators,0,pp.countval(<span class="stringliteral">&quot;refinement_indicators&quot;</span>));</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;refinement_indicators.size(); ++i)</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            std::string ref_prefix = <a class="code" href="classREMORA.html#a9724f153d0c7a89c5d6aec11605959aa">pp_prefix</a> + <span class="stringliteral">&quot;.&quot;</span> + refinement_indicators[i];</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            ParmParse ppr(ref_prefix);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            RealBox realbox;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            <span class="keywordtype">int</span> lev_for_box;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;in_box_lo&quot;</span>)) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                std::vector&lt;Real&gt; box_lo(3), box_hi(3);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                ppr.get(<span class="stringliteral">&quot;max_level&quot;</span>,lev_for_box);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                <span class="keywordflow">if</span> (lev_for_box &lt;= max_level)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                    ppr.getarr(<span class="stringliteral">&quot;in_box_lo&quot;</span>,box_lo,0,2);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                    ppr.getarr(<span class="stringliteral">&quot;in_box_hi&quot;</span>,box_hi,0,2);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                    box_lo[2] = geom[0].ProbLo(2);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                    box_hi[2] = geom[0].ProbHi(2);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                    realbox = RealBox(&amp;(box_lo[0]),&amp;(box_hi[0]));</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Reading &quot;</span> &lt;&lt; realbox &lt;&lt; <span class="stringliteral">&quot; at level &quot;</span> &lt;&lt; lev_for_box &lt;&lt; std::endl;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                    <a class="code" href="classREMORA.html#a6d28606118c0069a57eb6a3c13685c56">num_boxes_at_level</a>[lev_for_box] += 1;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                    <span class="keyword">const</span> <span class="keyword">auto</span>* dx  = geom[lev_for_box].CellSize();</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>* plo = geom[lev_for_box].ProbLo();</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                    <span class="keywordtype">int</span> ilo = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((box_lo[0] - plo[0])/dx[0]);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                    <span class="keywordtype">int</span> jlo = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((box_lo[1] - plo[1])/dx[1]);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                    <span class="keywordtype">int</span> klo = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((box_lo[2] - plo[2])/dx[2]);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                    <span class="keywordtype">int</span> ihi = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((box_hi[0] - plo[0])/dx[0]-1);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                    <span class="keywordtype">int</span> jhi = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((box_hi[1] - plo[1])/dx[1]-1);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                    <span class="keywordtype">int</span> khi = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((box_hi[2] - plo[2])/dx[2]-1);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                    Box bx(IntVect(ilo,jlo,klo),IntVect(ihi,jhi,khi));</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                    <span class="keywordflow">if</span> ( (ilo%ref_ratio[lev_for_box-1][0] != 0) || ((ihi+1)%ref_ratio[lev_for_box-1][0] != 0) ||</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                         (jlo%ref_ratio[lev_for_box-1][1] != 0) || ((jhi+1)%ref_ratio[lev_for_box-1][1] != 0) )</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                         amrex::Error(<span class="stringliteral">&quot;Fine box is not legit with this ref_ratio&quot;</span>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                    <a class="code" href="classREMORA.html#a45b928a121bd6c5e75ec75732a27f774">boxes_at_level</a>[lev_for_box].push_back(bx);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Saving in &#39;boxes at level&#39; as &quot;</span> &lt;&lt; bx &lt;&lt; std::endl;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                } <span class="comment">// lev</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            AMRErrorTagInfo info;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <span class="keywordflow">if</span> (realbox.ok()) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                info.SetRealBox(realbox);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;start_time&quot;</span>) &gt; 0) {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> ref_min_time; ppr.get(<span class="stringliteral">&quot;start_time&quot;</span>,ref_min_time);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                info.SetMinTime(ref_min_time);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;end_time&quot;</span>) &gt; 0) {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> ref_max_time; ppr.get(<span class="stringliteral">&quot;end_time&quot;</span>,ref_max_time);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                info.SetMaxTime(ref_max_time);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;max_level&quot;</span>) &gt; 0) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                <span class="keywordtype">int</span> ref_max_level; ppr.get(<span class="stringliteral">&quot;max_level&quot;</span>,ref_max_level);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                info.SetMaxLevel(ref_max_level);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;value_greater&quot;</span>)) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                <span class="keywordtype">int</span> num_val = ppr.countval(<span class="stringliteral">&quot;value_greater&quot;</span>);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                Vector&lt;Real&gt; value(num_val);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                ppr.getarr(<span class="stringliteral">&quot;value_greater&quot;</span>,value,0,num_val);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                std::string field; ppr.get(<span class="stringliteral">&quot;field_name&quot;</span>,field);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                <a class="code" href="classREMORA.html#a476b854ad74dd35ec1bf21cd9ea1f0b0">ref_tags</a>.push_back(AMRErrorTag(value,AMRErrorTag::GREATER,field,info));</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;value_less&quot;</span>)) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                <span class="keywordtype">int</span> num_val = ppr.countval(<span class="stringliteral">&quot;value_less&quot;</span>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                Vector&lt;Real&gt; value(num_val);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                ppr.getarr(<span class="stringliteral">&quot;value_less&quot;</span>,value,0,num_val);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                std::string field; ppr.get(<span class="stringliteral">&quot;field_name&quot;</span>,field);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                <a class="code" href="classREMORA.html#a476b854ad74dd35ec1bf21cd9ea1f0b0">ref_tags</a>.push_back(AMRErrorTag(value,AMRErrorTag::LESS,field,info));</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;adjacent_difference_greater&quot;</span>)) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                <span class="keywordtype">int</span> num_val = ppr.countval(<span class="stringliteral">&quot;adjacent_difference_greater&quot;</span>);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                Vector&lt;Real&gt; value(num_val);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                ppr.getarr(<span class="stringliteral">&quot;adjacent_difference_greater&quot;</span>,value,0,num_val);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                std::string field; ppr.get(<span class="stringliteral">&quot;field_name&quot;</span>,field);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                <a class="code" href="classREMORA.html#a476b854ad74dd35ec1bf21cd9ea1f0b0">ref_tags</a>.push_back(AMRErrorTag(value,AMRErrorTag::GRAD,field,info));</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (realbox.ok())</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                <a class="code" href="classREMORA.html#a476b854ad74dd35ec1bf21cd9ea1f0b0">ref_tags</a>.push_back(AMRErrorTag(info));</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                Abort(std::string(<span class="stringliteral">&quot;Unrecognized refinement indicator for &quot;</span> + refinement_indicators[i]).c_str());</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        } <span class="comment">// loop over criteria</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    } <span class="comment">// if max_level &gt; 0</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a73eb64a4ad24a247692981eae835caf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73eb64a4ad24a247692981eae835caf2">&#9670;&nbsp;</a></span>RemakeLevel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::RemakeLevel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::BoxArray &amp;&#160;</td>
          <td class="paramname"><em>ba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::DistributionMapping &amp;&#160;</td>
          <td class="paramname"><em>dm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Remake an existing level using provided BoxArray and DistributionMapping and fill with existing fine and coarse data. Overrides the pure virtual function in AmrCore </p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#if (NGROW==2)</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordtype">int</span> ngrow_state = <a class="code" href="classREMORA.html#a3be29f45efb0b259995c494f6dac2b97">ComputeGhostCells</a>(<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8e053ce39997ed619ac81aa4d5a1fd44">spatial_order</a>)+1;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordtype">int</span> ngrow_vels  = <a class="code" href="classREMORA.html#a3be29f45efb0b259995c494f6dac2b97">ComputeGhostCells</a>(<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8e053ce39997ed619ac81aa4d5a1fd44">spatial_order</a>)+1;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordtype">int</span> ngrow_state = <a class="code" href="classREMORA.html#a3be29f45efb0b259995c494f6dac2b97">ComputeGhostCells</a>(<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8e053ce39997ed619ac81aa4d5a1fd44">spatial_order</a>)+2;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordtype">int</span> ngrow_vels  = <a class="code" href="classREMORA.html#a3be29f45efb0b259995c494f6dac2b97">ComputeGhostCells</a>(<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8e053ce39997ed619ac81aa4d5a1fd44">spatial_order</a>)+2;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    MultiFab* tmp_cons_new; tmp_cons_new-&gt;define(ba, dm, <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>, ngrow_state);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    MultiFab* tmp_cons_old; tmp_cons_old-&gt;define(ba, dm, <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>, ngrow_state);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    MultiFab* tmp_xvel_new; tmp_xvel_new-&gt;define(convert(ba, IntVect(1,0,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    MultiFab* tmp_xvel_old; tmp_xvel_old-&gt;define(convert(ba, IntVect(1,0,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    MultiFab* tmp_yvel_new; tmp_yvel_new-&gt;define(convert(ba, IntVect(0,1,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    MultiFab* tmp_yvel_old; tmp_yvel_old-&gt;define(convert(ba, IntVect(0,1,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    MultiFab* tmp_zvel_new; tmp_zvel_new-&gt;define(convert(ba, IntVect(0,0,1)), dm, 1, IntVect(ngrow_vels,ngrow_vels,0));</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    MultiFab* tmp_zvel_old; tmp_zvel_old-&gt;define(convert(ba, IntVect(0,0,1)), dm, 1, IntVect(ngrow_vels,ngrow_vels,0));</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">// This will fill the temporary MultiFabs with data from previous fine data as well as coarse where needed</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *tmp_cons_new, <a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325abd1c55aaa78d7bcedd3a0e21005f2955">BdyVars::t</a>);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *tmp_xvel_new, <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">BdyVars::u</a>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *tmp_yvel_new, <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">BdyVars::v</a>);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *tmp_zvel_new, <a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325ab738c65b8fa93b2166002dce928aca27">BdyVars::null</a>);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    MultiFab::Copy(*tmp_cons_old,*tmp_cons_new,0,0,<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>,tmp_cons_new[lev].nGrowVect());</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    MultiFab::Copy(*tmp_xvel_old,*tmp_xvel_new,0,0,   1,tmp_xvel_new[lev].nGrowVect());</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    MultiFab::Copy(*tmp_yvel_old,*tmp_yvel_new,0,0,   1,tmp_yvel_new[lev].nGrowVect());</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    MultiFab::Copy(*tmp_zvel_old,*tmp_zvel_new,0,0,   1,tmp_zvel_new[lev].nGrowVect());</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    std::swap(tmp_cons_new, <a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev]);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    std::swap(tmp_cons_old, <a class="code" href="classREMORA.html#abc6ebdcc84239b993b12b3c95425fa88">cons_old</a>[lev]);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    std::swap(tmp_xvel_new, <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev]);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    std::swap(tmp_xvel_old, <a class="code" href="classREMORA.html#a51594dd103a7eee0f4e0c6e366d9f0ce">xvel_old</a>[lev]);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    std::swap(tmp_yvel_new, <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev]);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    std::swap(tmp_yvel_old, <a class="code" href="classREMORA.html#a9861cf91ee53fb2125f5f49c5cf73155">yvel_old</a>[lev]);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    std::swap(tmp_zvel_new, <a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[lev]);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    std::swap(tmp_zvel_old, <a class="code" href="classREMORA.html#a6a980b1cd1d4d0e1253a641bee00de75">zvel_old</a>[lev]);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev] = time;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="classREMORA.html#ae94018d43dcebc3cd70293e6c621c46a">t_old</a>[lev] = time - 1.e200;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="classREMORA.html#a98ad64e4a964e4748ebae07a26405286">init_stuff</a>(lev, ba, dm);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6f50a7999b5955331392139cfb09ad27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f50a7999b5955331392139cfb09ad27">&#9670;&nbsp;</a></span>remora_advance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::remora_advance </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>cons_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>cons_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>xvel_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>yvel_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>zvel_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>xvel_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>yvel_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>zvel_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Geometry&#160;</td>
          <td class="paramname"><em>fine_geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Interface for advancing the data at one level by one "slow" timestep </p>

</div>
</div>
<a id="aa91decb04550c58b177e6a18b9d70f0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa91decb04550c58b177e6a18b9d70f0d">&#9670;&nbsp;</a></span>resize_stuff()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::resize_stuff </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;{</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="classREMORA.html#ac956bf3a52181b34d3e98a85ea5ba131">vec_z_phys_nd</a>.resize(lev+1);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="classREMORA.html#a157e7645fedcf8c0b46516dbb625d3bd">vec_hOfTheConfusingName</a>.resize(lev+1);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="classREMORA.html#adeb60c66ba4665f07c57fbf3b3b8909a">vec_Zt_avg1</a>.resize(lev+1);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="classREMORA.html#afc9f775b64d67d4ad85bc493c9c54f4f">vec_s_r</a>.resize(lev+1);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="classREMORA.html#af7958bb9cfac605c91f1e74357f344b2">vec_z_w</a>.resize(lev+1);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="classREMORA.html#a6b24784c109d216c5a6cee02af8c5b0f">vec_z_r</a>.resize(lev+1);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="classREMORA.html#ab86841fb3954bcabcb79275416c46253">vec_y_r</a>.resize(lev+1);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="classREMORA.html#a55ca3c497c355a95a82bfbacf955771e">vec_x_r</a>.resize(lev+1);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="classREMORA.html#a488738b1aea61abbbf086a9d22b4f815">vec_Hz</a>.resize(lev+1);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="classREMORA.html#a89f042895cd59cc1a1226f2af2d3e04f">vec_Huon</a>.resize(lev+1);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="classREMORA.html#afd1aab14dfc9155d65e48aad2b34ef42">vec_Hvom</a>.resize(lev+1);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="classREMORA.html#ad36ee94716ca0cde00d8cad5fe5cce94">vec_Akv</a>.resize(lev+1);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="classREMORA.html#a48c1bf42530780ce02b3655d7cefe592">vec_Akt</a>.resize(lev+1);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="classREMORA.html#aae58396940a8e44b9b8aa4b6ec6e878f">vec_visc3d_r</a>.resize(lev+1);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="classREMORA.html#a65281506759b30fbc3c382ba0a64f38f">vec_visc2_p</a>.resize(lev+1);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="classREMORA.html#a86f0a2458c28f42d5be178d7bc5d104b">vec_visc2_r</a>.resize(lev+1);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="classREMORA.html#afdf4b75f0ec12caf3648dbee5ec7f653">vec_diff2</a>.resize(lev+1);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="classREMORA.html#aaf06acc3074f6a4dd322f9e1ca0c5244">vec_ru</a>.resize(lev+1);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <a class="code" href="classREMORA.html#ae4e70f2661f28e3a3a2585540e804486">vec_rv</a>.resize(lev+1);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="classREMORA.html#a5a0dd90f9e35c6055bf3ede53f4229d6">vec_rufrc</a>.resize(lev+1);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <a class="code" href="classREMORA.html#a49ea2c6c379a0fa006e4b6023fd69f88">vec_rvfrc</a>.resize(lev+1);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="classREMORA.html#a347a75f9295217fc66a8b7a4c2a47f9b">vec_sustr</a>.resize(lev+1);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="classREMORA.html#a88a26701f7276ea04f5c9ede4ae46981">vec_svstr</a>.resize(lev+1);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="classREMORA.html#adba780a7c66c2158c914bff64964df60">vec_rdrag</a>.resize(lev+1);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="classREMORA.html#abd341c53d0813eaea345511b8e14afdd">vec_bustr</a>.resize(lev+1);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="classREMORA.html#ac7d186a8a4d54c28a5b2eecaec6cb978">vec_bvstr</a>.resize(lev+1);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="classREMORA.html#ab8e2ff918dcaf20a807b37e88f9fdbb0">vec_DU_avg1</a>.resize(lev+1);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="classREMORA.html#a1b2cc0f2f617e846c6261df12aefd110">vec_DU_avg2</a>.resize(lev+1);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="classREMORA.html#a9e0560b2f68b9c541583c9c1ff6c87ec">vec_DV_avg1</a>.resize(lev+1);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="classREMORA.html#ac5ba663380c2e7b3857e21fd0d4286f9">vec_DV_avg2</a>.resize(lev+1);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="classREMORA.html#a15b7ca3e79155dde5c648ac78d64e6c7">vec_rubar</a>.resize(lev+1);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="classREMORA.html#a66a39d31a3a2f027101cfd4052b913f3">vec_rvbar</a>.resize(lev+1);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="classREMORA.html#ac8c001dd94aa7fb806502579324905fd">vec_rzeta</a>.resize(lev+1);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="classREMORA.html#abb214b8bab178b72c44907f5e2aeead8">vec_ubar</a>.resize(lev+1);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="classREMORA.html#ab70c8d3ac0d8a5f7ac51365571905874">vec_vbar</a>.resize(lev+1);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="classREMORA.html#ab60f476961622f8e7f27221595e84956">vec_zeta</a>.resize(lev+1);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="classREMORA.html#a3d55e55c73497ceabf620dacbe632a3a">vec_sstore</a>.resize(lev+1);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="classREMORA.html#a173014aa6947dd9d4e0026541211f2be">vec_pm</a>.resize(lev+1);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="classREMORA.html#ad2d61f66b270a3def972bf32478790d8">vec_pn</a>.resize(lev+1);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="classREMORA.html#a13f9894ec6aca96e68687e7a6762e337">vec_fcor</a>.resize(lev+1);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="classREMORA.html#a8386c899de7b3b3feab286c144f15229">vec_rhoS</a>.resize(lev+1);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="classREMORA.html#a9acf62fad9b709ea10e00e9534d7a7c5">vec_rhoA</a>.resize(lev+1);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="classREMORA.html#a6b32e42c790f2f3ac55ce545c2d03314">mapfac_m</a>.resize(lev+1);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <a class="code" href="classREMORA.html#a5d56f29784bbca12778ba7c58fa0f36d">mapfac_u</a>.resize(lev+1);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="classREMORA.html#aa30c202e051228d1936a521eedcd6957">mapfac_v</a>.resize(lev+1);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af82928444cae433cc744c0cf7427e8eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af82928444cae433cc744c0cf7427e8eb">&#9670;&nbsp;</a></span>restart()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::restart </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Restart </p>
<div class="fragment"><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;{</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="classREMORA.html#a316a6db4c0b9a218e834c054d8c8f437">ReadCheckpointFile</a>();</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">// We set this here so that we don&#39;t over-write the checkpoint file we just started from</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <a class="code" href="classREMORA.html#a70585b0129bfb5d405b1e10ea97020c5">last_check_file_step</a> = <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[0];</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;}</div>
<div class="ttc" id="aclassREMORA_html_a316a6db4c0b9a218e834c054d8c8f437"><div class="ttname"><a href="classREMORA.html#a316a6db4c0b9a218e834c054d8c8f437">REMORA::ReadCheckpointFile</a></div><div class="ttdeci">void ReadCheckpointFile()</div><div class="ttdef"><b>Definition:</b> Checkpoint.cpp:214</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aec60535e082a13276ce2334170205171"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec60535e082a13276ce2334170205171">&#9670;&nbsp;</a></span>rho_eos()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::rho_eos </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhoA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhoS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>z_w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>rho_eos</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bx</td><td>box for calculation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">state</td><td>state holds temp, salt </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rho</td><td>density </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rhoA</td><td>vertically-averaged density </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rhoS</td><td>density perturbation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Hz</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z_w</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td></td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    AMREX_ASSERT(bx.smallEnd(2) == 0 &amp;&amp; bx.bigEnd(2) == N);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">//  Linear equation of state.</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//  Compute &quot;in situ&quot; density anomaly (kg/m3 - 1000) using the linear</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//  equation of state.</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> R0 = <a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a7f081843ab68cd0a410afd74a27dfc30">R0</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> S0 = <a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#af8337b0c99a50300e9880db3e8296d91">S0</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> T0 = <a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab66cd9af0320c884173b77917e1dcf82">T0</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Tcoef = <a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a45cf7364024323178dd5f67d3996e9ef">Tcoef</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Scoef = <a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#ae8dbad91ad7a9be8eb4c2db5a62f5c47">Scoef</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        rho(i,j,k)  = R0 - R0*Tcoef*(state(i,j,k,<a class="code" href="IndexDefines_8H.html#a2439ff23f4449b8ffa90ddc5bcb36173">Temp_comp</a>)-T0)</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                         + R0*Scoef*(state(i,j,k,<a class="code" href="IndexDefines_8H.html#ab84ceec196f4b00670dab4fa7794d1cf">Salt_comp</a>)-S0)</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                         - 1000.0_rt;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    });</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//  Compute vertical averaged density (rhoA) and density perturbation</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">//  used (rhoS) in barotropic pressure gradient.</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2 =1.0_rt/<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a87396b485f47a76010673143372cca17">rho0</a>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    ParallelFor(makeSlab(bx,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff0 = rho(i,j,N)*Hz(i,j,N);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        rhoS(i,j,0) = 0.5_rt*cff0*Hz(i,j,N);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        rhoA(i,j,0) = cff0;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt;= N; ++k) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=rho(i,j,N-k)*Hz(i,j,N-k);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            rhoS(i,j,0) += Hz(i,j,N-k)*(rhoA(i,j,0)+0.5_rt*cff1);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            rhoA(i,j,0) += cff1;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff11 =1.0_rt/(z_w(i,j,N)+h(i,j,0,0));</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        rhoA(i,j,0) *= cff2*cff11;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        rhoS(i,j,0) *= 2.0_rt*cff11*cff11*cff2;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    });</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div>
<div class="ttc" id="astructSolverChoice_html_a45cf7364024323178dd5f67d3996e9ef"><div class="ttname"><a href="structSolverChoice.html#a45cf7364024323178dd5f67d3996e9ef">SolverChoice::Tcoef</a></div><div class="ttdeci">amrex::Real Tcoef</div><div class="ttdef"><b>Definition:</b> DataStruct.H:225</div></div>
<div class="ttc" id="astructSolverChoice_html_a7f081843ab68cd0a410afd74a27dfc30"><div class="ttname"><a href="structSolverChoice.html#a7f081843ab68cd0a410afd74a27dfc30">SolverChoice::R0</a></div><div class="ttdeci">amrex::Real R0</div><div class="ttdef"><b>Definition:</b> DataStruct.H:222</div></div>
<div class="ttc" id="astructSolverChoice_html_ab66cd9af0320c884173b77917e1dcf82"><div class="ttname"><a href="structSolverChoice.html#ab66cd9af0320c884173b77917e1dcf82">SolverChoice::T0</a></div><div class="ttdeci">amrex::Real T0</div><div class="ttdef"><b>Definition:</b> DataStruct.H:224</div></div>
<div class="ttc" id="astructSolverChoice_html_ae8dbad91ad7a9be8eb4c2db5a62f5c47"><div class="ttname"><a href="structSolverChoice.html#ae8dbad91ad7a9be8eb4c2db5a62f5c47">SolverChoice::Scoef</a></div><div class="ttdeci">amrex::Real Scoef</div><div class="ttdef"><b>Definition:</b> DataStruct.H:226</div></div>
<div class="ttc" id="astructSolverChoice_html_af8337b0c99a50300e9880db3e8296d91"><div class="ttname"><a href="structSolverChoice.html#af8337b0c99a50300e9880db3e8296d91">SolverChoice::S0</a></div><div class="ttdeci">amrex::Real S0</div><div class="ttdef"><b>Definition:</b> DataStruct.H:223</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a11e1383c91ab5a3df346a41a8b7338e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11e1383c91ab5a3df346a41a8b7338e0">&#9670;&nbsp;</a></span>rhs_t_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::rhs_t_3d </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>gbx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>tempstore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>Huon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>Hvom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>pn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>pm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>FC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>rhs_t_3d</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">gbx</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sstore</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Huon</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Hvom</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Hz</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pn</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pm</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">W</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">FC</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nrhs</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnew</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt_lev</td><td></td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;{</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">//copy the tilebox</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    Box tbxp1 = bx;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    Box tbxp2 = bx;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">//make only gbx be grown to match multifabs</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    tbxp2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    tbxp1.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">// Because grad, curv, FX, FE, are all local, do surroundinNodes</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    Box utbxp1 = surroundingNodes(tbxp1, 0);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    Box vtbxp1 = surroundingNodes(tbxp1, 1);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    Box ubx = surroundingNodes(bx, 0);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    Box vbx = surroundingNodes(bx, 1);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    BoxArray ba_gbx1 = intersect(BoxArray(tbxp1),gbx);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    AMREX_ASSERT((ba_gbx1.size() == 1));</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">// Scratch space</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    FArrayBox fab_grad(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    FArrayBox fab_curv(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    FArrayBox fab_FX(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    FArrayBox fab_FE(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keyword">auto</span> curv=fab_curv.array();</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keyword">auto</span> grad=fab_grad.array();</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keyword">auto</span> FX=fab_FX.array();</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keyword">auto</span> FE=fab_FE.array();</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    fab_grad.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    fab_curv.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    fab_FX.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    fab_FE.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    ParallelFor(utbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="comment">//should be t index 3</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        FX(i,j,k)=sstore(i,j,k,nrhs)-sstore(i-1,j,k,nrhs);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    });</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cffa=1.0_rt/6.0_rt;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cffb=1.0_rt/3.0_rt;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a57e1d7e053fa63774c4c44980272031a">flat_bathymetry</a>) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">Hadv_scheme</a> == <a class="code" href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca5b2d34872c0b46cfbabc832368e6ec7d">AdvectionScheme::upstream3</a>) {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            ParallelFor(tbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                <span class="comment">//Upstream3</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                curv(i,j,k)=-FX(i,j,k)+FX(i+1,j,k);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            });</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            ParallelFor(ubx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> max_Huon = std::max(Huon(i,j,k),0.0_rt);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> min_Huon = std::min(Huon(i,j,k),0.0_rt);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                FX(i,j,k)=Huon(i,j,k)*0.5*(sstore(i,j,k)+sstore(i-1,j,k))+</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                    cffa*(curv(i,j,k)*min_Huon+ curv(i-1,j,k)*max_Huon);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            });</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">Hadv_scheme</a> == <a class="code" href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca6d779455e4a7eebf97d6bcb893dd5235">AdvectionScheme::centered4</a>) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            ParallelFor(tbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                <span class="comment">//Centered4</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                grad(i,j,k)=0.5*(FX(i,j,k)+FX(i+1,j,k));</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            });</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            ParallelFor(ubx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                FX(i,j,k)=Huon(i,j,k)*0.5*(sstore(i,j,k)+sstore(i-1,j,k))+</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                    cffb*(grad(i,j,k)+ grad(i-1,j,k));</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            });</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            Error(<span class="stringliteral">&quot;Not a valid horizontal advection scheme&quot;</span>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">Hadv_scheme</a> == <a class="code" href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca5b2d34872c0b46cfbabc832368e6ec7d">AdvectionScheme::upstream3</a>) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            ParallelFor(tbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                <span class="comment">//Upstream3</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                curv(i,j,k)=-FX(i,j,k)+FX(i+1,j,k);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            });</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="comment">//HACK to avoid using the wrong index of t (using upstream3)</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            ParallelFor(ubx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> max_Huon = std::max(Huon(i,j,k),0.0_rt);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> min_Huon = std::min(Huon(i,j,k),0.0_rt);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                FX(i,j,k)=Huon(i,j,k)*0.5*(sstore(i,j,k)+sstore(i-1,j,k))-</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                    cffa*(curv(i,j,k)*min_Huon+ curv(i-1,j,k)*max_Huon);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            });</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">Hadv_scheme</a> == <a class="code" href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca6d779455e4a7eebf97d6bcb893dd5235">AdvectionScheme::centered4</a>) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            ParallelFor(tbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                <span class="comment">//Centered4</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                grad(i,j,k)=0.5*(FX(i,j,k)+FX(i+1,j,k));</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            });</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            ParallelFor(ubx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                FX(i,j,k)=Huon(i,j,k)*0.5*(sstore(i,j,k)+sstore(i-1,j,k)-</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                                           cffb*(grad(i,j,k)- grad(i-1,j,k)));</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            });</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            Error(<span class="stringliteral">&quot;Not a valid horizontal advection scheme&quot;</span>);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    } <span class="comment">// flat bathymetry?</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    ParallelFor(vtbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="comment">//should be t index 3</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        FE(i,j,k)=sstore(i,j,k,nrhs)-sstore(i,j-1,k,nrhs);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    });</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    cffa=1.0_rt/6.0_rt;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    cffb=1.0_rt/3.0_rt;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a57e1d7e053fa63774c4c44980272031a">flat_bathymetry</a>) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">Hadv_scheme</a> == <a class="code" href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca5b2d34872c0b46cfbabc832368e6ec7d">AdvectionScheme::upstream3</a>) {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            ParallelFor(tbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                curv(i,j,k)=-FE(i,j,k)+FE(i,j+1,k);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            });</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            ParallelFor(vbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> max_Hvom = std::max(Hvom(i,j,k),0.0_rt);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> min_Hvom = std::min(Hvom(i,j,k),0.0_rt);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                FE(i,j,k)=Hvom(i,j,k)*0.5*(sstore(i,j,k)+sstore(i,j-1,k))+</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                    cffa*(curv(i,j,k)*min_Hvom+ curv(i,j-1,k)*max_Hvom);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            });</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">Hadv_scheme</a> == <a class="code" href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca6d779455e4a7eebf97d6bcb893dd5235">AdvectionScheme::centered4</a>) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            ParallelFor(tbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                grad(i,j,k)=0.5*(FE(i,j,k)+FE(i,j+1,k));</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            });</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            ParallelFor(vbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                FE(i,j,k)=Hvom(i,j,k)*0.5*(sstore(i,j,k)+sstore(i,j-1,k))+</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                    cffb*(grad(i,j,k)+ grad(i,j-1,k));</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            });</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            Error(<span class="stringliteral">&quot;Not a valid horizontal advection scheme&quot;</span>);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">Hadv_scheme</a> == <a class="code" href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca5b2d34872c0b46cfbabc832368e6ec7d">AdvectionScheme::upstream3</a>) {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            ParallelFor(tbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                curv(i,j,k)=-FE(i,j,k)+FE(i,j+1,k);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            });</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            ParallelFor(vbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> max_Hvom = std::max(Hvom(i,j,k),0.0_rt);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> min_Hvom = std::min(Hvom(i,j,k),0.0_rt);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                FE(i,j,k)=Hvom(i,j,k)*0.5*(sstore(i,j,k)+sstore(i,j-1,k))-</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                    cffa*(curv(i,j,k)*min_Hvom+ curv(i,j-1,k)*max_Hvom);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            });</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">Hadv_scheme</a> == <a class="code" href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca6d779455e4a7eebf97d6bcb893dd5235">AdvectionScheme::centered4</a>) {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            ParallelFor(tbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                grad(i,j,k)=0.5*(FE(i,j,k)+FE(i,j+1,k));</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            });</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            ParallelFor(vbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                FE(i,j,k)=Hvom(i,j,k)*0.5*(sstore(i,j,k)+sstore(i,j-1,k)-</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                           cffb*(grad(i,j,k)- grad(i,j-1,k)));</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            });</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            Error(<span class="stringliteral">&quot;Not a valid horizontal advection scheme&quot;</span>);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    ParallelFor(bx,</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;          <span class="comment">//  Add in horizontal advection.</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = dt_lev*pm(i,j,0)*pn(i,j,0);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=cff*(FX(i+1,j,k)-FX(i,j,k));</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2=cff*(FE(i,j+1,k)-FE(i,j,k));</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff3=cff1+cff2;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;          <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325abd1c55aaa78d7bcedd3a0e21005f2955">t</a>(i,j,k,nnew) -= cff3;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    });</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">//  Time-step vertical advection term.</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">//Check which type of differences:</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">//  Fourth-order, central differences vertical advective flux</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">//  (Tunits m3/s).</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;              <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;              <span class="comment">//  Add in vertical advection.</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;              <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;              <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=0.5_rt;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;              <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2=7.0_rt/12.0_rt;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;              <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff3=1.0_rt/12.0_rt;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;              <span class="keywordflow">if</span> (k&gt;=1 &amp;&amp; k&lt;=N-2)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;              {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                      FC(i,j,k)=( cff2*(sstore(i  ,j,k  )+ sstore(i,j,k+1))</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                                 -cff3*(sstore(i  ,j,k-1)+ sstore(i,j,k+2)) ) * ( W(i,j,k));</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;              } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                  FC(i,j,N)=0.0_rt;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                  FC(i,j,N-1)=( cff2*sstore(i  ,j,N-1)+ cff1*sstore(i,j,N  )</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                               -cff3*sstore(i  ,j,N-2) ) * ( W(i  ,j,N-1));</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                  FC(i,j,0)=( cff2*sstore(i  ,j,1)+ cff1*sstore(i,j,0)</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                             -cff3*sstore(i  ,j,2) ) * ( W(i  ,j,0));</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;              }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    });</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=dt_lev*pm(i,j,0)*pn(i,j,0);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff4;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keywordflow">if</span>(k-1&gt;=0) {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            cff4=FC(i,j,k)-FC(i,j,k-1);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            cff4=FC(i,j,k);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325abd1c55aaa78d7bcedd3a0e21005f2955">t</a>(i,j,k) = (<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325abd1c55aaa78d7bcedd3a0e21005f2955">t</a>(i,j,k)-cff1*cff4) / Hz(i,j,k);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    });</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a08a2748cf44d3e95d08a1b78aef3d15f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08a2748cf44d3e95d08a1b78aef3d15f">&#9670;&nbsp;</a></span>rhs_uv_2d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::rhs_uv_2d </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>xbx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>ybx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>uold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>vold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>ru</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>rv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>Duon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>Dvom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nrhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>rhs_uv_2d</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xbx</td><td>Box for operations on x-velocity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ybx</td><td>Box for operations on y-velocity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ubar</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vbar</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rhs_ubar</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rhs_vbar</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DUon</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DVom</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">krhs</td><td></td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;{</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">// Scratch space</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    FArrayBox fab_UFx(growLo(xbx,0,1),1,amrex::The_Async_Arena()); fab_UFx.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    FArrayBox fab_UFe(growHi(xbx,1,1),1,amrex::The_Async_Arena()); fab_UFe.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    FArrayBox fab_VFe(growLo(ybx,1,1),1,amrex::The_Async_Arena()); fab_VFe.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    FArrayBox fab_VFx(growHi(ybx,0,1),1,amrex::The_Async_Arena()); fab_VFx.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keyword">auto</span> UFx=fab_UFx.array();</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keyword">auto</span> UFe=fab_UFe.array();</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keyword">auto</span> VFx=fab_VFx.array();</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keyword">auto</span> VFe=fab_VFe.array();</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">// *************************************************************</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// UPDATING U</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">// *************************************************************</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">// Think of the cell-centered box as                              [ 0:nx-1, 0:ny-1] (0,0,0) cc</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">// xbx is the x-face-centered box on which we update ubar (with rhs_ubar)  [ 0:nx  , 0:ny-1] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">//   to do so requires                                           UFx on    [-1:nx  , 0:ny-1] (0,0,0) cc</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">//      which requires                                           ubar on   [-2:nx+2, 0:ny-1] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">//       and  requires                                           DUon on   [-2:nx+2, 0:ny-1] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">//   to do so requires                                           UFe on    [ 0:nx  , 0:ny  ] (1,1,0) xy-nodes</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">//      which requires                                           ubar on   [ 0:nx  ,-2:ny+1] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">//       and  requires                                           DVom on   [-2:nx+1, 0:ny-1] (0,1,0) y-faces</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="comment">// Define UFx, the x-fluxes at cell centers for updating u</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">// (Note that grow arguments are (bx, dir, ng)</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    ParallelFor(growLo(xbx,0,1),</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> uxx_i   = <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i-1,j,0,krhs)-2.0*<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i  ,j,0,krhs)+<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i+1,j,0,krhs);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> uxx_ip1 = <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i  ,j,0,krhs)-2.0*<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i+1,j,0,krhs)+<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i+2,j,0,krhs);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> uxx_avg = uxx_i + uxx_ip1;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Huxx_i   = DUon(i-1,j,0)-2.0*DUon(i  ,j,0)+DUon(i+1,j,0);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Huxx_ip1 = DUon(i  ,j,0)-2.0*DUon(i+1,j,0)+DUon(i+2,j,0);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff=1.0/6.0;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> ubar_avg = <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i  ,j,0,krhs)+<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i+1,j,0,krhs);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        UFx(i,j,0)=0.25*(ubar_avg-cff*uxx_avg) * (DUon(i,j,0)+ DUon(i+1,j,0)-cff*(Huxx_i+ Huxx_ip1));</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    });</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">// Define UFe, the y-fluxes at nodes for updating u</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    ParallelFor(growHi(xbx,1,1),</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="comment">//should not include grow cells</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> uee_j   = <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i,j-1,0,krhs)-2.0*<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i,j  ,0,krhs)+<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i,j+1,0,krhs);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> uee_jm1 = <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i,j-2,0,krhs)-2.0*<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i,j-1,0,krhs)+<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i,j  ,0,krhs);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> uee_avg = uee_j + uee_jm1;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Hvxx_i   = DVom(i-1,j,0)-2.0*DVom(i  ,j,0)+DVom(i+1,j,0);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Hvxx_im1 = DVom(i-2,j,0)-2.0*DVom(i-1,j,0)+DVom(i  ,j,0);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff=1.0/6.0;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i,j  ,0,krhs)+<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i,j-1,0,krhs);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2=DVom(i,j,0)+DVom(i-1,j,0);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        UFe(i,j,0)=0.25*(cff1-uee_avg*cff)*</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;          (cff2-cff*(Hvxx_i+Hvxx_im1));</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    });</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">//  Add in horizontal advection.</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    ParallelFor(makeSlab(xbx,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;         <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=UFx(i,j  ,0)-UFx(i-1,j,0);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;         <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2=UFe(i,j+1,0)-UFe(i  ,j,0);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;         rhs_ubar(i,j,0) -= (cff1 + cff2);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    });</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// *************************************************************</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// UPDATING V</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">// *************************************************************</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">// Think of the cell-centered box as                              [ 0:nx-1, 0:ny-1] (0,0,0) cc</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">// ybx is the y-face-centered box on which we update vbar (with rhs_vbar)  [ 0:nx-1, 0:ny  ] (1,0,0)  y-faces</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">//   to do so requires                                  VFe on    [ 0:nx-1,-1:ny  ] (1,1,0)  xy-nodes</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">//      which requires                                    vbar on [ 0:nx-1,-2:ny+2] (1,0,0)  y-faces</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">//       and  requires                                    DVom on [ 0:nx-1,-2:ny+2] (0,1,0)  x-faces</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">//   to do so requires                                  VFx on    [ 0:nx  , 0:ny  ] (0,0,0)  cc</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">//      which requires                                    vbar on [-2:nx+1, 0:ny  ] (1,0,0)  y-faces</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">//       and  requires                                    DUon on [ 0:nx-1,-2:ny+1] (0,0,0)  y-faces</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">// Grow ybx by one in high x-direction</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    ParallelFor(growHi(ybx,0,1),</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff=1.0/6.0;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> vxx_i   = <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i-1,j,0,krhs)-2.0*<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i  ,j,0,krhs)+<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i+1,j,0,krhs);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> vxx_im1 = <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i-2,j,0,krhs)-2.0*<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i-1,j,0,krhs)+<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i  ,j,0,krhs);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> vxx_avg = vxx_i + vxx_im1;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="comment">//auto vxx_im1 = (i == gbx1.smallEnd(0)) ? vxx(i-1,j,k) :</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="comment">//    (vbar(i-2,j,0,krhs)-2.0*vbar(i-1,j,0,krhs)+vbar(i,j,0,krhs));</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="comment">//neglecting terms about periodicity since testing only periodic for now</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Huee_j   = DUon(i,j-1,0)-2.0*DUon(i,j  ,0)+DUon(i,j+1,0);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Huee_jm1 = DUon(i,j-2,0)-2.0*DUon(i,j-1,0)+DUon(i,j  ,0);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i  ,j,0,krhs)+<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i-1,j,0,krhs);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2=DUon(i,j,0)+DUon(i,j-1,0);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="comment">//auto Huee_jm1 = (j == gbx1.smallEnd(1)) ? Huee(i,j-1,k) :</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="comment">//    (DUon(i,j-2,k)-2.0*DUon(i,j-1,k)+DUon(i,j,k));</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        VFx(i,j,0)=0.25*(cff1-vxx_avg*cff)* (cff2-cff*(Huee_j+ Huee_jm1));</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    });</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    ParallelFor(growLo(ybx,1,1),</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> vee_j    = <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i,j-1,0,krhs)-2.0*<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i,j  ,0,krhs)+<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i,j+1,0,krhs);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> vee_jp1  = <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i,j  ,0,krhs)-2.0*<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i,j+1,0,krhs)+<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i,j+2,0,krhs);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> vee_avg  = vee_j + vee_jp1;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Hvee_j   = DVom(i,j-1,0)-2.0*DVom(i,j  ,0)+DVom(i,j+1,0);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Hvee_jp1 = DVom(i,j  ,0)-2.0*DVom(i,j+1,0)+DVom(i,j+2,0);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff=1.0/6.0;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i,j  ,0,krhs)+<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i,j+1,0,krhs);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        VFe(i,j,0) = 0.25 * (cff1-vee_avg*cff) * (DVom(i,j  ,0)+ DVom(i,j+1,0) -</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                                           cff  * (Hvee_j+ Hvee_jp1));</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    });</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    ParallelFor(makeSlab(ybx,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=VFx(i+1,j,0)-VFx(i  ,j,0);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2=VFe(i  ,j,0)-VFe(i,j-1,0);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        rhs_vbar(i,j,0) -= (cff1 + cff2);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    });</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a717b3cb13872e3c7bf83261bc7c5e1b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a717b3cb13872e3c7bf83261bc7c5e1b0">&#9670;&nbsp;</a></span>rhs_uv_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::rhs_uv_3d </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>xbx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>ybx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>uold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>vold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>ru</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>rv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>rufrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>rvfrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>sustr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>svstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>bustr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>bvstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>Huon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>Hvom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>pm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>pn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>FC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculation of the RHS</p>
<p>rhs_uv_2d</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xbx</td><td>Box for operations on x-velocity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ybx</td><td>Box for operations on y-velocity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">uold</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vold</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ru</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rv</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rufrc</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rvfrc</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sustr</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">svstr</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bustr</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bvstr</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Huon</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Hvom</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pm</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pn</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">W</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">FC</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nrhs</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td></td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;{</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">// Scratch space</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    FArrayBox fab_UFx(growLo(xbx,0,1),1,amrex::The_Async_Arena()); fab_UFx.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    FArrayBox fab_UFe(growHi(xbx,1,1),1,amrex::The_Async_Arena()); fab_UFe.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    FArrayBox fab_VFe(growLo(ybx,1,1),1,amrex::The_Async_Arena()); fab_VFe.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    FArrayBox fab_VFx(growHi(ybx,0,1),1,amrex::The_Async_Arena()); fab_VFx.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keyword">auto</span> UFx=fab_UFx.array();</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keyword">auto</span> UFe=fab_UFe.array();</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keyword">auto</span> VFx=fab_VFx.array();</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keyword">auto</span> VFe=fab_VFe.array();</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">//check this////////////</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Gadv = -0.25;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">// *************************************************************</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">// UPDATING U</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">// *************************************************************</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">// Think of the cell-centered box as                              [ 0:nx-1, 0:ny-1] (0,0,0) cc</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// xbx is the x-face-centered box on which we update u (with ru)  [ 0:nx  , 0:ny-1] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">//   to do so requires                                  UFx on    [-1:nx  , 0:ny-1] (0,0,0) cc</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">//      which requires                                  uold on   [-2:nx+2, 0:ny-1] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">//       and  requires                                  Huon on   [-2:nx+2, 0:ny-1] (0,0,0) x-faces</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">//   to do so requires                                  UFe on    [ 0:nx  , 0:ny  ] (1,1,0) xy-nodes</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">//      which requires                                  uold on   [ 0:nx  ,-2:ny+1] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">//       and  requires                                  Hvom on   [-2:nx+1, 0:ny-1] (0,1,0) y-faces</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// Define UFx, the x-fluxes at cell centers for updating u</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// (Note that grow arguments are (bx, dir, ng)</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    ParallelFor(growLo(xbx,0,1), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1 = uold(i,j,k,nrhs)+uold(i+1,j,k,nrhs);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="comment">// Upwinding</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = (cff1 &gt; 0.0) ? uold(i-1,j,k,nrhs)-2.0*uold(i  ,j,k,nrhs)+uold(i+1,j,k,nrhs) :</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                                  uold(i  ,j,k,nrhs)-2.0*uold(i+1,j,k,nrhs)+uold(i+2,j,k,nrhs);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Huxx_i   = Huon(i-1,j,k)-2.0*Huon(i  ,j,k)+Huon(i+1,j,k);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Huxx_ip1 = Huon(i  ,j,k)-2.0*Huon(i+1,j,k)+Huon(i+2,j,k);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Huxx_avg = 0.5 * (Huxx_i + Huxx_ip1);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Huon_avg = (Huon(i,j,k) + Huon(i+1,j,k));</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        UFx(i,j,k) = 0.25*(cff1+Gadv*cff) * ( Huon_avg + Gadv*Huxx_avg );</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    });</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">// Define UFe, the y-fluxes at nodes for updating u</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    ParallelFor(growHi(xbx,1,1), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1 = uold(i,j,k,nrhs) + uold(i  ,j-1,k,nrhs);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2 = Hvom(i,j,k)      + Hvom(i-1,j  ,k);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="comment">// Upwinding</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = (cff2 &gt; 0.0) ?  uold(i,j-2,k,nrhs) - 2.0*uold(i,j-1,k,nrhs) + uold(i  ,j,k,nrhs) :</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                                   uold(i,j-1,k,nrhs) - 2.0*uold(i,j  ,k,nrhs) + uold(i,j+1,k,nrhs);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Hvxx_i   = Hvom(i-1,j,k)-2.0*Hvom(i  ,j,k)+Hvom(i+1,j,k);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Hvxx_im1 = Hvom(i-2,j,k)-2.0*Hvom(i-1,j,k)+Hvom(i  ,j,k);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        UFe(i,j,k) = 0.25 * (cff1+Gadv*cff)* (cff2+Gadv*0.5*(Hvxx_i + Hvxx_im1));</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    });</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">// Define the RHS for u by differencing fluxes</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    ParallelFor(xbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;          ru(i,j,k,nrhs) -= ( (UFx(i,j,k)-UFx(i-1,j,k)) + (UFe(i,j+1,k)-UFe(i  ,j,k)) );</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    });</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    ParallelFor(xbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;          <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;          <span class="comment">//  Add in vertical advection.</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;          <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=9.0/16.0;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2=1.0/16.0;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;          <span class="keywordflow">if</span> (k&gt;=1 &amp;&amp; k&lt;=N-2)</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;          {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                  FC(i,j,k)=( cff1*(uold(i  ,j,k  ,nrhs)+ uold(i,j,k+1,nrhs))</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                             -cff2*(uold(i  ,j,k-1,nrhs)+ uold(i,j,k+2,nrhs)) )*</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                                ( cff1*(   W(i  ,j,k)+ W(i-1,j,k))</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                                 -cff2*(   W(i+1,j,k)+ W(i-2,j,k)) );</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;          }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;          <span class="keywordflow">else</span> <span class="comment">// this needs to be split up so that the following can be concurrent</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;          {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;              FC(i,j,N)=0.0;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;              FC(i,j,N-1)=( cff1*(uold(i  ,j,N-1,nrhs)+ uold(i,j,N  ,nrhs))</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                           -cff2*(uold(i  ,j,N-2,nrhs)+ uold(i,j,N  ,nrhs)) )*</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                              ( cff1*(   W(i  ,j,N-1)+ W(i-1,j,N-1))</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                               -cff2*(   W(i+1,j,N-1)+ W(i-2,j,N-1)) );</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;              FC(i,j,0)=( cff1*(uold(i  ,j,0,nrhs)+ uold(i,j,1,nrhs))</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                         -cff2*(uold(i  ,j,0,nrhs)+ uold(i,j,2,nrhs)) )*</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                            ( cff1*(   W(i  ,j,0)+ W(i-1,j,0))</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                             -cff2*(   W(i+1,j,0)+ W(i-2,j,0)) );</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;              <span class="comment">//              FC(i,0,-1)=0.0;</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;          }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    });</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    ParallelFor(xbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = (k &gt;= 1) ? FC(i,j,k)-FC(i,j,k-1) : FC(i,j,k);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        ru(i,j,k,nrhs) -= cff;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    });</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    Gpu::synchronize();</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    AMREX_ASSERT(xbx.smallEnd(2) == 0 &amp;&amp; xbx.bigEnd(2) == N);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    ParallelFor(makeSlab(xbx,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= N; ++k)</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;       {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;          rufrc(i,j,0) += ru(i,j,k,nrhs);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> om_u = 2.0 / (pm(i-1,j,0)+pm(i,j,0));</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> on_u = 2.0 / (pn(i-1,j,0)+pn(i,j,0));</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff  = om_u * on_u;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1 = (k == N) ?  sustr(i,j,0)*cff : 0.0;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2 = (k == 0) ? -bustr(i,j,0)*cff : 0.0;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;          rufrc(i,j,0) += cff1+cff2;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;       }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    });</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">// *************************************************************</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">// UPDATING V</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">// *************************************************************</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// Think of the cell-centered box as                              [ 0:nx-1, 0:ny-1] (0,0,0) cc</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// ybx is the y-face-centered box on which we update v (with rv)  [ 0:nx-1, 0:ny  ] (1,0,0)  y-faces</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">//   to do so requires                                  VFe on    [ 0:nx-1,-1:ny  ] (1,1,0)  xy-nodes</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">//      which requires                                    vold on [ 0:nx-1,-2:ny+2] (1,0,0)  y-faces</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">//       and  requires                                    Hvom on [ 0:nx-1,-2:ny+2] (0,1,0)  x-faces</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">//   to do so requires                                  VFx on    [ 0:nx  , 0:ny  ] (0,0,0)  cc</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">//      which requires                                    vold on [-2:nx+1, -:ny  ] (1,0,0)  y-faces</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">//       and  requires                                    Hvom on [ 0:nx-1,-2:ny+1] (0,0,0)  y-faces</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// Grow ybx by one in low y-direction</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    ParallelFor(growLo(ybx,1,1), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=vold(i,j,k,nrhs)+vold(i,j+1,k,nrhs);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="comment">// Upwinding</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = (cff1 &gt; 0.0) ? vold(i,j-1,k,nrhs)-2.0*vold(i,j,k,nrhs)+ vold(i,j+1,k,nrhs) :</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                                  vold(i,j,k,nrhs)-2.0*vold(i,j+1,k,nrhs)+ vold(i,j+2,k,nrhs);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Hvee_j   = Hvom(i,j-1,k)-2.0*Hvom(i,j  ,k)+Hvom(i,j+1,k);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Hvee_jp1 = Hvom(i,j  ,k)-2.0*Hvom(i,j+1,k)+Hvom(i,j+2,k);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        VFe(i,j,k) = 0.25 * (cff1+Gadv*cff) * ( Hvom(i,j  ,k)+ Hvom(i,j+1,k) + 0.5 * Gadv * (Hvee_j + Hvee_jp1) );</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    });</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">// Grow ybx by one in high x-direction</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    ParallelFor(growHi(ybx,0,1), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1 = vold(i,j,k,nrhs) + vold(i-1,j  ,k,nrhs);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2 = Huon(i,j,k)      + Huon(i  ,j-1,k);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="comment">// Upwinding</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = (cff2 &gt; 0.0) ? vold(i-2,j,k,nrhs)-2.0*vold(i-1,j,k,nrhs)+vold(i  ,j,k,nrhs) :</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                                  vold(i-1,j,k,nrhs)-2.0*vold(i  ,j,k,nrhs)+vold(i+1,j,k,nrhs);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Huee_j   = Huon(i,j-1,k)-2.0*Huon(i,j  ,k)+Huon(i,j+1,k);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Huee_jm1 = Huon(i,j-2,k)-2.0*Huon(i,j-1,k)+Huon(i,j  ,k);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        VFx(i,j,k) = 0.25*(cff1+Gadv*cff)* (cff2+Gadv*0.5*(Huee_j + Huee_jm1));</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    });</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    ParallelFor(ybx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;          rv(i,j,k,nrhs) -= ( (VFx(i+1,j,k)-VFx(i,j,k)) + (VFe(i,j,k)-VFe(i,j-1,k)) );</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    });</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    ParallelFor(ybx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=9.0/16.0;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2=1.0/16.0;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;          <span class="keywordflow">if</span> (k&gt;=1 &amp;&amp; k&lt;=N-2)</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;          {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;              FC(i,j,k)=( cff1*(vold(i,j,k  ,nrhs)+ vold(i,j,k+1,nrhs))</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                         -cff2*(vold(i,j,k-1,nrhs)+ vold(i,j,k+2,nrhs)) )*</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                            ( cff1*(W(i,j  ,k)+ W(i,j-1,k))</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                             -cff2*(W(i,j+1,k)+ W(i,j-2,k)) );</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;          }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;          <span class="keywordflow">else</span> <span class="comment">// this needs to be split up so that the following can be concurrent</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;          {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;              FC(i,j,N)=0.0;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;              FC(i,j,N-1)=( cff1*(vold(i,j,N-1,nrhs)+ vold(i,j,N  ,nrhs))</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                           -cff2*(vold(i,j,N-2,nrhs)+ vold(i,j,N  ,nrhs)) )*</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                              ( cff1*(W(i,j  ,N-1)+ W(i,j-1,N-1))</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                               -cff2*(W(i,j+1,N-1)+ W(i,j-2,N-1)) );</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;              FC(i,j,0)=( cff1*(vold(i,j,0,nrhs)+ vold(i,j,1,nrhs))</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                             -cff2*(vold(i,j,0,nrhs)+ vold(i,j,2,nrhs)) )*</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                            ( cff1*(W(i,j  ,0)+ W(i,j-1,0))</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                             -cff2*(W(i,j+1,0)+ W(i,j-2,0)) );</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;              <span class="comment">//              FC(i,0,-1)=0.0;</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;          }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    }); Gpu::synchronize();</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    ParallelFor(ybx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = (k &gt;= 1) ? FC(i,j,k)-FC(i,j,k-1) : FC(i,j,k);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        rv(i,j,k,nrhs) -= cff;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    });</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    Gpu::synchronize();</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    AMREX_ASSERT(ybx.smallEnd(2) == 0 &amp;&amp; ybx.bigEnd(2) == N);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    ParallelFor(makeSlab(ybx,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= N; ++k)</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;       {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;          rvfrc(i,j,0) += rv(i,j,k,nrhs);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> om_v = 2.0_rt / (pm(i,j-1,0)+pm(i,j,0));</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> on_v = 2.0_rt / (pn(i,j-1,0)+pn(i,j,0));</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = om_v * on_v;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1 = (k == N) ?  svstr(i,j,0)*cff : 0.0_rt;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2 = (k == 0) ? -bvstr(i,j,0)*cff : 0.0_rt;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;          rvfrc(i,j,0) += cff1+cff2;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;       }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    });</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab9d2fbd8ac171ab10eb09ff189cbb69b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9d2fbd8ac171ab10eb09ff189cbb69b">&#9670;&nbsp;</a></span>set_2darrays()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::set_2darrays </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;{</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_x_r = <a class="code" href="classREMORA.html#a55ca3c497c355a95a82bfbacf955771e">vec_x_r</a>[lev];</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_y_r = <a class="code" href="classREMORA.html#ab86841fb3954bcabcb79275416c46253">vec_y_r</a>[lev];</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keyword">auto</span> N = Geom(lev).Domain().size()[2]-1; <span class="comment">// Number of vertical &quot;levs&quot; aka, NZ</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(*(mf_x_r), TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      Array4&lt;Real&gt; <span class="keyword">const</span>&amp; x_r = (mf_x_r)-&gt;array(mfi);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      Array4&lt;Real&gt; <span class="keyword">const</span>&amp; y_r = (mf_y_r)-&gt;array(mfi);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keyword">const</span> Box&amp; bx = mfi.growntilebox();</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> &amp; geomdata = Geom(lev).data();</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      Gpu::synchronize();</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      amrex::ParallelFor(amrex::makeSlab(bx,2,0),</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>  )</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> prob_lo         = geomdata.ProbLo();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> dx              = geomdata.CellSize();</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        x_r(i,j,0) = prob_lo[0] + (i + 0.5) * dx[0];</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        y_r(i,j,0) = prob_lo[1] + (j + 0.5) * dx[1];</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="comment">//        const Real z = prob_lo[2] + (k + 0.5) * dx[2];</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      });</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    MultiFab* U_old = <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev];</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    MultiFab* V_old = <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev];</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_ubar = <a class="code" href="classREMORA.html#abb214b8bab178b72c44907f5e2aeead8">vec_ubar</a>[lev];</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_vbar = <a class="code" href="classREMORA.html#ab70c8d3ac0d8a5f7ac51365571905874">vec_vbar</a>[lev];</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_Hz  = <a class="code" href="classREMORA.html#a488738b1aea61abbbf086a9d22b4f815">vec_Hz</a>[lev];</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordtype">int</span> nstp = 0;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordtype">int</span> kstp = 0;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordtype">int</span> knew = 0;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(*<a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a> = (mf_ubar)-&gt;array(mfi);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a> = (mf_vbar)-&gt;array(mfi);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        Array4&lt;const Real&gt; <span class="keyword">const</span>&amp; Hz       = mf_Hz-&gt;const_array(mfi);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        Array4&lt;const Real&gt; <span class="keyword">const</span>&amp; <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">u</a>        = U_old-&gt;const_array(mfi);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        Array4&lt;const Real&gt; <span class="keyword">const</span>&amp; <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a>        = V_old-&gt;const_array(mfi);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        Box ubx2 = mfi.nodaltilebox(0); ubx2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>  ,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>  ,0)); <span class="comment">// x-face-centered, grown by 2</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        Box vbx2 = mfi.nodaltilebox(1); vbx2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>  ,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>  ,0)); <span class="comment">// y-face-centered, grown by 2</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        amrex::ParallelFor(makeSlab(ubx2,2,0),</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> CF = 0.;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> sum_of_hz = 0.;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;=N; k++) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> avg_hz = 0.5*(Hz(i,j,k)+Hz(i-1,j,k));</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                    sum_of_hz += avg_hz;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                    CF += avg_hz*<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">u</a>(i,j,k,nstp);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i,j,0,kstp) = CF / sum_of_hz;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">ubar</a>(i,j,0,knew) = CF / sum_of_hz;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            });</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        amrex::ParallelFor(makeSlab(vbx2,2,0),</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> CF = 0.;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> sum_of_hz = 0.;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;=N; k++) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> avg_hz = 0.5*(Hz(i,j,k)+Hz(i,j-1,k));</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                    sum_of_hz += avg_hz;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                    CF += avg_hz*<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a>(i,j,k,nstp);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i,j,0,kstp) = CF / sum_of_hz;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">vbar</a>(i,j,0,knew) = CF / sum_of_hz;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            });</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">// DEBUGGING NOTE -- DoublyPeriodic fails if these are commented out</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> time = 0.0;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev,time, *<a class="code" href="classREMORA.html#abb214b8bab178b72c44907f5e2aeead8">vec_ubar</a>[lev], GetVecOfPtrs(<a class="code" href="classREMORA.html#abb214b8bab178b72c44907f5e2aeead8">vec_ubar</a>), <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a6336bc425d2abd84d90f925fc32d358a">BdyVars::ubar</a>);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev,time, *<a class="code" href="classREMORA.html#ab70c8d3ac0d8a5f7ac51365571905874">vec_vbar</a>[lev], GetVecOfPtrs(<a class="code" href="classREMORA.html#ab70c8d3ac0d8a5f7ac51365571905874">vec_vbar</a>), <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a21bc8b125d8054e031f2dab527df5945">BdyVars::vbar</a>);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a97de693d117772818b80fb566720d4c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97de693d117772818b80fb566720d4c1">&#9670;&nbsp;</a></span>set_bathymetry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::set_bathymetry </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;{</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a345dba1135888a3a3e422c9b6a010ebf">ic_bc_type</a> == <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a90589c47f06eb971d548591f23c285af">IC_BC_Type::Custom</a>) {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <a class="code" href="prob__common_8H.html#aa1cdb9793fdab1b03dec18cf8fa52085">init_custom_bathymetry</a>(geom[lev], *<a class="code" href="classREMORA.html#a157e7645fedcf8c0b46516dbb625d3bd">vec_hOfTheConfusingName</a>[lev], <a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_NETCDF</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a345dba1135888a3a3e422c9b6a010ebf">ic_bc_type</a> == <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">IC_BC_Type::Real</a>) {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Calling init_bathymetry_from_netcdf &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        init_bathymetry_from_netcdf(lev);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Bathymetry loaded from netcdf file \n &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        Abort(<span class="stringliteral">&quot;Don&#39;t know this ic_bc_type!&quot;</span>);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">// HACK -- SHOULD WE ALWAYS DO THIS??</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <a class="code" href="classREMORA.html#adeb60c66ba4665f07c57fbf3b3b8909a">vec_Zt_avg1</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> time = 0.0;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#adeb60c66ba4665f07c57fbf3b3b8909a">vec_Zt_avg1</a>[lev], GetVecOfPtrs(<a class="code" href="classREMORA.html#adeb60c66ba4665f07c57fbf3b3b8909a">vec_Zt_avg1</a>));</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#a157e7645fedcf8c0b46516dbb625d3bd">vec_hOfTheConfusingName</a>[lev], GetVecOfPtrs(<a class="code" href="classREMORA.html#a157e7645fedcf8c0b46516dbb625d3bd">vec_hOfTheConfusingName</a>));</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;}</div>
<div class="ttc" id="aprob__common_8H_html_aa1cdb9793fdab1b03dec18cf8fa52085"><div class="ttname"><a href="prob__common_8H.html#aa1cdb9793fdab1b03dec18cf8fa52085">init_custom_bathymetry</a></div><div class="ttdeci">void init_custom_bathymetry(const amrex::Geometry &amp;geom, amrex::MultiFab &amp;mf_h, SolverChoice const &amp;m_solverChoice)</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classREMORA_a97de693d117772818b80fb566720d4c1_cgraph.png" border="0" usemap="#aclassREMORA_a97de693d117772818b80fb566720d4c1_cgraph" alt=""/></div>
<map name="aclassREMORA_a97de693d117772818b80fb566720d4c1_cgraph" id="aclassREMORA_a97de693d117772818b80fb566720d4c1_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,196,32"/>
<area shape="rect" href="prob__common_8H.html#aa1cdb9793fdab1b03dec18cf8fa52085" title=" " alt="" coords="244,5,425,32"/>
</map>
</div>

</div>
</div>
<a id="a43ebfe013ec1e2d1d0a8faaba3ebbbb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43ebfe013ec1e2d1d0a8faaba3ebbbb6">&#9670;&nbsp;</a></span>set_coriolis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::set_coriolis </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                            {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a9e86533aa6df5bf6408d91f0dfd23606">use_coriolis</a>) {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a5a2eb680fa53af115784a54eaa1924bf">coriolis_type</a> == <a class="code" href="DataStruct_8H.html#a70dc28894261645bb2ac2f2eb5c2ac55a90589c47f06eb971d548591f23c285af">Cor_Type::Custom</a>) {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            <a class="code" href="prob__common_8H.html#a134e39605b6afbabb6fe2a35f2189257">init_custom_coriolis</a>(geom[lev], *<a class="code" href="classREMORA.html#a13f9894ec6aca96e68687e7a6762e337">vec_fcor</a>[lev], <a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a5a2eb680fa53af115784a54eaa1924bf">coriolis_type</a> == <a class="code" href="DataStruct_8H.html#a70dc28894261645bb2ac2f2eb5c2ac55a2073202f4f2b21ad250091269d204792">Cor_Type::Beta_Plane</a>) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            <a class="code" href="classREMORA.html#a71e63d1870dd72923c2e110fa4158202">init_beta_plane_coriolis</a>(lev);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_NETCDF</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a5a2eb680fa53af115784a54eaa1924bf">coriolis_type</a> == <a class="code" href="DataStruct_8H.html#a70dc28894261645bb2ac2f2eb5c2ac55a7f80fcc452c2f1ed2bb51b39d0864df1">Cor_Type::Real</a>) {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Calling init_coriolis_from_netcdf &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            init_coriolis_from_netcdf(lev);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Coriolis loaded from netcdf file \n&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            Abort(<span class="stringliteral">&quot;Don&#39;t know this coriolis_type!&quot;</span>);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> time = 0.0;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#a13f9894ec6aca96e68687e7a6762e337">vec_fcor</a>[lev], GetVecOfPtrs(<a class="code" href="classREMORA.html#a13f9894ec6aca96e68687e7a6762e337">vec_fcor</a>));</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;}</div>
<div class="ttc" id="aDataStruct_8H_html_a70dc28894261645bb2ac2f2eb5c2ac55a2073202f4f2b21ad250091269d204792"><div class="ttname"><a href="DataStruct_8H.html#a70dc28894261645bb2ac2f2eb5c2ac55a2073202f4f2b21ad250091269d204792">Cor_Type::Beta_Plane</a></div><div class="ttdeci">@ Beta_Plane</div></div>
<div class="ttc" id="aDataStruct_8H_html_a70dc28894261645bb2ac2f2eb5c2ac55a7f80fcc452c2f1ed2bb51b39d0864df1"><div class="ttname"><a href="DataStruct_8H.html#a70dc28894261645bb2ac2f2eb5c2ac55a7f80fcc452c2f1ed2bb51b39d0864df1">Cor_Type::Real</a></div><div class="ttdeci">@ Real</div></div>
<div class="ttc" id="aDataStruct_8H_html_a70dc28894261645bb2ac2f2eb5c2ac55a90589c47f06eb971d548591f23c285af"><div class="ttname"><a href="DataStruct_8H.html#a70dc28894261645bb2ac2f2eb5c2ac55a90589c47f06eb971d548591f23c285af">Cor_Type::Custom</a></div><div class="ttdeci">@ Custom</div></div>
<div class="ttc" id="aclassREMORA_html_a71e63d1870dd72923c2e110fa4158202"><div class="ttname"><a href="classREMORA.html#a71e63d1870dd72923c2e110fa4158202">REMORA::init_beta_plane_coriolis</a></div><div class="ttdeci">void init_beta_plane_coriolis(int lev)</div><div class="ttdef"><b>Definition:</b> REMORA_init.cpp:54</div></div>
<div class="ttc" id="aprob__common_8H_html_a134e39605b6afbabb6fe2a35f2189257"><div class="ttname"><a href="prob__common_8H.html#a134e39605b6afbabb6fe2a35f2189257">init_custom_coriolis</a></div><div class="ttdeci">void init_custom_coriolis(const amrex::Geometry &amp;geom, amrex::MultiFab &amp;mf_fcor, SolverChoice const &amp;m_solverChoice)</div></div>
<div class="ttc" id="astructSolverChoice_html_a5a2eb680fa53af115784a54eaa1924bf"><div class="ttname"><a href="structSolverChoice.html#a5a2eb680fa53af115784a54eaa1924bf">SolverChoice::coriolis_type</a></div><div class="ttdeci">Cor_Type coriolis_type</div><div class="ttdef"><b>Definition:</b> DataStruct.H:211</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classREMORA_a43ebfe013ec1e2d1d0a8faaba3ebbbb6_cgraph.png" border="0" usemap="#aclassREMORA_a43ebfe013ec1e2d1d0a8faaba3ebbbb6_cgraph" alt=""/></div>
<map name="aclassREMORA_a43ebfe013ec1e2d1d0a8faaba3ebbbb6_cgraph" id="aclassREMORA_a43ebfe013ec1e2d1d0a8faaba3ebbbb6_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,167,32"/>
<area shape="rect" href="prob__common_8H.html#a134e39605b6afbabb6fe2a35f2189257" title=" " alt="" coords="215,5,367,32"/>
</map>
</div>

</div>
</div>
<a id="a6554e8c3a6e26956493818ff4e9ef1f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6554e8c3a6e26956493818ff4e9ef1f8">&#9670;&nbsp;</a></span>set_drag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::set_drag </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac61ff34983f1636e08e957c5a2a0ddbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac61ff34983f1636e08e957c5a2a0ddbc">&#9670;&nbsp;</a></span>set_hmixcoef()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::set_hmixcoef </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;{</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <a class="code" href="prob__common_8H.html#ac03b2472176ba10b0edc225576774769">init_custom_hmix</a>(geom[lev], *<a class="code" href="classREMORA.html#a65281506759b30fbc3c382ba0a64f38f">vec_visc2_p</a>[lev], *<a class="code" href="classREMORA.html#a86f0a2458c28f42d5be178d7bc5d104b">vec_visc2_r</a>[lev], *<a class="code" href="classREMORA.html#afdf4b75f0ec12caf3648dbee5ec7f653">vec_diff2</a>[lev], <a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> time = 0.0;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#a65281506759b30fbc3c382ba0a64f38f">vec_visc2_p</a>[lev], GetVecOfPtrs(<a class="code" href="classREMORA.html#a65281506759b30fbc3c382ba0a64f38f">vec_visc2_p</a>));</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#a86f0a2458c28f42d5be178d7bc5d104b">vec_visc2_r</a>[lev], GetVecOfPtrs(<a class="code" href="classREMORA.html#a86f0a2458c28f42d5be178d7bc5d104b">vec_visc2_r</a>));</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#afdf4b75f0ec12caf3648dbee5ec7f653">vec_diff2</a>[lev]  , GetVecOfPtrs(<a class="code" href="classREMORA.html#afdf4b75f0ec12caf3648dbee5ec7f653">vec_diff2</a>));</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;}</div>
<div class="ttc" id="aprob__common_8H_html_ac03b2472176ba10b0edc225576774769"><div class="ttname"><a href="prob__common_8H.html#ac03b2472176ba10b0edc225576774769">init_custom_hmix</a></div><div class="ttdeci">void init_custom_hmix(const amrex::Geometry &amp;geom, amrex::MultiFab &amp;mf_visc2_p, amrex::MultiFab &amp;mf_visc2_r, amrex::MultiFab &amp;mf_diff2, SolverChoice const &amp;m_solverChoice)</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classREMORA_ac61ff34983f1636e08e957c5a2a0ddbc_cgraph.png" border="0" usemap="#aclassREMORA_ac61ff34983f1636e08e957c5a2a0ddbc_cgraph" alt=""/></div>
<map name="aclassREMORA_ac61ff34983f1636e08e957c5a2a0ddbc_cgraph" id="aclassREMORA_ac61ff34983f1636e08e957c5a2a0ddbc_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,180,32"/>
<area shape="rect" href="prob__common_8H.html#ac03b2472176ba10b0edc225576774769" title=" " alt="" coords="228,5,367,32"/>
</map>
</div>

</div>
</div>
<a id="a4d4e9bae68124255e7ef6e949949d7ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d4e9bae68124255e7ef6e949949d7ae">&#9670;&nbsp;</a></span>set_smflux()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::set_smflux </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;{</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <a class="code" href="prob__common_8H.html#a36a5501b26f66b3ec6d4d187236bc3bc">init_custom_smflux</a>(geom[lev], time, *<a class="code" href="classREMORA.html#a347a75f9295217fc66a8b7a4c2a47f9b">vec_sustr</a>[lev], *<a class="code" href="classREMORA.html#a88a26701f7276ea04f5c9ede4ae46981">vec_svstr</a>[lev], <a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="comment">// FillPatch(lev, time, *vec_sustr[lev], GetVecOfPtrs(vec_sustr));</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="comment">// FillPatch(lev, time, *vec_svstr[lev], GetVecOfPtrs(vec_svstr));</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;}</div>
<div class="ttc" id="aprob__common_8H_html_a36a5501b26f66b3ec6d4d187236bc3bc"><div class="ttname"><a href="prob__common_8H.html#a36a5501b26f66b3ec6d4d187236bc3bc">init_custom_smflux</a></div><div class="ttdeci">void init_custom_smflux(const amrex::Geometry &amp;geom, amrex::Real time, amrex::MultiFab &amp;mf_sustr, amrex::MultiFab &amp;mf_svstr, SolverChoice const &amp;m_solverChoice)</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classREMORA_a4d4e9bae68124255e7ef6e949949d7ae_cgraph.png" border="0" usemap="#aclassREMORA_a4d4e9bae68124255e7ef6e949949d7ae_cgraph" alt=""/></div>
<map name="aclassREMORA_a4d4e9bae68124255e7ef6e949949d7ae_cgraph" id="aclassREMORA_a4d4e9bae68124255e7ef6e949949d7ae_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,164,32"/>
<area shape="rect" href="prob__common_8H.html#a36a5501b26f66b3ec6d4d187236bc3bc" title=" " alt="" coords="212,5,361,32"/>
</map>
</div>

</div>
</div>
<a id="a72df3d34cb4020524bc7aefe66db5aa8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72df3d34cb4020524bc7aefe66db5aa8">&#9670;&nbsp;</a></span>set_vmix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::set_vmix </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                        {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="prob__common_8H.html#a3aabbde4e8cfbf5eeb55157f2ac5fe98">init_custom_vmix</a>(geom[lev], *<a class="code" href="classREMORA.html#ad36ee94716ca0cde00d8cad5fe5cce94">vec_Akv</a>[lev], *<a class="code" href="classREMORA.html#a48c1bf42530780ce02b3655d7cefe592">vec_Akt</a>[lev], *<a class="code" href="classREMORA.html#af7958bb9cfac605c91f1e74357f344b2">vec_z_w</a>[lev], <a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> time = 0.0;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#ad36ee94716ca0cde00d8cad5fe5cce94">vec_Akv</a>[lev], GetVecOfPtrs(<a class="code" href="classREMORA.html#ad36ee94716ca0cde00d8cad5fe5cce94">vec_Akv</a>));</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#a48c1bf42530780ce02b3655d7cefe592">vec_Akt</a>[lev], GetVecOfPtrs(<a class="code" href="classREMORA.html#a48c1bf42530780ce02b3655d7cefe592">vec_Akt</a>));</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;}</div>
<div class="ttc" id="aprob__common_8H_html_a3aabbde4e8cfbf5eeb55157f2ac5fe98"><div class="ttname"><a href="prob__common_8H.html#a3aabbde4e8cfbf5eeb55157f2ac5fe98">init_custom_vmix</a></div><div class="ttdeci">void init_custom_vmix(const amrex::Geometry &amp;geom, amrex::MultiFab &amp;mf_Akv, amrex::MultiFab &amp;mf_Akt, amrex::MultiFab &amp;mf_z_w, SolverChoice const &amp;m_solverChoice)</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classREMORA_a72df3d34cb4020524bc7aefe66db5aa8_cgraph.png" border="0" usemap="#aclassREMORA_a72df3d34cb4020524bc7aefe66db5aa8_cgraph" alt=""/></div>
<map name="aclassREMORA_a72df3d34cb4020524bc7aefe66db5aa8_cgraph" id="aclassREMORA_a72df3d34cb4020524bc7aefe66db5aa8_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,152,32"/>
<area shape="rect" href="prob__common_8H.html#a3aabbde4e8cfbf5eeb55157f2ac5fe98" title=" " alt="" coords="200,5,339,32"/>
</map>
</div>

</div>
</div>
<a id="ad09828d9cb740f8465f4a794c2d90460"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad09828d9cb740f8465f4a794c2d90460">&#9670;&nbsp;</a></span>set_weights()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::set_weights </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;                               {</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> gamma, scale;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> wsum, shift, cff;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="comment">//HACK should possibly store fixed_ndtfast elsewhere</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keywordtype">int</span> ndtfast=<a class="code" href="classREMORA.html#acc900ee008729de41eb6aa28a36f6a26">fixed_ndtfast_ratio</a>&gt;0 ? <a class="code" href="classREMORA.html#acc900ee008729de41eb6aa28a36f6a26">fixed_ndtfast_ratio</a> : <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classREMORA.html#a5cdf62f58282022e2d5f79de304d425f">fixed_fast_dt</a> / <a class="code" href="classREMORA.html#a0c9e94b2bbf3ee8167abb9acd4b86807">fixed_dt</a>);</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="comment">//From mod_scalars</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Falpha = 2.0_rt;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Fbeta = 4.0_rt;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Fgamma = 0.284_rt;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <a class="code" href="classREMORA.html#ab17dd7f0866773488c052d67cb6086b3">vec_weight1</a>.resize(2*ndtfast+1);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <a class="code" href="classREMORA.html#a634b285cb09738ecdc4b191e897744ed">vec_weight2</a>.resize(2*ndtfast+1);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keyword">auto</span> weight1 = <a class="code" href="classREMORA.html#ab17dd7f0866773488c052d67cb6086b3">vec_weight1</a>.dataPtr();</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keyword">auto</span> weight2 = <a class="code" href="classREMORA.html#a634b285cb09738ecdc4b191e897744ed">vec_weight2</a>.dataPtr();</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">//  Compute time-averaging filter for barotropic fields.</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">//  Initialize both sets of weights to zero.</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>=0;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;=2*ndtfast;i++) {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        weight1[i-1]=0.0_rt;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        weight2[i-1]=0.0_rt;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//  Power-law shape filters.</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">//  The power-law shape filters are given by:</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">//     F(xi)=xi^Falpha*(1-xi^Fbeta)-Fgamma*xi</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">//  where xi=scale*i/ndtfast; and scale, Falpha, Fbeta, Fgamma, and</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">//  normalization are chosen to yield the correct zeroth-order</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">//  (normalization), first-order (consistency), and second-order moments,</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">//  resulting in overall second-order temporal accuracy for time-averaged</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">//  barotropic motions resolved by baroclinic time step.</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      scale=(Falpha+1.0_rt)*(Falpha+Fbeta+1.0_rt) /</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        ((Falpha+2.0_rt)*(Falpha+Fbeta+2.0_rt)*<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(ndtfast));</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">//  Find center of gravity of the primary weighting shape function and</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">//  iteratively adjust &quot;scale&quot; to place the  centroid exactly at</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">//  &quot;ndtfast&quot;.</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    gamma = Fgamma*max(0.0_rt, 1.0_rt-10.0_rt/<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(ndtfast));</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iter=1;iter&lt;=16;iter++) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>=0;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;=2*ndtfast;i++) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            cff=scale*<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(i);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            weight1[i-1]=pow(cff,Falpha)-pow(cff,(Falpha+Fbeta))-gamma*cff;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <span class="keywordflow">if</span> (weight1[i-1] &gt; 0.0_rt) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                <a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>=i;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <span class="keywordflow">if</span> ( (<a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>&gt;0) &amp;&amp; (weight1[i-1] &lt; 0.0_rt) ) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                weight1[i-1] = 0.0_rt;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        wsum  = 0.0_rt;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        shift = 0.0_rt;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;=<a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>;i++) {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            wsum=wsum+weight1[i-1];</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            shift=shift+weight1[i-1]*<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(i);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        scale *= shift/(wsum*<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(ndtfast));</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">//  Post-processing of primary weights.</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">//  Although it is assumed that the initial settings of the primary</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">//  weights has its center of gravity &quot;reasonably close&quot; to NDTFAST,</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">//  it may be not so according to the discrete rules of integration.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">//  The following procedure is designed to put the center of gravity</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">//  exactly to NDTFAST by computing mismatch (NDTFAST-shift) and</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">//  applying basically an upstream advection of weights to eliminate</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">//  the mismatch iteratively. Once this procedure is complete primary</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">//  weights are normalized.</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">//  Find center of gravity of the primary weights and subsequently</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">//  calculate the mismatch to be compensated.</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iter=1;iter&lt;=ndtfast;iter++) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        wsum  = 0.0_rt;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        shift = 0.0_rt;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;=<a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>;i++) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            wsum=wsum+weight1[i-1];</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            shift=shift+<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(i)*weight1[i-1];</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        shift=shift/wsum;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        cff=<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(ndtfast)-shift;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="comment">//  Apply advection step using either whole, or fractional shifts.</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="comment">//  Notice that none of the four loops here is reversible.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordflow">if</span> (cff &gt; 1.0_rt) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>=<a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>+1;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=<a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>;i&gt;=2;i--) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                weight1[i-1]=weight1[i-1-1];</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            weight1[1-1] = 0.0_rt;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cff&gt; 0.0_rt) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            wsum=1.0_rt-cff;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=<a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>;i&gt;=2;i--) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                weight1[i-1]=wsum*weight1[i-1]+cff*weight1[i-1-1];</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            weight1[1-1]=wsum*weight1[1-1];</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cff &lt; -1.0_rt) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>=<a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>-1;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1;i&lt;=<a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>;i++) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                weight1[i-1]=weight1[i+1-1];</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            weight1[<a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>+1-1] = 0.0_rt;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cff &lt; 0.0_rt) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            wsum=1.0_rt+cff;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1;i&lt;=<a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>-1;i++) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                weight1[i-1]=wsum*weight1[i-1]-cff*weight1[i+1-1];</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            weight1[<a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>-1]=wsum*weight1[<a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>-1];</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">//  Set SECONDARY weights assuming that backward Euler time step is used</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">//  for free surface.  Notice that array weight2[i] is assumed to</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">//  have all-zero status at entry in this segment of code.</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=1;j&lt;=<a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>;j++) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        cff=weight1[j-1];</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;=j;i++) {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            weight2[i-1]=weight2[i-1]+cff;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">//  Normalize both set of weights.</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    wsum = 0.0_rt;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    cff  = 0.0_rt;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;=<a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>;i++) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        wsum=wsum+weight1[i-1];</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        cff=cff+weight2[i-1];</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    wsum = 1.0_rt / wsum;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    cff  = 1.0_rt / cff;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;=<a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>;i++) {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        weight1[i-1]=wsum*weight1[i-1];</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        weight2[i-1]=cff*weight2[i-1];</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">//  Report weights.</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1, cff2;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        Print().SetPrecision(18)&lt;&lt;ParallelDescriptor::NProcs()&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;ndtfast&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;wsum&lt;&lt;std::endl;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        cff=0.0_rt;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        cff1=0.0_rt;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        cff2=0.0_rt;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        wsum=0.0_rt;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        shift=0.0_rt;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;=<a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>;i++) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;          cff=cff+weight1[i-1];</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;          cff1=cff1+weight1[i-1]*<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(i);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;          cff2=cff2+weight1[i-1]*<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(i*i);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;          wsum=wsum+weight2[i-1];</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;          shift=shift+weight2[i-1]*(<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(i)-0.5_rt);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;          Print().SetPrecision(18)&lt;&lt;<span class="stringliteral">&quot;i=&quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;weight1[i-1]&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;weight2[i-1]&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;cff&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;wsum&lt;&lt;std::endl;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        cff1=cff1/<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(ndtfast);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        cff2=cff2/(<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(ndtfast)*<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(ndtfast));</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        shift=shift/<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(ndtfast);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        Print().SetPrecision(18)&lt;&lt;ndtfast &lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt; <a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(<a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a>)/<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(ndtfast)&lt;&lt;std::endl;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        Print().SetPrecision(18)&lt;&lt;cff1&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;cff2&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;shift&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;cff&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;wsum&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;Fgamma&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;gamma&lt;&lt;std::endl;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keywordflow">if</span> (cff2&lt;1.0001_rt) Print()&lt;&lt;<span class="stringliteral">&quot;\n\n\n&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afe11d354ade4deed0c57c6f44f85ab41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe11d354ade4deed0c57c6f44f85ab41">&#9670;&nbsp;</a></span>setPlotVariables()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::setPlotVariables </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>pp_plot_var_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>plot_var_names</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>set which variables and derived quantities go into plotfiles </p>
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    ParmParse pp(<a class="code" href="classREMORA.html#a9724f153d0c7a89c5d6aec11605959aa">pp_prefix</a>);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="keywordflow">if</span> (pp.contains(pp_plot_var_names.c_str()))</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        std::string nm;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        <span class="keywordtype">int</span> nPltVars = pp.countval(pp_plot_var_names.c_str());</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nPltVars; i++)</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        {</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;            pp.get(pp_plot_var_names.c_str(), nm, i);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;            <span class="comment">// Add the named variable to our list of plot variables</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;            <span class="comment">// if it is not already in the list</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="REMORA_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, nm)) {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                plot_var_names.push_back(nm);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;            }</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        }</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <span class="comment">// The default is to add none of the variables to the list</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        plot_var_names.clear();</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    }</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="comment">// Get state variables in the same order as we define them,</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">// since they may be in any order in the input list</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    Vector&lt;std::string&gt; tmp_plot_names;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; ++i) {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="REMORA_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <a class="code" href="classREMORA.html#a006b52a7c7bc31839827318d5ca2dcee">cons_names</a>[i]) ) {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;            tmp_plot_names.push_back(<a class="code" href="classREMORA.html#a006b52a7c7bc31839827318d5ca2dcee">cons_names</a>[i]);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">// Check for velocity since it&#39;s not in cons_names</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">// If we are asked for any velocity component, we will need them all</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="REMORA_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;x_velocity&quot;</span>) ||</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <a class="code" href="REMORA_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;y_velocity&quot;</span>) ||</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <a class="code" href="REMORA_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;z_velocity&quot;</span>)) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        tmp_plot_names.push_back(<span class="stringliteral">&quot;x_velocity&quot;</span>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        tmp_plot_names.push_back(<span class="stringliteral">&quot;y_velocity&quot;</span>);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        tmp_plot_names.push_back(<span class="stringliteral">&quot;z_velocity&quot;</span>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">// If we are asked for any location component, we will provide them all</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="REMORA_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;x_cc&quot;</span>) ||</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <a class="code" href="REMORA_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;y_cc&quot;</span>) ||</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <a class="code" href="REMORA_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;z_cc&quot;</span>)) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        tmp_plot_names.push_back(<span class="stringliteral">&quot;x_cc&quot;</span>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        tmp_plot_names.push_back(<span class="stringliteral">&quot;y_cc&quot;</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        tmp_plot_names.push_back(<span class="stringliteral">&quot;z_cc&quot;</span>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classREMORA.html#ae91017557bdacda7d14418c7f15967e2">derived_names</a>.size(); ++i) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="REMORA_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <a class="code" href="classREMORA.html#ae91017557bdacda7d14418c7f15967e2">derived_names</a>[i]) ) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_PARTICLES</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            <span class="keywordflow">if</span> (particleData.use_tracer_particles || (<a class="code" href="classREMORA.html#ae91017557bdacda7d14418c7f15967e2">derived_names</a>[i] != <span class="stringliteral">&quot;tracer_particle_count&quot;</span>)) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;               tmp_plot_names.push_back(<a class="code" href="classREMORA.html#ae91017557bdacda7d14418c7f15967e2">derived_names</a>[i]);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_PARTICLES</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        } <span class="comment">// if</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    } <span class="comment">// i</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">// Check to see if we found all the requested variables</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> plot_name : plot_var_names) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="REMORA_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(tmp_plot_names, plot_name)) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;           Warning(<span class="stringliteral">&quot;\nWARNING: Requested to plot variable &#39;&quot;</span> + plot_name + <span class="stringliteral">&quot;&#39; but it is not available&quot;</span>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    plot_var_names = tmp_plot_names;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;}</div>
<div class="ttc" id="aREMORA_8H_html_a1f8554e7b211b0acfc202e8a600e7d67"><div class="ttname"><a href="REMORA_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a></div><div class="ttdeci">bool containerHasElement(const V &amp;iterable, const T &amp;query)</div><div class="ttdef"><b>Definition:</b> REMORA.H:63</div></div>
<div class="ttc" id="aclassREMORA_html_a006b52a7c7bc31839827318d5ca2dcee"><div class="ttname"><a href="classREMORA.html#a006b52a7c7bc31839827318d5ca2dcee">REMORA::cons_names</a></div><div class="ttdeci">const amrex::Vector&lt; std::string &gt; cons_names</div><div class="ttdef"><b>Definition:</b> REMORA.H:811</div></div>
<div class="ttc" id="aclassREMORA_html_ae91017557bdacda7d14418c7f15967e2"><div class="ttname"><a href="classREMORA.html#ae91017557bdacda7d14418c7f15967e2">REMORA::derived_names</a></div><div class="ttdeci">const amrex::Vector&lt; std::string &gt; derived_names</div><div class="ttdef"><b>Definition:</b> REMORA.H:817</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classREMORA_afe11d354ade4deed0c57c6f44f85ab41_cgraph.png" border="0" usemap="#aclassREMORA_afe11d354ade4deed0c57c6f44f85ab41_cgraph" alt=""/></div>
<map name="aclassREMORA_afe11d354ade4deed0c57c6f44f85ab41_cgraph" id="aclassREMORA_afe11d354ade4deed0c57c6f44f85ab41_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,197,32"/>
<area shape="rect" href="REMORA_8H.html#a1f8554e7b211b0acfc202e8a600e7d67" title=" " alt="" coords="245,5,408,32"/>
</map>
</div>

</div>
</div>
<a id="a7f4ee77d07b875ac526da57e8f0f1e98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f4ee77d07b875ac526da57e8f0f1e98">&#9670;&nbsp;</a></span>setRecordDataInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::setRecordDataInfo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    {</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        <span class="keywordflow">if</span> (amrex::ParallelDescriptor::IOProcessor())</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        {</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            <a class="code" href="classREMORA.html#ad3530fc80b87c25ce728095929a4ea99">datalog</a>[i] = std::make_unique&lt;std::fstream&gt;();</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;            <a class="code" href="classREMORA.html#ad3530fc80b87c25ce728095929a4ea99">datalog</a>[i]-&gt;open(filename.c_str(),std::ios::out|std::ios::app);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classREMORA.html#ad3530fc80b87c25ce728095929a4ea99">datalog</a>[i]-&gt;good()) {</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                amrex::FileOpenFailed(filename);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        }</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        amrex::ParallelDescriptor::Barrier(<span class="stringliteral">&quot;REMORA::setRecordDataInfo&quot;</span>);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad9ee5aba5b9cb8e020e6cbc8ff3cff74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9ee5aba5b9cb8e020e6cbc8ff3cff74">&#9670;&nbsp;</a></span>setup_step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::setup_step </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set everything up for a step on a level </p>
<div class="fragment"><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;{</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;REMORA::setup_step()&quot;</span>);</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160; </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    MultiFab&amp; S_old = *<a class="code" href="classREMORA.html#abc6ebdcc84239b993b12b3c95425fa88">cons_old</a>[lev];</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    MultiFab&amp; S_new = *<a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev];</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    MultiFab&amp; U_old = *<a class="code" href="classREMORA.html#a51594dd103a7eee0f4e0c6e366d9f0ce">xvel_old</a>[lev];</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    MultiFab&amp; V_old = *<a class="code" href="classREMORA.html#a9861cf91ee53fb2125f5f49c5cf73155">yvel_old</a>[lev];</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    MultiFab&amp; W_old = *<a class="code" href="classREMORA.html#a6a980b1cd1d4d0e1253a641bee00de75">zvel_old</a>[lev];</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    MultiFab&amp; U_new = *<a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev];</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    MultiFab&amp; V_new = *<a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev];</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    MultiFab&amp; W_new = *<a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[lev];</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keywordtype">int</span> nvars = S_old.nComp();</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="comment">// Fill ghost cells/faces at old time</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#abc6ebdcc84239b993b12b3c95425fa88">cons_old</a>[lev], <a class="code" href="classREMORA.html#abc6ebdcc84239b993b12b3c95425fa88">cons_old</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325abd1c55aaa78d7bcedd3a0e21005f2955">BdyVars::t</a>);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#a51594dd103a7eee0f4e0c6e366d9f0ce">xvel_old</a>[lev], <a class="code" href="classREMORA.html#a51594dd103a7eee0f4e0c6e366d9f0ce">xvel_old</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">BdyVars::u</a>);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#a9861cf91ee53fb2125f5f49c5cf73155">yvel_old</a>[lev], <a class="code" href="classREMORA.html#a9861cf91ee53fb2125f5f49c5cf73155">yvel_old</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">BdyVars::v</a>);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#a6a980b1cd1d4d0e1253a641bee00de75">zvel_old</a>[lev], <a class="code" href="classREMORA.html#a6a980b1cd1d4d0e1253a641bee00de75">zvel_old</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325ab738c65b8fa93b2166002dce928aca27">BdyVars::null</a>);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">    //////////    //pre_step3d corrections to boundaries</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keyword">const</span> BoxArray&amp;            ba = S_old.boxArray();</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keyword">const</span> DistributionMapping&amp; dm = S_old.DistributionMap();</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nrhs  = 0;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nstp  = 0;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">// Place-holder for source array -- for now just set to 0</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    MultiFab source(ba,dm,nvars,1);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    source.setVal(0.0);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">//  Time step momentum equation</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">//Only used locally, probably should be rearranged into FArrayBox declaration</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    MultiFab mf_AK(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)); <span class="comment">//2d missing j coordinate</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    MultiFab mf_DC(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1)); <span class="comment">//2d missing j coordinate</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    MultiFab mf_Hzk(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1)); <span class="comment">//2d missing j coordinate</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    MultiFab* mf_z_r = <a class="code" href="classREMORA.html#a6b24784c109d216c5a6cee02af8c5b0f">vec_z_r</a>[lev].get();</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    MultiFab* mf_z_w = <a class="code" href="classREMORA.html#af7958bb9cfac605c91f1e74357f344b2">vec_z_w</a>[lev].get();</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    MultiFab* mf_h   = <a class="code" href="classREMORA.html#a157e7645fedcf8c0b46516dbb625d3bd">vec_hOfTheConfusingName</a>[lev].get();</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    MultiFab* mf_pm  = <a class="code" href="classREMORA.html#a173014aa6947dd9d4e0026541211f2be">vec_pm</a>[lev].get();</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    MultiFab* mf_pn  =   <a class="code" href="classREMORA.html#ad2d61f66b270a3def972bf32478790d8">vec_pn</a>[lev].get();</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    MultiFab* mf_fcor  = <a class="code" href="classREMORA.html#a13f9894ec6aca96e68687e7a6762e337">vec_fcor</a>[lev].get();</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">//Consider passing these into the advance function or renaming relevant things</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    MultiFab mf_rho(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_rhoS = <a class="code" href="classREMORA.html#a8386c899de7b3b3feab286c144f15229">vec_rhoS</a>[lev];</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_rhoA = <a class="code" href="classREMORA.html#a9acf62fad9b709ea10e00e9534d7a7c5">vec_rhoA</a>[lev];</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_ru = <a class="code" href="classREMORA.html#aaf06acc3074f6a4dd322f9e1ca0c5244">vec_ru</a>[lev];</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_rv = <a class="code" href="classREMORA.html#ae4e70f2661f28e3a3a2585540e804486">vec_rv</a>[lev];</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_rufrc = <a class="code" href="classREMORA.html#a5a0dd90f9e35c6055bf3ede53f4229d6">vec_rufrc</a>[lev];</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_rvfrc = <a class="code" href="classREMORA.html#a49ea2c6c379a0fa006e4b6023fd69f88">vec_rvfrc</a>[lev];</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_sustr = <a class="code" href="classREMORA.html#a347a75f9295217fc66a8b7a4c2a47f9b">vec_sustr</a>[lev];</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_svstr = <a class="code" href="classREMORA.html#a88a26701f7276ea04f5c9ede4ae46981">vec_svstr</a>[lev];</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_rdrag = <a class="code" href="classREMORA.html#adba780a7c66c2158c914bff64964df60">vec_rdrag</a>[lev];</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_bustr = <a class="code" href="classREMORA.html#abd341c53d0813eaea345511b8e14afdd">vec_bustr</a>[lev];</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_bvstr = <a class="code" href="classREMORA.html#ac7d186a8a4d54c28a5b2eecaec6cb978">vec_bvstr</a>[lev];</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    MultiFab mf_rw(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_visc2_p = <a class="code" href="classREMORA.html#a65281506759b30fbc3c382ba0a64f38f">vec_visc2_p</a>[lev];</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_visc2_r = <a class="code" href="classREMORA.html#a86f0a2458c28f42d5be178d7bc5d104b">vec_visc2_r</a>[lev];</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// We need to set these because otherwise in the first call to remora_advance we may</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">//    read uninitialized data on ghost values in setting the bc&#39;s on the velocities</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    mf_rho.setVal(0.e34,IntVect(AMREX_D_DECL(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0)));</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    mf_rhoS-&gt;setVal(0.e34,IntVect(AMREX_D_DECL(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0)));</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    mf_rhoA-&gt;setVal(0.e34,IntVect(AMREX_D_DECL(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0)));</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    mf_DC.setVal(0);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#abc6ebdcc84239b993b12b3c95425fa88">cons_old</a>[lev], <a class="code" href="classREMORA.html#abc6ebdcc84239b993b12b3c95425fa88">cons_old</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325abd1c55aaa78d7bcedd3a0e21005f2955">BdyVars::t</a>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#a51594dd103a7eee0f4e0c6e366d9f0ce">xvel_old</a>[lev], <a class="code" href="classREMORA.html#a51594dd103a7eee0f4e0c6e366d9f0ce">xvel_old</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">BdyVars::u</a>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#a9861cf91ee53fb2125f5f49c5cf73155">yvel_old</a>[lev], <a class="code" href="classREMORA.html#a9861cf91ee53fb2125f5f49c5cf73155">yvel_old</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">BdyVars::v</a>);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev], <a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325abd1c55aaa78d7bcedd3a0e21005f2955">BdyVars::t</a>);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev], <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">BdyVars::u</a>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev], <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">BdyVars::v</a>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    mf_rw.setVal(0.0);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    mf_rufrc-&gt;setVal(0);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    mf_rvfrc-&gt;setVal(0);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordtype">int</span> iic = <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[lev];</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordtype">int</span> ntfirst = 0;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">if</span>(iic==ntfirst) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        MultiFab::Copy(S_new,S_old,0,0,S_new.nComp(),S_new.nGrowVect());</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        MultiFab::Copy(U_new,U_old,0,0,U_new.nComp(),U_new.nGrowVect());</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        MultiFab::Copy(V_new,V_old,0,0,V_new.nComp(),V_new.nGrowVect());</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        MultiFab::Copy(W_new,W_old,0,0,W_new.nComp(),W_new.nGrowVect());</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="classREMORA.html#a4d4e9bae68124255e7ef6e949949d7ae">set_smflux</a>(lev,<a class="code" href="classREMORA.html#ae94018d43dcebc3cd70293e6c621c46a">t_old</a>[lev]);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keyword">auto</span> N = Geom(lev).Domain().size()[2]-1; <span class="comment">// Number of vertical &quot;levs&quot; aka, NZ</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(S_new, TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; h     = <a class="code" href="classREMORA.html#a157e7645fedcf8c0b46516dbb625d3bd">vec_hOfTheConfusingName</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; Hz    = <a class="code" href="classREMORA.html#a488738b1aea61abbbf086a9d22b4f815">vec_Hz</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; Huon  = <a class="code" href="classREMORA.html#a89f042895cd59cc1a1226f2af2d3e04f">vec_Huon</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; Hvom  = <a class="code" href="classREMORA.html#afd1aab14dfc9155d65e48aad2b34ef42">vec_Hvom</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; z_w   = mf_z_w-&gt;const_array(mfi);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; uold  = U_old.const_array(mfi);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; vold  = V_old.const_array(mfi);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; rho   = mf_rho.array(mfi);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; rhoA  = mf_rhoA-&gt;array(mfi);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; rhoS  = mf_rhoS-&gt;array(mfi);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; rdrag = mf_rdrag-&gt;const_array(mfi);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; bustr = mf_bustr-&gt;array(mfi);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; bvstr = mf_bvstr-&gt;array(mfi);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; pm = mf_pm-&gt;const_array(mfi);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; pn = mf_pn-&gt;const_array(mfi);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        Box  bx = mfi.tilebox();</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        Box gbx1 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        Box gbx2 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        Box bxD = bx;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        bxD.makeSlab(2,0);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        Box gbx1D = gbx1;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        gbx1D.makeSlab(2,0);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        Box gbx2D = gbx2;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        gbx2D.makeSlab(2,0);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        FArrayBox fab_FC(gbx2,1,amrex::The_Async_Arena()); <span class="comment">//3D</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        FArrayBox fab_FX(gbx2,1,amrex::The_Async_Arena()); <span class="comment">//3D</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        FArrayBox fab_FE(gbx2,1,amrex::The_Async_Arena()); <span class="comment">//3D</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        FArrayBox fab_BC(gbx2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        FArrayBox fab_CF(gbx2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="comment">// Set bottom stress as defined in set_vbx.F</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        ParallelFor(gbx1D, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            bustr(i,j,0) = 0.5 * (rdrag(i-1,j,0)+rdrag(i,j,0))*(uold(i,j,0));</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            bvstr(i,j,0) = 0.5 * (rdrag(i,j-1,0)+rdrag(i,j,0))*(vold(i,j,0));</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        });</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="comment">//  Compute horizontal mass fluxes, Hz*u/n and Hz*v/m (set_massflux_3d)</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        ParallelFor(Box(Huon), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> on_u = 2.0 / (pn(i-1,j,0)+pn(i,j,0));</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            Huon(i,j,k)=0.5*(Hz(i,j,k)+Hz(i-1,j,k))*uold(i,j,k)* on_u;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        });</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        ParallelFor(Box(Hvom), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> om_v= 2.0 / (pm(i,j-1,0)+pm(i,j,0));</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            Hvom(i,j,k)=0.5*(Hz(i,j,k)+Hz(i,j-1,k))*vold(i,j,k)* om_v;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        });</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; state_old = S_old.const_array(mfi);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <a class="code" href="classREMORA.html#aec60535e082a13276ce2334170205171">rho_eos</a>(gbx2,state_old,rho,rhoA,rhoS,Hz,z_w,h,N);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    MultiFab mf_W(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0));</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    mf_W.setVal(0.0);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#aef43f702963efac7f3e0c2b43249fbb6">use_prestep</a>) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> nnew  = 0;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <a class="code" href="classREMORA.html#ab5e1fd1459f17ce2b00a93b0152c8911">prestep</a>(lev, U_old, V_old, U_new, V_new,</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                mf_ru.get(), mf_rv.get(),</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                S_old, S_new, mf_W,</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                mf_DC, mf_z_r, mf_z_w, mf_h, mf_pm, mf_pn,</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                mf_sustr.get(), mf_svstr.get(), mf_bustr.get(), mf_bvstr.get(),</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                iic, ntfirst, nnew, nstp, nrhs, N, dt_lev);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">// We use FillBoundary not FillPatch here since mf_W is single-level scratch space</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    mf_W.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(S_old, TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; Hz    = <a class="code" href="classREMORA.html#a488738b1aea61abbbf086a9d22b4f815">vec_Hz</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Huon  = <a class="code" href="classREMORA.html#a89f042895cd59cc1a1226f2af2d3e04f">vec_Huon</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Hvom  = <a class="code" href="classREMORA.html#afd1aab14dfc9155d65e48aad2b34ef42">vec_Hvom</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; z_r   = (mf_z_r)-&gt;array(mfi);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; z_w   = (mf_z_w)-&gt;array(mfi);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; uold  = U_old.const_array(mfi);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; vold  = V_old.const_array(mfi);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">u</a>    = U_new.array(mfi);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a>    = V_new.array(mfi);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; rho = (mf_rho).array(mfi);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; ru = (mf_ru)-&gt;array(mfi);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; rv = (mf_rv)-&gt;array(mfi);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; rufrc = (mf_rufrc)-&gt;array(mfi);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; rvfrc = (mf_rvfrc)-&gt;array(mfi);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; W = (mf_W).array(mfi);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; sustr = (mf_sustr)-&gt;array(mfi);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; svstr = (mf_svstr)-&gt;array(mfi);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; bustr = (mf_bustr)-&gt;array(mfi);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; bvstr = (mf_bvstr)-&gt;array(mfi);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; visc2_p = (mf_visc2_p)-&gt;array(mfi);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; visc2_r = (mf_visc2_r)-&gt;array(mfi);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a63be12014785e028dafaa0104fad32fc">zeta</a> = (<a class="code" href="classREMORA.html#ab60f476961622f8e7f27221595e84956">vec_zeta</a>[lev])-&gt;array(mfi);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Zt_avg1 = (<a class="code" href="classREMORA.html#adeb60c66ba4665f07c57fbf3b3b8909a">vec_Zt_avg1</a>[lev])-&gt;array(mfi);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; pm = mf_pm-&gt;const_array(mfi);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; pn = mf_pn-&gt;const_array(mfi);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; fcor = mf_fcor-&gt;const_array(mfi);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        Box bx = mfi.tilebox();</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        Box tbxp1 = bx;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        Box tbxp2 = bx;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        Box xbx = mfi.nodaltilebox(0);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        Box ybx = mfi.nodaltilebox(1);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        Box gbx1 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        Box gbx2 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        Box utbx = mfi.nodaltilebox(0);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        Box vtbx = mfi.nodaltilebox(1);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        tbxp1.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        tbxp2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        Box bxD = bx;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        bxD.makeSlab(2,0);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        Box gbx1D = gbx1;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        gbx1D.makeSlab(2,0);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        Box gbx2D = gbx2;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        gbx2D.makeSlab(2,0);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        Box tbxp1D = tbxp1;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        tbxp1D.makeSlab(2,0);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        Box tbxp2D = tbxp2;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        tbxp2D.makeSlab(2,0);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        FArrayBox fab_FC(tbxp2,1,amrex::The_Async_Arena()); <span class="comment">//3D</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        FArrayBox fab_FX(gbx2,1,amrex::The_Async_Arena()); <span class="comment">//3D</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        FArrayBox fab_FE(gbx2,1,amrex::The_Async_Arena()); <span class="comment">//3D</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        FArrayBox fab_BC(gbx2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        FArrayBox fab_CF(gbx2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        FArrayBox fab_fomn(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keyword">auto</span> FC=fab_FC.array();</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keyword">auto</span> fomn=fab_fomn.array();</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a9e86533aa6df5bf6408d91f0dfd23606">use_coriolis</a>) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            ParallelFor(tbxp2D, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>  )</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                fomn(i,j,0) = fcor(i,j,0)*(1.0/(pm(i,j,0)*pn(i,j,0)));</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            });</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        ParallelFor(gbx2, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            FC(i,j,k)=0.0;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        });</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <a class="code" href="classREMORA.html#af8928e9ae21348d045cc231d56e1d45a">prsgrd</a>(tbxp1,gbx1,utbx,vtbx,ru,rv,pn,pm,rho,FC,Hz,z_r,z_w,nrhs,N);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="comment">// Apply mixing to temperature and, if use_salt, salt</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keywordtype">int</span> ncomp = <a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#afc652006d7343f1e01f5b9967604a0aa">use_salt</a> ? 2 : 1;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp;     s_arr = S_old.array(mfi);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; diff2_arr = <a class="code" href="classREMORA.html#afdf4b75f0ec12caf3648dbee5ec7f653">vec_diff2</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <a class="code" href="classREMORA.html#a7c7e059060888336e41e8a52bf716f06">t3dmix</a>(bx, s_arr, diff2_arr, Hz, pm, pn, dt_lev, ncomp);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; diff2_arr_scalar = <a class="code" href="classREMORA.html#afdf4b75f0ec12caf3648dbee5ec7f653">vec_diff2</a>[lev]-&gt;array(mfi,<a class="code" href="IndexDefines_8H.html#a4dd1335cac3e63bb654450bb807978a4">Scalar_comp</a>);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <a class="code" href="classREMORA.html#a7c7e059060888336e41e8a52bf716f06">t3dmix</a>(bx, S_old.array(mfi,<a class="code" href="IndexDefines_8H.html#a4dd1335cac3e63bb654450bb807978a4">Scalar_comp</a>), diff2_arr_scalar, Hz, pm, pn, dt_lev, 1);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a9e86533aa6df5bf6408d91f0dfd23606">use_coriolis</a>) {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="comment">// coriolis</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <span class="comment">// ru, rv updated</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <span class="comment">// In ROMS, coriolis is the first (un-ifdefed) thing to happen in rhs3d_tile, which gets called after t3dmix</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <a class="code" href="classREMORA.html#af28f51401edd36aa6014d9536e1393da">coriolis</a>(xbx, ybx, uold, vold, ru, rv, Hz, fomn, nrhs, nrhs);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">        ////rufrc from 3d is set to ru, then the wind stress (and bottom stress) is added, then the mixing is added</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment"></span>        <span class="comment">//rufrc=ru+sustr*om_u*on_u</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <a class="code" href="classREMORA.html#a717b3cb13872e3c7bf83261bc7c5e1b0">rhs_uv_3d</a>(xbx, ybx, uold, vold, ru, rv, rufrc, rvfrc,</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                  sustr, svstr, bustr, bvstr, Huon, Hvom,</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                  pm, pn, W, FC, nrhs, N);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a11fa6da1900fa3ad034197da861432ba">use_uv3dmix</a>) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> nnew = 0;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            <a class="code" href="classREMORA.html#a5e195a7da3e0ada7179455688f4711b5">uv3dmix</a>(xbx, ybx, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">u</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a>, uold, vold, rufrc, rvfrc, visc2_p, visc2_r, Hz, pm, pn, nrhs, nnew, dt_lev);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="comment">// Set first two components of zeta to time-averaged values before barotropic update</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        ParallelFor(gbx2D, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a63be12014785e028dafaa0104fad32fc">zeta</a>(i,j,0,0) = Zt_avg1(i,j,0);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a63be12014785e028dafaa0104fad32fc">zeta</a>(i,j,0,1) = Zt_avg1(i,j,0);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        });</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    } <span class="comment">// MFIter</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">// Update Akv with new depth. NOTE: this happens before set_zeta in ROMS</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="classREMORA.html#a72df3d34cb4020524bc7aefe66db5aa8">set_vmix</a>(lev);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#abc6ebdcc84239b993b12b3c95425fa88">cons_old</a>[lev], <a class="code" href="classREMORA.html#abc6ebdcc84239b993b12b3c95425fa88">cons_old</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325abd1c55aaa78d7bcedd3a0e21005f2955">BdyVars::t</a>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev], <a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325abd1c55aaa78d7bcedd3a0e21005f2955">BdyVars::t</a>);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#a3d55e55c73497ceabf620dacbe632a3a">vec_sstore</a>[lev], GetVecOfPtrs(<a class="code" href="classREMORA.html#a3d55e55c73497ceabf620dacbe632a3a">vec_sstore</a>), <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325abd1c55aaa78d7bcedd3a0e21005f2955">BdyVars::t</a>);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#a89f042895cd59cc1a1226f2af2d3e04f">vec_Huon</a>[lev], GetVecOfPtrs(<a class="code" href="classREMORA.html#a89f042895cd59cc1a1226f2af2d3e04f">vec_Huon</a>));</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#afd1aab14dfc9155d65e48aad2b34ef42">vec_Hvom</a>[lev], GetVecOfPtrs(<a class="code" href="classREMORA.html#afd1aab14dfc9155d65e48aad2b34ef42">vec_Hvom</a>));</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;}</div>
<div class="ttc" id="aclassREMORA_html_a4d4e9bae68124255e7ef6e949949d7ae"><div class="ttname"><a href="classREMORA.html#a4d4e9bae68124255e7ef6e949949d7ae">REMORA::set_smflux</a></div><div class="ttdeci">void set_smflux(int lev, amrex::Real time)</div><div class="ttdef"><b>Definition:</b> REMORA.cpp:438</div></div>
<div class="ttc" id="aclassREMORA_html_a717b3cb13872e3c7bf83261bc7c5e1b0"><div class="ttname"><a href="classREMORA.html#a717b3cb13872e3c7bf83261bc7c5e1b0">REMORA::rhs_uv_3d</a></div><div class="ttdeci">void rhs_uv_3d(const amrex::Box &amp;xbx, const amrex::Box &amp;ybx, const amrex::Array4&lt; amrex::Real const &gt; &amp;uold, const amrex::Array4&lt; amrex::Real const &gt; &amp;vold, const amrex::Array4&lt; amrex::Real &gt; &amp;ru, const amrex::Array4&lt; amrex::Real &gt; &amp;rv, const amrex::Array4&lt; amrex::Real &gt; &amp;rufrc, const amrex::Array4&lt; amrex::Real &gt; &amp;rvfrc, const amrex::Array4&lt; amrex::Real const &gt; &amp;sustr, const amrex::Array4&lt; amrex::Real const &gt; &amp;svstr, const amrex::Array4&lt; amrex::Real const &gt; &amp;bustr, const amrex::Array4&lt; amrex::Real const &gt; &amp;bvstr, const amrex::Array4&lt; amrex::Real const &gt; &amp;Huon, const amrex::Array4&lt; amrex::Real const &gt; &amp;Hvom, const amrex::Array4&lt; amrex::Real const &gt; &amp;pm, const amrex::Array4&lt; amrex::Real const &gt; &amp;pn, const amrex::Array4&lt; amrex::Real const &gt; &amp;W, const amrex::Array4&lt; amrex::Real &gt; &amp;FC, int nrhs, int N)</div><div class="ttdef"><b>Definition:</b> REMORA_rhs_uv_3d.cpp:31</div></div>
<div class="ttc" id="aclassREMORA_html_a7c7e059060888336e41e8a52bf716f06"><div class="ttname"><a href="classREMORA.html#a7c7e059060888336e41e8a52bf716f06">REMORA::t3dmix</a></div><div class="ttdeci">void t3dmix(const amrex::Box &amp;bx, const amrex::Array4&lt; amrex::Real &gt; &amp;state, const amrex::Array4&lt; amrex::Real const &gt; &amp;diff2, const amrex::Array4&lt; amrex::Real const &gt; &amp;Hz, const amrex::Array4&lt; amrex::Real const &gt; &amp;pm, const amrex::Array4&lt; amrex::Real const &gt; &amp;pn, const amrex::Real dt_lev, const int ncomp)</div><div class="ttdef"><b>Definition:</b> REMORA_t3dmix.cpp:6</div></div>
<div class="ttc" id="aclassREMORA_html_ab5e1fd1459f17ce2b00a93b0152c8911"><div class="ttname"><a href="classREMORA.html#ab5e1fd1459f17ce2b00a93b0152c8911">REMORA::prestep</a></div><div class="ttdeci">void prestep(int lev, amrex::MultiFab &amp;mf_uold, amrex::MultiFab &amp;mf_vold, amrex::MultiFab &amp;mf_u, amrex::MultiFab &amp;mf_v, amrex::MultiFab *mf_ru, amrex::MultiFab *mf_rv, amrex::MultiFab &amp;S_old, amrex::MultiFab &amp;S_new, amrex::MultiFab &amp;mf_W, amrex::MultiFab &amp;mf_DC, const amrex::MultiFab *mf_z_r, const amrex::MultiFab *mf_z_w, const amrex::MultiFab *mf_h, const amrex::MultiFab *mf_pm, const amrex::MultiFab *mf_pn, const amrex::MultiFab *mf_sustr, const amrex::MultiFab *mf_svstr, const amrex::MultiFab *mf_bustr, const amrex::MultiFab *mf_bvstr, const int iic, const int nfirst, const int nnew, int nstp, int nrhs, int N, const amrex::Real dt_lev)</div><div class="ttdef"><b>Definition:</b> REMORA_prestep.cpp:34</div></div>
<div class="ttc" id="aclassREMORA_html_aec60535e082a13276ce2334170205171"><div class="ttname"><a href="classREMORA.html#aec60535e082a13276ce2334170205171">REMORA::rho_eos</a></div><div class="ttdeci">void rho_eos(const amrex::Box &amp;bx, const amrex::Array4&lt; amrex::Real const &gt; &amp;state, const amrex::Array4&lt; amrex::Real &gt; &amp;rho, const amrex::Array4&lt; amrex::Real &gt; &amp;rhoA, const amrex::Array4&lt; amrex::Real &gt; &amp;rhoS, const amrex::Array4&lt; amrex::Real const &gt; &amp;Hz, const amrex::Array4&lt; amrex::Real const &gt; &amp;z_w, const amrex::Array4&lt; amrex::Real const &gt; &amp;h, const int N)</div><div class="ttdef"><b>Definition:</b> REMORA_rho_eos.cpp:20</div></div>
<div class="ttc" id="aclassREMORA_html_af8928e9ae21348d045cc231d56e1d45a"><div class="ttname"><a href="classREMORA.html#af8928e9ae21348d045cc231d56e1d45a">REMORA::prsgrd</a></div><div class="ttdeci">void prsgrd(const amrex::Box &amp;bx, const amrex::Box &amp;gbx, const amrex::Box &amp;utbx, const amrex::Box &amp;vtbx, const amrex::Array4&lt; amrex::Real &gt; &amp;ru, const amrex::Array4&lt; amrex::Real &gt; &amp;rv, const amrex::Array4&lt; amrex::Real const &gt; &amp;pn, const amrex::Array4&lt; amrex::Real const &gt; &amp;pm, const amrex::Array4&lt; amrex::Real const &gt; &amp;rho, const amrex::Array4&lt; amrex::Real &gt; &amp;FC, const amrex::Array4&lt; amrex::Real const &gt; &amp;Hz, const amrex::Array4&lt; amrex::Real const &gt; &amp;z_r, const amrex::Array4&lt; amrex::Real const &gt; &amp;z_w, const int nrhs, const int N)</div><div class="ttdef"><b>Definition:</b> REMORA_prsgrd.cpp:6</div></div>
<div class="ttc" id="astructSolverChoice_html_a11fa6da1900fa3ad034197da861432ba"><div class="ttname"><a href="structSolverChoice.html#a11fa6da1900fa3ad034197da861432ba">SolverChoice::use_uv3dmix</a></div><div class="ttdeci">bool use_uv3dmix</div><div class="ttdef"><b>Definition:</b> DataStruct.H:198</div></div>
<div class="ttc" id="astructSolverChoice_html_aef43f702963efac7f3e0c2b43249fbb6"><div class="ttname"><a href="structSolverChoice.html#aef43f702963efac7f3e0c2b43249fbb6">SolverChoice::use_prestep</a></div><div class="ttdeci">bool use_prestep</div><div class="ttdef"><b>Definition:</b> DataStruct.H:197</div></div>
<div class="ttc" id="astructSolverChoice_html_afc652006d7343f1e01f5b9967604a0aa"><div class="ttname"><a href="structSolverChoice.html#afc652006d7343f1e01f5b9967604a0aa">SolverChoice::use_salt</a></div><div class="ttdeci">bool use_salt</div><div class="ttdef"><b>Definition:</b> DataStruct.H:191</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a20f12090c7b81ca46d953ccf1319c0f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20f12090c7b81ca46d953ccf1319c0f5">&#9670;&nbsp;</a></span>stretch_transform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::stretch_transform </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;{</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_z_w = <a class="code" href="classREMORA.html#af7958bb9cfac605c91f1e74357f344b2">vec_z_w</a>[lev];</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_z_r = <a class="code" href="classREMORA.html#a6b24784c109d216c5a6cee02af8c5b0f">vec_z_r</a>[lev];</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_s_r = <a class="code" href="classREMORA.html#afc9f775b64d67d4ad85bc493c9c54f4f">vec_s_r</a>[lev];</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_Hz  = <a class="code" href="classREMORA.html#a488738b1aea61abbbf086a9d22b4f815">vec_Hz</a>[lev];</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_h  = <a class="code" href="classREMORA.html#a157e7645fedcf8c0b46516dbb625d3bd">vec_hOfTheConfusingName</a>[lev];</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_Zt_avg1  = <a class="code" href="classREMORA.html#adeb60c66ba4665f07c57fbf3b3b8909a">vec_Zt_avg1</a>[lev];</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_z_phys_nd  = <a class="code" href="classREMORA.html#ac956bf3a52181b34d3e98a85ea5ba131">vec_z_phys_nd</a>[lev];</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keyword">auto</span> N_loop = Geom(lev).Domain().size()[2]-1; <span class="comment">// Number of vertical &quot;levs&quot; aka, NZ</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(*<a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    {</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;      Array4&lt;Real&gt; <span class="keyword">const</span>&amp; z_w = (mf_z_w)-&gt;array(mfi);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;      Array4&lt;Real&gt; <span class="keyword">const</span>&amp; z_r = (mf_z_r)-&gt;array(mfi);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;      Array4&lt;Real&gt; <span class="keyword">const</span>&amp; s_r = (mf_s_r)-&gt;array(mfi);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;      Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Hz  = (mf_Hz)-&gt;array(mfi);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;      Array4&lt;Real&gt; <span class="keyword">const</span>&amp; h  = (mf_h)-&gt;array(mfi);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;      Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Zt_avg1  = (mf_Zt_avg1)-&gt;array(mfi);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      Box bx = mfi.tilebox();</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      Box gbx2 = bx;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      gbx2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      Box gbx3 = bx;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      gbx3.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0));</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      Box gbx2D = gbx2;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      gbx2D.makeSlab(2,0);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      Box gbx3D = gbx3;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      gbx3D.makeSlab(2,0);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      Box wgbx3 = gbx3.surroundingNodes(2);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> &amp; geomdata = Geom(lev).data();</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="keywordtype">int</span> nz = geom[lev].Domain().length(2);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <span class="keyword">auto</span> N = nz; <span class="comment">// Number of vertical &quot;levels&quot; aka, NZ</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="comment">//forcing tcline to be the same as probhi for now, one in DataStruct.H other in inputs</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> hc=-min(geomdata.ProbHi(2),-<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8567bc83a2159c88c5372ea30770725e">tcline</a>); <span class="comment">// Do we need to enforce min here?</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> local_theta_s = <a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a6c6e710a8470aace72066b3dfdd69017">theta_s</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> local_theta_b = <a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a6b82e27f159d8bc0bf4e3429cecce8b5">theta_b</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      amrex::ParallelFor(wgbx3, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;          z_w(i,j,k) = h(i,j,0);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      });</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="comment">// ROMS Transform 2</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      Gpu::streamSynchronize();</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      amrex::ParallelFor(gbx3D, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=-1; k&lt;=N_loop; k++) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;              <span class="comment">//        const Real z = prob_lo[2] + (k + 0.5) * dx[2];</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;              <span class="comment">// const auto prob_lo         = geomdata.ProbLo();</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;              <span class="comment">// const auto dx              = geomdata.CellSize();</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;              <span class="comment">// This is the z for the bottom of the cell this k corresponds to</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;              <span class="comment">//   if we weren&#39;t stretching and transforming</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;              <span class="comment">//        const Real z = prob_lo[2] + (k) * dx[2];</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;              <span class="comment">//        h(i,j,0) = -prob_lo[2]; // conceptually</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">              ////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"></span>              <span class="comment">//ROMS Stretching 4</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;              <span class="comment">// Move this block to it&#39;s own function for maintainability if needed</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;              <span class="comment">// Information about the problem dimension would need to be added</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;              <span class="comment">// This file would need a k dependent function to return the</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;              <span class="comment">// stretching scalars, or access to 4 vectors of length prob_length(2)</span><span class="comment"></span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">              /////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment"></span>              <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> ds = 1.0_rt / <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(N);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;              <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff_r, cff_w, cff1_r, cff1_w, cff2_r, cff2_w, Csur, Cbot;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;              <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> sc_r,sc_w,Cs_r,Cs_w;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;              <span class="keywordflow">if</span> (k==N) <span class="comment">// end of array // pretend we&#39;re storing 0?</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;              {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                  sc_w=0.0; <span class="comment">//sc_w / hc</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                  Cs_w=0.0; <span class="comment">//Cs_w</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;              }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k==0) <span class="comment">// beginning of array</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;              {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                  sc_w=-1.0; <span class="comment">//sc_w / hc</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                  Cs_w=-1.0; <span class="comment">//Cs_w</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;              }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;              {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                sc_w=ds*(k-N);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                <span class="keywordflow">if</span> (local_theta_s &gt; 0.0_rt) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                  Csur=(1.0_rt-std::cosh(local_theta_s*sc_w))/</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                    (std::cosh(local_theta_s)-1.0_rt);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                  Csur=-sc_w*sc_w;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                <span class="keywordflow">if</span> (local_theta_b &gt; 0.0_rt) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                  Cbot=(std::exp(local_theta_b*Csur)-1.0_rt)/</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                    (1.0_rt-std::exp(-local_theta_b));</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                  Cs_w=Cbot;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                  Cs_w=Csur;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;              } <span class="comment">// k test</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;              cff_w=hc*sc_w;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;              cff1_w=Cs_w;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;              <span class="comment">//cff_r =&gt; sc_r *hc</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;              <span class="comment">//cff1_r =&gt; Cs_r</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;              <span class="comment">//Don&#39;t do anything special for first/last index</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;              {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                sc_r=ds*(k-N+0.5_rt);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                <span class="keywordflow">if</span> (local_theta_s &gt; 0.0_rt) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                  Csur=(1.0_rt-std::cosh(local_theta_s*sc_r))/</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                    (std::cosh(local_theta_s)-1.0_rt);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                  Csur=-sc_r*sc_r;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                <span class="keywordflow">if</span> (local_theta_b &gt; 0.0_rt) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                  Cbot=(std::exp(local_theta_b*Csur)-1.0_rt)/</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                    (1.0_rt-std::exp(-local_theta_b));</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                  Cs_r=Cbot;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                  Cs_r=Csur;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;              }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;              <span class="keywordflow">if</span> (i==0&amp;&amp;j==0&amp;&amp;k&lt;N&amp;&amp;k&gt;=0) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                  s_r(0,0,k) = sc_r;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;              }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;              cff_r=hc*sc_r;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;              cff1_r=Cs_r;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">              ////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"></span>              <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> hwater=h(i,j,0);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;              <span class="comment">//</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;              <span class="comment">// if (k==0)  //extra guess added (maybe not actually defined in ROMS)</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;              <span class="comment">// {</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;              <span class="comment">//     Real hinv=1.0_rt/(hc+hwater);</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;              <span class="comment">//     cff2_r=(cff_r+cff1_r*hwater)*hinv;</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;              <span class="comment">//     //         z_w(i,j,k-2) = hwater;</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;              <span class="comment">//     //         z_w(i,j,k-1)= -hwater;</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;              <span class="comment">//     z_r(i,j,k) = Zt_avg1(i,j,0)+(Zt_avg1(i,j,0)+hwater)*cff2_r;</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;              <span class="comment">//     Hz(i,j,k)=z_w(i,j,k)+hwater;//-z_w(i,j,k-1);</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;              <span class="comment">// } else</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;              <span class="comment">//Note, we are not supporting ICESHELF flag</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;              <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> hinv=1.0_rt/(hc+hwater);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;              cff2_r=(cff_r+cff1_r*hwater)*hinv;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;              cff2_w=(cff_w+cff1_w*hwater)*hinv;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;              <span class="keywordflow">if</span>(k==0) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                  <span class="comment">// HACK: should actually be the normal expression with coeffs evaluated at k=N-1</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                  z_w(i,j,N-1)=Zt_avg1(i,j,0);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;              } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k==-1) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                  h(i,j,0,1) = Zt_avg1(i,j,0)+(Zt_avg1(i,j,0)+hwater)*cff2_w;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;              } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                  z_w(i,j,k-1)=Zt_avg1(i,j,0)+(Zt_avg1(i,j,0)+hwater)*cff2_w;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;              }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;              <span class="keywordflow">if</span>(k!=-1) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                  z_r(i,j,k)=Zt_avg1(i,j,0)+(Zt_avg1(i,j,0)+hwater)*cff2_r;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;              }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;          } <span class="comment">// k</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      });</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      Gpu::streamSynchronize();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      amrex::ParallelFor(gbx3, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;          <span class="keywordflow">if</span> (k==0) {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;              Hz(i,j,k)=z_w(i,j,k)+h(i,j,0);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;              Hz(i,j,k)=z_w(i,j,k)-z_w(i,j,k-1);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;          }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      });</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> time = <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev];</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#af7958bb9cfac605c91f1e74357f344b2">vec_z_w</a>[lev], GetVecOfPtrs(<a class="code" href="classREMORA.html#af7958bb9cfac605c91f1e74357f344b2">vec_z_w</a>));</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#a6b24784c109d216c5a6cee02af8c5b0f">vec_z_r</a>[lev], GetVecOfPtrs(<a class="code" href="classREMORA.html#a6b24784c109d216c5a6cee02af8c5b0f">vec_z_r</a>));</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#afc9f775b64d67d4ad85bc493c9c54f4f">vec_s_r</a>[lev], GetVecOfPtrs(<a class="code" href="classREMORA.html#afc9f775b64d67d4ad85bc493c9c54f4f">vec_s_r</a>));</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, time, *<a class="code" href="classREMORA.html#a488738b1aea61abbbf086a9d22b4f815">vec_Hz</a>[lev] , GetVecOfPtrs(<a class="code" href="classREMORA.html#a488738b1aea61abbbf086a9d22b4f815">vec_Hz</a>));</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// Define nodal z as average of z on w-faces</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(*<a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      Array4&lt;Real&gt; <span class="keyword">const</span>&amp; z_w = (mf_z_w)-&gt;array(mfi);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      Array4&lt;Real&gt; <span class="keyword">const</span>&amp; z_phys_nd  = (mf_z_phys_nd)-&gt;array(mfi);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      Box z_w_box = Box(z_w);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keyword">auto</span> <span class="keyword">const</span> lo = amrex::lbound(z_w_box);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keyword">auto</span> <span class="keyword">const</span> hi = amrex::ubound(z_w_box);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="comment">// WARNING: z_w(i,j,k)       refers to the face on the HIGH side of cell (i,j,k)</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <span class="comment">// WARNING: z_phys_nd(i,j,k) refers to the node on the LOW  side of cell (i,j,k)</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      ParallelFor(Box(z_phys_nd), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;          <span class="comment">// For now assume all boundaries are constant height --</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          <span class="comment">//     we will enforce periodicity below</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          <span class="keywordtype">int</span> kk = (k == 0) ? hi.z : k-1;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;          if ( i &gt;= lo.x &amp;&amp; i &lt;= hi.x-1 &amp;&amp; j &gt;= lo.y &amp;&amp; j &lt;= hi.y-1 )</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;          {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;              z_phys_nd(i,j,k)=0.25*( z_w(i,j  ,kk) + z_w(i+1,j  ,kk) +</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                                      z_w(i,j+1,kk) + z_w(i+1,j+1,kk) );</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;             <span class="keywordtype">int</span> ii = std::min(std::max(i, lo.x), hi.x);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;             <span class="keywordtype">int</span> jj = std::min(std::max(j, lo.y), hi.y);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;             z_phys_nd(i,j,k) = z_w(ii,jj,kk);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;          }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          <span class="keywordflow">if</span> (k == 0)  z_phys_nd(i,j,k) *= -1.;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      });</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    } <span class="comment">// mf</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">// Note that we do *not* want to do a multilevel fill here -- we have</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">// already filled z_phys_nd on the grown boxes, but we enforce periodicity just in case</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="classREMORA.html#ac956bf3a52181b34d3e98a85ea5ba131">vec_z_phys_nd</a>[lev]-&gt;FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;}</div>
<div class="ttc" id="astructSolverChoice_html_a6b82e27f159d8bc0bf4e3429cecce8b5"><div class="ttname"><a href="structSolverChoice.html#a6b82e27f159d8bc0bf4e3429cecce8b5">SolverChoice::theta_b</a></div><div class="ttdeci">amrex::Real theta_b</div><div class="ttdef"><b>Definition:</b> DataStruct.H:215</div></div>
<div class="ttc" id="astructSolverChoice_html_a6c6e710a8470aace72066b3dfdd69017"><div class="ttname"><a href="structSolverChoice.html#a6c6e710a8470aace72066b3dfdd69017">SolverChoice::theta_s</a></div><div class="ttdeci">amrex::Real theta_s</div><div class="ttdef"><b>Definition:</b> DataStruct.H:214</div></div>
<div class="ttc" id="astructSolverChoice_html_a8567bc83a2159c88c5372ea30770725e"><div class="ttname"><a href="structSolverChoice.html#a8567bc83a2159c88c5372ea30770725e">SolverChoice::tcline</a></div><div class="ttdeci">amrex::Real tcline</div><div class="ttdef"><b>Definition:</b> DataStruct.H:216</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aafa685722589c03eb84d71568feb26bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafa685722589c03eb84d71568feb26bc">&#9670;&nbsp;</a></span>sum_integrated_quantities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::sum_integrated_quantities </td>
          <td>(</td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Integrate conserved quantities for diagnostics </p>
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;REMORA::sum_integrated_quantities()&quot;</span>);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#ad9ed53f5f841397304bf3b16fc82ecd9">verbose</a> &lt;= 0)</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keywordtype">int</span> datwidth = 14;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keywordtype">int</span> datprecision = 6;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> scalar = 0.0;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> kineng = 0.0;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    {</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        MultiFab kineng_mf(grids[lev], dmap[lev], 1, 0);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        MultiFab cc_vel_mf(grids[lev], dmap[lev], 3, 0);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        average_face_to_cellcenter(cc_vel_mf,0,</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;            Array&lt;const MultiFab*,3&gt;{<a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev],<a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev],<a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[lev]});</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="keywordflow">for</span> (MFIter mfi(*<a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;            <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;            <span class="keyword">const</span> Array4&lt;      Real&gt; kineng_arr = kineng_mf.array(mfi);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;            <span class="keyword">const</span> Array4&lt;const Real&gt;    vel_arr = cc_vel_mf.const_array(mfi);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;            ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;            {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                kineng_arr(i,j,k) = 0.5 * ( vel_arr(i,j,k,0)*vel_arr(i,j,k,0) + vel_arr(i,j,k,1)*vel_arr(i,j,k,1) +</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                                            vel_arr(i,j,k,2)*vel_arr(i,j,k,2) );</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            });</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        scalar += <a class="code" href="classREMORA.html#abeeb495dbfc8b1a3f35556f156d4b3d2">volWgtSumMF</a>(lev,*<a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev],<a class="code" href="IndexDefines_8H.html#a4dd1335cac3e63bb654450bb807978a4">Scalar_comp</a>,<span class="keyword">false</span>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        kineng += <a class="code" href="classREMORA.html#abeeb495dbfc8b1a3f35556f156d4b3d2">volWgtSumMF</a>(lev,kineng_mf     ,             0,<span class="keyword">false</span>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#ad9ed53f5f841397304bf3b16fc82ecd9">verbose</a> &gt; 0) {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> nfoo = 2;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> foo[nfoo] = {scalar,kineng};</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#ifdef AMREX_LAZY</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        Lazy::QueueReduction([=]() <span class="keyword">mutable</span> {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        ParallelDescriptor::ReduceRealSum(</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            foo, nfoo, ParallelDescriptor::IOProcessorNumber());</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;          <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            scalar = foo[i++];</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            kineng = foo[i++];</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            amrex::Print() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;TIME= &quot;</span> &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; SCALAR      = &quot;</span> &lt;&lt; scalar &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;TIME= &quot;</span> &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; KIN. ENG.   = &quot;</span> &lt;&lt; kineng &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#abe6c7702fc1edcb5bb7d9a1a56d007a9">NumDataLogs</a>() &gt; 0) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                std::ostream&amp; data_log1 = <a class="code" href="classREMORA.html#a82e5140a7b4d9092e8230b7043d0a388">DataLog</a>(0);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                <span class="keywordflow">if</span> (data_log1.good()) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                    <span class="keywordflow">if</span> (time == 0.0) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                        data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; <span class="stringliteral">&quot;          time&quot;</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                        data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; <span class="stringliteral">&quot;        scalar&quot;</span>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                        data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; <span class="stringliteral">&quot;        kineng&quot;</span>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                        data_log1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                    }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                  <span class="comment">// Write the quantities at this time</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                  data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; time;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                  data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                            &lt;&lt; scalar;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                  data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision)</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                            &lt;&lt; kineng;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                  data_log1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;              }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;          }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#ifdef AMREX_LAZY</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        });</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;}</div>
<div class="ttc" id="aclassREMORA_html_a82e5140a7b4d9092e8230b7043d0a388"><div class="ttname"><a href="classREMORA.html#a82e5140a7b4d9092e8230b7043d0a388">REMORA::DataLog</a></div><div class="ttdeci">AMREX_FORCE_INLINE std::ostream &amp; DataLog(int i)</div><div class="ttdef"><b>Definition:</b> REMORA.H:924</div></div>
<div class="ttc" id="aclassREMORA_html_abe6c7702fc1edcb5bb7d9a1a56d007a9"><div class="ttname"><a href="classREMORA.html#abe6c7702fc1edcb5bb7d9a1a56d007a9">REMORA::NumDataLogs</a></div><div class="ttdeci">AMREX_FORCE_INLINE int NumDataLogs() noexcept</div><div class="ttdef"><b>Definition:</b> REMORA.H:931</div></div>
<div class="ttc" id="aclassREMORA_html_abeeb495dbfc8b1a3f35556f156d4b3d2"><div class="ttname"><a href="classREMORA.html#abeeb495dbfc8b1a3f35556f156d4b3d2">REMORA::volWgtSumMF</a></div><div class="ttdeci">amrex::Real volWgtSumMF(int lev, const amrex::MultiFab &amp;mf, int comp, bool local, bool finemask)</div><div class="ttdef"><b>Definition:</b> REMORA_SumIQ.cpp:89</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c7e059060888336e41e8a52bf716f06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c7e059060888336e41e8a52bf716f06">&#9670;&nbsp;</a></span>t3dmix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::t3dmix </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>diff2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>pm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>pn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ncomp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Harmonic diffusivity for tracers </p>
<div class="fragment"><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;{</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="comment">//  Add in harmonic diffusivity s terms.</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    Box xbx(bx); xbx.surroundingNodes(0);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    Box ybx(bx); ybx.surroundingNodes(1);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    FArrayBox fab_FX(xbx,ncomp,The_Async_Arena());</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    FArrayBox fab_FE(ybx,ncomp,The_Async_Arena());</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keyword">auto</span> FX=fab_FX.array();</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keyword">auto</span> FE=fab_FE.array();</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    ParallelFor(xbx, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n)</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> pmon_u = (pm(i-1,j,0)+pm(i,j,0))/(pn(i-1,j,0)+pn(i,j,0));</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = 0.25 * (diff2(i,j,n) + diff2(i-1,j,n)) * pmon_u;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        FX(i,j,k,n) = cff * (Hz(i,j,k) + Hz(i+1,j,k)) * (state(i,j,k,n)-state(i-1,j,k,n));</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    });</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    ParallelFor(ybx, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n)</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> pnom_v = (pn(i,j-1,0)+pn(i,j,0))/(pm(i,j-1,0)+pm(i,j,0));</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = 0.25*(diff2(i,j,n)+diff2(i,j-1,n)) * pnom_v;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        FE(i,j,k,n) = cff * (Hz(i,j,k) + Hz(i,j-1,k)) * (state(i,j,k,n) - state(i,j-1,k,n));</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    });</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">     Time-step harmonic, S-surfaces diffusion term.</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    ParallelFor(bx, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n)</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = dt_lev*pm(i,j,0)*pn(i,j,0);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        state(i,j,k,n) += cff * ( (FX(i+1,j  ,k,n)-FX(i,j,k,n))</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                                 +(FE(i  ,j+1,k,n)-FE(i,j,k,n)) );</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    });</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac88ed7a3bf97eec4dca7f70126a0600d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac88ed7a3bf97eec4dca7f70126a0600d">&#9670;&nbsp;</a></span>timeStep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::timeStep </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iteration</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>advance a level by dt, includes a recursive call for finer levels </p>
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a5d3ceaf421e5e6ec42b4da2fcb2d610c">regrid_int</a> &gt; 0)  <span class="comment">// We may need to regrid</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    {</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        <span class="comment">// help keep track of whether a level was already regridded</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        <span class="comment">// from a coarser level call to regrid</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        <span class="keyword">static</span> Vector&lt;int&gt; last_regrid_step(max_level+1, 0);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        <span class="comment">// regrid changes level &quot;lev+1&quot; so we don&#39;t regrid on max_level</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        <span class="comment">// also make sure we don&#39;t regrid fine levels again if</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        <span class="comment">// it was taken care of during a coarser regrid</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        <span class="keywordflow">if</span> (lev &lt; max_level &amp;&amp; <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[lev] &gt; last_regrid_step[lev])</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        {</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[lev] % <a class="code" href="classREMORA.html#a5d3ceaf421e5e6ec42b4da2fcb2d610c">regrid_int</a> == 0)</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;            {</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;                <span class="comment">// regrid could add newly refine levels (if finest_level &lt; max_level)</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;                <span class="comment">// so we save the previous finest level index</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                <span class="keywordtype">int</span> old_finest = finest_level;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                regrid(lev, time);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;                <span class="comment">// Mark that we have regridded this level already</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = lev; k &lt;= finest_level; ++k) {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                    last_regrid_step[k] = <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[k];</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                }</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                <span class="comment">// If there are newly created levels, set the time step</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = old_finest+1; k &lt;= finest_level; ++k) {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                    <a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[k] = <a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[k-1] / MaxRefRatio(k-1);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                }</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;            }</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        }</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// Update what we call &quot;old&quot; and &quot;new&quot; time</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="classREMORA.html#ae94018d43dcebc3cd70293e6c621c46a">t_old</a>[lev] = <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev];</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev] += <a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[lev];</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">if</span> (Verbose()) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;[Level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; step &quot;</span> &lt;&lt; <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[lev]+1 &lt;&lt; <span class="stringliteral">&quot;] &quot;</span>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;ADVANCE from time = &quot;</span> &lt;&lt; <a class="code" href="classREMORA.html#ae94018d43dcebc3cd70293e6c621c46a">t_old</a>[lev] &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev]</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot; with dt = &quot;</span> &lt;&lt; <a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[lev] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">// We must swap the pointers so the previous step&#39;s &quot;new&quot; is now this step&#39;s &quot;old&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    std::swap(<a class="code" href="classREMORA.html#abc6ebdcc84239b993b12b3c95425fa88">cons_old</a>[lev], <a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev]);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    std::swap(<a class="code" href="classREMORA.html#a51594dd103a7eee0f4e0c6e366d9f0ce">xvel_old</a>[lev], <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev]);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    std::swap(<a class="code" href="classREMORA.html#a9861cf91ee53fb2125f5f49c5cf73155">yvel_old</a>[lev], <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev]);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    std::swap(<a class="code" href="classREMORA.html#a6a980b1cd1d4d0e1253a641bee00de75">zvel_old</a>[lev], <a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[lev]);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="comment">// Advance a single level for a single time step</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="classREMORA.html#a9a67a95c1bc1f744268a245f4ca4c446">Advance</a>(lev, time, <a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[lev], iteration, <a class="code" href="classREMORA.html#a7595b63fdb3f613a189cd20936290d2b">nsubsteps</a>[lev]);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    ++<a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[lev];</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">if</span> (Verbose())</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;[Level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; step &quot;</span> &lt;&lt; <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[lev] &lt;&lt; <span class="stringliteral">&quot;] &quot;</span>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Advanced &quot;</span> &lt;&lt; CountCells(lev) &lt;&lt; <span class="stringliteral">&quot; cells&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">if</span> (lev &lt; finest_level)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="comment">// recursive call for next-finer level</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= <a class="code" href="classREMORA.html#a7595b63fdb3f613a189cd20936290d2b">nsubsteps</a>[lev+1]; ++i)</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <a class="code" href="classREMORA.html#ac88ed7a3bf97eec4dca7f70126a0600d">timeStep</a>(lev+1, time+(i-1)*<a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[lev+1], i);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == <a class="code" href="DataStruct_8H.html#ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815">CouplingType::TwoWay</a>) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            <a class="code" href="classREMORA.html#a685a244b9590a93bd7272b2261d0ecf3">AverageDownTo</a>(lev); <span class="comment">// average lev+1 down to lev</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;}</div>
<div class="ttc" id="aclassREMORA_html_a9a67a95c1bc1f744268a245f4ca4c446"><div class="ttname"><a href="classREMORA.html#a9a67a95c1bc1f744268a245f4ca4c446">REMORA::Advance</a></div><div class="ttdeci">void Advance(int lev, amrex::Real time, amrex::Real dt_lev, int iteration, int ncycle)</div><div class="ttdef"><b>Definition:</b> REMORA_Advance.cpp:7</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acf259537f6d9c23a0edcf6641381a9d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf259537f6d9c23a0edcf6641381a9d0">&#9670;&nbsp;</a></span>timeStepML()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::timeStepML </td>
          <td>(</td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iteration</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>advance all levels by dt, loops over finer levels </p>
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <span class="comment">// HACK HACK so lev is defined and compiler won&#39;t complain, but always say regrid_int=-1</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev=0; lev &lt;= finest_level;lev++) {</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a5d3ceaf421e5e6ec42b4da2fcb2d610c">regrid_int</a> &gt; 0)  <span class="comment">// We may need to regrid</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;            <span class="comment">// help keep track of whether a level was already regridded</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;            <span class="comment">// from a coarser level call to regrid</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;            <span class="keyword">static</span> Vector&lt;int&gt; last_regrid_step(max_level+1, 0);</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;            <span class="comment">// regrid changes level &quot;lev+1&quot; so we don&#39;t regrid on max_level</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;            <span class="comment">// also make sure we don&#39;t regrid fine levels again if</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;            <span class="comment">// it was taken care of during a coarser regrid</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;            <span class="keywordflow">if</span> (lev &lt; max_level &amp;&amp; <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[lev] &gt; last_regrid_step[lev])</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;            {</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[lev] % <a class="code" href="classREMORA.html#a5d3ceaf421e5e6ec42b4da2fcb2d610c">regrid_int</a> == 0)</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;                {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                    <span class="comment">// regrid could add newly refine levels (if finest_level &lt; max_level)</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                    <span class="comment">// so we save the previous finest level index</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;                    <span class="keywordtype">int</span> old_finest = finest_level;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;                    regrid(lev, time);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                    <span class="comment">// Mark that we have regridded this level already</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = lev; k &lt;= finest_level; ++k) {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;                        last_regrid_step[k] = <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[k];</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                    }</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                    <span class="comment">// If there are newly created levels, set the time step</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = old_finest+1; k &lt;= finest_level; ++k) {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                        <a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[k] = <a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[k-1] / MaxRefRatio(k-1);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                    }</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            }</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev=0; lev &lt;= finest_level;lev++)</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="comment">// Update what we call &quot;old&quot; and &quot;new&quot; time</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <a class="code" href="classREMORA.html#ae94018d43dcebc3cd70293e6c621c46a">t_old</a>[lev] = <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev];</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev] += <a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[lev];</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keywordflow">if</span> (Verbose()) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;[Level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; step &quot;</span> &lt;&lt; <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[lev]+1 &lt;&lt; <span class="stringliteral">&quot;] &quot;</span>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;ADVANCE from time = &quot;</span> &lt;&lt; <a class="code" href="classREMORA.html#ae94018d43dcebc3cd70293e6c621c46a">t_old</a>[lev] &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev]</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                           &lt;&lt; <span class="stringliteral">&quot; with dt = &quot;</span> &lt;&lt; <a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[lev] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="comment">// We must swap the pointers so the previous step&#39;s &quot;new&quot; is now this step&#39;s &quot;old&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        std::swap(<a class="code" href="classREMORA.html#abc6ebdcc84239b993b12b3c95425fa88">cons_old</a>[lev], <a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev]);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        std::swap(<a class="code" href="classREMORA.html#a51594dd103a7eee0f4e0c6e366d9f0ce">xvel_old</a>[lev], <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev]);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        std::swap(<a class="code" href="classREMORA.html#a9861cf91ee53fb2125f5f49c5cf73155">yvel_old</a>[lev], <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev]);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        std::swap(<a class="code" href="classREMORA.html#a6a980b1cd1d4d0e1253a641bee00de75">zvel_old</a>[lev], <a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[lev]);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <a class="code" href="classREMORA.html#ad9ee5aba5b9cb8e020e6cbc8ff3cff74">setup_step</a>(lev, time, <a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[lev]);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a2a6fbf7ebea6ac5d9faddcbfe36771bd">use_barotropic</a>)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordtype">int</span> nfast_counter=<a class="code" href="classREMORA.html#a05d2c2f58537f7fdae1bb5088f50e149">nfast</a> + 1;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev=0; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <span class="comment">//Compute fast timestep from dt_lev and ratio</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dtfast_lev=<a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[lev]/<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(<a class="code" href="classREMORA.html#acc900ee008729de41eb6aa28a36f6a26">fixed_ndtfast_ratio</a>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> my_iif = 0; my_iif &lt; nfast_counter; my_iif++) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                <a class="code" href="classREMORA.html#a67b92f7c5b82933e953e447bdfc9074c">advance_2d_onestep</a>(lev, <a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[lev], dtfast_lev, my_iif, nfast_counter);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            } <span class="comment">// my_iif</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        } <span class="comment">// lev</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    } <span class="comment">// use_barotropic</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev=0; lev &lt;= finest_level; lev++) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <a class="code" href="classREMORA.html#a805863a28beceb70cefd0b6f050d8c2d">advance_3d_ml</a>(lev, <a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[lev]);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        ++<a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[lev];</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordflow">if</span> (Verbose())</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;[Level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; step &quot;</span> &lt;&lt; <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[lev] &lt;&lt; <span class="stringliteral">&quot;] &quot;</span>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Advanced &quot;</span> &lt;&lt; CountCells(lev) &lt;&lt; <span class="stringliteral">&quot; cells&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == <a class="code" href="DataStruct_8H.html#ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815">CouplingType::TwoWay</a>) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev=0; lev &lt;= finest_level-1; lev++) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <a class="code" href="classREMORA.html#a685a244b9590a93bd7272b2261d0ecf3">AverageDownTo</a>(lev); <span class="comment">// average lev+1 down to lev</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="acea9f8015629ed812b0f2a00ab1f1b70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acea9f8015629ed812b0f2a00ab1f1b70">&#9670;&nbsp;</a></span>update_massflux_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::update_massflux_3d </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ioff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>joff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>phibar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>Hphi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>pm_or_pn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>Dphi1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>Dphi2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>DC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>FC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nnew</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>update_massflux_3d</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bx</td><td>box on which to update </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ioff</td><td>offset in x-direction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">joff</td><td>offset in y-direction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">phi</td><td>u or v </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Hphi</td><td>H-weighted u or v </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Hz</td><td>weighting </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">om_v_or_on_u</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Dphi_avg1</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Dphi_avg2</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">DC</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">FC</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnew</td><td>component of velocity </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;{</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keyword">auto</span> N = Geom(0).Domain().size()[2]-1; <span class="comment">// Number of vertical &quot;levs&quot; aka, NZ</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keyword">auto</span> bxD=bx;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keyword">auto</span> bx_g1z=bx;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    bxD.makeSlab(2,0);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    bx_g1z.grow(IntVect(0,0,1));</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// auto geomdata = Geom(0).data();</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">// bool NSPeriodic = geomdata.isPeriodic(1);</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">// bool EWPeriodic = geomdata.isPeriodic(0);</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">//Copied depth of water column calculation from DepthStretchTransform</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">//Compute thicknesses of U-boxes DC(i,j,0:N-1), total depth of the water column DC(i,j,-1)</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">//This takes advantage of Hz being an extra grow cell size</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> om_v_or_on_u = 2.0_rt / (pm_or_pn(i,j,0) + pm_or_pn(i-ioff,j-joff,0));</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        DC(i,j,k) = 0.5_rt * om_v_or_on_u * (Hz(i,j,k)+Hz(i-ioff,j-joff,k));</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    });</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    ParallelFor(bxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;=N; k++) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            DC(i,j,-1) += DC(i,j,k);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        DC(i,j,-1) = 1.0 / DC(i,j,-1);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;=N; k++) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">//          BOUNDARY CONDITIONS</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">//          if (!(NSPeriodic&amp;&amp;EWPeriodic))</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">//          {</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">//              if ( ( ((i&lt;0)||(i&gt;=Mn+1)) &amp;&amp; !EWPeriodic ) ||  ( ((j&lt;0)||(j&gt;=Mm+1)) &amp;&amp; !NSPeriodic ) )</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">//              {</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">//                  phi(i,j,k) -= CF;</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">//              }</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">//          }</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            Hphi(i,j,k) = 0.5 * (Hphi(i,j,k)+phi(i,j,k,nnew)*DC(i,j,k));</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            FC(i,j,0)  += Hphi(i,j,k);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        } <span class="comment">// k</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        FC(i,j,0) = DC(i,j,-1)*(FC(i,j,0)-Dphi_avg2(i,j,0));</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    });</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        Hphi(i,j,k) -= DC(i,j,k)*FC(i,j,0);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    });</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    ParallelFor(bxD, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        phibar(i,j,0,0) = DC(i,j,-1) * Dphi_avg1(i,j,0);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        phibar(i,j,0,1) = phibar(i,j,0,0);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    });</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5e195a7da3e0ada7179455688f4711b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e195a7da3e0ada7179455688f4711b5">&#9670;&nbsp;</a></span>uv3dmix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::uv3dmix </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>xbx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>ybx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>uold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>vold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>rufrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>rvfrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>visc2_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>visc2_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>pm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>pn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Harmonic viscosity </p>
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="comment">//  Add in harmonic viscosity s terms.</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    FArrayBox fab_UFx(growLo(xbx,0,1),1,amrex::The_Async_Arena()); fab_UFx.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    FArrayBox fab_UFe(growHi(xbx,1,1),1,amrex::The_Async_Arena()); fab_UFe.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    FArrayBox fab_VFe(growLo(ybx,1,1),1,amrex::The_Async_Arena()); fab_VFe.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    FArrayBox fab_VFx(growHi(ybx,0,1),1,amrex::The_Async_Arena()); fab_VFx.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keyword">auto</span> UFx=fab_UFx.array();</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keyword">auto</span> UFe=fab_UFe.array();</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keyword">auto</span> VFx=fab_VFx.array();</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keyword">auto</span> VFe=fab_VFe.array();</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="comment">// Think of the cell-centered box as                              [ 0:nx-1, 0:ny-1] (0,0,0) cc</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">// xbx is the x-face-centered box on which we update u  [ 0:nx  , 0:ny-1] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">//   to do so requires                        UFx on    [-1:nx  , 0:ny-1] (0,0,0) cc</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">//      which requires                        uold on   [-1:nx+1, 0:ny-1] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">//        and requires                        vold on   [-1:nx  , 0:ny  ] (0,1,0) y-faces</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">//   to do so requires                        UFe on    [ 0:nx  , 0:ny  ] (1,1,0) xy-nodes</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">//      which requires                        uold on   [ 0:nx  ,-1:ny  ] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">//       and  requires                        vold on   [ -1:nx , 0:ny  ] (0,1,0) y-faces</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    ParallelFor(growLo(xbx,0,1), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = 0.5*Hz(i,j,k) * ( pm(i,j,0) / pn(i,j,0) *</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                                    ( (pn(i  ,j,0) + pn(i+1,j,0)) * uold(i+1,j,k,nrhs)-</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                                      (pn(i-1,j,0) + pn(i  ,j,0)) * uold(i  ,j,k,nrhs) )-</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                                                pn(i,j,0) / pm(i,j,0) *</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                                    ( (pm(i,j  ,0) + pm(i,j+1,0)) * vold(i,j+1,k,nrhs)-</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                                      (pm(i,j-1,0) + pm(i,j  ,0)) * vold(i,j  ,k,nrhs) ) );</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> on_r = 1.0_rt / pm(i,j,0);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        UFx(i,j,k) = on_r * on_r * visc2_r(i,j,0) * cff;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    });</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    ParallelFor(growHi(xbx,1,1), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = 0.125 * (Hz(i-1,j  ,k) + Hz(i,j ,k)+ Hz(i-1,j-1,k) + Hz(i,j-1,k))*</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                    (pm(i,j,0)/pn(i,j,0)*</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                     ((pn(i  ,j-1,0)+pn(i  ,j,0))*vold(i  ,j,k,nrhs)-</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                      (pn(i-1,j-1,0)+pn(i-1,j,0))*vold(i-1,j,k,nrhs))+</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                     pn(i,j,0)/pm(i,j,0)*</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                     ((pm(i-1,j  ,0)+pm(i,j  ,0))*uold(i,j  ,k,nrhs)-</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                      (pm(i-1,j-1,0)+pm(i,j-1,0))*uold(i,j-1,k,nrhs)));</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> om_p =  4.0_rt / (pm(i-1,j-1,0)+pm(i-1,j,0)+pm(i,j-1,0)+pm(i,j,0));</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        UFe(i,j,k) = om_p*om_p*visc2_p(i,j,0)*cff;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    });</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    ParallelFor(xbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff=dt_lev*0.25*(pm(i-1,j,0)+pm(i,j,0))*(pn(i-1,j,0)+pn(i,j,0));</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=0.5*(pn(i-1,j,0)+pn(i,j,0))*(UFx(i,j  ,k)-UFx(i-1,j,k));</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2=0.5*(pm(i-1,j,0)+pm(i,j,0))*(UFe(i,j+1,k)-UFe(i  ,j,k));</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff3=cff*(cff1+cff2);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        amrex::Gpu::Atomic::Add(&amp;(rufrc(i,j,0)), cff1+cff2);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">u</a>(i,j,k,nnew)=<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">u</a>(i,j,k,nnew)+cff3;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    });</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">// Think of the cell-centered box as                              [ 0:nx-1, 0:ny-1] (0,0,0) cc</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">// ybx is the y-face-centered box on which we update v  [ 0:nx-1, 0:ny  ] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">//   to do so requires                        VFe on    [ 0:nx-1,-1:ny  ] (0,0,0) cc</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">//      which requires                        uold on   [ 0:nx  ,-1:ny  ] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">//        and requires                        vold on   [ 0:nx-1,-1:ny+1] (0,1,0) y-faces</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">//   to do so requires                        VFx on    [ 0:nx  , 0:ny  ] (1,1,0) xy-nodes</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">//      which requires                        uold on   [ 0:nx  ,-1:ny  ] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">//       and  requires                        vold on   [-1:nx  , 0:ny  ] (0,1,0) y-faces</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    ParallelFor(growLo(ybx,1,1), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="comment">// cff depends on k, but UFx and VFe will only be affected by the last cell?</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = 0.5*Hz(i,j,k) * (pm(i,j,0) / pn(i,j,0) *</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                ((pn(i,  j,0) + pn(i+1,j,0)) * uold(i+1,j,k,nrhs)-</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                 (pn(i-1,j,0) + pn(i,  j,0)) * uold(i  ,j,k,nrhs))-</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                pn(i,j,0) / pm(i,j,0) *</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                ((pm(i,j  ,0)+pm(i,j+1,0))*vold(i,j+1,k,nrhs)-</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                 (pm(i,j-1,0)+pm(i,j  ,0))*vold(i,j  ,k,nrhs)));</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> om_r = 1.0_rt / pm(i,j,0);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        VFe(i,j,k) = om_r * om_r * visc2_r(i,j,0) * cff;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    });</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    ParallelFor(growHi(ybx,0,1), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = 0.125 * (Hz(i-1,j  ,k)+Hz(i,j ,k)+</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                              Hz(i-1,j-1,k)+Hz(i,j-1,k))*</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                    (pm(i,j,0)/pn(i,j,0)*</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                     ((pn(i  ,j-1,0)+pn(i  ,j,0))*vold(i  ,j,k,nrhs)-</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                      (pn(i-1,j-1,0)+pn(i-1,j,0))*vold(i-1,j,k,nrhs))+</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                     pn(i,j,0)/pm(i,j,0)*</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                     ((pm(i-1,j  ,0)+pm(i,j  ,0))*uold(i,j  ,k,nrhs)-</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                      (pm(i-1,j-1,0)+pm(i,j-1,0))*uold(i,j-1,k,nrhs)));</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> on_p =  4.0_rt / (pn(i-1,j-1,0)+pn(i-1,j,0)+pn(i,j-1,0)+pn(i,j,0));</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        VFx(i,j,k) = on_p*on_p*visc2_p(i,j,0)*cff;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    });</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    ParallelFor(ybx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff=dt_lev*0.25*(pm(i,j,0)+pm(i,j-1,0))*(pn(i,j,0)+pn(i,j-1,0));</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=0.5*(pn(i,j-1,0)+pn(i,j,0))*(VFx(i+1,j,k)-VFx(i,j  ,k));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2=0.5*(pm(i,j-1,0)+pm(i,j,0))*(VFe(i  ,j,k)-VFe(i,j-1,k));</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff3=cff*(cff1-cff2);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        amrex::Gpu::Atomic::Add(&amp;(rvfrc(i,j,0)), cff1-cff2);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a>(i,j,k,nnew)=<a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">v</a>(i,j,k,nnew)+cff3;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    });</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a745f57b79548ae8e06b0df3ceb5def44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a745f57b79548ae8e06b0df3ceb5def44">&#9670;&nbsp;</a></span>vert_mean_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::vert_mean_3d </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ioff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>joff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>Dphi_avg1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>DC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>CF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>dxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;{</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    ParallelFor(makeSlab(phi_bx,2,0),</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    {</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;      <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Hzk_on_face = 0.5*(Hz(i-ioff,j-joff,0)+Hz(i,j,0));</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;      CF(i,j,-1) =                 Hzk_on_face;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;      DC(i,j,-1) = phi(i,j,0,nnew)*Hzk_on_face;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=1; k&lt;=N; k++) {</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;          Hzk_on_face = 0.5*(Hz(i-ioff,j-joff,k)+Hz(i,j,k));</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;          CF(i,j,-1) +=                 Hzk_on_face;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;          DC(i,j,-1) += phi(i,j,k,nnew)*Hzk_on_face;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      }</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    });</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    ParallelFor(makeSlab(phi_bx,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=1.0/(CF(i,j,-1)*(1.0/dxlen(i,j,0)));</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        DC(i,j,-1) = (DC(i,j,-1)*(1.0/dxlen(i,j,0)) - Dphi_avg1(i,j,0))*cff1; <span class="comment">// recursive</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    });</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    ParallelFor(phi_bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        phi(i,j,k) -= DC(i,j,-1);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    });</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac027e24879f2db46f7af0ac0bd7880f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac027e24879f2db46f7af0ac0bd7880f1">&#9670;&nbsp;</a></span>vert_visc_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::vert_visc_3d </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ioff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>joff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real const &gt; &amp;&#160;</td>
          <td class="paramname"><em>Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>Hzk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>AK</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>Akv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>DC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>FC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Array4&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>CF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;{</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="comment">// Put Hzk on the x- or y-face as appropriate, or leave on cell center for tracers</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#ad9ed53f5f841397304bf3b16fc82ecd9">verbose</a> &gt; 1)</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;updating on box in vert_visc_3d: &quot;</span> &lt;&lt; phi_bx &lt;&lt; std::endl;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    ParallelFor(phi_bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        Hzk(i,j,k)=0.5*(Hz(i-ioff,j-joff,k)+Hz(i,j,k));</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    });</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// Put Akv on the x- or y-face as appropriate, or leave on cell center for tracers</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    ParallelFor(phi_bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        AK(i,j,k) = 0.5 * (Akv(i-ioff,j-joff,k)+Akv(i,j,k));</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    });</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    Gpu::streamSynchronize();</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#ifdef AMREX_USE_GPU</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    Gpu::synchronize();</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#endif</span><span class="comment"></span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">    /////////////////// This and the following loop is the first non-matching thing that affects plotfile comparison for cuda</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"></span>    <span class="comment">// NOTE: vertical viscosity term for tracers is identical except AK=Akt</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> sixth = 1.0_rt / 6.0_rt;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> third = 1.0_rt / 3.0_rt;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    ParallelFor(makeSlab(phi_bx,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;=N; k++)</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            <span class="comment">//  Use conservative, parabolic spline reconstruction of vertical</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            <span class="comment">//  viscosity derivatives.  Then, time step vertical viscosity term</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            <span class="comment">//  implicitly by solving a tridiagonal system.</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> oHz = 1.0/ Hzk(i,j,k);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            FC(i,j,k) = (k &gt;= 1) ? sixth*Hzk(i,j,k  )-dt_lev*AK(i,j,k-1)*oHz :</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                                   sixth*Hzk(i,j,k);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            <span class="keywordflow">if</span> (k &lt; N)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> oHzkp1 = 1.0/ Hzk(i,j,k+1);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                CF(i,j,k)=sixth*Hzk(i,j,k+1)-dt_lev*AK(i,j,k+1)*oHzkp1;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                <span class="keywordflow">if</span> (k==0)</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                    BC(i,j,k)=third*(Hzk(i,j,k)+Hzk(i,j,k+1)) + dt_lev*AK(i,j,k)*(oHz+oHzkp1);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                    cff=1.0/(BC(i,j,k)-FC(i,j,k)*0.0);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                    CF(i,j,k) *= cff;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                    DC(i,j,k) = cff*(phi(i,j,k+1,nnew)-phi(i,j,k,nnew)-FC(i,j,k)*0.0);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                    BC(i,j,k)=third*(Hzk(i,j,k)+Hzk(i,j,k+1)) + dt_lev*AK(i,j,k)*(oHz+oHzkp1);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                    cff=1.0/(BC(i,j,k)-FC(i,j,k)*CF(i,j,k-1));</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                    CF(i,j,k) *= cff;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                    DC(i,j,k) = cff*(phi(i,j,k+1,nnew)-phi(i,j,k,nnew)-FC(i,j,k)*DC(i,j,k-1));</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            } <span class="comment">// k &lt; N</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        } <span class="comment">// k</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    });</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#ifdef AMREX_USE_GPU</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    Gpu::synchronize();</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    Gpu::streamSynchronize();</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    ParallelFor(makeSlab(phi_bx,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;=N; k++) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;           <span class="comment">//</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;           <span class="comment">//  Backward substitution.</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;           <span class="comment">//</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;           DC(i,j,N)=0.0;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;           <span class="keywordflow">if</span>(N-k+1&lt;=N &amp;&amp; N&gt;=k) <span class="comment">//-N,1,-1 =&gt; kidx =N-k+1</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;           {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;               <span class="keywordflow">if</span>(N+1&lt;k || N+2&lt;k) amrex::Abort(<span class="stringliteral">&quot;-1 here&quot;</span>);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;               DC(i,j,N-k) -= CF(i,j,N-k)*DC(i,j,N-k+1);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;           }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;       }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    });</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">#ifdef AMREX_USE_GPU</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    Gpu::synchronize();</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    ParallelFor(phi_bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        DC(i,j,k) *= AK(i,j,k);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    });</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    ParallelFor(phi_bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordflow">if</span>(k-1&gt;=0) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> oHz = 1.0/ Hzk(i,j,k);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            cff = dt_lev*oHz*(DC(i,j,k)-DC(i,j,k-1));</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> oHz = 1.0/ Hzk(i,j,k);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            cff = dt_lev*oHz*(DC(i,j,k));</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        phi(i,j,k) += cff;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;     });</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abeeb495dbfc8b1a3f35556f156d4b3d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abeeb495dbfc8b1a3f35556f156d4b3d2">&#9670;&nbsp;</a></span>volWgtSumMF()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> REMORA::volWgtSumMF </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>comp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>finemask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;{</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;REMORA::volWgtSumMF()&quot;</span>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> sum = 0.0;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    MultiFab tmp(grids[lev], dmap[lev], 1, 0);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    MultiFab::Copy(tmp, mf, comp, 0, 1, 0);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">if</span> (lev &lt; finest_level &amp;&amp; finemask) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keyword">const</span> MultiFab&amp; mask = <a class="code" href="classREMORA.html#a6577b0c143b8fc44c6f68cad8dec5fd6">build_fine_mask</a>(lev+1);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        MultiFab::Multiply(tmp, mask, 0, 0, 1, 0);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    MultiFab volume(grids[lev], dmap[lev], 1, 0);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>&amp; dx = geom[lev].CellSizeArray();</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cell_vol = dx[0]*dx[1]*dx[2];</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    volume.setVal(cell_vol);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    sum = MultiFab::Dot(tmp, 0, volume, 0, 1, 0, local);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">if</span> (!local)</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      ParallelDescriptor::ReduceRealSum(sum);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">return</span> sum;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;}</div>
<div class="ttc" id="aclassREMORA_html_a6577b0c143b8fc44c6f68cad8dec5fd6"><div class="ttname"><a href="classREMORA.html#a6577b0c143b8fc44c6f68cad8dec5fd6">REMORA::build_fine_mask</a></div><div class="ttdeci">amrex::MultiFab &amp; build_fine_mask(int lev)</div><div class="ttdef"><b>Definition:</b> REMORA_SumIQ.cpp:115</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7714f7f51b35f7a425da770fdae443c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7714f7f51b35f7a425da770fdae443c6">&#9670;&nbsp;</a></span>writeBuildInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::writeBuildInfo </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;{</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  std::string PrettyLine = std::string(78, <span class="charliteral">&#39;=&#39;</span>) + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  std::string OtherLine = std::string(78, <span class="charliteral">&#39;-&#39;</span>) + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  std::string SkipSpace = std::string(8, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">// build information</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  os &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot; REMORA Build Information\n&quot;</span>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  os &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;build date:    &quot;</span> &lt;&lt; amrex::buildInfoGetBuildDate() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;build machine: &quot;</span> &lt;&lt; amrex::buildInfoGetBuildMachine() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;build dir:     &quot;</span> &lt;&lt; amrex::buildInfoGetBuildDir() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;AMReX dir:     &quot;</span> &lt;&lt; amrex::buildInfoGetAMReXDir() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;COMP:          &quot;</span> &lt;&lt; amrex::buildInfoGetComp() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;COMP version:  &quot;</span> &lt;&lt; amrex::buildInfoGetCompVersion() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;C++ compiler:  &quot;</span> &lt;&lt; amrex::buildInfoGetCXXName() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;C++ flags:     &quot;</span> &lt;&lt; amrex::buildInfoGetCXXFlags() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;Link flags:    &quot;</span> &lt;&lt; amrex::buildInfoGetLinkFlags() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;Libraries:     &quot;</span> &lt;&lt; amrex::buildInfoGetLibraries() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; n &lt;= amrex::buildInfoGetNumModules(); n++) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    os &lt;&lt; amrex::buildInfoGetModuleName(n) &lt;&lt; <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;       &lt;&lt; amrex::buildInfoGetModuleVal(n) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* githash1 = amrex::buildInfoGetGitHash(1);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* githash2 = amrex::buildInfoGetGitHash(2);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">if</span> (strlen(githash1) &gt; 0) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;REMORA       git hash: &quot;</span> &lt;&lt; githash1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordflow">if</span> (strlen(githash2) &gt; 0) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;AMReX       git hash: &quot;</span> &lt;&lt; githash2 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgithash = amrex::buildInfoGetBuildGitHash();</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgitname = amrex::buildInfoGetBuildGitName();</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">if</span> (strlen(buildgithash) &gt; 0) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    os &lt;&lt; buildgitname &lt;&lt; <span class="stringliteral">&quot; git hash: &quot;</span> &lt;&lt; buildgithash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot; REMORA Compile time variables: \n&quot;</span>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot; REMORA Defines: \n&quot;</span>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;_OPENMP &quot;</span> &lt;&lt; std::setw(6) &lt;&lt; <span class="stringliteral">&quot;ON&quot;</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;     &lt;&lt; std::endl;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;_OPENMP &quot;</span> &lt;&lt; std::setw(6) &lt;&lt; <span class="stringliteral">&quot;OFF&quot;</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;     &lt;&lt; std::endl;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="preprocessor">#ifdef MPI_VERSION</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;MPI_VERSION &quot;</span> &lt;&lt; std::setw(6)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;     &lt;&lt; MPI_VERSION &lt;&lt; std::endl;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;MPI_VERSION &quot;</span> &lt;&lt; std::setw(6)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;UNDEFINED&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor">#ifdef MPI_SUBVERSION</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;MPI_SUBVERSION &quot;</span> &lt;&lt; std::setw(6)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;     &lt;&lt; MPI_SUBVERSION &lt;&lt; std::endl;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;MPI_SUBVERSION &quot;</span> &lt;&lt; std::setw(6)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;UNDEFINED&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classREMORA_a7714f7f51b35f7a425da770fdae443c6_icgraph.png" border="0" usemap="#aclassREMORA_a7714f7f51b35f7a425da770fdae443c6_icgraph" alt=""/></div>
<map name="aclassREMORA_a7714f7f51b35f7a425da770fdae443c6_icgraph" id="aclassREMORA_a7714f7f51b35f7a425da770fdae443c6_icgraph">
<area shape="rect" title=" " alt="" coords="108,5,287,32"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="aec14981d78f55e2e326b1080cfc5656c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec14981d78f55e2e326b1080cfc5656c">&#9670;&nbsp;</a></span>WriteCheckpointFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::WriteCheckpointFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;{</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="comment">// chk00010            write a checkpoint file with this root directory</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="comment">// chk00010/Header     this contains information you need to save (e.g., finest_level, t_new, etc.) and also</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="comment">//                     the BoxArrays at each level</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="comment">// chk00010/Level_0/</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="comment">// chk00010/Level_1/</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="comment">// etc.                these subdirectories will hold the MultiFab data at each level of refinement</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="comment">// checkpoint file name, e.g., chk00010</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keyword">const</span> std::string&amp; checkpointname = amrex::Concatenate(<a class="code" href="classREMORA.html#a4ca794481e17552667b3824252497b6a">check_file</a>,<a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[0],5);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Writing checkpoint &quot;</span> &lt;&lt; checkpointname &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels = finest_level+1;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">// ---- prebuild a hierarchy of directories</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">// ---- dirName is built first.  if dirName exists, it is renamed.  then build</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">// ---- dirName/subDirPrefix_0 .. dirName/subDirPrefix_nlevels-1</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// ---- if callBarrier is true, call ParallelDescriptor::Barrier()</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="comment">// ---- after all directories are built</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="comment">// ---- ParallelDescriptor::IOProcessor() creates the directories</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    amrex::PreBuildDirectorHierarchy(checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, nlevels, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">// write Header file</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;   <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;       std::string HeaderFileName(checkpointname + <span class="stringliteral">&quot;/Header&quot;</span>);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;       VisMF::IO_Buffer io_buffer(VisMF::IO_Buffer_Size);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;       std::ofstream HeaderFile;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;       HeaderFile.rdbuf()-&gt;pubsetbuf(io_buffer.dataPtr(), io_buffer.size());</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;       HeaderFile.open(HeaderFileName.c_str(), std::ofstream::out   |</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                               std::ofstream::trunc |</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                                               std::ofstream::binary);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;       <span class="keywordflow">if</span>( ! HeaderFile.good()) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;           amrex::FileOpenFailed(HeaderFileName);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;       }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;       HeaderFile.precision(17);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;       <span class="comment">// write out title line</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;       HeaderFile &lt;&lt; <span class="stringliteral">&quot;Checkpoint file for REMORA\n&quot;</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;       <span class="comment">// write out finest_level</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;       HeaderFile &lt;&lt; finest_level &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;       <span class="comment">// write the number of components</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;       <span class="comment">// for each variable we store</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;       <span class="comment">// conservative, cell-centered vars</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;       HeaderFile &lt;&lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;       <span class="comment">// x-velocity on faces</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;       HeaderFile &lt;&lt; 1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;       <span class="comment">// y-velocity on faces</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;       HeaderFile &lt;&lt; 1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;       <span class="comment">// z-velocity on faces</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;       HeaderFile &lt;&lt; 1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;       HeaderFile &lt;&lt; 2 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;       HeaderFile &lt;&lt; 2 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;       HeaderFile &lt;&lt; 3 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;       HeaderFile &lt;&lt; 3 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;       <span class="comment">// write out array of istep</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>.size(); ++i) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;           HeaderFile &lt;&lt; <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;       }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;       HeaderFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;       <span class="comment">// write out array of dt</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>.size(); ++i) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;           HeaderFile &lt;&lt; <a class="code" href="classREMORA.html#aedae6fd90cb13271f63ea80e59a2aacb">dt</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;       }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;       HeaderFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;       <span class="comment">// write out array of t_new</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>.size(); ++i) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;           HeaderFile &lt;&lt; <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;       }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;       HeaderFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;       <span class="comment">// write the BoxArray at each level</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;           boxArray(lev).writeOn(HeaderFile);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;           HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;       }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   <span class="comment">// write the MultiFab data to, e.g., chk00010/Level_0/</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   <span class="comment">// Here we make copies of the MultiFab with no ghost cells</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;       BoxList bl2d = grids[lev].boxList();</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;       <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; b : bl2d) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;           b.setRange(2,0);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;       }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;       BoxArray ba2d(std::move(bl2d));</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;       MultiFab cons(grids[lev],dmap[lev],<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>,0);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;       MultiFab::Copy(cons,*<a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev],0,0,<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>,0);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;       VisMF::Write(cons, amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Cell&quot;</span>));</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;       MultiFab xvel(convert(grids[lev],IntVect(1,0,0)),dmap[lev],1,0);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;       MultiFab::Copy(xvel,*<a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev],0,0,1,0);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;       VisMF::Write(xvel, amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;XFace&quot;</span>));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;       MultiFab yvel(convert(grids[lev],IntVect(0,1,0)),dmap[lev],1,0);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;       MultiFab::Copy(yvel,*<a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev],0,0,1,0);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;       VisMF::Write(yvel, amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;YFace&quot;</span>));</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;       MultiFab zvel(convert(grids[lev],IntVect(0,0,1)),dmap[lev],1,0);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;       MultiFab::Copy(zvel,*<a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[lev],0,0,1,0);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;       VisMF::Write(zvel, amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;ZFace&quot;</span>));</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;       MultiFab mf_ru(grids[lev],dmap[lev],2,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;       MultiFab::Copy(mf_ru,*<a class="code" href="classREMORA.html#aaf06acc3074f6a4dd322f9e1ca0c5244">vec_ru</a>[lev],0,0,2,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;       VisMF::Write(mf_ru, amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;XRHS&quot;</span>));</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;       MultiFab mf_rv(grids[lev],dmap[lev],2,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;       MultiFab::Copy(mf_rv,*<a class="code" href="classREMORA.html#ae4e70f2661f28e3a3a2585540e804486">vec_rv</a>[lev],0,0,2,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;       VisMF::Write(mf_rv, amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;YRHS&quot;</span>));</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;       MultiFab mf_ubar(ba2d,dmap[lev],3,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;       MultiFab::Copy(mf_ubar,*(<a class="code" href="classREMORA.html#abb214b8bab178b72c44907f5e2aeead8">vec_ubar</a>[lev]),0,0,3,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;       VisMF::Write(mf_ubar, amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;XBar&quot;</span>));</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;       MultiFab mf_vbar(ba2d,dmap[lev],3,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;       MultiFab::Copy(mf_vbar,*(<a class="code" href="classREMORA.html#ab70c8d3ac0d8a5f7ac51365571905874">vec_vbar</a>[lev]),0,0,3,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;       VisMF::Write(mf_vbar, amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;YBar&quot;</span>));</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;       VisMF::Write(*(<a class="code" href="classREMORA.html#a5a0dd90f9e35c6055bf3ede53f4229d6">vec_rufrc</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;rufrc&quot;</span>));</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;       VisMF::Write(*(<a class="code" href="classREMORA.html#a49ea2c6c379a0fa006e4b6023fd69f88">vec_rvfrc</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;rvfrc&quot;</span>));</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;       VisMF::Write(*(<a class="code" href="classREMORA.html#a347a75f9295217fc66a8b7a4c2a47f9b">vec_sustr</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;sustr&quot;</span>));</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;       VisMF::Write(*(<a class="code" href="classREMORA.html#a88a26701f7276ea04f5c9ede4ae46981">vec_svstr</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;svstr&quot;</span>));</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;       VisMF::Write(*(<a class="code" href="classREMORA.html#adba780a7c66c2158c914bff64964df60">vec_rdrag</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;rdrag&quot;</span>));</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;       VisMF::Write(*(<a class="code" href="classREMORA.html#abd341c53d0813eaea345511b8e14afdd">vec_bustr</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;bustr&quot;</span>));</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;       VisMF::Write(*(<a class="code" href="classREMORA.html#ac7d186a8a4d54c28a5b2eecaec6cb978">vec_bvstr</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;bvstr&quot;</span>));</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;       VisMF::Write(*(<a class="code" href="classREMORA.html#ab8e2ff918dcaf20a807b37e88f9fdbb0">vec_DU_avg1</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;DU_avg1&quot;</span>));</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;       VisMF::Write(*(<a class="code" href="classREMORA.html#a1b2cc0f2f617e846c6261df12aefd110">vec_DU_avg2</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;DU_avg2&quot;</span>));</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;       VisMF::Write(*(<a class="code" href="classREMORA.html#a9e0560b2f68b9c541583c9c1ff6c87ec">vec_DV_avg1</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;DV_avg1&quot;</span>));</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;       VisMF::Write(*(<a class="code" href="classREMORA.html#ac5ba663380c2e7b3857e21fd0d4286f9">vec_DV_avg2</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;DV_avg2&quot;</span>));</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;       VisMF::Write(*(<a class="code" href="classREMORA.html#ab60f476961622f8e7f27221595e84956">vec_zeta</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;zeta&quot;</span>));</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;       VisMF::Write(*(<a class="code" href="classREMORA.html#adeb60c66ba4665f07c57fbf3b3b8909a">vec_Zt_avg1</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Zt_avg1&quot;</span>));</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_PARTICLES</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;   particleData.Checkpoint(checkpointname);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_NETCDF</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;   <span class="comment">// Write bdy_data files</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   <span class="keywordflow">if</span> ( ParallelDescriptor::IOProcessor() &amp;&amp; (<a class="code" href="classREMORA.html#aa88bf20926ca017d05ebabe44f224443">solverChoice</a>.<a class="code" href="structSolverChoice.html#a345dba1135888a3a3e422c9b6a010ebf">ic_bc_type</a> == <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">IC_BC_Type::Real</a>) )</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;   {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;     <span class="comment">// Vector dimensions</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;     <span class="keywordtype">int</span> num_time = bdy_data_xlo.size();</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;     <span class="keywordtype">int</span> num_var  = bdy_data_xlo[0].size();</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;     <span class="comment">// Open header file and write to it</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;     std::ofstream bdy_h_file(amrex::MultiFabFileFullPrefix(0, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;bdy_H&quot;</span>));</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;     bdy_h_file &lt;&lt; std::setprecision(1) &lt;&lt; std::fixed;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;     bdy_h_file &lt;&lt; num_time &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;     bdy_h_file &lt;&lt; num_var  &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;     bdy_h_file &lt;&lt; start_bdy_time &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;     bdy_h_file &lt;&lt; bdy_time_interval &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;     bdy_h_file &lt;&lt; bdy_width &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar(0); ivar&lt;num_var; ++ivar) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;       bdy_h_file &lt;&lt; bdy_data_xlo[0][ivar].box() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;       bdy_h_file &lt;&lt; bdy_data_xhi[0][ivar].box() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;       bdy_h_file &lt;&lt; bdy_data_ylo[0][ivar].box() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;       bdy_h_file &lt;&lt; bdy_data_yhi[0][ivar].box() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;     }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;     <span class="comment">// Open data file and write to it</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;     std::ofstream bdy_d_file(amrex::MultiFabFileFullPrefix(0, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;bdy_D&quot;</span>));</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itime(0); itime&lt;num_time; ++itime) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar(0); ivar&lt;num_var; ++ivar) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;         bdy_data_xlo[itime][ivar].writeOn(bdy_d_file,0,1);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;         bdy_data_xhi[itime][ivar].writeOn(bdy_d_file,0,1);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;         bdy_data_ylo[itime][ivar].writeOn(bdy_d_file,0,1);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;         bdy_data_yhi[itime][ivar].writeOn(bdy_d_file,0,1);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;       }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;     }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;   }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a76b30b516d67fc5b30bfdfc221d63554"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76b30b516d67fc5b30bfdfc221d63554">&#9670;&nbsp;</a></span>WriteGenericPlotfileHeaderWithBathymetry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::WriteGenericPlotfileHeaderWithBathymetry </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>HeaderFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlevels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; amrex::BoxArray &gt; &amp;&#160;</td>
          <td class="paramname"><em>bArray</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>varnames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>level_steps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>versionName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>levelPrefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>mfPrefix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;{</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        BL_ASSERT(nlevels &lt;= bArray.size());</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        BL_ASSERT(nlevels &lt;= ref_ratio.size()+1);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        BL_ASSERT(nlevels &lt;= level_steps.size());</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        HeaderFile.precision(17);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="comment">// ---- this is the generic plot file type name</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        HeaderFile &lt;&lt; versionName &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        HeaderFile &lt;&lt; varnames.size() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar = 0; ivar &lt; varnames.size(); ++ivar) {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            HeaderFile &lt;&lt; varnames[ivar] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        HeaderFile &lt;&lt; AMREX_SPACEDIM &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        HeaderFile &lt;&lt; time &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        HeaderFile &lt;&lt; finest_level &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; ++i) {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            HeaderFile &lt;&lt; geom[0].ProbLo(i) &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; ++i) {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            HeaderFile &lt;&lt; geom[0].ProbHi(i) &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; finest_level; ++i) {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            HeaderFile &lt;&lt; ref_ratio[i][0] &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= finest_level; ++i) {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            HeaderFile &lt;&lt; geom[i].Domain() &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= finest_level; ++i) {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            HeaderFile &lt;&lt; level_steps[i] &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= finest_level; ++i) {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; AMREX_SPACEDIM; ++k) {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                HeaderFile &lt;&lt; geom[i].CellSize()[k] &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        }</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        HeaderFile &lt;&lt; (int) geom[0].<a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01">Coord</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        HeaderFile &lt;&lt; <span class="stringliteral">&quot;0\n&quot;</span>;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> level = 0; level &lt;= finest_level; ++level) {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            HeaderFile &lt;&lt; level &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; bArray[level].size() &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; time &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            HeaderFile &lt;&lt; level_steps[level] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <span class="keyword">const</span> IntVect&amp; domain_lo = geom[level].Domain().smallEnd();</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; bArray[level].size(); ++i)</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                <span class="comment">// Need to shift because the RealBox ctor we call takes the</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                <span class="comment">// physical location of index (0,0,0).  This does not affect</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                <span class="comment">// the usual cases where the domain index starts with 0.</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                <span class="keyword">const</span> Box&amp; b = shift(bArray[level][i], -domain_lo);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                RealBox loc = RealBox(b, geom[level].CellSize(), geom[level].ProbLo());</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; AMREX_SPACEDIM; ++n) {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                    HeaderFile &lt;&lt; loc.lo(n) &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; loc.hi(n) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            HeaderFile &lt;&lt; MultiFabHeaderPath(level, levelPrefix, mfPrefix) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        HeaderFile &lt;&lt; <span class="stringliteral">&quot;1&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        HeaderFile &lt;&lt; <span class="stringliteral">&quot;3&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        HeaderFile &lt;&lt; <span class="stringliteral">&quot;amrexvec_nu_x&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        HeaderFile &lt;&lt; <span class="stringliteral">&quot;amrexvec_nu_y&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        HeaderFile &lt;&lt; <span class="stringliteral">&quot;amrexvec_nu_z&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        std::string mf_nodal_prefix = <span class="stringliteral">&quot;Nu_nd&quot;</span>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> level = 0; level &lt;= finest_level; ++level) {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            HeaderFile &lt;&lt; MultiFabHeaderPath(level, levelPrefix, mf_nodal_prefix) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;}</div>
<div class="ttc" id="aDataStruct_8H_html_a627f1f843904477f763577ad1460de01"><div class="ttname"><a href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01">Coord</a></div><div class="ttdeci">Coord</div><div class="ttdef"><b>Definition:</b> DataStruct.H:17</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a331fbdef188eaf70cc72be04b1208020"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a331fbdef188eaf70cc72be04b1208020">&#9670;&nbsp;</a></span>writeJobInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::writeJobInfo </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>dir</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;{</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  <span class="comment">// job_info file with details about the run</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  std::ofstream jobInfoFile;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  std::string FullPathJobInfoFile = dir;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  FullPathJobInfoFile += <span class="stringliteral">&quot;/job_info&quot;</span>;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  jobInfoFile.open(FullPathJobInfoFile.c_str(), std::ios::out);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  std::string PrettyLine = <span class="stringliteral">&quot;===================================================&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;                           <span class="stringliteral">&quot;============================\n&quot;</span>;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  std::string OtherLine = <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                          <span class="stringliteral">&quot;----------------------------\n&quot;</span>;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  std::string SkipSpace = <span class="stringliteral">&quot;        &quot;</span>;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="comment">// job information</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; REMORA Job Information\n&quot;</span>;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;inputs file: &quot;</span> &lt;&lt; <a class="code" href="writeJobInfo_8cpp.html#aabaa127a3a319c1b86090d6c88568965">inputs_name</a> &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;number of MPI processes: &quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;              &lt;&lt; amrex::ParallelDescriptor::NProcs() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;number of threads:       &quot;</span> &lt;&lt; omp_get_max_threads() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;CPU time used since start of simulation (CPU-hours): &quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;              &lt;&lt; <a class="code" href="classREMORA.html#a79eb0ac9909062422d3b3207a7643dd8">getCPUTime</a>() / 3600.0;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="comment">// plotfile information</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Plotfile Information\n&quot;</span>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  time_t now = time(0);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="comment">// Convert now to tm struct for local timezone</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  tm* localtm = localtime(&amp;now);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;output data / time: &quot;</span> &lt;&lt; asctime(localtm);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  std::string currentDir = amrex::FileSystem::CurrentPath();</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;output dir:         &quot;</span> &lt;&lt; currentDir &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="comment">// build information</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Build Information\n&quot;</span>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;build date:    &quot;</span> &lt;&lt; amrex::buildInfoGetBuildDate() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;build machine: &quot;</span> &lt;&lt; amrex::buildInfoGetBuildMachine() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;build dir:     &quot;</span> &lt;&lt; amrex::buildInfoGetBuildDir() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;AMReX dir:     &quot;</span> &lt;&lt; amrex::buildInfoGetAMReXDir() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;COMP:          &quot;</span> &lt;&lt; amrex::buildInfoGetComp() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;COMP version:  &quot;</span> &lt;&lt; amrex::buildInfoGetCompVersion() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; n &lt;= amrex::buildInfoGetNumModules(); n++) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    jobInfoFile &lt;&lt; amrex::buildInfoGetModuleName(n) &lt;&lt; <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                &lt;&lt; amrex::buildInfoGetModuleVal(n) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* githash1 = amrex::buildInfoGetGitHash(1);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* githash2 = amrex::buildInfoGetGitHash(2);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordflow">if</span> (strlen(githash1) &gt; 0) {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;REMORA       git hash: &quot;</span> &lt;&lt; githash1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">if</span> (strlen(githash2) &gt; 0) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;AMReX       git hash: &quot;</span> &lt;&lt; githash2 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgithash = amrex::buildInfoGetBuildGitHash();</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgitname = amrex::buildInfoGetBuildGitName();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">if</span> (strlen(buildgithash) &gt; 0) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    jobInfoFile &lt;&lt; buildgitname &lt;&lt; <span class="stringliteral">&quot; git hash: &quot;</span> &lt;&lt; buildgithash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">// grid information</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Grid Information\n&quot;</span>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordtype">int</span> f_lev = finest_level;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= f_lev; i++) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot; level: &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   number of boxes = &quot;</span> &lt;&lt; grids[i].size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   maximum zones   = &quot;</span>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; AMREX_SPACEDIM; n++) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      jobInfoFile &lt;&lt; geom[i].Domain().length(n) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Boundary conditions\n&quot;</span>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   -x: &quot;</span> &lt;&lt; <a class="code" href="classREMORA.html#ac686c83706316dc3388d6c1d6b270a2c">domain_bc_type</a>[0] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   +x: &quot;</span> &lt;&lt; <a class="code" href="classREMORA.html#ac686c83706316dc3388d6c1d6b270a2c">domain_bc_type</a>[3] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   -y: &quot;</span> &lt;&lt; <a class="code" href="classREMORA.html#ac686c83706316dc3388d6c1d6b270a2c">domain_bc_type</a>[1] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   +y: &quot;</span> &lt;&lt; <a class="code" href="classREMORA.html#ac686c83706316dc3388d6c1d6b270a2c">domain_bc_type</a>[4] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   -z: &quot;</span> &lt;&lt; <a class="code" href="classREMORA.html#ac686c83706316dc3388d6c1d6b270a2c">domain_bc_type</a>[2] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   +z: &quot;</span> &lt;&lt; <a class="code" href="classREMORA.html#ac686c83706316dc3388d6c1d6b270a2c">domain_bc_type</a>[5] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="comment">// runtime parameters</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Inputs File Parameters\n&quot;</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  amrex::ParmParse::dumpTable(jobInfoFile, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  jobInfoFile.close();</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div>
<div class="ttc" id="aclassREMORA_html_a79eb0ac9909062422d3b3207a7643dd8"><div class="ttname"><a href="classREMORA.html#a79eb0ac9909062422d3b3207a7643dd8">REMORA::getCPUTime</a></div><div class="ttdeci">amrex::Real getCPUTime() const</div><div class="ttdef"><b>Definition:</b> REMORA.H:940</div></div>
<div class="ttc" id="awriteJobInfo_8cpp_html_aabaa127a3a319c1b86090d6c88568965"><div class="ttname"><a href="writeJobInfo_8cpp.html#aabaa127a3a319c1b86090d6c88568965">inputs_name</a></div><div class="ttdeci">std::string inputs_name</div><div class="ttdef"><b>Definition:</b> main.cpp:9</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classREMORA_a331fbdef188eaf70cc72be04b1208020_cgraph.png" border="0" usemap="#aclassREMORA_a331fbdef188eaf70cc72be04b1208020_cgraph" alt=""/></div>
<map name="aclassREMORA_a331fbdef188eaf70cc72be04b1208020_cgraph" id="aclassREMORA_a331fbdef188eaf70cc72be04b1208020_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,171,32"/>
<area shape="rect" href="classREMORA.html#a79eb0ac9909062422d3b3207a7643dd8" title=" " alt="" coords="219,5,387,32"/>
</map>
</div>

</div>
</div>
<a id="a8c6fbe147d0a9bc99510fc8ee97aea98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c6fbe147d0a9bc99510fc8ee97aea98">&#9670;&nbsp;</a></span>WriteMultiLevelPlotfileWithBathymetry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::WriteMultiLevelPlotfileWithBathymetry </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>plotfilename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlevels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; const amrex::MultiFab * &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; const amrex::MultiFab * &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_nd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>varnames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>level_steps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>versionName</em> = <code>&quot;HyperCLaw-V1.1&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>levelPrefix</em> = <code>&quot;Level_&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>mfPrefix</em> = <code>&quot;Cell&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>extra_dirs</em> = <code>amrex::Vector&lt;std::string&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;{</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;WriteMultiLevelPlotfileWithBathymetry()&quot;</span>);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    BL_ASSERT(nlevels &lt;= mf.size());</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    BL_ASSERT(nlevels &lt;= ref_ratio.size()+1);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    BL_ASSERT(nlevels &lt;= level_steps.size());</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    BL_ASSERT(mf[0]-&gt;nComp() == varnames.size());</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordtype">bool</span> callBarrier(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    PreBuildDirectorHierarchy(plotfilename, levelPrefix, nlevels, callBarrier);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">if</span> (!extra_dirs.empty()) {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; d : extra_dirs) {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="keyword">const</span> std::string ed = plotfilename+<span class="stringliteral">&quot;/&quot;</span>+d;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            PreBuildDirectorHierarchy(ed, levelPrefix, nlevels, callBarrier);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    ParallelDescriptor::Barrier();</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">if</span> (ParallelDescriptor::MyProc() == ParallelDescriptor::NProcs()-1) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        Vector&lt;BoxArray&gt; boxArrays(nlevels);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> level(0); level &lt; boxArrays.size(); ++level) {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            boxArrays[level] = mf[level]-&gt;boxArray();</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="keyword">auto</span> f = [=]() {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            VisMF::IO_Buffer io_buffer(VisMF::IO_Buffer_Size);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            std::string HeaderFileName(plotfilename + <span class="stringliteral">&quot;/Header&quot;</span>);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            std::ofstream HeaderFile;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            HeaderFile.rdbuf()-&gt;pubsetbuf(io_buffer.dataPtr(), io_buffer.size());</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            HeaderFile.open(HeaderFileName.c_str(), std::ofstream::out   |</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                                    std::ofstream::trunc |</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                                                    std::ofstream::binary);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            <span class="keywordflow">if</span>( ! HeaderFile.good()) FileOpenFailed(HeaderFileName);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            <a class="code" href="classREMORA.html#a76b30b516d67fc5b30bfdfc221d63554">WriteGenericPlotfileHeaderWithBathymetry</a>(HeaderFile, nlevels, boxArrays, varnames,</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                                                     time, level_steps, versionName,</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                                                     levelPrefix, mfPrefix);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        };</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="keywordflow">if</span> (AsyncOut::UseAsyncOut()) {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            AsyncOut::Submit(std::move(f));</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            f();</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    std::string mf_nodal_prefix = <span class="stringliteral">&quot;Nu_nd&quot;</span>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> level = 0; level &lt;= finest_level; ++level)</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keywordflow">if</span> (AsyncOut::UseAsyncOut()) {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            VisMF::AsyncWrite(*mf[level],</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                              MultiFabFileFullPrefix(level, plotfilename, levelPrefix, mfPrefix),</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                              <span class="keyword">true</span>);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            VisMF::AsyncWrite(*mf_nd[level],</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                              MultiFabFileFullPrefix(level, plotfilename, levelPrefix, mf_nodal_prefix),</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                              <span class="keyword">true</span>);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <span class="keyword">const</span> MultiFab* data;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            std::unique_ptr&lt;MultiFab&gt; mf_tmp;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            <span class="keywordflow">if</span> (mf[level]-&gt;nGrowVect() != 0) {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                mf_tmp = std::make_unique&lt;MultiFab&gt;(mf[level]-&gt;boxArray(),</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                                                    mf[level]-&gt;DistributionMap(),</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                                    mf[level]-&gt;nComp(), 0, MFInfo(),</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                                                    mf[level]-&gt;Factory());</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                MultiFab::Copy(*mf_tmp, *mf[level], 0, 0, mf[level]-&gt;nComp(), 0);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                data = mf_tmp.get();</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                data = mf[level];</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            VisMF::Write(*data       , MultiFabFileFullPrefix(level, plotfilename, levelPrefix, mfPrefix));</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            VisMF::Write(*mf_nd[level], MultiFabFileFullPrefix(level, plotfilename, levelPrefix, mf_nodal_prefix));</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;}</div>
<div class="ttc" id="aclassREMORA_html_a76b30b516d67fc5b30bfdfc221d63554"><div class="ttname"><a href="classREMORA.html#a76b30b516d67fc5b30bfdfc221d63554">REMORA::WriteGenericPlotfileHeaderWithBathymetry</a></div><div class="ttdeci">void WriteGenericPlotfileHeaderWithBathymetry(std::ostream &amp;HeaderFile, int nlevels, const amrex::Vector&lt; amrex::BoxArray &gt; &amp;bArray, const amrex::Vector&lt; std::string &gt; &amp;varnames, amrex::Real time, const amrex::Vector&lt; int &gt; &amp;level_steps, const std::string &amp;versionName, const std::string &amp;levelPrefix, const std::string &amp;mfPrefix) const</div><div class="ttdef"><b>Definition:</b> Plotfile.cpp:390</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6c03ef43eb1e2584973f5a45975f5482"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c03ef43eb1e2584973f5a45975f5482">&#9670;&nbsp;</a></span>WritePlotFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void REMORA::WritePlotFile </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>which</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>plot_var_names</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>write plotfile to disk </p>
<div class="fragment"><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;{</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keyword">const</span> Vector&lt;std::string&gt; varnames = <a class="code" href="classREMORA.html#adf81b939a430211f29fed95b3d5f06fb">PlotFileVarNames</a>(plot_var_names);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> ncomp_mf = varnames.size();</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> ngrow_vars = IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// We fillpatch here because some of the derived quantities require derivatives</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">//     which require ghost cells to be filled</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev], *<a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev], <a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325abd1c55aaa78d7bcedd3a0e21005f2955">BdyVars::t</a>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev], *<a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev], <a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a2e6ad92071d7c5eed4b6ab6ddccb9d16">BdyVars::u</a>);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev], *<a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev], <a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325a5d1dca5f1979361c8219d60c365ca922">BdyVars::v</a>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <a class="code" href="classREMORA.html#aeac4c75110a1011acdf716c00bc62299">FillPatch</a>(lev, <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[lev], *<a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[lev], <a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>, <a class="code" href="namespaceBdyVars.html#a0860568d9ad7e1487cd6567de76e0325ab738c65b8fa93b2166002dce928aca27">BdyVars::null</a>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">if</span> (ncomp_mf == 0)</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    Vector&lt;MultiFab&gt; mf(finest_level+1);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        mf[lev].define(grids[lev], dmap[lev], ncomp_mf, ngrow_vars);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    Vector&lt;MultiFab&gt; mf_nd(finest_level+1);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        BoxArray nodal_grids(grids[lev]); nodal_grids.surroundingNodes();</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        mf_nd[lev].define(nodal_grids, dmap[lev], AMREX_SPACEDIM, 0);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        mf_nd[lev].setVal(0.);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordtype">int</span> mf_comp = 0;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="comment">// First, copy any of the conserved state variables into the output plotfile</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        AMREX_ALWAYS_ASSERT(<a class="code" href="classREMORA.html#a006b52a7c7bc31839827318d5ca2dcee">cons_names</a>.size() == <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; ++i) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="REMORA_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <a class="code" href="classREMORA.html#a006b52a7c7bc31839827318d5ca2dcee">cons_names</a>[i])) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;              MultiFab::Copy(mf[lev],*<a class="code" href="classREMORA.html#a1e6bb5ba18bc44344e75066721820ed5">cons_new</a>[lev],i,mf_comp,1,ngrow_vars);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                mf_comp++;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="comment">// Next, check for velocities and output none or all</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="REMORA_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;x_velocity&quot;</span>) ||</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <a class="code" href="REMORA_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;y_velocity&quot;</span>) ||</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <a class="code" href="REMORA_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;z_velocity&quot;</span>)) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a002524d813441c4b5fe1b223b46389fa">plotfile_type</a> == <a class="code" href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9eabbe17e876cafcbc06d3ea0d2a23854d3">PlotfileType::amrex</a>) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                Print()&lt;&lt;<span class="stringliteral">&quot;We now average the face-based velocity components onto cell centers for plotting &quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            average_face_to_cellcenter(mf[lev],mf_comp,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                                       Array&lt;const MultiFab*,3&gt;{<a class="code" href="classREMORA.html#a6d4e5271a8d00e497c4bce0a51dbe63c">xvel_new</a>[lev],<a class="code" href="classREMORA.html#a57327a8173b5dd09f9db6ce23f745dd5">yvel_new</a>[lev],<a class="code" href="classREMORA.html#a3950916f4ed965bcd10f62e28e08fd76">zvel_new</a>[lev]});</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            mf_comp += AMREX_SPACEDIM;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="comment">// Fill cell-centered location</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dx = Geom()[lev].CellSizeArray()[0];</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dy = Geom()[lev].CellSizeArray()[1];</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="comment">// Next, check for location names -- if we write one we write all</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="REMORA_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;x_cc&quot;</span>) ||</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <a class="code" href="REMORA_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;y_cc&quot;</span>) ||</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <a class="code" href="REMORA_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;z_cc&quot;</span>))</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            MultiFab dmf(mf[lev], make_alias, mf_comp, AMREX_SPACEDIM);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(dmf, TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt; loc_arr = dmf.array(mfi);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt; zp_arr = <a class="code" href="classREMORA.html#ac956bf3a52181b34d3e98a85ea5ba131">vec_z_phys_nd</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                    loc_arr(i,j,k,0) = (i+0.5) * dx;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                    loc_arr(i,j,k,1) = (j+0.5) * dy;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                    loc_arr(i,j,k,2) = 0.125_rt * (zp_arr(i,j  ,k  ) + zp_arr(i+1,j  ,k  ) +</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                                                   zp_arr(i,j+1,k  ) + zp_arr(i+1,j+1,k  ) +</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                                   zp_arr(i,j  ,k+1) + zp_arr(i+1,j  ,k+1) +</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                                                   zp_arr(i,j+1,k+1) + zp_arr(i+1,j+1,k+1) );</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                });</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            mf_comp += AMREX_SPACEDIM;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        } <span class="comment">// if containerHasElement</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_PARTICLES</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="REMORA_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;tracer_particle_count&quot;</span>))</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            MultiFab temp_dat(mf[lev].boxArray(), mf[lev].DistributionMap(), 1, 0);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            temp_dat.setVal(0);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            particleData.tracer_particles-&gt;Redistribute();</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            particleData.tracer_particles-&gt;Increment(temp_dat, lev);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            MultiFab::Copy(mf[lev], temp_dat, 0, mf_comp, 1, 0);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        MultiFab::Copy(mf_nd[lev],*<a class="code" href="classREMORA.html#ac956bf3a52181b34d3e98a85ea5ba131">vec_z_phys_nd</a>[lev],0,2,1,0);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dz = Geom()[lev].CellSizeArray()[2];</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordflow">for</span> (MFIter mfi(mf_nd[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            Array4&lt;Real&gt; mf_arr = mf_nd[lev].array(mfi);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                mf_arr(i,j,k,2) -= k * dz;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            });</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    } <span class="comment">// lev</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    std::string plotfilename;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">if</span> (which == 1)</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;       plotfilename = Concatenate(<a class="code" href="classREMORA.html#a784ba6c1f790c6df29d1e04772193ff0">plot_file_1</a>, <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[0], 5);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (which == 2)</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;       plotfilename = Concatenate(<a class="code" href="classREMORA.html#a6afd10f4968ef17dfe32806d62c465d4">plot_file_2</a>, <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>[0], 5);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">if</span> (finest_level == 0)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a002524d813441c4b5fe1b223b46389fa">plotfile_type</a> == <a class="code" href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9eabbe17e876cafcbc06d3ea0d2a23854d3">PlotfileType::amrex</a>) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Writing plotfile &quot;</span> &lt;&lt; plotfilename &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            <a class="code" href="classREMORA.html#a8c6fbe147d0a9bc99510fc8ee97aea98">WriteMultiLevelPlotfileWithBathymetry</a>(plotfilename, finest_level+1,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                                  GetVecOfConstPtrs(mf),</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                                                  GetVecOfConstPtrs(mf_nd),</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                                                  varnames,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                                                  <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[0], <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <a class="code" href="classREMORA.html#a331fbdef188eaf70cc72be04b1208020">writeJobInfo</a>(plotfilename);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_PARTICLES</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            particleData.Checkpoint(plotfilename);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_HDF5</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a002524d813441c4b5fe1b223b46389fa">plotfile_type</a> == <a class="code" href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9ead12072103bcd8a3e062dd7bc9124d354">PlotfileType::hdf5</a>) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Writing plotfile &quot;</span> &lt;&lt; plotfilename+<span class="stringliteral">&quot;d01.h5&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            WriteMultiLevelPlotfileHDF5(plotfilename, finest_level+1,</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                        GetVecOfConstPtrs(mf),</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                                        varnames,</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                                        Geom(), <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[0], <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>, refRatio());</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_NETCDF</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a002524d813441c4b5fe1b223b46389fa">plotfile_type</a> == <a class="code" href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9eac2e0f73e7b066a47b743d6ce8213e684">PlotfileType::netcdf</a>) {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;             <span class="comment">// int lev   = 0;</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;             <span class="comment">// int nc_which = 0;</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;             <span class="comment">// writeNCPlotFile(lev, nc_which, plotfilename, GetVecOfConstPtrs(mf), varnames, istep, t_new[0]);</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;             <span class="comment">// total_plot_file_step_1 += 1;</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            amrex::Abort(<span class="stringliteral">&quot;User specified unknown plot_filetype&quot;</span>);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// multilevel</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        Vector&lt;IntVect&gt;   r2(finest_level);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        Vector&lt;Geometry&gt;  g2(finest_level+1);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        Vector&lt;MultiFab&gt; mf2(finest_level+1);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        mf2[0].define(grids[0], dmap[0], ncomp_mf, 0);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="comment">// Copy level 0 as is</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        MultiFab::Copy(mf2[0],mf[0],0,0,mf[0].nComp(),0);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="comment">// Define a new multi-level array of Geometry&#39;s so that we pass the new &quot;domain&quot; at lev &gt; 0</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        Array&lt;int,AMREX_SPACEDIM&gt; periodicity =</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                     {Geom()[0].isPeriodic(0),Geom()[0].isPeriodic(1),Geom()[0].isPeriodic(2)};</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        g2[0].define(Geom()[0].Domain(),&amp;(Geom()[0].ProbDomain()),0,periodicity.data());</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classREMORA.html#a002524d813441c4b5fe1b223b46389fa">plotfile_type</a> == <a class="code" href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9eabbe17e876cafcbc06d3ea0d2a23854d3">PlotfileType::amrex</a>) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            r2[0] = IntVect(1,1,ref_ratio[0][0]);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                <span class="keywordflow">if</span> (lev &gt; 1) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                    r2[lev-1][0] = 1;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                    r2[lev-1][1] = 1;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                    r2[lev-1][2] = r2[lev-2][2] * ref_ratio[lev-1][0];</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                mf2[lev].define(refine(grids[lev],r2[lev-1]), dmap[lev], ncomp_mf, 0);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                <span class="comment">// Set the new problem domain</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                Box d2(Geom()[lev].Domain());</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                d2.refine(r2[lev-1]);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                g2[lev].define(d2,&amp;(Geom()[lev].ProbDomain()),0,periodicity.data());</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <span class="comment">// Do piecewise interpolation of mf into mf2</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                <span class="keywordflow">for</span> (MFIter mfi(mf2[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                    <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                    pcinterp_interp(bx,mf2[lev].array(mfi), 0, mf[lev].nComp(), mf[lev].const_array(mfi),0,r2[lev-1]);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="comment">// Define an effective ref_ratio which is isotropic to be passed into WriteMultiLevelPlotfile</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            Vector&lt;IntVect&gt; rr(finest_level);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt; finest_level; ++lev) {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                rr[lev] = IntVect(ref_ratio[lev][0],ref_ratio[lev][1],ref_ratio[lev][0]);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            WriteMultiLevelPlotfile(plotfilename, finest_level+1, GetVecOfConstPtrs(mf2), varnames,</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                                    g2, <a class="code" href="classREMORA.html#aa726a41ea5c80773654850a9444bf7fe">t_new</a>[0], <a class="code" href="classREMORA.html#a7c44493fe1a5743c92f272c91c3aa558">istep</a>, rr);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <a class="code" href="classREMORA.html#a331fbdef188eaf70cc72be04b1208020">writeJobInfo</a>(plotfilename);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="preprocessor">#ifdef REMORA_USE_PARTICLES</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            particleData.Checkpoint(plotfilename);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    } <span class="comment">// end multi-level</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;}</div>
<div class="ttc" id="aDataStruct_8H_html_a4036964f680afc43cfce078311111a9ead12072103bcd8a3e062dd7bc9124d354"><div class="ttname"><a href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9ead12072103bcd8a3e062dd7bc9124d354">PlotfileType::hdf5</a></div><div class="ttdeci">@ hdf5</div></div>
<div class="ttc" id="aclassREMORA_html_a331fbdef188eaf70cc72be04b1208020"><div class="ttname"><a href="classREMORA.html#a331fbdef188eaf70cc72be04b1208020">REMORA::writeJobInfo</a></div><div class="ttdeci">void writeJobInfo(const std::string &amp;dir) const</div><div class="ttdef"><b>Definition:</b> writeJobInfo.cpp:7</div></div>
<div class="ttc" id="aclassREMORA_html_a8c6fbe147d0a9bc99510fc8ee97aea98"><div class="ttname"><a href="classREMORA.html#a8c6fbe147d0a9bc99510fc8ee97aea98">REMORA::WriteMultiLevelPlotfileWithBathymetry</a></div><div class="ttdeci">void WriteMultiLevelPlotfileWithBathymetry(const std::string &amp;plotfilename, int nlevels, const amrex::Vector&lt; const amrex::MultiFab * &gt; &amp;mf, const amrex::Vector&lt; const amrex::MultiFab * &gt; &amp;mf_nd, const amrex::Vector&lt; std::string &gt; &amp;varnames, amrex::Real time, const amrex::Vector&lt; int &gt; &amp;level_steps, const std::string &amp;versionName=&quot;HyperCLaw-V1.1&quot;, const std::string &amp;levelPrefix=&quot;Level_&quot;, const std::string &amp;mfPrefix=&quot;Cell&quot;, const amrex::Vector&lt; std::string &gt; &amp;extra_dirs=amrex::Vector&lt; std::string &gt;()) const</div><div class="ttdef"><b>Definition:</b> Plotfile.cpp:305</div></div>
<div class="ttc" id="aclassREMORA_html_adf81b939a430211f29fed95b3d5f06fb"><div class="ttname"><a href="classREMORA.html#adf81b939a430211f29fed95b3d5f06fb">REMORA::PlotFileVarNames</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; PlotFileVarNames(amrex::Vector&lt; std::string &gt; plot_var_names) const</div><div class="ttdef"><b>Definition:</b> Plotfile.cpp:87</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classREMORA_a6c03ef43eb1e2584973f5a45975f5482_cgraph.png" border="0" usemap="#aclassREMORA_a6c03ef43eb1e2584973f5a45975f5482_cgraph" alt=""/></div>
<map name="aclassREMORA_a6c03ef43eb1e2584973f5a45975f5482_cgraph" id="aclassREMORA_a6c03ef43eb1e2584973f5a45975f5482_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,176,32"/>
<area shape="rect" href="REMORA_8H.html#a1f8554e7b211b0acfc202e8a600e7d67" title=" " alt="" coords="224,5,387,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="aa4b94dcbe06a58009a8b64d358b51bfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4b94dcbe06a58009a8b64d358b51bfc">&#9670;&nbsp;</a></span>advflux_reg</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::YAFluxRegister*&gt; REMORA::advflux_reg</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classREMORA.html#a0e2c89247c418609b713bdc107696258">getAdvFluxReg()</a>.</p>

</div>
</div>
<a id="a0536244c7b431fbd8cc40557061aadd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0536244c7b431fbd8cc40557061aadd5">&#9670;&nbsp;</a></span>bndry_output_planes_interval</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int REMORA::bndry_output_planes_interval</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af396dd41bf49d15c3c1a6f6e5ed4fdb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af396dd41bf49d15c3c1a6f6e5ed4fdb6">&#9670;&nbsp;</a></span>bndry_output_planes_per</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real REMORA::bndry_output_planes_per</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2a9189b0c8dd06cd3a6e1f0e2ec367ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a9189b0c8dd06cd3a6e1f0e2ec367ac">&#9670;&nbsp;</a></span>bndry_output_planes_start_time</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real REMORA::bndry_output_planes_start_time</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a45b928a121bd6c5e75ec75732a27f774"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45b928a121bd6c5e75ec75732a27f774">&#9670;&nbsp;</a></span>boxes_at_level</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::Box&gt; &gt; REMORA::boxes_at_level</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad3cf3f0d0e6783927e40a57231693fee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3cf3f0d0e6783927e40a57231693fee">&#9670;&nbsp;</a></span>cfl</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real REMORA::cfl = 0.8</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8c3a852e766271b0dcf52a99f2ba6500"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c3a852e766271b0dcf52a99f2ba6500">&#9670;&nbsp;</a></span>change_max</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real REMORA::change_max = 1.1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4ca794481e17552667b3824252497b6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ca794481e17552667b3824252497b6a">&#9670;&nbsp;</a></span>check_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string REMORA::check_file {&quot;chk&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae12e05882ce5fbae362e87b567d1a05f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae12e05882ce5fbae362e87b567d1a05f">&#9670;&nbsp;</a></span>check_int</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int REMORA::check_int = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac6b864f6c16bd0320325b81333ca93b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6b864f6c16bd0320325b81333ca93b3">&#9670;&nbsp;</a></span>column_file_name</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string REMORA::column_file_name</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0659caeaf0312106700eee623eac075d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0659caeaf0312106700eee623eac075d">&#9670;&nbsp;</a></span>column_interval</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int REMORA::column_interval</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4006290dea5d963b8c030d48812d18cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4006290dea5d963b8c030d48812d18cf">&#9670;&nbsp;</a></span>column_loc_x</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real REMORA::column_loc_x</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4be90b3f9b1c315976a021db1c27382c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4be90b3f9b1c315976a021db1c27382c">&#9670;&nbsp;</a></span>column_loc_y</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real REMORA::column_loc_y</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="afa757e1f348fcf80e7e05dce9e3bb25b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa757e1f348fcf80e7e05dce9e3bb25b">&#9670;&nbsp;</a></span>column_per</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real REMORA::column_per</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a006b52a7c7bc31839827318d5ca2dcee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a006b52a7c7bc31839827318d5ca2dcee">&#9670;&nbsp;</a></span>cons_names</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const amrex::Vector&lt;std::string&gt; REMORA::cons_names {&quot;temp&quot;, &quot;salt&quot;, &quot;scalar&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1e6bb5ba18bc44344e75066721820ed5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e6bb5ba18bc44344e75066721820ed5">&#9670;&nbsp;</a></span>cons_new</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab*&gt; REMORA::cons_new</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="abc6ebdcc84239b993b12b3c95425fa88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc6ebdcc84239b993b12b3c95425fa88">&#9670;&nbsp;</a></span>cons_old</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab*&gt; REMORA::cons_old</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa86962216f5ba94d0d6a92b313fe6b91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa86962216f5ba94d0d6a92b313fe6b91">&#9670;&nbsp;</a></span>d_havg_density</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Gpu::DeviceVector&lt;amrex::Real&gt; REMORA::d_havg_density</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9d8bfb2faf76f5666db1f2e6c3c27c46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d8bfb2faf76f5666db1f2e6c3c27c46">&#9670;&nbsp;</a></span>d_havg_pressure</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Gpu::DeviceVector&lt;amrex::Real&gt; REMORA::d_havg_pressure</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a815d07375e65ea99f9e99dc3b32cc5c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a815d07375e65ea99f9e99dc3b32cc5c4">&#9670;&nbsp;</a></span>d_havg_temperature</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Gpu::DeviceVector&lt;amrex::Real&gt; REMORA::d_havg_temperature</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad3530fc80b87c25ce728095929a4ea99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3530fc80b87c25ce728095929a4ea99">&#9670;&nbsp;</a></span>datalog</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;std::fstream&gt; &gt; REMORA::datalog</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classREMORA.html#a82e5140a7b4d9092e8230b7043d0a388">DataLog()</a>, <a class="el" href="classREMORA.html#abe6c7702fc1edcb5bb7d9a1a56d007a9">NumDataLogs()</a>, and <a class="el" href="classREMORA.html#a7f4ee77d07b875ac526da57e8f0f1e98">setRecordDataInfo()</a>.</p>

</div>
</div>
<a id="a39048951d6927086a690d57a53754160"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39048951d6927086a690d57a53754160">&#9670;&nbsp;</a></span>datalogname</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::string&gt; REMORA::datalogname</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classREMORA.html#a8062b4dcb1ea9deba016d427d23480aa">DataLogName()</a>.</p>

</div>
</div>
<a id="ae91017557bdacda7d14418c7f15967e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae91017557bdacda7d14418c7f15967e2">&#9670;&nbsp;</a></span>derived_names</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const amrex::Vector&lt;std::string&gt; REMORA::derived_names {&quot;dpdx&quot;, &quot;dpdy&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2c050fd7227b627691a3c074eb104c8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c050fd7227b627691a3c074eb104c8d">&#9670;&nbsp;</a></span>do_substep</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int REMORA::do_substep</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac686c83706316dc3388d6c1d6b270a2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac686c83706316dc3388d6c1d6b270a2c">&#9670;&nbsp;</a></span>domain_bc_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Array&lt;std::string,2*AMREX_SPACEDIM&gt; REMORA::domain_bc_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classREMORA.html#a331fbdef188eaf70cc72be04b1208020">writeJobInfo()</a>.</p>

</div>
</div>
<a id="a116e340c1b1afd8b7a64faa108157a0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a116e340c1b1afd8b7a64faa108157a0f">&#9670;&nbsp;</a></span>domain_bcs_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::BCRec&gt; REMORA::domain_bcs_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af4c01c1be8a352c96a61e03e08c25121"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4c01c1be8a352c96a61e03e08c25121">&#9670;&nbsp;</a></span>domain_bcs_type_d</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Gpu::DeviceVector&lt;amrex::BCRec&gt; REMORA::domain_bcs_type_d</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aedae6fd90cb13271f63ea80e59a2aacb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedae6fd90cb13271f63ea80e59a2aacb">&#9670;&nbsp;</a></span>dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; REMORA::dt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1767264051aeb1f4463f23304214617e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1767264051aeb1f4463f23304214617e">&#9670;&nbsp;</a></span>fine_mask</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::MultiFab REMORA::fine_mask</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0c9e94b2bbf3ee8167abb9acd4b86807"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c9e94b2bbf3ee8167abb9acd4b86807">&#9670;&nbsp;</a></span>fixed_dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real REMORA::fixed_dt = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5cdf62f58282022e2d5f79de304d425f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cdf62f58282022e2d5f79de304d425f">&#9670;&nbsp;</a></span>fixed_fast_dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real REMORA::fixed_fast_dt = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="acc900ee008729de41eb6aa28a36f6a26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc900ee008729de41eb6aa28a36f6a26">&#9670;&nbsp;</a></span>fixed_ndtfast_ratio</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int REMORA::fixed_ndtfast_ratio = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa1a54cdd1292614b340f58125684e7b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1a54cdd1292614b340f58125684e7b1">&#9670;&nbsp;</a></span>h_havg_density</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; REMORA::h_havg_density</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a81ae77b15e0b8ff1061e8a54a6b820ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81ae77b15e0b8ff1061e8a54a6b820ad">&#9670;&nbsp;</a></span>h_havg_pressure</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; REMORA::h_havg_pressure</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6c3b580d36c077489568637e56a71d82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c3b580d36c077489568637e56a71d82">&#9670;&nbsp;</a></span>h_havg_temperature</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; REMORA::h_havg_temperature</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a17de9bc2e49fbb1de53a5c57489d36bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17de9bc2e49fbb1de53a5c57489d36bb">&#9670;&nbsp;</a></span>init_shrink</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real REMORA::init_shrink = 1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="acf556866c1e50658f057b20b323b637a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf556866c1e50658f057b20b323b637a">&#9670;&nbsp;</a></span>input_bndry_planes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int REMORA::input_bndry_planes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aef205c3aa9b16521417f944c4f95f401"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef205c3aa9b16521417f944c4f95f401">&#9670;&nbsp;</a></span>input_sounding_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string REMORA::input_sounding_file</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7c44493fe1a5743c92f272c91c3aa558"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c44493fe1a5743c92f272c91c3aa558">&#9670;&nbsp;</a></span>istep</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;int&gt; REMORA::istep</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a70585b0129bfb5d405b1e10ea97020c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70585b0129bfb5d405b1e10ea97020c5">&#9670;&nbsp;</a></span>last_check_file_step</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int REMORA::last_check_file_step</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa1b32ce8d7cfb920dd3c61c002fc9e0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1b32ce8d7cfb920dd3c61c002fc9e0f">&#9670;&nbsp;</a></span>last_plot_file_step_1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int REMORA::last_plot_file_step_1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a642013869cd0ee3902d2106b64fa418a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a642013869cd0ee3902d2106b64fa418a">&#9670;&nbsp;</a></span>last_plot_file_step_2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int REMORA::last_plot_file_step_2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a09a032f4d90f8dd939ab8e2ab5a06e06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09a032f4d90f8dd939ab8e2ab5a06e06">&#9670;&nbsp;</a></span>m_bc_extdir_vals</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Array&lt;amrex::Array&lt;amrex::Real, AMREX_SPACEDIM*2&gt;,AMREX_SPACEDIM+<a class="el" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>&gt; REMORA::m_bc_extdir_vals</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6b32e42c790f2f3ac55ce545c2d03314"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b32e42c790f2f3ac55ce545c2d03314">&#9670;&nbsp;</a></span>mapfac_m</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::mapfac_m</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5d56f29784bbca12778ba7c58fa0f36d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d56f29784bbca12778ba7c58fa0f36d">&#9670;&nbsp;</a></span>mapfac_u</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::mapfac_u</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa30c202e051228d1936a521eedcd6957"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa30c202e051228d1936a521eedcd6957">&#9670;&nbsp;</a></span>mapfac_v</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::mapfac_v</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a69c542c1c57e6c6532a20eec60b9a0c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69c542c1c57e6c6532a20eec60b9a0c3">&#9670;&nbsp;</a></span>max_step</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int REMORA::max_step = std::numeric_limits&lt;int&gt;::max()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ade8f2985b433261b76ac1d8f28fa6d0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade8f2985b433261b76ac1d8f28fa6d0a">&#9670;&nbsp;</a></span>nc_bdry_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string REMORA::nc_bdry_file</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af0ba249e52817855bb895b47cb005227"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0ba249e52817855bb895b47cb005227">&#9670;&nbsp;</a></span>nc_grid_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;std::string&gt; &gt; REMORA::nc_grid_file</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af7b7f34b69f804f7acd9a1bc0c7bb5b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7b7f34b69f804f7acd9a1bc0c7bb5b9">&#9670;&nbsp;</a></span>nc_init_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;std::string&gt; &gt; REMORA::nc_init_file</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a05d2c2f58537f7fdae1bb5088f50e149"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05d2c2f58537f7fdae1bb5088f50e149">&#9670;&nbsp;</a></span>nfast</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int REMORA::nfast</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7595b63fdb3f613a189cd20936290d2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7595b63fdb3f613a189cd20936290d2b">&#9670;&nbsp;</a></span>nsubsteps</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;int&gt; REMORA::nsubsteps</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6d28606118c0069a57eb6a3c13685c56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d28606118c0069a57eb6a3c13685c56">&#9670;&nbsp;</a></span>num_boxes_at_level</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;int&gt; REMORA::num_boxes_at_level</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a66ad489788fb8d0913833d3d6c89b9dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66ad489788fb8d0913833d3d6c89b9dd">&#9670;&nbsp;</a></span>num_files_at_level</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;int&gt; REMORA::num_files_at_level</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad280580fcce56885135a6923a2e0239c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad280580fcce56885135a6923a2e0239c">&#9670;&nbsp;</a></span>output_1d_column</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int REMORA::output_1d_column</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6266d103134197c8d3847f1033b80736"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6266d103134197c8d3847f1033b80736">&#9670;&nbsp;</a></span>output_bndry_planes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int REMORA::output_bndry_planes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="adac776c0b66cb62bc9a7a03369b6240e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adac776c0b66cb62bc9a7a03369b6240e">&#9670;&nbsp;</a></span>phys_bc_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::GpuArray&lt;<a class="el" href="IndexDefines_8H.html#a4a23ce64320a8ee19b456144f4deb325">REMORA_BC</a>, AMREX_SPACEDIM*2&gt; REMORA::phys_bc_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a75e6e53bc24b47b664fddcafed41dbd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75e6e53bc24b47b664fddcafed41dbd1">&#9670;&nbsp;</a></span>physbcs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;<a class="el" href="classREMORAPhysBCFunct.html">REMORAPhysBCFunct</a>&gt; &gt; REMORA::physbcs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a784ba6c1f790c6df29d1e04772193ff0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a784ba6c1f790c6df29d1e04772193ff0">&#9670;&nbsp;</a></span>plot_file_1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string REMORA::plot_file_1 {&quot;plt_1_&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6afd10f4968ef17dfe32806d62c465d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6afd10f4968ef17dfe32806d62c465d4">&#9670;&nbsp;</a></span>plot_file_2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string REMORA::plot_file_2 {&quot;plt_2_&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ab9ce060b467505349e57dacf4e5553fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9ce060b467505349e57dacf4e5553fd">&#9670;&nbsp;</a></span>plot_file_on_restart</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int REMORA::plot_file_on_restart = 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3a61745803081888ac360f521a623b1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a61745803081888ac360f521a623b1b">&#9670;&nbsp;</a></span>plot_int_1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int REMORA::plot_int_1 = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1db03ec74ac9a6e94c59ed0e4a187bbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1db03ec74ac9a6e94c59ed0e4a187bbb">&#9670;&nbsp;</a></span>plot_int_2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int REMORA::plot_int_2 = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0737e2206f4961852b5cbdc0c9c889f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0737e2206f4961852b5cbdc0c9c889f1">&#9670;&nbsp;</a></span>plot_var_names_1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::string&gt; REMORA::plot_var_names_1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2dc73785c2de0224c069e73c5d57e794"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dc73785c2de0224c069e73c5d57e794">&#9670;&nbsp;</a></span>plot_var_names_2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::string&gt; REMORA::plot_var_names_2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a002524d813441c4b5fe1b223b46389fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a002524d813441c4b5fe1b223b46389fa">&#9670;&nbsp;</a></span>plotfile_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9e">PlotfileType</a> REMORA::plotfile_type = <a class="el" href="DataStruct_8H.html#a4036964f680afc43cfce078311111a9eabbe17e876cafcbc06d3ea0d2a23854d3">PlotfileType::amrex</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9724f153d0c7a89c5d6aec11605959aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9724f153d0c7a89c5d6aec11605959aa">&#9670;&nbsp;</a></span>pp_prefix</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string REMORA::pp_prefix {&quot;remora&quot;}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a13791ab61c74d1c95a4caa544d9ac3d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13791ab61c74d1c95a4caa544d9ac3d3">&#9670;&nbsp;</a></span>previousCPUTimeUsed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real REMORA::previousCPUTimeUsed = 0.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classREMORA.html#a79eb0ac9909062422d3b3207a7643dd8">getCPUTime()</a>.</p>

</div>
</div>
<a id="a476b854ad74dd35ec1bf21cd9ea1f0b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a476b854ad74dd35ec1bf21cd9ea1f0b0">&#9670;&nbsp;</a></span>ref_tags</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vector&lt; AMRErrorTag &gt; REMORA::ref_tags</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5d3ceaf421e5e6ec42b4da2fcb2d610c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d3ceaf421e5e6ec42b4da2fcb2d610c">&#9670;&nbsp;</a></span>regrid_int</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int REMORA::regrid_int = 2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae376daabb97c474de25b283de6bd985d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae376daabb97c474de25b283de6bd985d">&#9670;&nbsp;</a></span>restart_chkfile</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string REMORA::restart_chkfile = &quot;&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa88bf20926ca017d05ebabe44f224443"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa88bf20926ca017d05ebabe44f224443">&#9670;&nbsp;</a></span>solverChoice</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structSolverChoice.html">SolverChoice</a> REMORA::solverChoice</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a87c0b19a10b9aaf727f902e62dad8f77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87c0b19a10b9aaf727f902e62dad8f77">&#9670;&nbsp;</a></span>sst</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::sst</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4d3e0a094fbd5ed0ef96114162a88478"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d3e0a094fbd5ed0ef96114162a88478">&#9670;&nbsp;</a></span>startCPUTime</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real REMORA::startCPUTime = 0.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classREMORA.html#a79eb0ac9909062422d3b3207a7643dd8">getCPUTime()</a>.</p>

</div>
</div>
<a id="a2981da216b5811080251dc15b27ca281"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2981da216b5811080251dc15b27ca281">&#9670;&nbsp;</a></span>stop_time</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real REMORA::stop_time = std::numeric_limits&lt;amrex::Real&gt;::max()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a295ab241204aca35cc4c720392bb3fd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a295ab241204aca35cc4c720392bb3fd2">&#9670;&nbsp;</a></span>sum_interval</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int REMORA::sum_interval = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aee90bf7b804b280c88a65dd354d97ee5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee90bf7b804b280c88a65dd354d97ee5">&#9670;&nbsp;</a></span>sum_per</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real REMORA::sum_per = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa726a41ea5c80773654850a9444bf7fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa726a41ea5c80773654850a9444bf7fe">&#9670;&nbsp;</a></span>t_new</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; REMORA::t_new</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae94018d43dcebc3cd70293e6c621c46a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae94018d43dcebc3cd70293e6c621c46a">&#9670;&nbsp;</a></span>t_old</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; REMORA::t_old</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a97dfe1e54e1222290a2c76a64cdf7339"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97dfe1e54e1222290a2c76a64cdf7339">&#9670;&nbsp;</a></span>use_tracer_particles</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool REMORA::use_tracer_particles</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a48c1bf42530780ce02b3655d7cefe592"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48c1bf42530780ce02b3655d7cefe592">&#9670;&nbsp;</a></span>vec_Akt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_Akt</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Vertical diffusion coefficient (3D), set in .in file </p>

</div>
</div>
<a id="ad36ee94716ca0cde00d8cad5fe5cce94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad36ee94716ca0cde00d8cad5fe5cce94">&#9670;&nbsp;</a></span>vec_Akv</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_Akv</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Vertical viscosity coefficient (3D), set in .in file </p>

</div>
</div>
<a id="abd341c53d0813eaea345511b8e14afdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd341c53d0813eaea345511b8e14afdd">&#9670;&nbsp;</a></span>vec_bustr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_bustr</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Bottom stress in the u direction </p>

</div>
</div>
<a id="ac7d186a8a4d54c28a5b2eecaec6cb978"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7d186a8a4d54c28a5b2eecaec6cb978">&#9670;&nbsp;</a></span>vec_bvstr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_bvstr</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Bottom stress in the v direction </p>

</div>
</div>
<a id="afdf4b75f0ec12caf3648dbee5ec7f653"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdf4b75f0ec12caf3648dbee5ec7f653">&#9670;&nbsp;</a></span>vec_diff2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_diff2</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Harmonic diffusivity for temperature / salinity </p>

</div>
</div>
<a id="ab8e2ff918dcaf20a807b37e88f9fdbb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8e2ff918dcaf20a807b37e88f9fdbb0">&#9670;&nbsp;</a></span>vec_DU_avg1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_DU_avg1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>time average of barotropic x velocity flux (2D) </p>

</div>
</div>
<a id="a1b2cc0f2f617e846c6261df12aefd110"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b2cc0f2f617e846c6261df12aefd110">&#9670;&nbsp;</a></span>vec_DU_avg2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_DU_avg2</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>correct time average of barotropic x velocity flux for coupling (2D) </p>

</div>
</div>
<a id="a9e0560b2f68b9c541583c9c1ff6c87ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e0560b2f68b9c541583c9c1ff6c87ec">&#9670;&nbsp;</a></span>vec_DV_avg1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_DV_avg1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>time average of barotropic y velocity flux </p>

</div>
</div>
<a id="ac5ba663380c2e7b3857e21fd0d4286f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5ba663380c2e7b3857e21fd0d4286f9">&#9670;&nbsp;</a></span>vec_DV_avg2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_DV_avg2</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>correct time average of barotropic y velocity flux for coupling (2D) </p>

</div>
</div>
<a id="a13f9894ec6aca96e68687e7a6762e337"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13f9894ec6aca96e68687e7a6762e337">&#9670;&nbsp;</a></span>vec_fcor</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_fcor</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>coriolis factor (2D) </p>

</div>
</div>
<a id="a157e7645fedcf8c0b46516dbb625d3bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a157e7645fedcf8c0b46516dbb625d3bd">&#9670;&nbsp;</a></span>vec_hOfTheConfusingName</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_hOfTheConfusingName</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Bathymetry data (2D, positive valued, h in ROMS) </p>

</div>
</div>
<a id="a89f042895cd59cc1a1226f2af2d3e04f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89f042895cd59cc1a1226f2af2d3e04f">&#9670;&nbsp;</a></span>vec_Huon</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_Huon</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>u-volume flux (3D) </p>

</div>
</div>
<a id="afd1aab14dfc9155d65e48aad2b34ef42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd1aab14dfc9155d65e48aad2b34ef42">&#9670;&nbsp;</a></span>vec_Hvom</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_Hvom</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>v-volume flux (3D) </p>

</div>
</div>
<a id="a488738b1aea61abbbf086a9d22b4f815"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a488738b1aea61abbbf086a9d22b4f815">&#9670;&nbsp;</a></span>vec_Hz</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_Hz</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Width of cells in the vertical (z-) direction (3D, Hz in ROMS) </p>

</div>
</div>
<a id="a173014aa6947dd9d4e0026541211f2be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a173014aa6947dd9d4e0026541211f2be">&#9670;&nbsp;</a></span>vec_pm</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_pm</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>map factor (2D) </p>

</div>
</div>
<a id="ad2d61f66b270a3def972bf32478790d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2d61f66b270a3def972bf32478790d8">&#9670;&nbsp;</a></span>vec_pn</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_pn</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>map factor (2D) </p>

</div>
</div>
<a id="adba780a7c66c2158c914bff64964df60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adba780a7c66c2158c914bff64964df60">&#9670;&nbsp;</a></span>vec_rdrag</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_rdrag</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Linear drag coefficient [m/s], defined at rho points </p>

</div>
</div>
<a id="a9acf62fad9b709ea10e00e9534d7a7c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9acf62fad9b709ea10e00e9534d7a7c5">&#9670;&nbsp;</a></span>vec_rhoA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_rhoA</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8386c899de7b3b3feab286c144f15229"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8386c899de7b3b3feab286c144f15229">&#9670;&nbsp;</a></span>vec_rhoS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_rhoS</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aaf06acc3074f6a4dd322f9e1ca0c5244"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf06acc3074f6a4dd322f9e1ca0c5244">&#9670;&nbsp;</a></span>vec_ru</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_ru</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>u velocity RHS (3D, includes horizontal and vertical advection) </p>

</div>
</div>
<a id="a15b7ca3e79155dde5c648ac78d64e6c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15b7ca3e79155dde5c648ac78d64e6c7">&#9670;&nbsp;</a></span>vec_rubar</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_rubar</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>barotropic x velocity for the RHS (2D) </p>

</div>
</div>
<a id="a5a0dd90f9e35c6055bf3ede53f4229d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a0dd90f9e35c6055bf3ede53f4229d6">&#9670;&nbsp;</a></span>vec_rufrc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_rufrc</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>u velocity RHS, integrated, including advection and bottom/surface stresses (2D) </p>

</div>
</div>
<a id="ae4e70f2661f28e3a3a2585540e804486"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4e70f2661f28e3a3a2585540e804486">&#9670;&nbsp;</a></span>vec_rv</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_rv</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>v velocity RHS (3D, includes horizontal and vertical advection) </p>

</div>
</div>
<a id="a66a39d31a3a2f027101cfd4052b913f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66a39d31a3a2f027101cfd4052b913f3">&#9670;&nbsp;</a></span>vec_rvbar</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_rvbar</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>barotropic y velocity for the RHS (2D) </p>

</div>
</div>
<a id="a49ea2c6c379a0fa006e4b6023fd69f88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49ea2c6c379a0fa006e4b6023fd69f88">&#9670;&nbsp;</a></span>vec_rvfrc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_rvfrc</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>v velocity RHS, integrated, including advection and bottom/surface stresses (2D) </p>

</div>
</div>
<a id="ac8c001dd94aa7fb806502579324905fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8c001dd94aa7fb806502579324905fd">&#9670;&nbsp;</a></span>vec_rzeta</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_rzeta</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>free surface height for the RHS (2D) </p>

</div>
</div>
<a id="afc9f775b64d67d4ad85bc493c9c54f4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc9f775b64d67d4ad85bc493c9c54f4f">&#9670;&nbsp;</a></span>vec_s_r</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_s_r</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Scaled vertical coordinate (range [0,1]) that transforms to z, defined at rho points (cell centers) </p>

</div>
</div>
<a id="a3d55e55c73497ceabf620dacbe632a3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d55e55c73497ceabf620dacbe632a3a">&#9670;&nbsp;</a></span>vec_sstore</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_sstore</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>saltstore, tempstore, etc </p>

</div>
</div>
<a id="a347a75f9295217fc66a8b7a4c2a47f9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a347a75f9295217fc66a8b7a4c2a47f9b">&#9670;&nbsp;</a></span>vec_sustr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_sustr</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Surface stress in the u direction </p>

</div>
</div>
<a id="a88a26701f7276ea04f5c9ede4ae46981"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88a26701f7276ea04f5c9ede4ae46981">&#9670;&nbsp;</a></span>vec_svstr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_svstr</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Surface stress in the v direction </p>

</div>
</div>
<a id="abb214b8bab178b72c44907f5e2aeead8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb214b8bab178b72c44907f5e2aeead8">&#9670;&nbsp;</a></span>vec_ubar</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_ubar</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>barotropic x velocity (2D) </p>

</div>
</div>
<a id="ab70c8d3ac0d8a5f7ac51365571905874"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab70c8d3ac0d8a5f7ac51365571905874">&#9670;&nbsp;</a></span>vec_vbar</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_vbar</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>barotropic y velocity (2D) </p>

</div>
</div>
<a id="a65281506759b30fbc3c382ba0a64f38f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65281506759b30fbc3c382ba0a64f38f">&#9670;&nbsp;</a></span>vec_visc2_p</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_visc2_p</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Harmonic viscosity devined on the psi points (corners of horizontal grid cells) </p>

</div>
</div>
<a id="a86f0a2458c28f42d5be178d7bc5d104b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86f0a2458c28f42d5be178d7bc5d104b">&#9670;&nbsp;</a></span>vec_visc2_r</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_visc2_r</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Harmonic viscosity devined on the rho points (centers) </p>

</div>
</div>
<a id="aae58396940a8e44b9b8aa4b6ec6e878f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae58396940a8e44b9b8aa4b6ec6e878f">&#9670;&nbsp;</a></span>vec_visc3d_r</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_visc3d_r</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab17dd7f0866773488c052d67cb6086b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab17dd7f0866773488c052d67cb6086b3">&#9670;&nbsp;</a></span>vec_weight1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; REMORA::vec_weight1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a634b285cb09738ecdc4b191e897744ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a634b285cb09738ecdc4b191e897744ed">&#9670;&nbsp;</a></span>vec_weight2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; REMORA::vec_weight2</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a55ca3c497c355a95a82bfbacf955771e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55ca3c497c355a95a82bfbacf955771e">&#9670;&nbsp;</a></span>vec_x_r</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_x_r</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>x coordinates at rho points (cell centers) </p>

</div>
</div>
<a id="ab86841fb3954bcabcb79275416c46253"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab86841fb3954bcabcb79275416c46253">&#9670;&nbsp;</a></span>vec_y_r</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_y_r</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>y coordinates at rho points (cell centers) </p>

</div>
</div>
<a id="ac956bf3a52181b34d3e98a85ea5ba131"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac956bf3a52181b34d3e98a85ea5ba131">&#9670;&nbsp;</a></span>vec_z_phys_nd</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_z_phys_nd</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>z coordinates at psi points (cell nodes) </p>

</div>
</div>
<a id="a6b24784c109d216c5a6cee02af8c5b0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b24784c109d216c5a6cee02af8c5b0f">&#9670;&nbsp;</a></span>vec_z_r</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_z_r</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>z coordinates at rho points (cell centers) </p>

</div>
</div>
<a id="af7958bb9cfac605c91f1e74357f344b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7958bb9cfac605c91f1e74357f344b2">&#9670;&nbsp;</a></span>vec_z_w</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_z_w</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>z coordinates at w points (faces between z-cells) </p>

</div>
</div>
<a id="ab60f476961622f8e7f27221595e84956"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab60f476961622f8e7f27221595e84956">&#9670;&nbsp;</a></span>vec_zeta</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_zeta</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>free surface height (2D) </p>

</div>
</div>
<a id="adeb60c66ba4665f07c57fbf3b3b8909a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adeb60c66ba4665f07c57fbf3b3b8909a">&#9670;&nbsp;</a></span>vec_Zt_avg1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; REMORA::vec_Zt_avg1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Average of the free surface, zeta (2D) </p>

</div>
</div>
<a id="ad9ed53f5f841397304bf3b16fc82ecd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9ed53f5f841397304bf3b16fc82ecd9">&#9670;&nbsp;</a></span>verbose</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int REMORA::verbose = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6d4e5271a8d00e497c4bce0a51dbe63c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d4e5271a8d00e497c4bce0a51dbe63c">&#9670;&nbsp;</a></span>xvel_new</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab*&gt; REMORA::xvel_new</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a51594dd103a7eee0f4e0c6e366d9f0ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51594dd103a7eee0f4e0c6e366d9f0ce">&#9670;&nbsp;</a></span>xvel_old</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab*&gt; REMORA::xvel_old</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a57327a8173b5dd09f9db6ce23f745dd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57327a8173b5dd09f9db6ce23f745dd5">&#9670;&nbsp;</a></span>yvel_new</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab*&gt; REMORA::yvel_new</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9861cf91ee53fb2125f5f49c5cf73155"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9861cf91ee53fb2125f5f49c5cf73155">&#9670;&nbsp;</a></span>yvel_old</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab*&gt; REMORA::yvel_old</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3950916f4ed965bcd10f62e28e08fd76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3950916f4ed965bcd10f62e28e08fd76">&#9670;&nbsp;</a></span>zvel_new</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab*&gt; REMORA::zvel_new</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6a980b1cd1d4d0e1253a641bee00de75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a980b1cd1d4d0e1253a641bee00de75">&#9670;&nbsp;</a></span>zvel_old</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab*&gt; REMORA::zvel_old</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/runner/work/REMORA/REMORA/Source/<a class="el" href="REMORA_8H_source.html">REMORA.H</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/BoundaryConditions/<a class="el" href="REMORA__FillPatch_8cpp.html">REMORA_FillPatch.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/Initialization/<a class="el" href="REMORA__init_8cpp.html">REMORA_init.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/Initialization/<a class="el" href="REMORA__init__bcs_8cpp.html">REMORA_init_bcs.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/Initialization/<a class="el" href="REMORA__make__new__level_8cpp.html">REMORA_make_new_level.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/IO/<a class="el" href="Checkpoint_8cpp.html">Checkpoint.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/IO/<a class="el" href="Plotfile_8cpp.html">Plotfile.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/IO/<a class="el" href="writeJobInfo_8cpp.html">writeJobInfo.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/<a class="el" href="REMORA_8cpp.html">REMORA.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/<a class="el" href="REMORA__SumIQ_8cpp.html">REMORA_SumIQ.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/<a class="el" href="REMORA__Tagging_8cpp.html">REMORA_Tagging.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/TimeIntegration/<a class="el" href="REMORA__Advance_8cpp.html">REMORA_Advance.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/TimeIntegration/<a class="el" href="REMORA__advance__2d_8cpp.html">REMORA_advance_2d.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/TimeIntegration/<a class="el" href="REMORA__advance__2d__onestep_8cpp.html">REMORA_advance_2d_onestep.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/TimeIntegration/<a class="el" href="REMORA__advance__3d_8cpp.html">REMORA_advance_3d.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/TimeIntegration/<a class="el" href="REMORA__advance__3d__ml_8cpp.html">REMORA_advance_3d_ml.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/TimeIntegration/<a class="el" href="REMORA__ComputeTimestep_8cpp.html">REMORA_ComputeTimestep.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/TimeIntegration/<a class="el" href="REMORA__coriolis_8cpp.html">REMORA_coriolis.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/TimeIntegration/<a class="el" href="REMORA__prestep_8cpp.html">REMORA_prestep.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/TimeIntegration/<a class="el" href="REMORA__prestep__diffusion_8cpp.html">REMORA_prestep_diffusion.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/TimeIntegration/<a class="el" href="REMORA__prestep__t__advection_8cpp.html">REMORA_prestep_t_advection.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/TimeIntegration/<a class="el" href="REMORA__prsgrd_8cpp.html">REMORA_prsgrd.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/TimeIntegration/<a class="el" href="REMORA__rho__eos_8cpp.html">REMORA_rho_eos.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/TimeIntegration/<a class="el" href="REMORA__rhs__t__3d_8cpp.html">REMORA_rhs_t_3d.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/TimeIntegration/<a class="el" href="REMORA__rhs__uv__2d_8cpp.html">REMORA_rhs_uv_2d.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/TimeIntegration/<a class="el" href="REMORA__rhs__uv__3d_8cpp.html">REMORA_rhs_uv_3d.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/TimeIntegration/<a class="el" href="REMORA__set__weights_8cpp.html">REMORA_set_weights.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/TimeIntegration/<a class="el" href="REMORA__setup__step_8cpp.html">REMORA_setup_step.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/TimeIntegration/<a class="el" href="REMORA__t3dmix_8cpp.html">REMORA_t3dmix.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/TimeIntegration/<a class="el" href="REMORA__TimeStep_8cpp.html">REMORA_TimeStep.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/TimeIntegration/<a class="el" href="REMORA__TimeStepML_8cpp.html">REMORA_TimeStepML.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/TimeIntegration/<a class="el" href="REMORA__update__massflux__3d_8cpp.html">REMORA_update_massflux_3d.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/TimeIntegration/<a class="el" href="REMORA__uv3dmix_8cpp.html">REMORA_uv3dmix.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/TimeIntegration/<a class="el" href="REMORA__vert__mean__3d_8cpp.html">REMORA_vert_mean_3d.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/TimeIntegration/<a class="el" href="REMORA__vert__visc__3d_8cpp.html">REMORA_vert_visc_3d.cpp</a></li>
<li>/home/runner/work/REMORA/REMORA/Source/Utils/<a class="el" href="DepthStretchTransform_8H_source.html">DepthStretchTransform.H</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classREMORA.html">REMORA</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
