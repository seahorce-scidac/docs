<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ROMSX: ROMSX Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ROMSX
   </div>
   <div id="projectbrief">Energy Research and Forecasting: An Atmospheric Modeling Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classROMSX.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="classROMSX-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ROMSX Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="ROMSX_8H_source.html">ROMSX.H</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for ROMSX:</div>
<div class="dyncontent">
<div class="center"><img src="classROMSX__inherit__graph.png" border="0" usemap="#aROMSX_inherit__map" alt="Inheritance graph"/></div>
<map name="aROMSX_inherit__map" id="aROMSX_inherit__map">
<area shape="rect" title=" " alt="" coords="35,80,105,107"/>
<area shape="rect" title=" " alt="" coords="5,5,135,32"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for ROMSX:</div>
<div class="dyncontent">
<div class="center"><img src="classROMSX__coll__graph.png" border="0" usemap="#aROMSX_coll__map" alt="Collaboration graph"/></div>
<map name="aROMSX_coll__map" id="aROMSX_coll__map">
<area shape="rect" title=" " alt="" coords="925,1409,996,1436"/>
<area shape="rect" title=" " alt="" coords="551,12,680,39"/>
<area shape="rect" title=" " alt="" coords="489,63,741,89"/>
<area shape="rect" title=" " alt="" coords="530,114,701,155"/>
<area shape="rect" title=" " alt="" coords="503,179,727,221"/>
<area shape="rect" title=" " alt="" coords="502,245,729,272"/>
<area shape="rect" title=" " alt="" coords="237,507,288,533"/>
<area shape="rect" href="structSolverChoice.html" title=" " alt="" coords="562,867,669,893"/>
<area shape="rect" title=" " alt="" coords="208,811,317,837"/>
<area shape="rect" title=" " alt="" coords="243,1091,282,1117"/>
<area shape="rect" title=" " alt="" coords="237,913,288,940"/>
<area shape="rect" title=" " alt="" coords="219,1220,306,1247"/>
<area shape="rect" title=" " alt="" coords="5,1213,144,1254"/>
<area shape="rect" title=" " alt="" coords="193,1020,332,1047"/>
<area shape="rect" title=" " alt="" coords="214,760,311,787"/>
<area shape="rect" title=" " alt="" coords="536,1380,695,1407"/>
<area shape="rect" title=" " alt="" coords="533,1431,698,1473"/>
<area shape="rect" title=" " alt="" coords="577,1497,654,1524"/>
<area shape="rect" title=" " alt="" coords="525,1549,706,1590"/>
<area shape="rect" title=" " alt="" coords="529,1671,701,1697"/>
<area shape="rect" title=" " alt="" coords="560,1760,671,1787"/>
<area shape="rect" title=" " alt="" coords="511,1884,720,1911"/>
<area shape="rect" title=" " alt="" coords="525,1935,706,1977"/>
<area shape="rect" title=" " alt="" coords="531,2001,700,2042"/>
<area shape="rect" title=" " alt="" coords="533,2066,698,2107"/>
<area shape="rect" title=" " alt="" coords="523,2131,708,2202"/>
<area shape="rect" title=" " alt="" coords="517,2297,714,2338"/>
<area shape="rect" title=" " alt="" coords="523,2363,708,2389"/>
<area shape="rect" title=" " alt="" coords="531,2414,700,2455"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a172ef44112e79149fd4b321e8c1ab357"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a172ef44112e79149fd4b321e8c1ab357">ROMSX</a> ()</td></tr>
<tr class="separator:a172ef44112e79149fd4b321e8c1ab357"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fba793897d4512a556f2a7da8da3de0"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a9fba793897d4512a556f2a7da8da3de0">~ROMSX</a> ()</td></tr>
<tr class="separator:a9fba793897d4512a556f2a7da8da3de0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2491883c8e50f6734a2c474d65817824"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a2491883c8e50f6734a2c474d65817824">Evolve</a> ()</td></tr>
<tr class="separator:a2491883c8e50f6734a2c474d65817824"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3d2c692cc496f5f7a57b46f0c9e2f12"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ac3d2c692cc496f5f7a57b46f0c9e2f12">ErrorEst</a> (int lev, amrex::TagBoxArray &amp;tags, amrex::Real time, int ngrow) override</td></tr>
<tr class="separator:ac3d2c692cc496f5f7a57b46f0c9e2f12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93658365b6d73248b584d7952b75a899"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a93658365b6d73248b584d7952b75a899">InitData</a> ()</td></tr>
<tr class="separator:a93658365b6d73248b584d7952b75a899"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae7ba5940968ecd9397fa506a7082933"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#aae7ba5940968ecd9397fa506a7082933">init_only</a> (int lev, amrex::Real time)</td></tr>
<tr class="separator:aae7ba5940968ecd9397fa506a7082933"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e841cff9ccca5ed1945876def44c681"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a9e841cff9ccca5ed1945876def44c681">restart</a> ()</td></tr>
<tr class="separator:a9e841cff9ccca5ed1945876def44c681"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae2265fdbf5360bf2409b673135281a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#aae2265fdbf5360bf2409b673135281a7">post_timestep</a> (int nstep, amrex::Real time, amrex::Real dt_lev)</td></tr>
<tr class="separator:aae2265fdbf5360bf2409b673135281a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55bb606cb2f4fc86e05232b5c314a829"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a55bb606cb2f4fc86e05232b5c314a829">sum_integrated_quantities</a> (amrex::Real time)</td></tr>
<tr class="separator:a55bb606cb2f4fc86e05232b5c314a829"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65203858561c0499791ef95ef51f3447"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a65203858561c0499791ef95ef51f3447">volWgtSumMF</a> (int lev, const amrex::MultiFab &amp;mf, int comp, bool local, bool finemask)</td></tr>
<tr class="separator:a65203858561c0499791ef95ef51f3447"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11fae6ec83db5a377afd32858e0a80a1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a11fae6ec83db5a377afd32858e0a80a1">is_it_time_for_action</a> (int nstep, amrex::Real time, amrex::Real <a class="el" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>, int action_interval, amrex::Real action_per)</td></tr>
<tr class="separator:a11fae6ec83db5a377afd32858e0a80a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f756bf6c9c2c09f1d9f1d9ba0bf387e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a8f756bf6c9c2c09f1d9f1d9ba0bf387e">MakeNewLevelFromCoarse</a> (int lev, amrex::Real time, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm) override</td></tr>
<tr class="separator:a8f756bf6c9c2c09f1d9f1d9ba0bf387e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a366c20991d6dd6d7057ff0a593c8c11f"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a366c20991d6dd6d7057ff0a593c8c11f">RemakeLevel</a> (int lev, amrex::Real time, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm) override</td></tr>
<tr class="separator:a366c20991d6dd6d7057ff0a593c8c11f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57d541b3753f65c8359d606869b31a25"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a57d541b3753f65c8359d606869b31a25">ClearLevel</a> (int lev) override</td></tr>
<tr class="separator:a57d541b3753f65c8359d606869b31a25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9e8dc15f5a291fb654b1ef1bdc47974"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ac9e8dc15f5a291fb654b1ef1bdc47974">MakeNewLevelFromScratch</a> (int lev, amrex::Real time, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm) override</td></tr>
<tr class="separator:ac9e8dc15f5a291fb654b1ef1bdc47974"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf5a8c8dcd7e6c993fea4acf2845e3d0"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#aaf5a8c8dcd7e6c993fea4acf2845e3d0">estTimeStep</a> (int lev) const</td></tr>
<tr class="separator:aaf5a8c8dcd7e6c993fea4acf2845e3d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad462a3ade367c29008f7e42e4063410e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ad462a3ade367c29008f7e42e4063410e">romsx_advance</a> (int level, amrex::MultiFab &amp;<a class="el" href="classROMSX.html#a7a14aa971cac1b1ad0eb5d4b46b90343">cons_old</a>, amrex::MultiFab &amp;<a class="el" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>, amrex::MultiFab &amp;<a class="el" href="classROMSX.html#af0b5074dc426b753beb5511bd63df407">xvel_old</a>, amrex::MultiFab &amp;<a class="el" href="classROMSX.html#a87f0b7446438b8145bdea79012b985f5">yvel_old</a>, amrex::MultiFab &amp;<a class="el" href="classROMSX.html#acb72d33af4be09dede2005fa6c901686">zvel_old</a>, amrex::MultiFab &amp;<a class="el" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>, amrex::MultiFab &amp;<a class="el" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>, amrex::MultiFab &amp;<a class="el" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>, amrex::MultiFab &amp;source, const amrex::Geometry fine_geom, const amrex::Real <a class="el" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>, const amrex::Real time)</td></tr>
<tr class="separator:ad462a3ade367c29008f7e42e4063410e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c60bb81e7afd74c2a73020e3096bd32"><td class="memItemLeft" align="right" valign="top">amrex::MultiFab &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a6c60bb81e7afd74c2a73020e3096bd32">build_fine_mask</a> (int lev)</td></tr>
<tr class="separator:a6c60bb81e7afd74c2a73020e3096bd32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0049697ad0398380ac5a058705fece48"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a0049697ad0398380ac5a058705fece48">WritePlotFile</a> (int which, amrex::Vector&lt; std::string &gt; plot_var_names)</td></tr>
<tr class="separator:a0049697ad0398380ac5a058705fece48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d697ec8b659282c8b02f559b3eabe34"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a5d697ec8b659282c8b02f559b3eabe34">WriteMultiLevelPlotfileWithBathymetry</a> (const std::string &amp;plotfilename, int nlevels, const amrex::Vector&lt; const amrex::MultiFab * &gt; &amp;mf, const amrex::Vector&lt; const amrex::MultiFab * &gt; &amp;mf_nd, const amrex::Vector&lt; std::string &gt; &amp;varnames, amrex::Real time, const amrex::Vector&lt; int &gt; &amp;level_steps, const std::string &amp;versionName=&quot;HyperCLaw-V1.1&quot;, const std::string &amp;levelPrefix=&quot;Level_&quot;, const std::string &amp;mfPrefix=&quot;Cell&quot;, const amrex::Vector&lt; std::string &gt; &amp;extra_dirs=amrex::Vector&lt; std::string &gt;()) const</td></tr>
<tr class="separator:a5d697ec8b659282c8b02f559b3eabe34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63d0268875b00ab11fad450c2f5a5dfd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a63d0268875b00ab11fad450c2f5a5dfd">WriteGenericPlotfileHeaderWithBathymetry</a> (std::ostream &amp;HeaderFile, int nlevels, const amrex::Vector&lt; amrex::BoxArray &gt; &amp;bArray, const amrex::Vector&lt; std::string &gt; &amp;varnames, amrex::Real time, const amrex::Vector&lt; int &gt; &amp;level_steps, const std::string &amp;versionName, const std::string &amp;levelPrefix, const std::string &amp;mfPrefix) const</td></tr>
<tr class="separator:a63d0268875b00ab11fad450c2f5a5dfd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d120bfdaf2972b92fda49a4c1bbc43d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a5d120bfdaf2972b92fda49a4c1bbc43d">Advance</a> (int lev, amrex::Real time, amrex::Real dt_lev, int iteration, int ncycle)</td></tr>
<tr class="separator:a5d120bfdaf2972b92fda49a4c1bbc43d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62d0fa7d294be023f9050f71bb0ad221"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a62d0fa7d294be023f9050f71bb0ad221">setup_step</a> (int lev, amrex::Real time, amrex::Real dt_lev)</td></tr>
<tr class="separator:a62d0fa7d294be023f9050f71bb0ad221"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77f393227b048d127b50340ea256a9cf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a77f393227b048d127b50340ea256a9cf">advance_3d_ml</a> (int lev, amrex::Real dt_lev)</td></tr>
<tr class="separator:a77f393227b048d127b50340ea256a9cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fa9ebf787a2bcd053f235b50e5dbac3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a8fa9ebf787a2bcd053f235b50e5dbac3">advance_2d_onestep</a> (int lev, amrex::Real dt_lev, amrex::Real dtfast_lev, int my_iif, int nfast_counter)</td></tr>
<tr class="separator:a8fa9ebf787a2bcd053f235b50e5dbac3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00ce68e5a1dd4a3db8e47bc28f4f9c73"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a00ce68e5a1dd4a3db8e47bc28f4f9c73">advance_2d</a> (int lev, amrex::MultiFab const *mf_rhoS, amrex::MultiFab const *mf_rhoA, amrex::MultiFab *mf_ru, amrex::MultiFab *mf_rv, amrex::MultiFab *mf_rufrc, amrex::MultiFab *mf_rvfrc, amrex::MultiFab *mf_Zt_avg1, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DU_avg1, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DU_avg2, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DV_avg1, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DV_avg2, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_rubar, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_rvbar, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_rzeta, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_ubar, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_vbar, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_zeta, amrex::MultiFab const *mf_h, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_visc2_p, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_visc2_r, const amrex::Real dtfast_lev, const bool predictor_2d_step, const bool first_2d_step, int my_iif, int &amp;next_indx1)</td></tr>
<tr class="separator:a00ce68e5a1dd4a3db8e47bc28f4f9c73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e9c23866425937fcf943fc31dbf0884"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a4e9c23866425937fcf943fc31dbf0884">advance_3d</a> (int lev, amrex::MultiFab &amp;mf_cons, amrex::MultiFab &amp;mf_u, amrex::MultiFab &amp;mf_v, amrex::MultiFab *mf_sstore, amrex::MultiFab *mf_ru, amrex::MultiFab *mf_rv, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DU_avg1, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DU_avg2, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DV_avg1, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DV_avg2, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_ubar, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_vbar, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_Akv, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_Akt, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_Hz, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_Huon, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_Hvom, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_z_w, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_h, const int N, const amrex::Real dt_lev)</td></tr>
<tr class="separator:a4e9c23866425937fcf943fc31dbf0884"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67ddc86fe4c43ffe1900646deba10f1c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a67ddc86fe4c43ffe1900646deba10f1c">prestep</a> (int lev, amrex::MultiFab &amp;mf_uold, amrex::MultiFab &amp;mf_vold, amrex::MultiFab &amp;mf_u, amrex::MultiFab &amp;mf_v, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_ru, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_rv, amrex::MultiFab &amp;S_old, amrex::MultiFab &amp;S_new, amrex::MultiFab &amp;mf_W, amrex::MultiFab &amp;mf_DC, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_z_r, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_z_w, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_h, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_sustr, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_svstr, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_bustr, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_bvstr, const int iic, const int nfirst, const int nnew, int nstp, int nrhs, int N, const amrex::Real dt_lev)</td></tr>
<tr class="separator:a67ddc86fe4c43ffe1900646deba10f1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d0910d02ead7f2406ba79c5b3474e05"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a0d0910d02ead7f2406ba79c5b3474e05">prestep_t_advection</a> (const amrex::Box &amp;tbx, const amrex::Box &amp;gbx, amrex::Array4&lt; amrex::Real &gt; tempold, amrex::Array4&lt; amrex::Real &gt; tempcache, amrex::Array4&lt; amrex::Real &gt; Hz, amrex::Array4&lt; amrex::Real &gt; Huon, amrex::Array4&lt; amrex::Real &gt; Hvom, amrex::Array4&lt; amrex::Real &gt; pm, amrex::Array4&lt; amrex::Real &gt; pn, amrex::Array4&lt; amrex::Real &gt; W, amrex::Array4&lt; amrex::Real &gt; DC, amrex::Array4&lt; amrex::Real &gt; FC, amrex::Array4&lt; amrex::Real &gt; tempstore, amrex::Array4&lt; amrex::Real &gt; z_w, amrex::Array4&lt; amrex::Real &gt; h, int iic, int ntfirst, int nrhs, int N, const amrex::Real dt_lev)</td></tr>
<tr class="separator:a0d0910d02ead7f2406ba79c5b3474e05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8d98458b0900b3cd71925d37d248dde"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ac8d98458b0900b3cd71925d37d248dde">prestep_uv_3d</a> (const amrex::Box &amp;bx, const amrex::Box &amp;gbx, amrex::Array4&lt; amrex::Real &gt; uold, amrex::Array4&lt; amrex::Real &gt; vold, amrex::Array4&lt; amrex::Real &gt; u, amrex::Array4&lt; amrex::Real &gt; v, amrex::Array4&lt; amrex::Real &gt; ru, amrex::Array4&lt; amrex::Real &gt; rv, amrex::Array4&lt; amrex::Real &gt; Hz, amrex::Array4&lt; amrex::Real &gt; Akv, amrex::Array4&lt; amrex::Real &gt; pm, amrex::Array4&lt; amrex::Real &gt; pn, amrex::Array4&lt; amrex::Real &gt; W, amrex::Array4&lt; amrex::Real &gt; DC, amrex::Array4&lt; amrex::Real &gt; FC, amrex::Array4&lt; amrex::Real &gt; z_r, amrex::Array4&lt; amrex::Real &gt; sustr, amrex::Array4&lt; amrex::Real &gt; svstr, amrex::Array4&lt; amrex::Real &gt; bustr, amrex::Array4&lt; amrex::Real &gt; bvstr, int iic, int ntfirst, int nnew, int nstp, int nrhs, int N, const amrex::Real lambda, const amrex::Real dt_lev)</td></tr>
<tr class="separator:ac8d98458b0900b3cd71925d37d248dde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf9f32897499d17bad9d80230331db6a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#aaf9f32897499d17bad9d80230331db6a">rhs_t_3d</a> (const amrex::Box &amp;bx, const amrex::Box &amp;gbx, amrex::Array4&lt; amrex::Real &gt; t, amrex::Array4&lt; amrex::Real &gt; tempstore, amrex::Array4&lt; amrex::Real &gt; Huon, amrex::Array4&lt; amrex::Real &gt; Hvom, amrex::Array4&lt; amrex::Real &gt; Hz, amrex::Array4&lt; amrex::Real &gt; oHz, amrex::Array4&lt; amrex::Real &gt; pn, amrex::Array4&lt; amrex::Real &gt; pm, amrex::Array4&lt; amrex::Real &gt; W, amrex::Array4&lt; amrex::Real &gt; FC, int nrhs, int nnew, int N, const amrex::Real dt_lev)</td></tr>
<tr class="separator:aaf9f32897499d17bad9d80230331db6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed11841ea026316e25162880b8c455c9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#aed11841ea026316e25162880b8c455c9">rhs_uv_3d</a> (const amrex::Box &amp;xbx, const amrex::Box &amp;ybx, amrex::Array4&lt; amrex::Real &gt; uold, amrex::Array4&lt; amrex::Real &gt; vold, amrex::Array4&lt; amrex::Real &gt; ru, amrex::Array4&lt; amrex::Real &gt; rv, amrex::Array4&lt; amrex::Real &gt; rufrc, amrex::Array4&lt; amrex::Real &gt; rvfrc, amrex::Array4&lt; amrex::Real &gt; sustr, amrex::Array4&lt; amrex::Real &gt; svstr, amrex::Array4&lt; amrex::Real &gt; bustr, amrex::Array4&lt; amrex::Real &gt; bvstr, amrex::Array4&lt; amrex::Real &gt; Huon, amrex::Array4&lt; amrex::Real &gt; Hvom, amrex::Array4&lt; amrex::Real &gt; on_u, amrex::Array4&lt; amrex::Real &gt; om_v, amrex::Array4&lt; amrex::Real &gt; om_u, amrex::Array4&lt; amrex::Real &gt; on_v, amrex::Array4&lt; amrex::Real &gt; W, amrex::Array4&lt; amrex::Real &gt; FC, int nrhs, int N)</td></tr>
<tr class="separator:aed11841ea026316e25162880b8c455c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c78b061e07c56adac2e9732485480fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a1c78b061e07c56adac2e9732485480fc">rhs_uv_2d</a> (const amrex::Box &amp;xbx, const amrex::Box &amp;ybx, amrex::Array4&lt; amrex::Real &gt; uold, amrex::Array4&lt; amrex::Real &gt; vold, amrex::Array4&lt; amrex::Real &gt; ru, amrex::Array4&lt; amrex::Real &gt; rv, amrex::Array4&lt; amrex::Real &gt; Huon, amrex::Array4&lt; amrex::Real &gt; Hvom, int nrhs)</td></tr>
<tr class="separator:a1c78b061e07c56adac2e9732485480fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa21a56eb75e6c5565402a56d818c179e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#aa21a56eb75e6c5565402a56d818c179e">rho_eos</a> (const amrex::Box &amp;bx, amrex::Array4&lt; amrex::Real const &gt; state, amrex::Array4&lt; amrex::Real &gt; rho, amrex::Array4&lt; amrex::Real &gt; rhoA, amrex::Array4&lt; amrex::Real &gt; rhoS, amrex::Array4&lt; amrex::Real const &gt; Hz, amrex::Array4&lt; amrex::Real const &gt; z_w, amrex::Array4&lt; amrex::Real const &gt; h, const int N)</td></tr>
<tr class="separator:aa21a56eb75e6c5565402a56d818c179e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afae25c40f01d9ba6b5bca880660756e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#afae25c40f01d9ba6b5bca880660756e3">prsgrd</a> (const amrex::Box &amp;bx, const amrex::Box &amp;gbx, const amrex::Box &amp;utbx, const amrex::Box &amp;vtbx, amrex::Array4&lt; amrex::Real &gt; ru, amrex::Array4&lt; amrex::Real &gt; rv, amrex::Array4&lt; amrex::Real &gt; on_u, amrex::Array4&lt; amrex::Real &gt; om_v, amrex::Array4&lt; amrex::Real &gt; rho, amrex::Array4&lt; amrex::Real &gt; FC, amrex::Array4&lt; amrex::Real &gt; Hz, amrex::Array4&lt; amrex::Real &gt; z_r, amrex::Array4&lt; amrex::Real &gt; z_w, const int nrhs, const int N)</td></tr>
<tr class="separator:afae25c40f01d9ba6b5bca880660756e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5357850164cf2ac2a2ba5eff1fb2b011"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a5357850164cf2ac2a2ba5eff1fb2b011">prestep_diffusion</a> (const amrex::Box &amp;bx, const amrex::Box &amp;gbx, const int ioff, const int joff, amrex::Array4&lt; amrex::Real &gt; vel, amrex::Array4&lt; amrex::Real &gt; vel_old, amrex::Array4&lt; amrex::Real &gt; rvel, amrex::Array4&lt; amrex::Real &gt; Hz, amrex::Array4&lt; amrex::Real &gt; Akv, amrex::Array4&lt; amrex::Real &gt; pm, amrex::Array4&lt; amrex::Real &gt; pn, amrex::Array4&lt; amrex::Real &gt; DC, amrex::Array4&lt; amrex::Real &gt; FC, amrex::Array4&lt; amrex::Real &gt; sstr, amrex::Array4&lt; amrex::Real &gt; bstr, amrex::Array4&lt; amrex::Real &gt; z_r, const int iic, const int ntfirst, const int nnew, int nstp, int nrhs, int N, const amrex::Real lambda, const amrex::Real dt_lev)</td></tr>
<tr class="separator:a5357850164cf2ac2a2ba5eff1fb2b011"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a506eb0db4a850e63f4479269a97b38"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a3a506eb0db4a850e63f4479269a97b38">vert_visc_3d</a> (const amrex::Box &amp;bx, const int ioff, const int joff, amrex::Array4&lt; amrex::Real &gt; phi, amrex::Array4&lt; amrex::Real const &gt; Hz, amrex::Array4&lt; amrex::Real &gt; Hzk, amrex::Array4&lt; amrex::Real &gt; oHz, amrex::Array4&lt; amrex::Real &gt; AK, amrex::Array4&lt; amrex::Real &gt; Akv, amrex::Array4&lt; amrex::Real &gt; BC, amrex::Array4&lt; amrex::Real &gt; DC, amrex::Array4&lt; amrex::Real &gt; FC, amrex::Array4&lt; amrex::Real &gt; CF, const int nnew, const int N, const amrex::Real dt_lev)</td></tr>
<tr class="separator:a3a506eb0db4a850e63f4479269a97b38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58c4b17d8ae67640e6248d93d3317581"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a58c4b17d8ae67640e6248d93d3317581">set_massflux_3d</a> (amrex::Array4&lt; amrex::Real &gt; u, amrex::Array4&lt; amrex::Real &gt; Hu, amrex::Array4&lt; amrex::Real &gt; on_u, amrex::Array4&lt; amrex::Real &gt; v, amrex::Array4&lt; amrex::Real &gt; Hv, amrex::Array4&lt; amrex::Real &gt; om_v, amrex::Array4&lt; amrex::Real const &gt; Hz)</td></tr>
<tr class="separator:a58c4b17d8ae67640e6248d93d3317581"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a799fe579a21d193e4f1e1a6a1fc74cd9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a799fe579a21d193e4f1e1a6a1fc74cd9">update_massflux_3d</a> (const amrex::Box &amp;bx, const int ioff, const int joff, amrex::Array4&lt; amrex::Real &gt; phi, amrex::Array4&lt; amrex::Real &gt; phibar, amrex::Array4&lt; amrex::Real &gt; Hphi, amrex::Array4&lt; amrex::Real const &gt; Hz, amrex::Array4&lt; amrex::Real &gt; on_u_or_om_v, amrex::Array4&lt; amrex::Real const &gt; Dphi1, amrex::Array4&lt; amrex::Real const &gt; Dphi2, amrex::Array4&lt; amrex::Real &gt; DC, amrex::Array4&lt; amrex::Real &gt; FC, const int nnew)</td></tr>
<tr class="separator:a799fe579a21d193e4f1e1a6a1fc74cd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3bb9347625aef307add2c82a9b21d10"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ad3bb9347625aef307add2c82a9b21d10">vert_mean_3d</a> (const amrex::Box &amp;bx, const int ioff, const int joff, amrex::Array4&lt; amrex::Real &gt; phi, amrex::Array4&lt; amrex::Real const &gt; Hz, amrex::Array4&lt; amrex::Real const &gt; Dphi_avg1, amrex::Array4&lt; amrex::Real &gt; DC, amrex::Array4&lt; amrex::Real &gt; CF, amrex::Array4&lt; amrex::Real &gt; dxlen, const int nnew, const int N)</td></tr>
<tr class="separator:ad3bb9347625aef307add2c82a9b21d10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace94faecb215ee9b4fdbc03e0cdaabdb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ace94faecb215ee9b4fdbc03e0cdaabdb">uv3dmix</a> (const amrex::Box &amp;xbx, const amrex::Box &amp;ybx, amrex::Array4&lt; amrex::Real &gt; u, amrex::Array4&lt; amrex::Real &gt; v, amrex::Array4&lt; amrex::Real &gt; uold, amrex::Array4&lt; amrex::Real &gt; vold, amrex::Array4&lt; amrex::Real &gt; rufrc, amrex::Array4&lt; amrex::Real &gt; rvfrc, amrex::Array4&lt; amrex::Real &gt; visc2_p, amrex::Array4&lt; amrex::Real &gt; visc2_r, amrex::Array4&lt; amrex::Real &gt; Hz, amrex::Array4&lt; amrex::Real &gt; om_r, amrex::Array4&lt; amrex::Real &gt; on_r, amrex::Array4&lt; amrex::Real &gt; om_p, amrex::Array4&lt; amrex::Real &gt; on_p, amrex::Array4&lt; amrex::Real &gt; pm, amrex::Array4&lt; amrex::Real &gt; pn, int nrhs, int nnew, const amrex::Real dt_lev)</td></tr>
<tr class="separator:ace94faecb215ee9b4fdbc03e0cdaabdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af208e1fa3f6e5250df093a4d6ad34e77"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#af208e1fa3f6e5250df093a4d6ad34e77">t3dmix</a> (const amrex::Box &amp;bx, amrex::Array4&lt; amrex::Real &gt; state, amrex::Array4&lt; amrex::Real &gt; diff2, amrex::Array4&lt; amrex::Real &gt; Hz, amrex::Array4&lt; amrex::Real &gt; pm, amrex::Array4&lt; amrex::Real &gt; pn, amrex::Array4&lt; amrex::Real &gt; pmon_u, amrex::Array4&lt; amrex::Real &gt; pnom_v, const amrex::Real dt_lev, const int ncomp)</td></tr>
<tr class="separator:af208e1fa3f6e5250df093a4d6ad34e77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa92192721003020501bef87d5f4a667"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#afa92192721003020501bef87d5f4a667">coriolis</a> (const amrex::Box &amp;xbx, const amrex::Box &amp;ybx, amrex::Array4&lt; amrex::Real &gt; uold, amrex::Array4&lt; amrex::Real &gt; vold, amrex::Array4&lt; amrex::Real &gt; ru, amrex::Array4&lt; amrex::Real &gt; rv, amrex::Array4&lt; amrex::Real &gt; Hz, amrex::Array4&lt; amrex::Real &gt; fomn, int nrhs, int nr)</td></tr>
<tr class="separator:afa92192721003020501bef87d5f4a667"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd0ef9b9a56b5f6985a0903895d81e46"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#abd0ef9b9a56b5f6985a0903895d81e46">set_2darrays</a> (int lev)</td></tr>
<tr class="separator:abd0ef9b9a56b5f6985a0903895d81e46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab93d802ac3111e738dafe04367813135"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ab93d802ac3111e738dafe04367813135">set_bathymetry</a> (int lev)</td></tr>
<tr class="separator:ab93d802ac3111e738dafe04367813135"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad35c03f38c28e55791b50da18f2604c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#aad35c03f38c28e55791b50da18f2604c">stretch_transform</a> (int lev)</td></tr>
<tr class="separator:aad35c03f38c28e55791b50da18f2604c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48b99337b5ac313ce48a95ab0b9e73dc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a48b99337b5ac313ce48a95ab0b9e73dc">set_vmix</a> (int lev)</td></tr>
<tr class="separator:a48b99337b5ac313ce48a95ab0b9e73dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7137f5e39d218263180f04072cb93b73"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a7137f5e39d218263180f04072cb93b73">set_smflux</a> (int lev, amrex::Real time)</td></tr>
<tr class="separator:a7137f5e39d218263180f04072cb93b73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dd9fc911df600f1eb0e8f3c131d8353"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a5dd9fc911df600f1eb0e8f3c131d8353">set_hmixcoef</a> (int lev)</td></tr>
<tr class="separator:a5dd9fc911df600f1eb0e8f3c131d8353"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbc1fc6bd3f6ededfed2346989ccf055"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#afbc1fc6bd3f6ededfed2346989ccf055">set_drag</a> (int lev)</td></tr>
<tr class="separator:afbc1fc6bd3f6ededfed2346989ccf055"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ca3a726e1b0ecfc4339b2a07ade77b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a3ca3a726e1b0ecfc4339b2a07ade77b7">set_weights</a> (int lev)</td></tr>
<tr class="separator:a3ca3a726e1b0ecfc4339b2a07ade77b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb9e3a06ecbafa6f4860576cc80db30c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a> (int lev, amrex::Real time, amrex::MultiFab &amp;mf_to_be_filled, amrex::Vector&lt; amrex::MultiFab * &gt; const &amp;mfs)</td></tr>
<tr class="separator:abb9e3a06ecbafa6f4860576cc80db30c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae886b3856fed4fa4d820c5dda7effb7c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ae886b3856fed4fa4d820c5dda7effb7c">writeJobInfo</a> (const std::string &amp;dir) const</td></tr>
<tr class="separator:ae886b3856fed4fa4d820c5dda7effb7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a08b14a766ed31e1f6a9ccec0c7f64618"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a08b14a766ed31e1f6a9ccec0c7f64618">writeBuildInfo</a> (std::ostream &amp;os)</td></tr>
<tr class="separator:a08b14a766ed31e1f6a9ccec0c7f64618"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:afda0f54b3ad1ed8dbb39bbef8ed48c92"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#afda0f54b3ad1ed8dbb39bbef8ed48c92">pp_prefix</a> {&quot;romsx&quot;}</td></tr>
<tr class="separator:afda0f54b3ad1ed8dbb39bbef8ed48c92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a14aa971cac1b1ad0eb5d4b46b90343"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a7a14aa971cac1b1ad0eb5d4b46b90343">cons_old</a></td></tr>
<tr class="separator:a7a14aa971cac1b1ad0eb5d4b46b90343"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0b5074dc426b753beb5511bd63df407"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#af0b5074dc426b753beb5511bd63df407">xvel_old</a></td></tr>
<tr class="separator:af0b5074dc426b753beb5511bd63df407"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87f0b7446438b8145bdea79012b985f5"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a87f0b7446438b8145bdea79012b985f5">yvel_old</a></td></tr>
<tr class="separator:a87f0b7446438b8145bdea79012b985f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb72d33af4be09dede2005fa6c901686"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#acb72d33af4be09dede2005fa6c901686">zvel_old</a></td></tr>
<tr class="separator:acb72d33af4be09dede2005fa6c901686"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f7c60f6b48935de00903f101ffcf412"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a></td></tr>
<tr class="separator:a7f7c60f6b48935de00903f101ffcf412"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d8d8b238ca3a5ebf4346e4110c82af2"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a></td></tr>
<tr class="separator:a2d8d8b238ca3a5ebf4346e4110c82af2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa67ecec73cc05ad8c7af8578faa77b48"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a></td></tr>
<tr class="separator:aa67ecec73cc05ad8c7af8578faa77b48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4db3a202bf1aa714f1c5a2e9d6174e4"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a></td></tr>
<tr class="separator:af4db3a202bf1aa714f1c5a2e9d6174e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03b79a651abf3dc2bd37fadaca99fd46"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a03b79a651abf3dc2bd37fadaca99fd46">vec_hOfTheConfusingName</a></td></tr>
<tr class="separator:a03b79a651abf3dc2bd37fadaca99fd46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5461758b528d199101b5ea74f9a6c12"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#aa5461758b528d199101b5ea74f9a6c12">vec_Hz</a></td></tr>
<tr class="separator:aa5461758b528d199101b5ea74f9a6c12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24f02b944df51884168ab0c08c736c91"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a24f02b944df51884168ab0c08c736c91">vec_Huon</a></td></tr>
<tr class="separator:a24f02b944df51884168ab0c08c736c91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21dcccced847102e553281c1852ce005"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a21dcccced847102e553281c1852ce005">vec_Hvom</a></td></tr>
<tr class="separator:a21dcccced847102e553281c1852ce005"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1343869d59f89fd4773bc7fa230aa73"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ab1343869d59f89fd4773bc7fa230aa73">vec_ru</a></td></tr>
<tr class="separator:ab1343869d59f89fd4773bc7fa230aa73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5041f0f370ab1ec4f7f7e16127c9039"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ab5041f0f370ab1ec4f7f7e16127c9039">vec_rv</a></td></tr>
<tr class="separator:ab5041f0f370ab1ec4f7f7e16127c9039"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5b7ff78a167e59ae727b22094b39079"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ab5b7ff78a167e59ae727b22094b39079">vec_rufrc</a></td></tr>
<tr class="separator:ab5b7ff78a167e59ae727b22094b39079"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52a5f265a370595f128046c31b9f31d5"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a52a5f265a370595f128046c31b9f31d5">vec_rvfrc</a></td></tr>
<tr class="separator:a52a5f265a370595f128046c31b9f31d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec2c137ce4314357035cbc7ae292338f"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#aec2c137ce4314357035cbc7ae292338f">vec_Akv</a></td></tr>
<tr class="separator:aec2c137ce4314357035cbc7ae292338f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63d077c5232d18aa0c31f1824b63b5ca"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a63d077c5232d18aa0c31f1824b63b5ca">vec_Akt</a></td></tr>
<tr class="separator:a63d077c5232d18aa0c31f1824b63b5ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af83a943f37cd6bbaf25c52fcaceb0930"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#af83a943f37cd6bbaf25c52fcaceb0930">vec_visc2_p</a></td></tr>
<tr class="separator:af83a943f37cd6bbaf25c52fcaceb0930"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8fff925fc76e919ddc53de08b3725e9"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#aa8fff925fc76e919ddc53de08b3725e9">vec_visc2_r</a></td></tr>
<tr class="separator:aa8fff925fc76e919ddc53de08b3725e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f47ec18ca3f2465e3253f92ca493bbc"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a2f47ec18ca3f2465e3253f92ca493bbc">vec_diff2</a></td></tr>
<tr class="separator:a2f47ec18ca3f2465e3253f92ca493bbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2de6e4298de90faa955d8073a65f7cd9"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a2de6e4298de90faa955d8073a65f7cd9">vec_x_r</a></td></tr>
<tr class="separator:a2de6e4298de90faa955d8073a65f7cd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a453443ec491d496adbd2cf5ac292d8"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a9a453443ec491d496adbd2cf5ac292d8">vec_y_r</a></td></tr>
<tr class="separator:a9a453443ec491d496adbd2cf5ac292d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a9b1a5cf021018defc82b45cbecb2c5"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a0a9b1a5cf021018defc82b45cbecb2c5">vec_z_r</a></td></tr>
<tr class="separator:a0a9b1a5cf021018defc82b45cbecb2c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e2a55ae7fb02290e6ead16ec3e658fa"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a7e2a55ae7fb02290e6ead16ec3e658fa">vec_z_w</a></td></tr>
<tr class="separator:a7e2a55ae7fb02290e6ead16ec3e658fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a3b7fb166ec3acf1b1057f53e08adad"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a7a3b7fb166ec3acf1b1057f53e08adad">vec_s_r</a></td></tr>
<tr class="separator:a7a3b7fb166ec3acf1b1057f53e08adad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e887c13b3d23581a26580f4e7e9aef0"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a8e887c13b3d23581a26580f4e7e9aef0">vec_z_phys_nd</a></td></tr>
<tr class="separator:a8e887c13b3d23581a26580f4e7e9aef0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab962f23dc27b3ce17bb19e3b8c9991f8"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ab962f23dc27b3ce17bb19e3b8c9991f8">vec_Zt_avg1</a></td></tr>
<tr class="separator:ab962f23dc27b3ce17bb19e3b8c9991f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2082155131b8b7e0dec29068a92cece2"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a2082155131b8b7e0dec29068a92cece2">vec_sustr</a></td></tr>
<tr class="separator:a2082155131b8b7e0dec29068a92cece2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44a44e4d82bc38d55daa03f281437113"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a44a44e4d82bc38d55daa03f281437113">vec_svstr</a></td></tr>
<tr class="separator:a44a44e4d82bc38d55daa03f281437113"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac49463f0fb789402ba8641f289906456"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ac49463f0fb789402ba8641f289906456">vec_rdrag</a></td></tr>
<tr class="separator:ac49463f0fb789402ba8641f289906456"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a607e27d43f6eaebcf557c4ae17b8039a"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a607e27d43f6eaebcf557c4ae17b8039a">vec_bustr</a></td></tr>
<tr class="separator:a607e27d43f6eaebcf557c4ae17b8039a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a981dafaf65d2d8d96f16e1e7467eb2"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a5a981dafaf65d2d8d96f16e1e7467eb2">vec_bvstr</a></td></tr>
<tr class="separator:a5a981dafaf65d2d8d96f16e1e7467eb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18212e9657c0655cd29e0c6241c1224f"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a18212e9657c0655cd29e0c6241c1224f">vec_DU_avg1</a></td></tr>
<tr class="separator:a18212e9657c0655cd29e0c6241c1224f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a883756f67229729f133b9bdf784c21ff"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a883756f67229729f133b9bdf784c21ff">vec_DU_avg2</a></td></tr>
<tr class="separator:a883756f67229729f133b9bdf784c21ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9738d90727df4f8aba2afb0ffed1e8f"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#aa9738d90727df4f8aba2afb0ffed1e8f">vec_DV_avg1</a></td></tr>
<tr class="separator:aa9738d90727df4f8aba2afb0ffed1e8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6847259dab9f6118da780bf623a9868a"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a6847259dab9f6118da780bf623a9868a">vec_DV_avg2</a></td></tr>
<tr class="separator:a6847259dab9f6118da780bf623a9868a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5d263be53bfdd397f6c64672ee77009"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ab5d263be53bfdd397f6c64672ee77009">vec_rubar</a></td></tr>
<tr class="separator:ab5d263be53bfdd397f6c64672ee77009"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83d781ead821f8ed29f6f2b9ef70a9aa"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a83d781ead821f8ed29f6f2b9ef70a9aa">vec_rvbar</a></td></tr>
<tr class="separator:a83d781ead821f8ed29f6f2b9ef70a9aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2324a5a8d5949f83ac7621ef79f8fdd"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ac2324a5a8d5949f83ac7621ef79f8fdd">vec_rzeta</a></td></tr>
<tr class="separator:ac2324a5a8d5949f83ac7621ef79f8fdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a047f6faef02a00ced0a6c1766e4c9b5a"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a047f6faef02a00ced0a6c1766e4c9b5a">vec_ubar</a></td></tr>
<tr class="separator:a047f6faef02a00ced0a6c1766e4c9b5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a375f2e83347418b7cf5d4bd812ee55"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a2a375f2e83347418b7cf5d4bd812ee55">vec_vbar</a></td></tr>
<tr class="separator:a2a375f2e83347418b7cf5d4bd812ee55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab026fffd3c4e9a9ef612cbb23132a1f5"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ab026fffd3c4e9a9ef612cbb23132a1f5">vec_zeta</a></td></tr>
<tr class="separator:ab026fffd3c4e9a9ef612cbb23132a1f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d747b62e29b6c979763cd243e61a866"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a3d747b62e29b6c979763cd243e61a866">vec_sstore</a></td></tr>
<tr class="separator:a3d747b62e29b6c979763cd243e61a866"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a640f040827d96f0b2085a385f0faaa3b"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a640f040827d96f0b2085a385f0faaa3b">vec_visc3d_r</a></td></tr>
<tr class="separator:a640f040827d96f0b2085a385f0faaa3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20d43f4b49b92542c1790c1ea01ca19c"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a20d43f4b49b92542c1790c1ea01ca19c">vec_rhoS</a></td></tr>
<tr class="separator:a20d43f4b49b92542c1790c1ea01ca19c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0978a71210c5f05a5541002532bd9cd2"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a0978a71210c5f05a5541002532bd9cd2">vec_rhoA</a></td></tr>
<tr class="separator:a0978a71210c5f05a5541002532bd9cd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55d028f9a1e55a035ab877607ac326fe"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a55d028f9a1e55a035ab877607ac326fe">vec_weight1</a></td></tr>
<tr class="separator:a55d028f9a1e55a035ab877607ac326fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1781a7c54d695e8889f2d394062b85a7"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a1781a7c54d695e8889f2d394062b85a7">vec_weight2</a></td></tr>
<tr class="separator:a1781a7c54d695e8889f2d394062b85a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ae3543d5a8078423ea4ac399ee53a67b9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ae3543d5a8078423ea4ac399ee53a67b9">ReadParameters</a> ()</td></tr>
<tr class="separator:ae3543d5a8078423ea4ac399ee53a67b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a73ffdd93eed4bef7f0d3c6bdac0e6e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a5a73ffdd93eed4bef7f0d3c6bdac0e6e">AverageDown</a> ()</td></tr>
<tr class="separator:a5a73ffdd93eed4bef7f0d3c6bdac0e6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2036cccb3cbb45cb3c57d6d26f4168c7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a2036cccb3cbb45cb3c57d6d26f4168c7">init1DArrays</a> ()</td></tr>
<tr class="separator:a2036cccb3cbb45cb3c57d6d26f4168c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abba6cffe4a459932b33465a0d126d4d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#abba6cffe4a459932b33465a0d126d4d8">init_bcs</a> ()</td></tr>
<tr class="separator:abba6cffe4a459932b33465a0d126d4d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3c54ec9fe911484d73ce5ba486ccfc5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#af3c54ec9fe911484d73ce5ba486ccfc5">init_custom</a> (int lev)</td></tr>
<tr class="separator:af3c54ec9fe911484d73ce5ba486ccfc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45591c69e52ac45b762eaa78880c6229"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a45591c69e52ac45b762eaa78880c6229">init_stuff</a> (int lev, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm)</td></tr>
<tr class="separator:a45591c69e52ac45b762eaa78880c6229"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab4e25f240ebdc93f8fa58f522faf740"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#aab4e25f240ebdc93f8fa58f522faf740">resize_stuff</a> (int lev)</td></tr>
<tr class="separator:aab4e25f240ebdc93f8fa58f522faf740"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a243ea260c190601764cb8b6368d18615"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a243ea260c190601764cb8b6368d18615">AverageDownTo</a> (int crse_lev)</td></tr>
<tr class="separator:a243ea260c190601764cb8b6368d18615"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcdff09eb45a7281877f6bd97c07738f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#afcdff09eb45a7281877f6bd97c07738f">FillCoarsePatch</a> (int lev, amrex::Real time, amrex::MultiFab *mf_fine, amrex::MultiFab *mf_crse)</td></tr>
<tr class="separator:afcdff09eb45a7281877f6bd97c07738f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dc11d863a7ed83b76003eca972a8578"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structTimeInterpolatedData.html">TimeInterpolatedData</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a1dc11d863a7ed83b76003eca972a8578">GetDataAtTime</a> (int lev, amrex::Real time)</td></tr>
<tr class="separator:a1dc11d863a7ed83b76003eca972a8578"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5abd4890b0a7b5939c66c6af3d9bb6c2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a5abd4890b0a7b5939c66c6af3d9bb6c2">timeStep</a> (int lev, amrex::Real time, int iteration)</td></tr>
<tr class="separator:a5abd4890b0a7b5939c66c6af3d9bb6c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5f0052238ebf09ba49652188d59315a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#af5f0052238ebf09ba49652188d59315a">timeStepML</a> (amrex::Real time, int iteration)</td></tr>
<tr class="separator:af5f0052238ebf09ba49652188d59315a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d1af171ee1ce7a7b4ab8e3908de7f1d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a1d1af171ee1ce7a7b4ab8e3908de7f1d">initHSE</a> ()</td></tr>
<tr class="memdesc:a1d1af171ee1ce7a7b4ab8e3908de7f1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize HSE.  <a href="classROMSX.html#a1d1af171ee1ce7a7b4ab8e3908de7f1d">More...</a><br /></td></tr>
<tr class="separator:a1d1af171ee1ce7a7b4ab8e3908de7f1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e3c16fa9a25b28f842de8981ce7b00e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a2e3c16fa9a25b28f842de8981ce7b00e">initRayleigh</a> ()</td></tr>
<tr class="memdesc:a2e3c16fa9a25b28f842de8981ce7b00e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize Rayleigh damping profiles.  <a href="classROMSX.html#a2e3c16fa9a25b28f842de8981ce7b00e">More...</a><br /></td></tr>
<tr class="separator:a2e3c16fa9a25b28f842de8981ce7b00e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b84298925e299d4f57401ef3020227b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a6b84298925e299d4f57401ef3020227b">ComputeDt</a> ()</td></tr>
<tr class="separator:a6b84298925e299d4f57401ef3020227b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8b5cf6a265b5815a0441e903e9f2dcb"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#af8b5cf6a265b5815a0441e903e9f2dcb">PlotFileName</a> (int lev) const</td></tr>
<tr class="separator:af8b5cf6a265b5815a0441e903e9f2dcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae387d14721ffd15c0a57002fdbc150cc"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ae387d14721ffd15c0a57002fdbc150cc">PlotFileVarNames</a> (amrex::Vector&lt; std::string &gt; plot_var_names) const</td></tr>
<tr class="separator:ae387d14721ffd15c0a57002fdbc150cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a570a9208f8598e95442e4c5717902638"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a570a9208f8598e95442e4c5717902638">setPlotVariables</a> (const std::string &amp;pp_plot_var_names, amrex::Vector&lt; std::string &gt; &amp;plot_var_names)</td></tr>
<tr class="separator:a570a9208f8598e95442e4c5717902638"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc4b85fa57f43aa0f68f33c4edd82611"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#acc4b85fa57f43aa0f68f33c4edd82611">WriteCheckpointFile</a> () const</td></tr>
<tr class="separator:acc4b85fa57f43aa0f68f33c4edd82611"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a750d5e2613cd056f28a42a7eb950be05"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a750d5e2613cd056f28a42a7eb950be05">ReadCheckpointFile</a> ()</td></tr>
<tr class="separator:a750d5e2613cd056f28a42a7eb950be05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd827bd0a6a3e30ec9c105bc8a533a88"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#acd827bd0a6a3e30ec9c105bc8a533a88">InitializeFromFile</a> ()</td></tr>
<tr class="separator:acd827bd0a6a3e30ec9c105bc8a533a88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54b6fe8dfe7db9e4f0d5ae6af6b1156b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a54b6fe8dfe7db9e4f0d5ae6af6b1156b">InitializeLevelFromData</a> (int lev, const amrex::MultiFab &amp;initial_data)</td></tr>
<tr class="separator:a54b6fe8dfe7db9e4f0d5ae6af6b1156b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a514fa82950fa541fb1ebde3f9230eb51"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a514fa82950fa541fb1ebde3f9230eb51">post_update</a> (amrex::MultiFab &amp;state_mf, const amrex::Real time, const amrex::Geometry &amp;geom)</td></tr>
<tr class="separator:a514fa82950fa541fb1ebde3f9230eb51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa79a87e1aaab7555dbf9ce414b385bb9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#aa79a87e1aaab7555dbf9ce414b385bb9">fill_rhs</a> (amrex::MultiFab &amp;rhs_mf, const amrex::MultiFab &amp;state_mf, const amrex::Real time, const amrex::Geometry &amp;geom)</td></tr>
<tr class="separator:aa79a87e1aaab7555dbf9ce414b385bb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95cf73016433f9bc8822da57b7f3736e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a95cf73016433f9bc8822da57b7f3736e">refinement_criteria_setup</a> ()</td></tr>
<tr class="separator:a95cf73016433f9bc8822da57b7f3736e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e8f6e71ae2c366a6455882d029de926"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a4e8f6e71ae2c366a6455882d029de926">ComputeGhostCells</a> (const int &amp;spatial_order)</td></tr>
<tr class="separator:a4e8f6e71ae2c366a6455882d029de926"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b610851883faf8e10f6ac7f660e3e44"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE amrex::YAFluxRegister *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a2b610851883faf8e10f6ac7f660e3e44">getAdvFluxReg</a> (int lev)</td></tr>
<tr class="separator:a2b610851883faf8e10f6ac7f660e3e44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cc7343babd4642f2cf727a3d40035f3"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a2cc7343babd4642f2cf727a3d40035f3">DataLog</a> (int i)</td></tr>
<tr class="separator:a2cc7343babd4642f2cf727a3d40035f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf6f2e4f8b883d81702ea424d90ff4de"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#adf6f2e4f8b883d81702ea424d90ff4de">NumDataLogs</a> () noexcept</td></tr>
<tr class="separator:adf6f2e4f8b883d81702ea424d90ff4de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0103d20b9a7008fea63fa553b76726f2"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a0103d20b9a7008fea63fa553b76726f2">getCPUTime</a> () const</td></tr>
<tr class="separator:a0103d20b9a7008fea63fa553b76726f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdccbdf27483fa87a7fc769ef6aa16fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#abdccbdf27483fa87a7fc769ef6aa16fd">setRecordDataInfo</a> (int i, const std::string &amp;filename)</td></tr>
<tr class="separator:abdccbdf27483fa87a7fc769ef6aa16fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34887f38557bf5026acaf46581e05375"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a34887f38557bf5026acaf46581e05375">DataLogName</a> (int i) const noexcept</td></tr>
<tr class="memdesc:a34887f38557bf5026acaf46581e05375"><td class="mdescLeft">&#160;</td><td class="mdescRight">The filename of the ith datalog file.  <a href="classROMSX.html#a34887f38557bf5026acaf46581e05375">More...</a><br /></td></tr>
<tr class="separator:a34887f38557bf5026acaf46581e05375"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a20d2ef21f22efe90f8939f86ebc40b54"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a20d2ef21f22efe90f8939f86ebc40b54">GotoNextLine</a> (std::istream &amp;is)</td></tr>
<tr class="separator:a20d2ef21f22efe90f8939f86ebc40b54"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a2b67bb92b64c187e9869d8f8726e4e42"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a2b67bb92b64c187e9869d8f8726e4e42">num_boxes_at_level</a></td></tr>
<tr class="separator:a2b67bb92b64c187e9869d8f8726e4e42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb84a2eea3c51e9954981176e98341c3"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#adb84a2eea3c51e9954981176e98341c3">num_files_at_level</a></td></tr>
<tr class="separator:adb84a2eea3c51e9954981176e98341c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8125e3b638f29f6f08872c2cefd5335"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Box &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ab8125e3b638f29f6f08872c2cefd5335">boxes_at_level</a></td></tr>
<tr class="separator:ab8125e3b638f29f6f08872c2cefd5335"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31b7954d302e5fd9474c084078ad4784"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a></td></tr>
<tr class="separator:a31b7954d302e5fd9474c084078ad4784"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab02aa1c49bf90239a6bce4ca84da985d"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ab02aa1c49bf90239a6bce4ca84da985d">nsubsteps</a></td></tr>
<tr class="separator:ab02aa1c49bf90239a6bce4ca84da985d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac116ec30618bbd5641218e7522cdb86"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a></td></tr>
<tr class="separator:aac116ec30618bbd5641218e7522cdb86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac395453aa10633a05bb7323b2946101e"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ac395453aa10633a05bb7323b2946101e">t_old</a></td></tr>
<tr class="separator:ac395453aa10633a05bb7323b2946101e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8a469941edd719ce7c6052afc30d067"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a></td></tr>
<tr class="separator:aa8a469941edd719ce7c6052afc30d067"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11e74dcdbeb3670a3f92a614366a7b32"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; <a class="el" href="classROMSXPhysBCFunct.html">ROMSXPhysBCFunct</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a11e74dcdbeb3670a3f92a614366a7b32">physbcs</a></td></tr>
<tr class="separator:a11e74dcdbeb3670a3f92a614366a7b32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a606d7f526ef409ef78feb8ce127f98c9"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a606d7f526ef409ef78feb8ce127f98c9">mapfac_m</a></td></tr>
<tr class="separator:a606d7f526ef409ef78feb8ce127f98c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a865698971c9689455573c4b81ecaf26c"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a865698971c9689455573c4b81ecaf26c">mapfac_u</a></td></tr>
<tr class="separator:a865698971c9689455573c4b81ecaf26c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad96e947b76f50a01928821d3cd2455f7"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ad96e947b76f50a01928821d3cd2455f7">mapfac_v</a></td></tr>
<tr class="separator:ad96e947b76f50a01928821d3cd2455f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1071e0c88d861f589184ad86ff14774"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ae1071e0c88d861f589184ad86ff14774">sst</a></td></tr>
<tr class="separator:ae1071e0c88d861f589184ad86ff14774"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc5b78f8bc38863080c02301dba5377f"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::YAFluxRegister * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#afc5b78f8bc38863080c02301dba5377f">advflux_reg</a></td></tr>
<tr class="separator:afc5b78f8bc38863080c02301dba5377f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a003d617559e7196bba737b43e23f9fc4"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::BCRec &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a></td></tr>
<tr class="separator:a003d617559e7196bba737b43e23f9fc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04e9242a2702910e640d84f47a7aae3c"><td class="memItemLeft" align="right" valign="top">amrex::Gpu::DeviceVector&lt; amrex::BCRec &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a04e9242a2702910e640d84f47a7aae3c">domain_bcs_type_d</a></td></tr>
<tr class="separator:a04e9242a2702910e640d84f47a7aae3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ebadda9dbf9fbf5fd040bb1df0f18c3"><td class="memItemLeft" align="right" valign="top">amrex::Array&lt; std::string, 2 *AMREX_SPACEDIM &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a3ebadda9dbf9fbf5fd040bb1df0f18c3">domain_bc_type</a></td></tr>
<tr class="separator:a3ebadda9dbf9fbf5fd040bb1df0f18c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e9e683aa14e1ce2cd331cc56e665faa"><td class="memItemLeft" align="right" valign="top">amrex::Array&lt; amrex::Array&lt; amrex::Real, AMREX_SPACEDIM *2 &gt;, AMREX_SPACEDIM+<a class="el" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a3e9e683aa14e1ce2cd331cc56e665faa">m_bc_extdir_vals</a></td></tr>
<tr class="separator:a3e9e683aa14e1ce2cd331cc56e665faa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99fc9ef2e303a2fd0cb70225fca95acb"><td class="memItemLeft" align="right" valign="top">amrex::GpuArray&lt; <a class="el" href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281">ROMSX_BC</a>, AMREX_SPACEDIM *2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a99fc9ef2e303a2fd0cb70225fca95acb">phys_bc_type</a></td></tr>
<tr class="separator:a99fc9ef2e303a2fd0cb70225fca95acb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d94cb5986d9f35bc8becc666cfaea3d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a3d94cb5986d9f35bc8becc666cfaea3d">last_plot_file_step_1</a></td></tr>
<tr class="separator:a3d94cb5986d9f35bc8becc666cfaea3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25ecb4567ed2adbaf9be2fbae65d3640"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a25ecb4567ed2adbaf9be2fbae65d3640">last_plot_file_step_2</a></td></tr>
<tr class="separator:a25ecb4567ed2adbaf9be2fbae65d3640"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07e31a4dec6fc9e9d1ec3f1e96381c53"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a07e31a4dec6fc9e9d1ec3f1e96381c53">total_plot_file_step_1</a> = -1</td></tr>
<tr class="separator:a07e31a4dec6fc9e9d1ec3f1e96381c53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33906f6209da9e2a247b1022f60d24ac"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a33906f6209da9e2a247b1022f60d24ac">last_check_file_step</a></td></tr>
<tr class="separator:a33906f6209da9e2a247b1022f60d24ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90451fd26c3ca52a56982e35d2887214"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a90451fd26c3ca52a56982e35d2887214">plot_file_on_restart</a> = 1</td></tr>
<tr class="separator:a90451fd26c3ca52a56982e35d2887214"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad895c0936e0bd64ca71ec355e5e164b6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ad895c0936e0bd64ca71ec355e5e164b6">max_step</a> = std::numeric_limits&lt;int&gt;::max()</td></tr>
<tr class="separator:ad895c0936e0bd64ca71ec355e5e164b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22dfd39392c026bd023c8f1d57fd0889"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a22dfd39392c026bd023c8f1d57fd0889">stop_time</a> = std::numeric_limits&lt;amrex::Real&gt;::max()</td></tr>
<tr class="separator:a22dfd39392c026bd023c8f1d57fd0889"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2d89ab211dd0d324dda03720b8c4bff"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a> = &quot;&quot;</td></tr>
<tr class="separator:ae2d89ab211dd0d324dda03720b8c4bff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac248f5de275736769f83c3e6bfc6b550"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a></td></tr>
<tr class="separator:ac248f5de275736769f83c3e6bfc6b550"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a116ad0a8fa0753367f3458e5744c8e8e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a116ad0a8fa0753367f3458e5744c8e8e">do_substep</a></td></tr>
<tr class="separator:a116ad0a8fa0753367f3458e5744c8e8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab61e1364d5b301c8f727566234b9eb89"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ab61e1364d5b301c8f727566234b9eb89">regrid_int</a> = 2</td></tr>
<tr class="separator:ab61e1364d5b301c8f727566234b9eb89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05371cb6acdebe55d3aa25bebbaa65e2"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a05371cb6acdebe55d3aa25bebbaa65e2">plot_file_1</a> {&quot;plt_1_&quot;}</td></tr>
<tr class="separator:a05371cb6acdebe55d3aa25bebbaa65e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0f18c68a94b27d41e87d49662ec0ac1"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#aa0f18c68a94b27d41e87d49662ec0ac1">plot_file_2</a> {&quot;plt_2_&quot;}</td></tr>
<tr class="separator:aa0f18c68a94b27d41e87d49662ec0ac1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abaae04ebda466750a5480506239c6ca7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#abaae04ebda466750a5480506239c6ca7">plot_int_1</a> = -1</td></tr>
<tr class="separator:abaae04ebda466750a5480506239c6ca7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3cd25f16ca7432ac68b7a02a8880226"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#aa3cd25f16ca7432ac68b7a02a8880226">plot_int_2</a> = -1</td></tr>
<tr class="separator:aa3cd25f16ca7432ac68b7a02a8880226"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e6058cb21bf6f6c2b491581fa742828"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a2e6058cb21bf6f6c2b491581fa742828">check_file</a> {&quot;chk&quot;}</td></tr>
<tr class="separator:a2e6058cb21bf6f6c2b491581fa742828"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72cbded1c13914c8b88cd81ee1a95824"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a72cbded1c13914c8b88cd81ee1a95824">check_type</a> {&quot;native&quot;}</td></tr>
<tr class="separator:a72cbded1c13914c8b88cd81ee1a95824"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae866db953617cc0cc4090aeedfd3103c"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ae866db953617cc0cc4090aeedfd3103c">restart_type</a> {&quot;native&quot;}</td></tr>
<tr class="separator:ae866db953617cc0cc4090aeedfd3103c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a216e5a3eb30ef276aef23458bd6ebd98"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a216e5a3eb30ef276aef23458bd6ebd98">check_int</a> = -1</td></tr>
<tr class="separator:a216e5a3eb30ef276aef23458bd6ebd98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fd2ffd8760dc3b1d68392d18cc728ae"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a6fd2ffd8760dc3b1d68392d18cc728ae">plot_var_names_1</a></td></tr>
<tr class="separator:a6fd2ffd8760dc3b1d68392d18cc728ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b9c22ebd57fa77b0bb64f3932acc51c"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a9b9c22ebd57fa77b0bb64f3932acc51c">plot_var_names_2</a></td></tr>
<tr class="separator:a9b9c22ebd57fa77b0bb64f3932acc51c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd7f32f1e2d2c5152773534f6f8ab5a0"><td class="memItemLeft" align="right" valign="top">const amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#afd7f32f1e2d2c5152773534f6f8ab5a0">cons_names</a> {&quot;temp&quot;, &quot;salt&quot;, &quot;scalar&quot;}</td></tr>
<tr class="separator:afd7f32f1e2d2c5152773534f6f8ab5a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab221b060f02f422f90d511e71b5c13d6"><td class="memItemLeft" align="right" valign="top">const amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ab221b060f02f422f90d511e71b5c13d6">derived_names</a> {&quot;dpdx&quot;, &quot;dpdy&quot;}</td></tr>
<tr class="separator:ab221b060f02f422f90d511e71b5c13d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6efd311333adc503a24d5b3364c4a2d3"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a6efd311333adc503a24d5b3364c4a2d3">h_havg_density</a></td></tr>
<tr class="separator:a6efd311333adc503a24d5b3364c4a2d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5dcbcc6efc7c4e5fbca45b466b475ac"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#aa5dcbcc6efc7c4e5fbca45b466b475ac">h_havg_temperature</a></td></tr>
<tr class="separator:aa5dcbcc6efc7c4e5fbca45b466b475ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82b2332d9dee5db2130ebd0ef2fa0d0b"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a82b2332d9dee5db2130ebd0ef2fa0d0b">h_havg_pressure</a></td></tr>
<tr class="separator:a82b2332d9dee5db2130ebd0ef2fa0d0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a271306c0bdbc6ac6822bbca35f395d07"><td class="memItemLeft" align="right" valign="top">amrex::Gpu::DeviceVector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a271306c0bdbc6ac6822bbca35f395d07">d_havg_density</a></td></tr>
<tr class="separator:a271306c0bdbc6ac6822bbca35f395d07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9af6ccc61c900c2139238378b214ce44"><td class="memItemLeft" align="right" valign="top">amrex::Gpu::DeviceVector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a9af6ccc61c900c2139238378b214ce44">d_havg_temperature</a></td></tr>
<tr class="separator:a9af6ccc61c900c2139238378b214ce44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09200be1d5d74f87d3679591a850eaef"><td class="memItemLeft" align="right" valign="top">amrex::Gpu::DeviceVector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a09200be1d5d74f87d3679591a850eaef">d_havg_pressure</a></td></tr>
<tr class="separator:a09200be1d5d74f87d3679591a850eaef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d17615a53d63c67d12c657c9b5dade5"><td class="memItemLeft" align="right" valign="top">amrex::MultiFab&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a6d17615a53d63c67d12c657c9b5dade5">fine_mask</a></td></tr>
<tr class="separator:a6d17615a53d63c67d12c657c9b5dade5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a854a34e778a776e3ca46f7eeac9813e4"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; std::fstream &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a854a34e778a776e3ca46f7eeac9813e4">datalog</a></td></tr>
<tr class="separator:a854a34e778a776e3ca46f7eeac9813e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae308f7068f2eb8e48913fc77d32f9065"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ae308f7068f2eb8e48913fc77d32f9065">datalogname</a></td></tr>
<tr class="separator:ae308f7068f2eb8e48913fc77d32f9065"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:a87dc05168f41e1ad8b45d1030655f6e7"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a87dc05168f41e1ad8b45d1030655f6e7">cfl</a> = 0.8</td></tr>
<tr class="separator:a87dc05168f41e1ad8b45d1030655f6e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc2d5ca5334b8dc2acb9c6c57febbcf1"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#afc2d5ca5334b8dc2acb9c6c57febbcf1">init_shrink</a> = 1.0</td></tr>
<tr class="separator:afc2d5ca5334b8dc2acb9c6c57febbcf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe5f357fc00e46eb1445f35f84cbdf8e"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#afe5f357fc00e46eb1445f35f84cbdf8e">change_max</a> = 1.1</td></tr>
<tr class="separator:afe5f357fc00e46eb1445f35f84cbdf8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f1ff8349f4357e88dc70143f163b392"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a9f1ff8349f4357e88dc70143f163b392">fixed_dt</a> = -1.0</td></tr>
<tr class="separator:a9f1ff8349f4357e88dc70143f163b392"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b13ff6c8fec8f7ac0eb7330732d9bcc"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a9b13ff6c8fec8f7ac0eb7330732d9bcc">fixed_fast_dt</a> = -1.0</td></tr>
<tr class="separator:a9b13ff6c8fec8f7ac0eb7330732d9bcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a676fc3cc2402734727ca9e04e050d171"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a676fc3cc2402734727ca9e04e050d171">fixed_ndtfast_ratio</a> = 0</td></tr>
<tr class="separator:a676fc3cc2402734727ca9e04e050d171"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21df816ace6144ce0ed78d0031eaa946"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structSolverChoice.html">SolverChoice</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a></td></tr>
<tr class="separator:a21df816ace6144ce0ed78d0031eaa946"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab37afaafcf05a9b10c0fba3180539610"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ab37afaafcf05a9b10c0fba3180539610">verbose</a> = 0</td></tr>
<tr class="separator:ab37afaafcf05a9b10c0fba3180539610"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e111db2e680a1a90e4f1ddd37212ba6"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a1e111db2e680a1a90e4f1ddd37212ba6">use_tracer_particles</a></td></tr>
<tr class="separator:a1e111db2e680a1a90e4f1ddd37212ba6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcedb31381fd065fff2ca36196f8da40"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#afcedb31381fd065fff2ca36196f8da40">sum_interval</a> = -1</td></tr>
<tr class="separator:afcedb31381fd065fff2ca36196f8da40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af638ada4294dcf5b33de335efef61de1"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#af638ada4294dcf5b33de335efef61de1">sum_per</a> = -1.0</td></tr>
<tr class="separator:af638ada4294dcf5b33de335efef61de1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a802f6c0afcdf21170461376c39e9701a"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a802f6c0afcdf21170461376c39e9701a">plotfile_type</a> = &quot;amrex&quot;</td></tr>
<tr class="separator:a802f6c0afcdf21170461376c39e9701a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae637f59528ab8ecd6d5780a4b9e667e5"><td class="memItemLeft" align="right" valign="top">static amrex::Vector&lt; amrex::Vector&lt; std::string &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ae637f59528ab8ecd6d5780a4b9e667e5">nc_init_file</a> = {{&quot;&quot;}}</td></tr>
<tr class="separator:ae637f59528ab8ecd6d5780a4b9e667e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a067945622be8aeb2bd7a812ae222b031"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a067945622be8aeb2bd7a812ae222b031">nc_bdy_file</a></td></tr>
<tr class="separator:a067945622be8aeb2bd7a812ae222b031"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addd7497677393458ec87e5aa1ed1b6c5"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#addd7497677393458ec87e5aa1ed1b6c5">input_sounding_file</a></td></tr>
<tr class="separator:addd7497677393458ec87e5aa1ed1b6c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9db9e34cdbbb00987f648d9075fa4e3e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a9db9e34cdbbb00987f648d9075fa4e3e">output_1d_column</a></td></tr>
<tr class="separator:a9db9e34cdbbb00987f648d9075fa4e3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef48ba3f3f3d75f7dfd36560a71ef94f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#aef48ba3f3f3d75f7dfd36560a71ef94f">column_interval</a></td></tr>
<tr class="separator:aef48ba3f3f3d75f7dfd36560a71ef94f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77bb4ecfec25fd3dd2fde5b637f557f2"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a77bb4ecfec25fd3dd2fde5b637f557f2">column_per</a></td></tr>
<tr class="separator:a77bb4ecfec25fd3dd2fde5b637f557f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a4ea92dce7e8d0072b37aa3edd20d9f"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a8a4ea92dce7e8d0072b37aa3edd20d9f">column_loc_x</a></td></tr>
<tr class="separator:a8a4ea92dce7e8d0072b37aa3edd20d9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaffc5965ead48d24734ec365b6ee522"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#aeaffc5965ead48d24734ec365b6ee522">column_loc_y</a></td></tr>
<tr class="separator:aeaffc5965ead48d24734ec365b6ee522"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29488d66fbb560d30a4b5e06b672beeb"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a29488d66fbb560d30a4b5e06b672beeb">column_file_name</a></td></tr>
<tr class="separator:a29488d66fbb560d30a4b5e06b672beeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96d71c96092397cf1a692d490652973e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a96d71c96092397cf1a692d490652973e">output_bndry_planes</a></td></tr>
<tr class="separator:a96d71c96092397cf1a692d490652973e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13e740677d31feb5f33e044d1a48c8a4"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a13e740677d31feb5f33e044d1a48c8a4">bndry_output_planes_interval</a></td></tr>
<tr class="separator:a13e740677d31feb5f33e044d1a48c8a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7cb5e92951f1b72d818578160d0f993"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ae7cb5e92951f1b72d818578160d0f993">bndry_output_planes_per</a></td></tr>
<tr class="separator:ae7cb5e92951f1b72d818578160d0f993"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8550f36a6138b1e0679e79b3c84d489"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#aa8550f36a6138b1e0679e79b3c84d489">bndry_output_planes_start_time</a></td></tr>
<tr class="separator:aa8550f36a6138b1e0679e79b3c84d489"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3894b8be6ddf628ddd718abfc4c36ad"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ae3894b8be6ddf628ddd718abfc4c36ad">input_bndry_planes</a></td></tr>
<tr class="separator:ae3894b8be6ddf628ddd718abfc4c36ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a335a655f6cf611277de2803029419c4c"><td class="memItemLeft" align="right" valign="top">static amrex::Vector&lt; amrex::AMRErrorTag &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#a335a655f6cf611277de2803029419c4c">ref_tags</a></td></tr>
<tr class="separator:a335a655f6cf611277de2803029419c4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3e7f280e92f9e5cbdad88a3f222069c"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#ab3e7f280e92f9e5cbdad88a3f222069c">startCPUTime</a> = 0.0</td></tr>
<tr class="separator:ab3e7f280e92f9e5cbdad88a3f222069c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe8d71bf62ec39dc02fb961910a79811"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMSX.html#afe8d71bf62ec39dc02fb961910a79811">previousCPUTimeUsed</a> = 0.0</td></tr>
<tr class="separator:afe8d71bf62ec39dc02fb961910a79811"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a172ef44112e79149fd4b321e8c1ab357"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a172ef44112e79149fd4b321e8c1ab357">&#9670;&nbsp;</a></span>ROMSX()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ROMSX::ROMSX </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>constructor - reads in parameters from inputs file</p><ul>
<li>sizes multilevel arrays and data structures </li>
</ul>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* romsx_hash = amrex::buildInfoGetGitHash(1);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* amrex_hash = amrex::buildInfoGetGitHash(2);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgithash = amrex::buildInfoGetBuildGitHash();</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgitname = amrex::buildInfoGetBuildGitName();</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordflow">if</span> (strlen(romsx_hash) &gt; 0) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;          amrex::Print() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                         &lt;&lt; <span class="stringliteral">&quot;ROMSX git hash: &quot;</span> &lt;&lt; romsx_hash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordflow">if</span> (strlen(amrex_hash) &gt; 0) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;          amrex::Print() &lt;&lt; <span class="stringliteral">&quot;AMReX git hash: &quot;</span> &lt;&lt; amrex_hash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keywordflow">if</span> (strlen(buildgithash) &gt; 0) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;          amrex::Print() &lt;&lt; buildgitname &lt;&lt; <span class="stringliteral">&quot; git hash: &quot;</span> &lt;&lt; buildgithash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="classROMSX.html#ae3543d5a8078423ea4ac399ee53a67b9">ReadParameters</a>();</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keyword">const</span> std::string&amp; pv1 = <span class="stringliteral">&quot;plot_vars_1&quot;</span>; <a class="code" href="classROMSX.html#a570a9208f8598e95442e4c5717902638">setPlotVariables</a>(pv1,<a class="code" href="classROMSX.html#a6fd2ffd8760dc3b1d68392d18cc728ae">plot_var_names_1</a>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keyword">const</span> std::string&amp; pv2 = <span class="stringliteral">&quot;plot_vars_2&quot;</span>; <a class="code" href="classROMSX.html#a570a9208f8598e95442e4c5717902638">setPlotVariables</a>(pv2,<a class="code" href="classROMSX.html#a9b9c22ebd57fa77b0bb64f3932acc51c">plot_var_names_2</a>);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="prob__common_8H.html#afef32e2116829d24b864c64caebf5ea6">amrex_probinit</a>(geom[0].ProbLo(),geom[0].ProbHi());</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// Geometry on all levels has been defined already.</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// No valid BoxArray and DistributionMapping have been defined.</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// But the arrays for them have been resized.</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordtype">int</span> nlevs_max = max_level + 1;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>.resize(nlevs_max, 0);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="classROMSX.html#ab02aa1c49bf90239a6bce4ca84da985d">nsubsteps</a>.resize(nlevs_max, 1);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= max_level; ++lev) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <a class="code" href="classROMSX.html#ab02aa1c49bf90239a6bce4ca84da985d">nsubsteps</a>[lev] = <a class="code" href="classROMSX.html#a116ad0a8fa0753367f3458e5744c8e8e">do_substep</a> ? MaxRefRatio(lev-1) : 1;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="classROMSX.html#a11e74dcdbeb3670a3f92a614366a7b32">physbcs</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>.resize(nlevs_max, 0.0);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="classROMSX.html#ac395453aa10633a05bb7323b2946101e">t_old</a>.resize(nlevs_max, -1.e100);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>.resize(nlevs_max, 1.e100);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="classROMSX.html#a7a14aa971cac1b1ad0eb5d4b46b90343">cons_old</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="classROMSX.html#af0b5074dc426b753beb5511bd63df407">xvel_old</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="classROMSX.html#a87f0b7446438b8145bdea79012b985f5">yvel_old</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="classROMSX.html#acb72d33af4be09dede2005fa6c901686">zvel_old</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="classROMSX.html#afc5b78f8bc38863080c02301dba5377f">advflux_reg</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// Initialize tagging criteria for mesh refinement</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="classROMSX.html#a95cf73016433f9bc8822da57b7f3736e">refinement_criteria_setup</a>();</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// We have already read in the ref_Ratio (via amr.ref_ratio =) but we need to enforce</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">//     that there is no refinement in the vertical so we test on that here.</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt; max_level; ++lev)</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;       amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Refinement ratio at level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; set to be &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;          ref_ratio[lev][0]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ref_ratio[lev][1]  &lt;&lt;  <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ref_ratio[lev][2] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;       <span class="keywordflow">if</span> (ref_ratio[lev][2] != 1)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;       {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;           amrex::Error(<span class="stringliteral">&quot;We don&#39;t allow refinement in the vertical -- make sure to set ref_ratio = 1 in z&quot;</span>);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;       }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;}</div>
<div class="ttc" id="aclassROMSX_html_a116ad0a8fa0753367f3458e5744c8e8e"><div class="ttname"><a href="classROMSX.html#a116ad0a8fa0753367f3458e5744c8e8e">ROMSX::do_substep</a></div><div class="ttdeci">int do_substep</div><div class="ttdef"><b>Definition:</b> ROMSX.H:795</div></div>
<div class="ttc" id="aclassROMSX_html_a11e74dcdbeb3670a3f92a614366a7b32"><div class="ttname"><a href="classROMSX.html#a11e74dcdbeb3670a3f92a614366a7b32">ROMSX::physbcs</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; ROMSXPhysBCFunct &gt; &gt; physbcs</div><div class="ttdef"><b>Definition:</b> ROMSX.H:737</div></div>
<div class="ttc" id="aclassROMSX_html_a2d8d8b238ca3a5ebf4346e4110c82af2"><div class="ttname"><a href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">ROMSX::xvel_new</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab * &gt; xvel_new</div><div class="ttdef"><b>Definition:</b> ROMSX.H:190</div></div>
<div class="ttc" id="aclassROMSX_html_a31b7954d302e5fd9474c084078ad4784"><div class="ttname"><a href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">ROMSX::istep</a></div><div class="ttdeci">amrex::Vector&lt; int &gt; istep</div><div class="ttdef"><b>Definition:</b> ROMSX.H:729</div></div>
<div class="ttc" id="aclassROMSX_html_a570a9208f8598e95442e4c5717902638"><div class="ttname"><a href="classROMSX.html#a570a9208f8598e95442e4c5717902638">ROMSX::setPlotVariables</a></div><div class="ttdeci">void setPlotVariables(const std::string &amp;pp_plot_var_names, amrex::Vector&lt; std::string &gt; &amp;plot_var_names)</div><div class="ttdef"><b>Definition:</b> Plotfile.cpp:9</div></div>
<div class="ttc" id="aclassROMSX_html_a6fd2ffd8760dc3b1d68392d18cc728ae"><div class="ttname"><a href="classROMSX.html#a6fd2ffd8760dc3b1d68392d18cc728ae">ROMSX::plot_var_names_1</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; plot_var_names_1</div><div class="ttdef"><b>Definition:</b> ROMSX.H:813</div></div>
<div class="ttc" id="aclassROMSX_html_a7a14aa971cac1b1ad0eb5d4b46b90343"><div class="ttname"><a href="classROMSX.html#a7a14aa971cac1b1ad0eb5d4b46b90343">ROMSX::cons_old</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab * &gt; cons_old</div><div class="ttdef"><b>Definition:</b> ROMSX.H:184</div></div>
<div class="ttc" id="aclassROMSX_html_a7f7c60f6b48935de00903f101ffcf412"><div class="ttname"><a href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">ROMSX::cons_new</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab * &gt; cons_new</div><div class="ttdef"><b>Definition:</b> ROMSX.H:189</div></div>
<div class="ttc" id="aclassROMSX_html_a87f0b7446438b8145bdea79012b985f5"><div class="ttname"><a href="classROMSX.html#a87f0b7446438b8145bdea79012b985f5">ROMSX::yvel_old</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab * &gt; yvel_old</div><div class="ttdef"><b>Definition:</b> ROMSX.H:186</div></div>
<div class="ttc" id="aclassROMSX_html_a95cf73016433f9bc8822da57b7f3736e"><div class="ttname"><a href="classROMSX.html#a95cf73016433f9bc8822da57b7f3736e">ROMSX::refinement_criteria_setup</a></div><div class="ttdeci">void refinement_criteria_setup()</div><div class="ttdef"><b>Definition:</b> ROMSX_Tagging.cpp:39</div></div>
<div class="ttc" id="aclassROMSX_html_a9b9c22ebd57fa77b0bb64f3932acc51c"><div class="ttname"><a href="classROMSX.html#a9b9c22ebd57fa77b0bb64f3932acc51c">ROMSX::plot_var_names_2</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; plot_var_names_2</div><div class="ttdef"><b>Definition:</b> ROMSX.H:814</div></div>
<div class="ttc" id="aclassROMSX_html_aa67ecec73cc05ad8c7af8578faa77b48"><div class="ttname"><a href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">ROMSX::yvel_new</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab * &gt; yvel_new</div><div class="ttdef"><b>Definition:</b> ROMSX.H:191</div></div>
<div class="ttc" id="aclassROMSX_html_aa8a469941edd719ce7c6052afc30d067"><div class="ttname"><a href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">ROMSX::dt</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; dt</div><div class="ttdef"><b>Definition:</b> ROMSX.H:735</div></div>
<div class="ttc" id="aclassROMSX_html_aac116ec30618bbd5641218e7522cdb86"><div class="ttname"><a href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">ROMSX::t_new</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; t_new</div><div class="ttdef"><b>Definition:</b> ROMSX.H:733</div></div>
<div class="ttc" id="aclassROMSX_html_ab02aa1c49bf90239a6bce4ca84da985d"><div class="ttname"><a href="classROMSX.html#ab02aa1c49bf90239a6bce4ca84da985d">ROMSX::nsubsteps</a></div><div class="ttdeci">amrex::Vector&lt; int &gt; nsubsteps</div><div class="ttdef"><b>Definition:</b> ROMSX.H:730</div></div>
<div class="ttc" id="aclassROMSX_html_ac395453aa10633a05bb7323b2946101e"><div class="ttname"><a href="classROMSX.html#ac395453aa10633a05bb7323b2946101e">ROMSX::t_old</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; t_old</div><div class="ttdef"><b>Definition:</b> ROMSX.H:734</div></div>
<div class="ttc" id="aclassROMSX_html_acb72d33af4be09dede2005fa6c901686"><div class="ttname"><a href="classROMSX.html#acb72d33af4be09dede2005fa6c901686">ROMSX::zvel_old</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab * &gt; zvel_old</div><div class="ttdef"><b>Definition:</b> ROMSX.H:187</div></div>
<div class="ttc" id="aclassROMSX_html_ae3543d5a8078423ea4ac399ee53a67b9"><div class="ttname"><a href="classROMSX.html#ae3543d5a8078423ea4ac399ee53a67b9">ROMSX::ReadParameters</a></div><div class="ttdeci">void ReadParameters()</div><div class="ttdef"><b>Definition:</b> ROMSX.cpp:431</div></div>
<div class="ttc" id="aclassROMSX_html_af0b5074dc426b753beb5511bd63df407"><div class="ttname"><a href="classROMSX.html#af0b5074dc426b753beb5511bd63df407">ROMSX::xvel_old</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab * &gt; xvel_old</div><div class="ttdef"><b>Definition:</b> ROMSX.H:185</div></div>
<div class="ttc" id="aclassROMSX_html_af4db3a202bf1aa714f1c5a2e9d6174e4"><div class="ttname"><a href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">ROMSX::zvel_new</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab * &gt; zvel_new</div><div class="ttdef"><b>Definition:</b> ROMSX.H:192</div></div>
<div class="ttc" id="aclassROMSX_html_afc5b78f8bc38863080c02301dba5377f"><div class="ttname"><a href="classROMSX.html#afc5b78f8bc38863080c02301dba5377f">ROMSX::advflux_reg</a></div><div class="ttdeci">amrex::Vector&lt; amrex::YAFluxRegister * &gt; advflux_reg</div><div class="ttdef"><b>Definition:</b> ROMSX.H:748</div></div>
<div class="ttc" id="aprob__common_8H_html_afef32e2116829d24b864c64caebf5ea6"><div class="ttname"><a href="prob__common_8H.html#afef32e2116829d24b864c64caebf5ea6">amrex_probinit</a></div><div class="ttdeci">void amrex_probinit(const amrex_real *problo, const amrex_real *probhi)</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classROMSX_a172ef44112e79149fd4b321e8c1ab357_cgraph.png" border="0" usemap="#aclassROMSX_a172ef44112e79149fd4b321e8c1ab357_cgraph" alt=""/></div>
<map name="aclassROMSX_a172ef44112e79149fd4b321e8c1ab357_cgraph" id="aclassROMSX_a172ef44112e79149fd4b321e8c1ab357_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,132,32"/>
<area shape="rect" href="prob__common_8H.html#afef32e2116829d24b864c64caebf5ea6" title=" " alt="" coords="180,5,301,32"/>
</map>
</div>

</div>
</div>
<a id="a9fba793897d4512a556f2a7da8da3de0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fba793897d4512a556f2a7da8da3de0">&#9670;&nbsp;</a></span>~ROMSX()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ROMSX::~ROMSX </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;{</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a5d120bfdaf2972b92fda49a4c1bbc43d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d120bfdaf2972b92fda49a4c1bbc43d">&#9670;&nbsp;</a></span>Advance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::Advance </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iteration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncycle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>advance a single level for a single time step </p>
<div class="fragment"><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;{</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ROMSX::Advance()&quot;</span>);</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160; </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <a class="code" href="classROMSX.html#a62d0fa7d294be023f9050f71bb0ad221">setup_step</a>(lev, time, dt_lev);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a2a6fbf7ebea6ac5d9faddcbfe36771bd">use_barotropic</a>)</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        <span class="keywordtype">int</span> nfast_counter=<a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a> + 1;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        <span class="comment">//***************************************************</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        <span class="comment">//Compute fast timestep from dt_lev and ratio</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        <span class="comment">//***************************************************</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dtfast_lev=dt_lev/<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(<a class="code" href="classROMSX.html#a676fc3cc2402734727ca9e04e050d171">fixed_ndtfast_ratio</a>);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        <span class="comment">//***************************************************</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        <span class="comment">//Advance nfast_counter steps of the 2d integrator</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        <span class="comment">//***************************************************</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> my_iif = 0; my_iif &lt; nfast_counter; my_iif++) {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;            <a class="code" href="classROMSX.html#a8fa9ebf787a2bcd053f235b50e5dbac3">advance_2d_onestep</a>(lev, dt_lev, dtfast_lev, my_iif, nfast_counter);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        }</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    }</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">//***************************************************</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">//Advance one step of the 3d integrator</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">//***************************************************</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="classROMSX.html#a77f393227b048d127b50340ea256a9cf">advance_3d_ml</a>(lev, dt_lev);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;}</div>
<div class="ttc" id="aDataStruct_8H_html_aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1"><div class="ttname"><a href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">IC_BC_Type::Real</a></div><div class="ttdeci">@ Real</div></div>
<div class="ttc" id="aclassROMSX_html_a21df816ace6144ce0ed78d0031eaa946"><div class="ttname"><a href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">ROMSX::solverChoice</a></div><div class="ttdeci">static SolverChoice solverChoice</div><div class="ttdef"><b>Definition:</b> ROMSX.H:826</div></div>
<div class="ttc" id="aclassROMSX_html_a62d0fa7d294be023f9050f71bb0ad221"><div class="ttname"><a href="classROMSX.html#a62d0fa7d294be023f9050f71bb0ad221">ROMSX::setup_step</a></div><div class="ttdeci">void setup_step(int lev, amrex::Real time, amrex::Real dt_lev)</div><div class="ttdef"><b>Definition:</b> ROMSX_setup_step.cpp:7</div></div>
<div class="ttc" id="aclassROMSX_html_a676fc3cc2402734727ca9e04e050d171"><div class="ttname"><a href="classROMSX.html#a676fc3cc2402734727ca9e04e050d171">ROMSX::fixed_ndtfast_ratio</a></div><div class="ttdeci">static int fixed_ndtfast_ratio</div><div class="ttdef"><b>Definition:</b> ROMSX.H:791</div></div>
<div class="ttc" id="aclassROMSX_html_a77f393227b048d127b50340ea256a9cf"><div class="ttname"><a href="classROMSX.html#a77f393227b048d127b50340ea256a9cf">ROMSX::advance_3d_ml</a></div><div class="ttdeci">void advance_3d_ml(int lev, amrex::Real dt_lev)</div><div class="ttdef"><b>Definition:</b> ROMSX_advance_3d_ml.cpp:6</div></div>
<div class="ttc" id="aclassROMSX_html_a8fa9ebf787a2bcd053f235b50e5dbac3"><div class="ttname"><a href="classROMSX.html#a8fa9ebf787a2bcd053f235b50e5dbac3">ROMSX::advance_2d_onestep</a></div><div class="ttdeci">void advance_2d_onestep(int lev, amrex::Real dt_lev, amrex::Real dtfast_lev, int my_iif, int nfast_counter)</div><div class="ttdef"><b>Definition:</b> ROMSX_advance_2d_onestep.cpp:6</div></div>
<div class="ttc" id="aclassROMSX_html_ac248f5de275736769f83c3e6bfc6b550"><div class="ttname"><a href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">ROMSX::nfast</a></div><div class="ttdeci">int nfast</div><div class="ttdef"><b>Definition:</b> ROMSX.H:792</div></div>
<div class="ttc" id="astructSolverChoice_html_a2a6fbf7ebea6ac5d9faddcbfe36771bd"><div class="ttname"><a href="structSolverChoice.html#a2a6fbf7ebea6ac5d9faddcbfe36771bd">SolverChoice::use_barotropic</a></div><div class="ttdeci">bool use_barotropic</div><div class="ttdef"><b>Definition:</b> DataStruct.H:164</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a00ce68e5a1dd4a3db8e47bc28f4f9c73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00ce68e5a1dd4a3db8e47bc28f4f9c73">&#9670;&nbsp;</a></span>advance_2d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::advance_2d </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab const *&#160;</td>
          <td class="paramname"><em>mf_rhoS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab const *&#160;</td>
          <td class="paramname"><em>mf_rhoA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_ru</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_rv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_rufrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_rvfrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_Zt_avg1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_DU_avg1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_DU_avg2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_DV_avg1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_DV_avg2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_rubar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_rvbar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_rzeta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_ubar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_vbar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_zeta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab const *&#160;</td>
          <td class="paramname"><em>mf_h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_visc2_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_visc2_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dtfast_lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>predictor_2d_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>first_2d_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>my_iif</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>next_indx1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Perform a 2D predictor (predictor_2d_step=True) or corrector (predictor_2d_step=False) step</p>
<p>Function that coordinates the evolution across levels &ndash; this calls Advance to do the actual advance at this level, then recursively calls itself at finer levels</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lev</td><td>level of refinement (coarsest level is 0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_rhoS</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_rhoA</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_ru</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_rv</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_rufrc</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_rvfrc</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_Zt_avg1</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_DU_avg1</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_DU_avg2</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_DV_avg1</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_DV_avg2</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_rubar</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_rvbar</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_rbar</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_rbar</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_zeta</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_h</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_visc2_p</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_visc2_f</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dtfast_lev</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">predictor_2d_step</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">first_2d_step</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">my_iif</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">next_indx1</td><td></td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;{</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keyword">auto</span> geomdata  = Geom(lev).data();</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> dxi = Geom(lev).InvCellSizeArray();</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordtype">int</span> iic = <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[lev];</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nnew  = 0;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nstp  = 0;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordtype">int</span> ntfirst = 0;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordtype">int</span> knew = 3;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordtype">int</span> krhs = (my_iif + iic) % 2 + 1;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordtype">int</span> kstp = my_iif &lt;=1 ? iic % 2 + 1 : (iic % 2 + my_iif % 2 + 1) % 2 + 1;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordtype">int</span> indx1 = krhs;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">if</span> (predictor_2d_step) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        next_indx1 = 3 - indx1;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        knew = next_indx1;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        kstp = 3 - knew;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        krhs = 3;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="comment">//If it&#39;s not the auxiliary time step, set indx1 to next_indx1</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="comment">// NOTE: should this ever not execute?</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordflow">if</span> (my_iif&lt;<a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>+1)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            indx1=next_indx1;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordtype">int</span> ptsk = 3-kstp;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    knew-=1;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    krhs-=1;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    kstp-=1;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    indx1-=1;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    ptsk-=1;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keyword">auto</span> ba = mf_h-&gt;boxArray();</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keyword">auto</span> dm = mf_h-&gt;DistributionMap();</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    MultiFab mf_DUon(convert(ba,IntVect(1,0,0)),dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    MultiFab mf_DVom(convert(ba,IntVect(0,1,0)),dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(*mf_rhoS, TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; ubar = mf_ubar-&gt;array(mfi);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; vbar = mf_vbar-&gt;array(mfi);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; zeta = mf_zeta-&gt;array(mfi);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; h    = mf_h-&gt;const_array(mfi);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        Box bx = mfi.tilebox();</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        Box gbx = mfi.growntilebox();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        Box gbx1 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        Box gbx2 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        Box xbxD = mfi.nodaltilebox(0).makeSlab(2,0);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        Box ybxD = mfi.nodaltilebox(1).makeSlab(2,0);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        Box xgbx2 = mfi.grownnodaltilebox(0, IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        Box ygbx2 = mfi.grownnodaltilebox(1, IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        Box tbxp1 = bx;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        Box tbxp11 = bx;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        Box tbxp2 = bx;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        Box tbxp3 = bx;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        tbxp1.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        tbxp2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        tbxp11.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1));</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        tbxp3.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0));</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        Box bxD   = bx  ;   bxD.makeSlab(2,0);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        Box gbxD  = gbx ;  gbxD.makeSlab(2,0);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        Box gbx1D = gbx1; gbx1D.makeSlab(2,0);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        Box gbx2D = gbx2; gbx2D.makeSlab(2,0);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        Box tbxp2D = tbxp2;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        tbxp2D.makeSlab(2,0);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        FArrayBox fab_pn(tbxp2,1,The_Async_Arena());</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        FArrayBox fab_pm(tbxp2,1,The_Async_Arena());</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        FArrayBox fab_on_u(tbxp3,1,The_Async_Arena());</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        FArrayBox fab_om_v(tbxp3,1,The_Async_Arena());</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        FArrayBox fab_om_u(tbxp3,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        FArrayBox fab_on_v(tbxp3,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        FArrayBox fab_om_r(tbxp3,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        FArrayBox fab_on_r(tbxp3,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        FArrayBox fab_om_p(tbxp3,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        FArrayBox fab_on_p(tbxp3,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="comment">//step2d work arrays</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        FArrayBox fab_Drhs(tbxp3,1,The_Async_Arena());</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        FArrayBox fab_Dnew(tbxp1,1,The_Async_Arena());</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        FArrayBox fab_gzeta(tbxp1,1,The_Async_Arena());</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        FArrayBox fab_gzeta2(tbxp1,1,The_Async_Arena());</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        FArrayBox fab_gzetaSA(tbxp1,1,The_Async_Arena());</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        FArrayBox fab_Dstp(tbxp2,1,The_Async_Arena());</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        FArrayBox fab_rhs_ubar(xbxD,1,The_Async_Arena());</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        FArrayBox fab_rhs_vbar(ybxD,1,The_Async_Arena());</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        FArrayBox fab_rhs_zeta(tbxp1,1,The_Async_Arena());</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        FArrayBox fab_zeta_new(tbxp1,1,The_Async_Arena());</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keyword">auto</span> on_u=fab_on_u.array();</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keyword">auto</span> om_v=fab_om_v.array();</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keyword">auto</span> om_u=fab_om_u.array();</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keyword">auto</span> on_v=fab_on_v.array();</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keyword">auto</span> om_r=fab_om_r.array();</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keyword">auto</span> on_r=fab_on_r.array();</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keyword">auto</span> om_p=fab_om_p.array();</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keyword">auto</span> on_p=fab_on_p.array();</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keyword">auto</span> Drhs=fab_Drhs.array();</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keyword">auto</span> DUon = mf_DUon.array(mfi);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keyword">auto</span> DVom = mf_DVom.array(mfi);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="comment">// NOTE: these will eventually be on smaller boxes, since these</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="comment">// are all centered on different points</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        ParallelFor(makeSlab(tbxp3,2,0),</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;              <span class="comment">//Note: are the comment definitons right? Don&#39;t seem to match metrics.f90</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;              om_v(i,j,0)=1.0/dxi[0]; <span class="comment">// 2/(pm(i,j-1)+pm(i,j))</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;              on_u(i,j,0)=1.0/dxi[1]; <span class="comment">// 2/(pm(i,j-1)+pm(i,j))</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;              om_r(i,j,0)=1.0/dxi[0]; <span class="comment">// 1/pm(i,j)</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;              on_r(i,j,0)=1.0/dxi[1]; <span class="comment">// 1/pn(i,j)</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;              <span class="comment">//todo: om_p on_p</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;              om_p(i,j,0)=1.0/dxi[0]; <span class="comment">// 4/(pm(i-1,j-1)+pm(i-1,j)+pm(i,j-1)+pm(i,j))</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;              on_p(i,j,0)=1.0/dxi[1]; <span class="comment">// 4/(pn(i-1,j-1)+pn(i-1,j)+pn(i,j-1)+pn(i,j))</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;              on_v(i,j,0)=1.0/dxi[1]; <span class="comment">// 2/(pn(i-1,j)+pn(i,j))</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;              om_u(i,j,0)=1.0/dxi[0]; <span class="comment">// 2/(pm(i-1,j)+pm(i,j))</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        });</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        ParallelFor(makeSlab(tbxp3,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            Drhs(i,j,0)=zeta(i,j,0,krhs)+h(i,j,0);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        });</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        ParallelFor(makeSlab(xgbx2,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1= 0.5 * on_u(i,j,0) *(Drhs(i,j,0)+Drhs(i-1,j,0));</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            DUon(i,j,0)=ubar(i,j,0,krhs)*cff1;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        });</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        ParallelFor(makeSlab(ygbx2,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1= 0.5*om_v(i,j,0)*(Drhs(i,j,0)+Drhs(i,j-1,0));</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            DVom(i,j,0)=vbar(i,j,0,krhs)*cff1;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        });</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// These are needed to pass the tests with bathymetry but I don&#39;t quite see why</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    mf_DUon.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    mf_DVom.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(*mf_rhoS, TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; rhoS = mf_rhoS-&gt;const_array(mfi);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; rhoA = mf_rhoA-&gt;const_array(mfi);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; h    = mf_h-&gt;const_array(mfi);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; rufrc   = mf_rufrc-&gt;array(mfi);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; rvfrc   = mf_rvfrc-&gt;array(mfi);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; Zt_avg1 = mf_Zt_avg1-&gt;array(mfi);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; ubar = mf_ubar-&gt;array(mfi);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; vbar = mf_vbar-&gt;array(mfi);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; zeta = mf_zeta-&gt;array(mfi);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; DU_avg1 = (mf_DU_avg1)-&gt;array(mfi);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; DU_avg2 = (mf_DU_avg2)-&gt;array(mfi);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; DV_avg1 = (mf_DV_avg1)-&gt;array(mfi);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; DV_avg2 = (mf_DV_avg2)-&gt;array(mfi);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; ru = (mf_ru)-&gt;array(mfi);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; rv = (mf_rv)-&gt;array(mfi);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; rubar = (mf_rubar)-&gt;array(mfi);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; rvbar = (mf_rvbar)-&gt;array(mfi);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; rzeta = (mf_rzeta)-&gt;array(mfi);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; visc2_p = (mf_visc2_p)-&gt;array(mfi);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; visc2_r = (mf_visc2_r)-&gt;array(mfi);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        Box bx = mfi.tilebox();</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        Box gbx = mfi.growntilebox();</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        Box gbx1 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        Box gbx2 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        Box gbx3 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0));</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        Box xgbx2 = mfi.grownnodaltilebox(0, IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        Box ygbx2 = mfi.grownnodaltilebox(1, IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        Box xbxD = mfi.nodaltilebox(0);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        xbxD.makeSlab(2,0);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        Box ybxD = mfi.nodaltilebox(1);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        ybxD.makeSlab(2,0);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        Box tbxp1 = bx;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        Box tbxp11 = bx;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        Box tbxp2 = bx;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        Box tbxp3 = bx;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        tbxp1.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        tbxp2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        tbxp11.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1));</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        tbxp3.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0));</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        Box bxD = bx;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        bxD.makeSlab(2,0);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        Box gbxD = gbx;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        gbxD.makeSlab(2,0);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        Box gbx1D = gbx1;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        gbx1D.makeSlab(2,0);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        Box gbx2D = gbx2;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        gbx2D.makeSlab(2,0);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        Box tbxp2D = tbxp2;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        tbxp2D.makeSlab(2,0);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        FArrayBox fab_pn(tbxp3,1,The_Async_Arena());</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        FArrayBox fab_pm(tbxp3,1,The_Async_Arena());</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        FArrayBox fab_on_u(tbxp3,1,The_Async_Arena());</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        FArrayBox fab_om_v(tbxp3,1,The_Async_Arena());</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        FArrayBox fab_fomn(tbxp2,1,The_Async_Arena());</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        FArrayBox fab_om_u(tbxp3,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        FArrayBox fab_on_v(tbxp3,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        FArrayBox fab_om_r(tbxp3,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        FArrayBox fab_on_r(tbxp3,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        FArrayBox fab_om_p(tbxp3,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        FArrayBox fab_on_p(tbxp3,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="comment">//step2d work arrays</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        FArrayBox fab_Drhs(tbxp3,1,The_Async_Arena());</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        FArrayBox fab_Dnew(tbxp2,1,The_Async_Arena());</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        FArrayBox fab_zwrk(tbxp1,1,The_Async_Arena());</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        FArrayBox fab_gzeta(tbxp1,1,The_Async_Arena());</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        FArrayBox fab_gzeta2(tbxp1,1,The_Async_Arena());</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        FArrayBox fab_gzetaSA(tbxp1,1,The_Async_Arena());</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        FArrayBox fab_Dstp(tbxp3,1,The_Async_Arena());</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        FArrayBox &amp; fab_DUon=mf_DUon[mfi];</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        FArrayBox &amp; fab_DVom=mf_DVom[mfi];</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        FArrayBox fab_rhs_ubar(xbxD,1,The_Async_Arena());</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        FArrayBox fab_rhs_vbar(ybxD,1,The_Async_Arena());</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        FArrayBox fab_rhs_zeta(tbxp1,1,The_Async_Arena());</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        FArrayBox fab_zeta_new(tbxp1,1,The_Async_Arena());</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keyword">auto</span> on_u=fab_on_u.array();</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keyword">auto</span> om_v=fab_om_v.array();</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="keyword">auto</span> pn=fab_pn.array();</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keyword">auto</span> pm=fab_pm.array();</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keyword">auto</span> fomn=fab_fomn.array();</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keyword">auto</span> om_u=fab_om_u.array();</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keyword">auto</span> on_v=fab_on_v.array();</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keyword">auto</span> om_r=fab_om_r.array();</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keyword">auto</span> on_r=fab_on_r.array();</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keyword">auto</span> om_p=fab_om_p.array();</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keyword">auto</span> on_p=fab_on_p.array();</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keyword">auto</span> Drhs=fab_Drhs.array();</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keyword">auto</span> Dnew=fab_Dnew.array();</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="keyword">auto</span> zwrk=fab_zwrk.array();</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keyword">auto</span> gzeta=fab_gzeta.array();</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keyword">auto</span> gzeta2=fab_gzeta2.array();</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keyword">auto</span> gzetaSA=fab_gzetaSA.array();</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keyword">auto</span> Dstp=fab_Dstp.array();</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keyword">auto</span> DUon=fab_DUon.array();</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="keyword">auto</span> DVom=fab_DVom.array();</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="keyword">auto</span> rhs_ubar=fab_rhs_ubar.array();</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keyword">auto</span> rhs_vbar=fab_rhs_vbar.array();</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="keyword">auto</span> rhs_zeta=fab_rhs_zeta.array();</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keyword">auto</span> zeta_new=fab_zeta_new.array();</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keyword">auto</span> weight1 = <a class="code" href="classROMSX.html#a55d028f9a1e55a035ab877607ac326fe">vec_weight1</a>.dataPtr();</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="keyword">auto</span> weight2 = <a class="code" href="classROMSX.html#a1781a7c54d695e8889f2d394062b85a7">vec_weight2</a>.dataPtr();</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> coriolis_f0 = <a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a3a0b717e880c818de989b2e92c199d34">coriolis_f0</a>;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> coriolis_beta = <a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a0d7c9053be4054e355768bf3c17bf029">coriolis_beta</a>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="comment">//From ana_grid.h and metrics.F</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        ParallelFor(makeSlab(tbxp3,2,0),</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;              pm(i,j,0)=dxi[0];</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;              pn(i,j,0)=dxi[1];</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        });</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        ParallelFor(xbxD,</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;              rhs_ubar(i,j,0)=0.0;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        });</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        ParallelFor(ybxD,</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;              rhs_vbar(i,j,0)=0.0;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        });</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        ParallelFor(makeSlab(tbxp3,2,0),</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;              <span class="comment">//Note: are the comment definitons right? Don&#39;t seem to match metrics.f90</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;              om_v(i,j,0)=1.0/dxi[0]; <span class="comment">// 2/(pm(i,j-1)+pm(i,j))</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;              on_u(i,j,0)=1.0/dxi[1]; <span class="comment">// 2/(pm(i,j-1)+pm(i,j))</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;              om_r(i,j,0)=1.0/dxi[0]; <span class="comment">// 1/pm(i,j)</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;              on_r(i,j,0)=1.0/dxi[1]; <span class="comment">// 1/pn(i,j)</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;              <span class="comment">//todo: om_p on_p</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;              om_p(i,j,0)=1.0/dxi[0]; <span class="comment">// 4/(pm(i-1,j-1)+pm(i-1,j)+pm(i,j-1)+pm(i,j))</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;              on_p(i,j,0)=1.0/dxi[1]; <span class="comment">// 4/(pn(i-1,j-1)+pn(i-1,j)+pn(i,j-1)+pn(i,j))</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;              on_v(i,j,0)=1.0/dxi[1]; <span class="comment">// 2/(pn(i-1,j)+pn(i,j))</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;              om_u(i,j,0)=1.0/dxi[0]; <span class="comment">// 2/(pm(i-1,j)+pm(i,j))</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        });</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        ParallelFor(tbxp2D,</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>  )</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;              <span class="keyword">const</span> <span class="keyword">auto</span> prob_lo         = geomdata.ProbLo();</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;              <span class="keyword">const</span> <span class="keyword">auto</span> dx              = geomdata.CellSize();</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;              <span class="comment">//defined UPWELLING</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;              <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Esize=geomdata.ProbHi()[1] - geomdata.ProbLo()[1];</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;              <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01a415290769594460e2e485922904f345d">y</a> = prob_lo[1] + (j + 0.5) * dx[1];</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;              <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> f=coriolis_f0 + coriolis_beta*(<a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01a415290769594460e2e485922904f345d">y</a>-.5*Esize);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;              fomn(i,j,0)=f*(1.0/(pm(i,j,0)*pn(i,j,0)));</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        });</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        ParallelFor(makeSlab(tbxp3,2,0),</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            Drhs(i,j,0)=zeta(i,j,0,krhs)+h(i,j,0);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        });</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keywordflow">if</span>(predictor_2d_step)</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            <span class="keywordflow">if</span>(first_2d_step) {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2=(<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(-1.0)/<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(12.0))*weight2[my_iif+1];</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                ParallelFor(makeSlab(gbx3,2,0),</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                    Zt_avg1(i,j,0)=0.0;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                });</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                ParallelFor(makeSlab(xgbx2,2,0),</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                    DU_avg1(i,j,0)=0.0;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                    DU_avg2(i,j,0)=cff2*DUon(i,j,0);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                });</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                ParallelFor(makeSlab(ygbx2,2,0),</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                    DV_avg1(i,j,0)=0.0;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                    DV_avg2(i,j,0)=cff2*DVom(i,j,0);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                });</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1_wt1 = weight1[my_iif-1];</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2_wt1 = (<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(8.0)/<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(12.0))*weight2[my_iif]-</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                                (<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(1.0)/<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(12.0))*weight2[my_iif+1];</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                ParallelFor(makeSlab(gbx3,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                    Zt_avg1(i,j,0) += cff1_wt1*zeta(i,j,0,krhs);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                });</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                ParallelFor(makeSlab(xgbx2,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                    DU_avg1(i,j,0) += cff1_wt1*DUon(i,j,0);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                    DU_avg2(i,j,0) += cff2_wt1*DUon(i,j,0);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                });</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                ParallelFor(makeSlab(ygbx2,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                    DV_avg1(i,j,0) += cff1_wt1*DVom(i,j,0);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                    DV_avg2(i,j,0) += cff2_wt1*DVom(i,j,0);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                });</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        }</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2_wt2;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <span class="keywordflow">if</span> (first_2d_step) {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                cff2_wt2=weight2[my_iif];</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                cff2_wt2=<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(5.0)/<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(12.0)*weight2[my_iif];</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            }</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            ParallelFor(makeSlab(xgbx2,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                DU_avg2(i,j,0)=DU_avg2(i,j,0)+cff2_wt2*DUon(i,j,0);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            });</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            ParallelFor(makeSlab(ygbx2,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                DV_avg2(i,j,0)=DV_avg2(i,j,0)+cff2_wt2*DVom(i,j,0);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            });</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="comment">//  Do not perform the actual time stepping during the auxiliary</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="comment">//  (nfast(ng)+1) time step. Jump to next box</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordflow">if</span> (my_iif&gt;=<a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="comment">//Load new free-surface values into shared array at both predictor</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="comment">//and corrector steps</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="comment">//  Time step free-surface equation.</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="comment">//  During the first time-step, the predictor step is Forward-Euler</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="comment">//  and the corrector step is Backward-Euler. Otherwise, the predictor</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="comment">//  step is Leap-frog and the corrector step is Adams-Moulton.</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="comment">// todo: gzeta</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="comment">// todo: HACKHACKHACK Should use rho0 from prob.H</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> fac=1000.0/1025.0;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="keywordflow">if</span>(my_iif==0) {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=dtfast_lev;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            ParallelFor(tbxp1,</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                rhs_zeta(i,j,0) = (DUon(i,j,0)-DUon(i+1,j,0))+</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                                  (DVom(i,j,0)-DVom(i,j+1,0));</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                zeta_new(i,j,0) = zeta(i,j,0,kstp)+ pm(i,j,0)*pn(i,j,0)*cff1*rhs_zeta(i,j,0);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                Dnew(i,j,0) = zeta_new(i,j,0)+h(i,j,0);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                <span class="comment">//Pressure gradient terms:</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                zwrk(i,j,0)=0.5_rt*(zeta(i,j,0,kstp)+zeta_new(i,j,0));</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                gzeta(i,j,0)=(fac+rhoS(i,j,0))*zwrk(i,j,0);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                gzeta2(i,j,0)=gzeta(i,j,0)*zwrk(i,j,0);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                gzetaSA(i,j,0)=zwrk(i,j,0)*(rhoS(i,j,0)-rhoA(i,j,0));</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            });</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (predictor_2d_step) {</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=2.0_rt*dtfast_lev;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff4=4.0/25.0;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff5=1.0-2.0*cff4;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            ParallelFor(tbxp1,</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                rhs_zeta(i,j,0)=(DUon(i,j,0)-DUon(i+1,j,0))+</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                                (DVom(i,j,0)-DVom(i,j+1,0));</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                zeta_new(i,j,0)=zeta(i,j,0,kstp)+</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                                pm(i,j,0)*pn(i,j,0)*cff1*rhs_zeta(i,j,0);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                Dnew(i,j,0)=zeta_new(i,j,0)+h(i,j,0);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                <span class="comment">//Pressure gradient terms</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                zwrk(i,j,0)=cff5*zeta(i,j,0,krhs)+</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                    cff4*(zeta(i,j,0,kstp)+zeta_new(i,j,0));</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                gzeta(i,j,0)=(fac+rhoS(i,j,0))*zwrk(i,j,0);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                gzeta2(i,j,0)=gzeta(i,j,0)*zwrk(i,j,0);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                gzetaSA(i,j,0)=zwrk(i,j,0)*(rhoS(i,j,0)-rhoA(i,j,0));</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            });</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!predictor_2d_step) { <span class="comment">//AKA if(corrector_2d_step)</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=dtfast_lev*5.0_rt/12.0_rt;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2=dtfast_lev*8.0_rt/12.0_rt;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff3=dtfast_lev*1.0_rt/12.0_rt;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff4=2.0_rt/5.0_rt;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff5=1.0_rt-cff4;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            ParallelFor(tbxp1,</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            {</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff=cff1*((DUon(i,j,0)-DUon(i+1,j,0))+</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                               (DVom(i,j,0)-DVom(i,j+1,0)));</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                zeta_new(i,j,0)=zeta(i,j,0,kstp)+</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                    pm(i,j,0)*pn(i,j,0)*(cff+</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                                         cff2*rzeta(i,j,0,kstp)-</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                                         cff3*rzeta(i,j,0,ptsk));</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                Dnew(i,j,0)=zeta_new(i,j,0)+h(i,j,0);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                <span class="comment">//Pressure gradient terms</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                zwrk(i,j,0)=cff5*zeta_new(i,j,0)+cff4*zeta(i,j,0,krhs);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                gzeta(i,j,0)=(fac+rhoS(i,j,0))*zwrk(i,j,0);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                gzeta2(i,j,0)=gzeta(i,j,0)*zwrk(i,j,0);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                gzetaSA(i,j,0)=zwrk(i,j,0)*(rhoS(i,j,0)-rhoA(i,j,0));</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            });</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        }</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <span class="comment">//  Load new free-surface values into shared array at both predictor</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="comment">//  and corrector steps.</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">        //// zeta(knew) only valid at zeta_new, i.e. tbxp1</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment"></span>        ParallelFor(gbx1,</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            zeta(i,j,0,knew)=zeta_new(i,j,0);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        });</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="comment">//  If predictor step, load right-side-term into shared array.</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="keywordflow">if</span> (predictor_2d_step) {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            ParallelFor(gbx1,</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                rzeta(i,j,0,krhs)=rhs_zeta(i,j,0);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            });</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="comment">//  Compute right-hand-side for the 2D momentum equations.</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">!  Compute pressure gradient terms.</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1 = 0.5 * <a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#aeee9d0099e1ac4105829345280a4f03c">g</a>; <span class="comment">// Should be the variable gravitational field strength</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2 = 1.0 / 3.0;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        ParallelFor(xbxD,</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;          rhs_ubar(i,j,0)=cff1*on_u(i,j,0)*</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                        ((    h(i-1,j,0) +     h(i,j,0))*</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                         (gzeta(i-1,j,0) - gzeta(i,j,0))+</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                         (    h(i-1,j,0) -     h(i,j,0))*</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                         (      gzetaSA(i-1,j,0) + gzetaSA(i,j,0)+</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                          cff2*(   rhoA(i-1,j,0) -    rhoA(i,j,0))*</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                               (   zwrk(i-1,j,0) -    zwrk(i,j,0)))+</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                         (gzeta2(i-1,j,0)- gzeta2(i  ,j,0)));</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        });</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        ParallelFor(ybxD,</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            rhs_vbar(i,j,0) = cff1*om_v(i,j,0)*</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                          ((    h(i,j-1,0) +     h(i,j,0))*</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                           (gzeta(i,j-1,0) - gzeta(i,j,0))+</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                           (    h(i,j-1,0) -     h(i,j,0))*</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                           (gzetaSA(i,j-1,0)+ gzetaSA(i,j  ,0)+</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                            cff2*(rhoA(i,j-1,0)- rhoA(i,j  ,0))*</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                                 (zwrk(i,j-1,0)- zwrk(i,j  ,0)))+</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                           (gzeta2(i,j-1,0)- gzeta2(i,j  ,0)));</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        });</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;       <span class="comment">// Advection terms for 2d ubar, vbar added to rhs_ubar and rhs_vbar</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;       <span class="comment">//</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;       <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;       <span class="comment">// rhs_uv_2d</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;       <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;       <span class="comment">//</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;       <a class="code" href="classROMSX.html#a1c78b061e07c56adac2e9732485480fc">rhs_uv_2d</a>(xbxD, ybxD, ubar, vbar, rhs_ubar, rhs_vbar, DUon, DVom, krhs);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;       <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;       <span class="comment">// Add Coriolis forcing</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;       <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;       <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a9e86533aa6df5bf6408d91f0dfd23606">use_coriolis</a>) {</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <span class="comment">// Coriolis terms for 2d ubar, vbar added to rhs_ubar and rhs_vbar</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <span class="comment">// coriolis</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            <a class="code" href="classROMSX.html#afa92192721003020501bef87d5f4a667">coriolis</a>(xbxD, ybxD, ubar, vbar, rhs_ubar, rhs_vbar, Drhs, fomn, krhs, 0);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;       }</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;       <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;       <span class="comment">//Add in horizontal harmonic viscosity.</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;       <span class="comment">// Consider generalizing or copying uv3dmix, where Drhs is used instead of Hz and u=&gt;ubar v=&gt;vbar, drop dt terms</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;       <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;       <a class="code" href="classROMSX.html#ace94faecb215ee9b4fdbc03e0cdaabdb">uv3dmix</a>(xbxD, ybxD, ubar, vbar, ubar, vbar, rhs_ubar, rhs_vbar,</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;               visc2_p, visc2_r, Drhs, on_r, om_r, on_p, om_p, pn, pm, krhs, nnew, 0.0);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160; </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;       <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;       <span class="comment">// Coupling from 3d to 2d</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;       <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;       <span class="keywordflow">if</span> (first_2d_step&amp;&amp;predictor_2d_step)</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;       {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            <span class="keywordflow">if</span> (iic==ntfirst) {</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                ParallelFor(xbxD,</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                    rufrc(i,j,0)    -= rhs_ubar(i,j,0);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                    rhs_ubar(i,j,0) += rufrc(i,j,0);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                    ru(i,j,-1,nstp)  = rufrc(i,j,0);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                });</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                ParallelFor(ybxD,</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                    rvfrc(i,j,0)    -= rhs_vbar(i,j,0);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                    rhs_vbar(i,j,0) += rvfrc(i,j,0);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                    rv(i,j,-1,nstp)  = rvfrc(i,j,0);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                });</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iic==(ntfirst+1)) {</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                ParallelFor(xbxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                {</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                    rufrc(i,j,0)=rufrc(i,j,0)-rhs_ubar(i,j,0);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                    rhs_ubar(i,j,0)=rhs_ubar(i,j,0)+1.5_rt*rufrc(i,j,0)-0.5_rt*ru(i,j,-1,0);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                    ru(i,j,-1,1)=rufrc(i,j,0);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> r_swap= ru(i,j,-1,1);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                    ru(i,j,-1,1) = ru(i,j,-1,0);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                    ru(i,j,-1,0) = r_swap;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                });</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                ParallelFor(ybxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                    rvfrc(i,j,0)=rvfrc(i,j,0)-rhs_vbar(i,j,0);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                    rhs_vbar(i,j,0)=rhs_vbar(i,j,0)+1.5_rt*rvfrc(i,j,0)-0.5_rt*rv(i,j,-1,0);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                    rv(i,j,-1,1)=rvfrc(i,j,0);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> r_swap= rv(i,j,-1,1);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                    rv(i,j,-1,1) = rv(i,j,-1,0);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                    rv(i,j,-1,0) = r_swap;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                });</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                cff1=23.0_rt/12.0_rt;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                cff2=16.0_rt/12.0_rt;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff3= 5.0_rt/12.0_rt;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                ParallelFor(xbxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                {</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                    rufrc(i,j,0)=rufrc(i,j,0)-rhs_ubar(i,j,0);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                    rhs_ubar(i,j,0)=rhs_ubar(i,j,0)+</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                        cff1*rufrc(i,j,0)-</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                        cff2*ru(i,j,-1,0)+</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                        cff3*ru(i,j,-1,1);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                    ru(i,j,-1,1)=rufrc(i,j,0);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> r_swap= ru(i,j,-1,1);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                    ru(i,j,-1,1) = ru(i,j,-1,0);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                    ru(i,j,-1,0) = r_swap;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                });</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                ParallelFor(ybxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                    rvfrc(i,j,0)=rvfrc(i,j,0)-rhs_vbar(i,j,0);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                    rhs_vbar(i,j,0)=rhs_vbar(i,j,0)+</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                          cff1*rvfrc(i,j,0)-</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                          cff2*rv(i,j,-1,0)+</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                          cff3*rv(i,j,-1,1);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                    rv(i,j,-1,1)=rvfrc(i,j,0);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> r_swap= rv(i,j,-1,1);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                    rv(i,j,-1,1) = rv(i,j,-1,0);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                    rv(i,j,-1,0) = r_swap;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                });</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            }</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;       } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            ParallelFor(xbxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            {</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                rhs_ubar(i,j,0) += rufrc(i,j,0);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            });</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            ParallelFor(ybxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                rhs_vbar(i,j,0) += rvfrc(i,j,0);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            });</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        }</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        <span class="comment">//  Time step 2D momentum equations.</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        <span class="comment">//  Compute total water column depth.</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        ParallelFor(makeSlab(tbxp3,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;              Dstp(i,j,0)=zeta(i,j,0,kstp)+h(i,j,0);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        });</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <span class="comment">//  During the first time-step, the predictor step is Forward-Euler</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="comment">//  and the corrector step is Backward-Euler. Otherwise, the predictor</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="comment">//  step is Leap-frog and the corrector step is Adams-Moulton.</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="keywordflow">if</span> (my_iif==0) {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            cff1=0.5_rt*dtfast_lev;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            ParallelFor(xbxD,</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            {</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff=(pm(i,j,0)+pm(i-1,j,0))*(pn(i,j,0)+pn(i-1,j,0));</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Dnew_avg =1.0_rt/(Dnew(i,j,0)+Dnew(i-1,j,0));</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                ubar(i,j,0,knew)=(ubar(i,j,0,kstp)*</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                                 (Dstp(i,j,0)+Dstp(i-1,j,0))+</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                                  cff*cff1*rhs_ubar(i,j,0))*Dnew_avg;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            });</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            ParallelFor(ybxD,</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            {</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff=(pm(i,j,0)+pm(i,j-1,0))*(pn(i,j,0)+pn(i,j-1,0));</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Dnew_avg=1.0_rt/(Dnew(i,j,0)+Dnew(i,j-1,0));</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                vbar(i,j,0,knew)=(vbar(i,j,0,kstp)*</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                                 (Dstp(i,j,0)+Dstp(i,j-1,0))+</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                                  cff*cff1*rhs_vbar(i,j,0))*Dnew_avg;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            });</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160; </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (predictor_2d_step) {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            cff1=dtfast_lev;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            ParallelFor(xbxD,</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            {</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff=(pm(i,j,0)+pm(i-1,j,0))*(pn(i,j,0)+pn(i-1,j,0));</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Dnew_avg=1.0_rt/(Dnew(i,j,0)+Dnew(i-1,j,0));</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                ubar(i,j,0,knew)=(ubar(i,j,0,kstp)*</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                                 (Dstp(i,j,0)+Dstp(i-1,j,0))+</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                                  cff*cff1*rhs_ubar(i,j,0))*Dnew_avg;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            });</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            ParallelFor(ybxD,</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            {</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff=(pm(i,j,0)+pm(i,j-1,0))*(pn(i,j,0)+pn(i,j-1,0));</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Dnew_avg=1.0_rt/(Dnew(i,j,0)+Dnew(i,j-1,0));</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                vbar(i,j,0,knew)=(vbar(i,j,0,kstp)*</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                                 (Dstp(i,j,0)+Dstp(i,j-1,0))+</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                                  cff*cff1*rhs_vbar(i,j,0))*Dnew_avg;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            });</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((!predictor_2d_step)) {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160; </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            cff1=0.5_rt*dtfast_lev*5.0_rt/12.0_rt;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            cff2=0.5_rt*dtfast_lev*8.0_rt/12.0_rt;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff3=0.5_rt*dtfast_lev*1.0_rt/12.0_rt;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            ParallelFor(xbxD,</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff=(pm(i,j,0)+pm(i-1,j,0))*(pn(i,j,0)+pn(i-1,j,0));</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Dnew_avg=1.0_rt/(Dnew(i,j,0)+Dnew(i-1,j,0));</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                ubar(i,j,0,knew)=(ubar(i,j,0,kstp)*</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                                 (Dstp(i,j,0)+Dstp(i-1,j,0))+</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                                 cff*(cff1*rhs_ubar(i,j,0)+</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                                      cff2*rubar(i,j,0,kstp)-</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                                      cff3*rubar(i,j,0,ptsk)))*Dnew_avg;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            });</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            ParallelFor(ybxD,</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff=(pm(i,j,0)+pm(i,j-1,0))*(pn(i,j,0)+pn(i,j-1,0));</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Dnew_avg=1.0_rt/(Dnew(i,j,0)+Dnew(i,j-1,0));</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                vbar(i,j,0,knew)=(vbar(i,j,0,kstp)*</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                                 (Dstp(i,j,0)+Dstp(i,j-1,0))+</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                                 cff*(cff1*rhs_vbar(i,j,0)+</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                                      cff2*rvbar(i,j,0,kstp)-</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                                      cff3*rvbar(i,j,0,ptsk)))*Dnew_avg;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            });</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        }</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        <span class="comment">//store rhs_ubar and rhs_vbar to save later</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        <span class="comment">//  If predictor step, load right-side-term into shared arrays for</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <span class="comment">//  future use during the subsequent corrector step.</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160; </div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        <span class="keywordflow">if</span> (predictor_2d_step) {</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            ParallelFor(xbxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            {</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                rubar(i,j,0,krhs)=rhs_ubar(i,j,0);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            });</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            ParallelFor(ybxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            {</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                rvbar(i,j,0,krhs)=rhs_vbar(i,j,0);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            });</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        }</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;}</div>
<div class="ttc" id="aDataStruct_8H_html_a627f1f843904477f763577ad1460de01a415290769594460e2e485922904f345d"><div class="ttname"><a href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01a415290769594460e2e485922904f345d">Coord::y</a></div><div class="ttdeci">@ y</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a124da9e47fb1b1f3debaf49368f42e38"><div class="ttname"><a href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a></div><div class="ttdeci">#define NGROW</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:13</div></div>
<div class="ttc" id="aclassROMSX_html_a1781a7c54d695e8889f2d394062b85a7"><div class="ttname"><a href="classROMSX.html#a1781a7c54d695e8889f2d394062b85a7">ROMSX::vec_weight2</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; vec_weight2</div><div class="ttdef"><b>Definition:</b> ROMSX.H:280</div></div>
<div class="ttc" id="aclassROMSX_html_a1c78b061e07c56adac2e9732485480fc"><div class="ttname"><a href="classROMSX.html#a1c78b061e07c56adac2e9732485480fc">ROMSX::rhs_uv_2d</a></div><div class="ttdeci">void rhs_uv_2d(const amrex::Box &amp;xbx, const amrex::Box &amp;ybx, amrex::Array4&lt; amrex::Real &gt; uold, amrex::Array4&lt; amrex::Real &gt; vold, amrex::Array4&lt; amrex::Real &gt; ru, amrex::Array4&lt; amrex::Real &gt; rv, amrex::Array4&lt; amrex::Real &gt; Huon, amrex::Array4&lt; amrex::Real &gt; Hvom, int nrhs)</div><div class="ttdef"><b>Definition:</b> ROMSX_rhs_uv_2d.cpp:20</div></div>
<div class="ttc" id="aclassROMSX_html_a55d028f9a1e55a035ab877607ac326fe"><div class="ttname"><a href="classROMSX.html#a55d028f9a1e55a035ab877607ac326fe">ROMSX::vec_weight1</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; vec_weight1</div><div class="ttdef"><b>Definition:</b> ROMSX.H:279</div></div>
<div class="ttc" id="aclassROMSX_html_ace94faecb215ee9b4fdbc03e0cdaabdb"><div class="ttname"><a href="classROMSX.html#ace94faecb215ee9b4fdbc03e0cdaabdb">ROMSX::uv3dmix</a></div><div class="ttdeci">void uv3dmix(const amrex::Box &amp;xbx, const amrex::Box &amp;ybx, amrex::Array4&lt; amrex::Real &gt; u, amrex::Array4&lt; amrex::Real &gt; v, amrex::Array4&lt; amrex::Real &gt; uold, amrex::Array4&lt; amrex::Real &gt; vold, amrex::Array4&lt; amrex::Real &gt; rufrc, amrex::Array4&lt; amrex::Real &gt; rvfrc, amrex::Array4&lt; amrex::Real &gt; visc2_p, amrex::Array4&lt; amrex::Real &gt; visc2_r, amrex::Array4&lt; amrex::Real &gt; Hz, amrex::Array4&lt; amrex::Real &gt; om_r, amrex::Array4&lt; amrex::Real &gt; on_r, amrex::Array4&lt; amrex::Real &gt; om_p, amrex::Array4&lt; amrex::Real &gt; on_p, amrex::Array4&lt; amrex::Real &gt; pm, amrex::Array4&lt; amrex::Real &gt; pn, int nrhs, int nnew, const amrex::Real dt_lev)</div><div class="ttdef"><b>Definition:</b> ROMSX_uv3dmix.cpp:6</div></div>
<div class="ttc" id="aclassROMSX_html_afa92192721003020501bef87d5f4a667"><div class="ttname"><a href="classROMSX.html#afa92192721003020501bef87d5f4a667">ROMSX::coriolis</a></div><div class="ttdeci">void coriolis(const amrex::Box &amp;xbx, const amrex::Box &amp;ybx, amrex::Array4&lt; amrex::Real &gt; uold, amrex::Array4&lt; amrex::Real &gt; vold, amrex::Array4&lt; amrex::Real &gt; ru, amrex::Array4&lt; amrex::Real &gt; rv, amrex::Array4&lt; amrex::Real &gt; Hz, amrex::Array4&lt; amrex::Real &gt; fomn, int nrhs, int nr)</div><div class="ttdef"><b>Definition:</b> ROMSX_coriolis.cpp:10</div></div>
<div class="ttc" id="astructSolverChoice_html_a0d7c9053be4054e355768bf3c17bf029"><div class="ttname"><a href="structSolverChoice.html#a0d7c9053be4054e355768bf3c17bf029">SolverChoice::coriolis_beta</a></div><div class="ttdeci">amrex::Real coriolis_beta</div><div class="ttdef"><b>Definition:</b> DataStruct.H:192</div></div>
<div class="ttc" id="astructSolverChoice_html_a3a0b717e880c818de989b2e92c199d34"><div class="ttname"><a href="structSolverChoice.html#a3a0b717e880c818de989b2e92c199d34">SolverChoice::coriolis_f0</a></div><div class="ttdeci">amrex::Real coriolis_f0</div><div class="ttdef"><b>Definition:</b> DataStruct.H:191</div></div>
<div class="ttc" id="astructSolverChoice_html_a9e86533aa6df5bf6408d91f0dfd23606"><div class="ttname"><a href="structSolverChoice.html#a9e86533aa6df5bf6408d91f0dfd23606">SolverChoice::use_coriolis</a></div><div class="ttdeci">bool use_coriolis</div><div class="ttdef"><b>Definition:</b> DataStruct.H:158</div></div>
<div class="ttc" id="astructSolverChoice_html_aeee9d0099e1ac4105829345280a4f03c"><div class="ttname"><a href="structSolverChoice.html#aeee9d0099e1ac4105829345280a4f03c">SolverChoice::g</a></div><div class="ttdeci">amrex::Real g</div><div class="ttdef"><b>Definition:</b> DataStruct.H:195</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8fa9ebf787a2bcd053f235b50e5dbac3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fa9ebf787a2bcd053f235b50e5dbac3">&#9670;&nbsp;</a></span>advance_2d_onestep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::advance_2d_onestep </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dtfast_lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>my_iif</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nfast_counter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>2D advance, one predictor/corrector step </p>
<div class="fragment"><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;{</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    <span class="keywordtype">bool</span> first_2d_step=(my_iif==0);</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    <span class="comment">// These are needed to pass ctests</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dummy_time = 0.0;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, dummy_time, *<a class="code" href="classROMSX.html#a047f6faef02a00ced0a6c1766e4c9b5a">vec_ubar</a>[lev], GetVecOfPtrs(<a class="code" href="classROMSX.html#a047f6faef02a00ced0a6c1766e4c9b5a">vec_ubar</a>));</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, dummy_time, *<a class="code" href="classROMSX.html#a2a375f2e83347418b7cf5d4bd812ee55">vec_vbar</a>[lev], GetVecOfPtrs(<a class="code" href="classROMSX.html#a2a375f2e83347418b7cf5d4bd812ee55">vec_vbar</a>));</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="comment">//Predictor</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keywordtype">bool</span> predictor_2d_step=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keywordtype">int</span> next_indx1 = 0;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <a class="code" href="classROMSX.html#a00ce68e5a1dd4a3db8e47bc28f4f9c73">advance_2d</a>(lev,</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;               <a class="code" href="classROMSX.html#a20d43f4b49b92542c1790c1ea01ca19c">vec_rhoS</a>[lev].get() , <a class="code" href="classROMSX.html#a0978a71210c5f05a5541002532bd9cd2">vec_rhoA</a>[lev].get(),</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;               <a class="code" href="classROMSX.html#ab1343869d59f89fd4773bc7fa230aa73">vec_ru</a>[lev].get()   , <a class="code" href="classROMSX.html#ab5041f0f370ab1ec4f7f7e16127c9039">vec_rv</a>[lev].get(),</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;               <a class="code" href="classROMSX.html#ab5b7ff78a167e59ae727b22094b39079">vec_rufrc</a>[lev].get(), <a class="code" href="classROMSX.html#a52a5f265a370595f128046c31b9f31d5">vec_rvfrc</a>[lev].get(),</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;               <a class="code" href="classROMSX.html#ab962f23dc27b3ce17bb19e3b8c9991f8">vec_Zt_avg1</a>[lev].get(),</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;               <a class="code" href="classROMSX.html#a18212e9657c0655cd29e0c6241c1224f">vec_DU_avg1</a>[lev], <a class="code" href="classROMSX.html#a883756f67229729f133b9bdf784c21ff">vec_DU_avg2</a>[lev],</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;               <a class="code" href="classROMSX.html#aa9738d90727df4f8aba2afb0ffed1e8f">vec_DV_avg1</a>[lev], <a class="code" href="classROMSX.html#a6847259dab9f6118da780bf623a9868a">vec_DV_avg2</a>[lev],</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;               <a class="code" href="classROMSX.html#ab5d263be53bfdd397f6c64672ee77009">vec_rubar</a>[lev], <a class="code" href="classROMSX.html#a83d781ead821f8ed29f6f2b9ef70a9aa">vec_rvbar</a>[lev], <a class="code" href="classROMSX.html#ac2324a5a8d5949f83ac7621ef79f8fdd">vec_rzeta</a>[lev],</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                <a class="code" href="classROMSX.html#a047f6faef02a00ced0a6c1766e4c9b5a">vec_ubar</a>[lev],  <a class="code" href="classROMSX.html#a2a375f2e83347418b7cf5d4bd812ee55">vec_vbar</a>[lev],  <a class="code" href="classROMSX.html#ab026fffd3c4e9a9ef612cbb23132a1f5">vec_zeta</a>[lev],</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;               <a class="code" href="classROMSX.html#a03b79a651abf3dc2bd37fadaca99fd46">vec_hOfTheConfusingName</a>[lev].get(), <a class="code" href="classROMSX.html#af83a943f37cd6bbaf25c52fcaceb0930">vec_visc2_p</a>[lev], <a class="code" href="classROMSX.html#aa8fff925fc76e919ddc53de08b3725e9">vec_visc2_r</a>[lev],</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;               dtfast_lev, predictor_2d_step, first_2d_step, my_iif, next_indx1);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">//Corrector. Skip it on last fast step</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    predictor_2d_step=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordflow">if</span> (my_iif &lt; nfast_counter - 1) {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        <span class="comment">// These are needed to pass ctests</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, dummy_time, *<a class="code" href="classROMSX.html#a047f6faef02a00ced0a6c1766e4c9b5a">vec_ubar</a>[lev], GetVecOfPtrs(<a class="code" href="classROMSX.html#a047f6faef02a00ced0a6c1766e4c9b5a">vec_ubar</a>));</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, dummy_time, *<a class="code" href="classROMSX.html#a2a375f2e83347418b7cf5d4bd812ee55">vec_vbar</a>[lev], GetVecOfPtrs(<a class="code" href="classROMSX.html#a2a375f2e83347418b7cf5d4bd812ee55">vec_vbar</a>));</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <a class="code" href="classROMSX.html#a00ce68e5a1dd4a3db8e47bc28f4f9c73">advance_2d</a>(lev,</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                   <a class="code" href="classROMSX.html#a20d43f4b49b92542c1790c1ea01ca19c">vec_rhoS</a>[lev].get(), <a class="code" href="classROMSX.html#a0978a71210c5f05a5541002532bd9cd2">vec_rhoA</a>[lev].get(),</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                   <a class="code" href="classROMSX.html#ab1343869d59f89fd4773bc7fa230aa73">vec_ru</a>[lev].get(), <a class="code" href="classROMSX.html#ab5041f0f370ab1ec4f7f7e16127c9039">vec_rv</a>[lev].get(),</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                   <a class="code" href="classROMSX.html#ab5b7ff78a167e59ae727b22094b39079">vec_rufrc</a>[lev].get(), <a class="code" href="classROMSX.html#a52a5f265a370595f128046c31b9f31d5">vec_rvfrc</a>[lev].get(),</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                   <a class="code" href="classROMSX.html#ab962f23dc27b3ce17bb19e3b8c9991f8">vec_Zt_avg1</a>[lev].get(),</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                   <a class="code" href="classROMSX.html#a18212e9657c0655cd29e0c6241c1224f">vec_DU_avg1</a>[lev], <a class="code" href="classROMSX.html#a883756f67229729f133b9bdf784c21ff">vec_DU_avg2</a>[lev],</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                   <a class="code" href="classROMSX.html#aa9738d90727df4f8aba2afb0ffed1e8f">vec_DV_avg1</a>[lev], <a class="code" href="classROMSX.html#a6847259dab9f6118da780bf623a9868a">vec_DV_avg2</a>[lev],</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                   <a class="code" href="classROMSX.html#ab5d263be53bfdd397f6c64672ee77009">vec_rubar</a>[lev], <a class="code" href="classROMSX.html#a83d781ead821f8ed29f6f2b9ef70a9aa">vec_rvbar</a>[lev], <a class="code" href="classROMSX.html#ac2324a5a8d5949f83ac7621ef79f8fdd">vec_rzeta</a>[lev],</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                    <a class="code" href="classROMSX.html#a047f6faef02a00ced0a6c1766e4c9b5a">vec_ubar</a>[lev],  <a class="code" href="classROMSX.html#a2a375f2e83347418b7cf5d4bd812ee55">vec_vbar</a>[lev],  <a class="code" href="classROMSX.html#ab026fffd3c4e9a9ef612cbb23132a1f5">vec_zeta</a>[lev],</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                   <a class="code" href="classROMSX.html#a03b79a651abf3dc2bd37fadaca99fd46">vec_hOfTheConfusingName</a>[lev].get(), <a class="code" href="classROMSX.html#af83a943f37cd6bbaf25c52fcaceb0930">vec_visc2_p</a>[lev], <a class="code" href="classROMSX.html#aa8fff925fc76e919ddc53de08b3725e9">vec_visc2_r</a>[lev],</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                   dtfast_lev, predictor_2d_step, first_2d_step, my_iif, next_indx1);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;}</div>
<div class="ttc" id="aclassROMSX_html_a00ce68e5a1dd4a3db8e47bc28f4f9c73"><div class="ttname"><a href="classROMSX.html#a00ce68e5a1dd4a3db8e47bc28f4f9c73">ROMSX::advance_2d</a></div><div class="ttdeci">void advance_2d(int lev, amrex::MultiFab const *mf_rhoS, amrex::MultiFab const *mf_rhoA, amrex::MultiFab *mf_ru, amrex::MultiFab *mf_rv, amrex::MultiFab *mf_rufrc, amrex::MultiFab *mf_rvfrc, amrex::MultiFab *mf_Zt_avg1, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DU_avg1, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DU_avg2, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DV_avg1, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DV_avg2, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_rubar, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_rvbar, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_rzeta, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_ubar, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_vbar, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_zeta, amrex::MultiFab const *mf_h, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_visc2_p, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_visc2_r, const amrex::Real dtfast_lev, const bool predictor_2d_step, const bool first_2d_step, int my_iif, int &amp;next_indx1)</div><div class="ttdef"><b>Definition:</b> ROMSX_advance_2d.cpp:39</div></div>
<div class="ttc" id="aclassROMSX_html_a03b79a651abf3dc2bd37fadaca99fd46"><div class="ttname"><a href="classROMSX.html#a03b79a651abf3dc2bd37fadaca99fd46">ROMSX::vec_hOfTheConfusingName</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_hOfTheConfusingName</div><div class="ttdef"><b>Definition:</b> ROMSX.H:198</div></div>
<div class="ttc" id="aclassROMSX_html_a047f6faef02a00ced0a6c1766e4c9b5a"><div class="ttname"><a href="classROMSX.html#a047f6faef02a00ced0a6c1766e4c9b5a">ROMSX::vec_ubar</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_ubar</div><div class="ttdef"><b>Definition:</b> ROMSX.H:265</div></div>
<div class="ttc" id="aclassROMSX_html_a0978a71210c5f05a5541002532bd9cd2"><div class="ttname"><a href="classROMSX.html#a0978a71210c5f05a5541002532bd9cd2">ROMSX::vec_rhoA</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_rhoA</div><div class="ttdef"><b>Definition:</b> ROMSX.H:277</div></div>
<div class="ttc" id="aclassROMSX_html_a18212e9657c0655cd29e0c6241c1224f"><div class="ttname"><a href="classROMSX.html#a18212e9657c0655cd29e0c6241c1224f">ROMSX::vec_DU_avg1</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_DU_avg1</div><div class="ttdef"><b>Definition:</b> ROMSX.H:251</div></div>
<div class="ttc" id="aclassROMSX_html_a20d43f4b49b92542c1790c1ea01ca19c"><div class="ttname"><a href="classROMSX.html#a20d43f4b49b92542c1790c1ea01ca19c">ROMSX::vec_rhoS</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_rhoS</div><div class="ttdef"><b>Definition:</b> ROMSX.H:276</div></div>
<div class="ttc" id="aclassROMSX_html_a2a375f2e83347418b7cf5d4bd812ee55"><div class="ttname"><a href="classROMSX.html#a2a375f2e83347418b7cf5d4bd812ee55">ROMSX::vec_vbar</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_vbar</div><div class="ttdef"><b>Definition:</b> ROMSX.H:267</div></div>
<div class="ttc" id="aclassROMSX_html_a52a5f265a370595f128046c31b9f31d5"><div class="ttname"><a href="classROMSX.html#a52a5f265a370595f128046c31b9f31d5">ROMSX::vec_rvfrc</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_rvfrc</div><div class="ttdef"><b>Definition:</b> ROMSX.H:213</div></div>
<div class="ttc" id="aclassROMSX_html_a6847259dab9f6118da780bf623a9868a"><div class="ttname"><a href="classROMSX.html#a6847259dab9f6118da780bf623a9868a">ROMSX::vec_DV_avg2</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_DV_avg2</div><div class="ttdef"><b>Definition:</b> ROMSX.H:257</div></div>
<div class="ttc" id="aclassROMSX_html_a83d781ead821f8ed29f6f2b9ef70a9aa"><div class="ttname"><a href="classROMSX.html#a83d781ead821f8ed29f6f2b9ef70a9aa">ROMSX::vec_rvbar</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_rvbar</div><div class="ttdef"><b>Definition:</b> ROMSX.H:261</div></div>
<div class="ttc" id="aclassROMSX_html_a883756f67229729f133b9bdf784c21ff"><div class="ttname"><a href="classROMSX.html#a883756f67229729f133b9bdf784c21ff">ROMSX::vec_DU_avg2</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_DU_avg2</div><div class="ttdef"><b>Definition:</b> ROMSX.H:253</div></div>
<div class="ttc" id="aclassROMSX_html_aa8fff925fc76e919ddc53de08b3725e9"><div class="ttname"><a href="classROMSX.html#aa8fff925fc76e919ddc53de08b3725e9">ROMSX::vec_visc2_r</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_visc2_r</div><div class="ttdef"><b>Definition:</b> ROMSX.H:221</div></div>
<div class="ttc" id="aclassROMSX_html_aa9738d90727df4f8aba2afb0ffed1e8f"><div class="ttname"><a href="classROMSX.html#aa9738d90727df4f8aba2afb0ffed1e8f">ROMSX::vec_DV_avg1</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_DV_avg1</div><div class="ttdef"><b>Definition:</b> ROMSX.H:255</div></div>
<div class="ttc" id="aclassROMSX_html_ab026fffd3c4e9a9ef612cbb23132a1f5"><div class="ttname"><a href="classROMSX.html#ab026fffd3c4e9a9ef612cbb23132a1f5">ROMSX::vec_zeta</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_zeta</div><div class="ttdef"><b>Definition:</b> ROMSX.H:269</div></div>
<div class="ttc" id="aclassROMSX_html_ab1343869d59f89fd4773bc7fa230aa73"><div class="ttname"><a href="classROMSX.html#ab1343869d59f89fd4773bc7fa230aa73">ROMSX::vec_ru</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_ru</div><div class="ttdef"><b>Definition:</b> ROMSX.H:207</div></div>
<div class="ttc" id="aclassROMSX_html_ab5041f0f370ab1ec4f7f7e16127c9039"><div class="ttname"><a href="classROMSX.html#ab5041f0f370ab1ec4f7f7e16127c9039">ROMSX::vec_rv</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_rv</div><div class="ttdef"><b>Definition:</b> ROMSX.H:209</div></div>
<div class="ttc" id="aclassROMSX_html_ab5b7ff78a167e59ae727b22094b39079"><div class="ttname"><a href="classROMSX.html#ab5b7ff78a167e59ae727b22094b39079">ROMSX::vec_rufrc</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_rufrc</div><div class="ttdef"><b>Definition:</b> ROMSX.H:211</div></div>
<div class="ttc" id="aclassROMSX_html_ab5d263be53bfdd397f6c64672ee77009"><div class="ttname"><a href="classROMSX.html#ab5d263be53bfdd397f6c64672ee77009">ROMSX::vec_rubar</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_rubar</div><div class="ttdef"><b>Definition:</b> ROMSX.H:259</div></div>
<div class="ttc" id="aclassROMSX_html_ab962f23dc27b3ce17bb19e3b8c9991f8"><div class="ttname"><a href="classROMSX.html#ab962f23dc27b3ce17bb19e3b8c9991f8">ROMSX::vec_Zt_avg1</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_Zt_avg1</div><div class="ttdef"><b>Definition:</b> ROMSX.H:238</div></div>
<div class="ttc" id="aclassROMSX_html_abb9e3a06ecbafa6f4860576cc80db30c"><div class="ttname"><a href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">ROMSX::FillPatch</a></div><div class="ttdeci">void FillPatch(int lev, amrex::Real time, amrex::MultiFab &amp;mf_to_be_filled, amrex::Vector&lt; amrex::MultiFab * &gt; const &amp;mfs)</div><div class="ttdef"><b>Definition:</b> ROMSX_FillPatch.cpp:16</div></div>
<div class="ttc" id="aclassROMSX_html_ac2324a5a8d5949f83ac7621ef79f8fdd"><div class="ttname"><a href="classROMSX.html#ac2324a5a8d5949f83ac7621ef79f8fdd">ROMSX::vec_rzeta</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_rzeta</div><div class="ttdef"><b>Definition:</b> ROMSX.H:263</div></div>
<div class="ttc" id="aclassROMSX_html_af83a943f37cd6bbaf25c52fcaceb0930"><div class="ttname"><a href="classROMSX.html#af83a943f37cd6bbaf25c52fcaceb0930">ROMSX::vec_visc2_p</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_visc2_p</div><div class="ttdef"><b>Definition:</b> ROMSX.H:219</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4e9c23866425937fcf943fc31dbf0884"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e9c23866425937fcf943fc31dbf0884">&#9670;&nbsp;</a></span>advance_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::advance_3d </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf_cons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_sstore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_ru</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_rv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_DU_avg1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_DU_avg2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_DV_avg1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_DV_avg2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_ubar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_vbar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_Akv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_Akt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_Huon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_Hvom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_z_w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Advance the 3D variables </p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;{</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nrhs  = 0;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nnew  = 0;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keyword">const</span> GpuArray&lt;Real,AMREX_SPACEDIM&gt; dx  = Geom(lev).CellSizeArray();</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keyword">const</span> GpuArray&lt;Real,AMREX_SPACEDIM&gt; dxi = Geom(lev).InvCellSizeArray();</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordtype">int</span> iic = <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[lev];</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordtype">int</span> ntfirst = 0;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">// Because zeta may have changed</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="classROMSX.html#aad35c03f38c28e55791b50da18f2604c">stretch_transform</a>(lev);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// These temporaries used to be made in advance_3d_ml and passed in;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">// now we make them here</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keyword">const</span> BoxArray&amp;            ba = mf_cons.boxArray();</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keyword">const</span> DistributionMapping&amp; dm = mf_cons.DistributionMap();</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">//Only used locally, probably should be rearranged into FArrayBox declaration</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    MultiFab mf_AK (ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));       <span class="comment">//2d missing j coordinate</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    MultiFab mf_DC (ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1)); <span class="comment">//2d missing j coordinate</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    MultiFab mf_Hzk(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1)); <span class="comment">//2d missing j coordinate</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(mf_cons, TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; u = mf_u.array(mfi);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; v = mf_v.array(mfi);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; ru = mf_ru-&gt;array(mfi);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; rv = mf_rv-&gt;array(mfi);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; AK = mf_AK.array(mfi);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; DC = mf_DC.array(mfi);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Hzk = mf_Hzk.array(mfi);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Akv = mf_Akv-&gt;array(mfi);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; Hz  = mf_Hz-&gt;const_array(mfi);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; DU_avg1  = mf_DU_avg1-&gt;const_array(mfi);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; DV_avg1  = mf_DV_avg1-&gt;const_array(mfi);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; DU_avg2  = mf_DU_avg2-&gt;array(mfi);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; DV_avg2  = mf_DV_avg2-&gt;array(mfi);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; ubar = mf_ubar-&gt;array(mfi);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; vbar = mf_vbar-&gt;array(mfi);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Huon = mf_Huon-&gt;array(mfi);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Hvom = mf_Hvom-&gt;array(mfi);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        Box bx = mfi.tilebox();</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        Box gbx2 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        Box gbx11 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1));</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        Box gbx21 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1));</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        Box xbx = mfi.nodaltilebox(0);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        Box ybx = mfi.nodaltilebox(1);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        Box gbx2D = gbx2;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        gbx2D.makeSlab(2,0);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        Box tbxp1 = bx;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        Box tbxp11 = bx;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        Box tbxp2 = bx;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        tbxp1.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        tbxp2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        tbxp11.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1));</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        FArrayBox fab_FC(gbx2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        FArrayBox fab_BC(gbx2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        FArrayBox fab_CF(gbx21,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        FArrayBox fab_oHz(gbx11,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        FArrayBox fab_pn(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        FArrayBox fab_pm(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        FArrayBox fab_W(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        FArrayBox fab_on_u(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        FArrayBox fab_om_v(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keyword">auto</span> on_u = fab_on_u.array();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keyword">auto</span> om_v = fab_om_v.array();</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keyword">auto</span> FC = fab_FC.array();</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keyword">auto</span> BC = fab_BC.array();</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keyword">auto</span> CF = fab_CF.array();</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keyword">auto</span> oHz= fab_oHz.array();</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keyword">auto</span> pn=fab_pn.array();</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keyword">auto</span> pm=fab_pm.array();</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="comment">// Update to u and v</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        ParallelFor(amrex::makeSlab(tbxp2,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            pm(i,j,0)=dxi[0];</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            pn(i,j,0)=dxi[1];</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        });</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        fab_on_u.template setVal&lt;RunOn::Device&gt;(dx[1],amrex::makeSlab(tbxp2,2,0));</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        fab_om_v.template setVal&lt;RunOn::Device&gt;(dx[0],amrex::makeSlab(tbxp2,2,0));</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordflow">if</span> (iic==ntfirst) {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;          cff=0.25*dt_lev;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iic==ntfirst+1) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          cff=0.25*dt_lev*3.0/2.0;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;          cff=0.25*dt_lev*23.0/12.0;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        ParallelFor(xbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            u(i,j,k) += cff * (pm(i,j,0)+pm(i-1,j,0)) * (pn(i,j,0)+pn(i-1,j,0)) * ru(i,j,k,nrhs);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            u(i,j,k) *= 2.0 / (Hz(i-1,j,k) + Hz(i,j,k));</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        });</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        ParallelFor(ybx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            v(i,j,k) += cff * (pm(i,j,0)+pm(i,j-1,0)) * (pn(i,j,0)+pn(i,j-1,0)) * rv(i,j,k,nrhs);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            v(i,j,k) *= 2.0 / (Hz(i,j-1,k) + Hz(i,j,k));</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        });</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="comment">// NOTE: DC is only used as scratch in vert_visc_3d -- no need to pass or return a value</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="comment">// NOTE: may not actually need to set these to zero</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="comment">// Reset to zero on the box on which they&#39;ll be used</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        mf_DC[mfi].template setVal&lt;RunOn::Device&gt;(0.,xbx);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        fab_CF.template     setVal&lt;RunOn::Device&gt;(0.,xbx);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <a class="code" href="classROMSX.html#a3a506eb0db4a850e63f4479269a97b38">vert_visc_3d</a>(xbx,1,0,u,Hz,Hzk,oHz,AK,Akv,BC,DC,FC,CF,nnew,N,dt_lev);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="comment">// Reset to zero on the box on which they&#39;ll be used</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        mf_DC[mfi].template setVal&lt;RunOn::Device&gt;(0.,ybx);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        fab_CF.template     setVal&lt;RunOn::Device&gt;(0.,ybx);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <a class="code" href="classROMSX.html#a3a506eb0db4a850e63f4479269a97b38">vert_visc_3d</a>(ybx,0,1,v,Hz,Hzk,oHz,AK,Akv,BC,DC,FC,CF,nnew,N,dt_lev);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="comment">// Reset to zero on the box on which they&#39;ll be used</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        mf_DC[mfi].template setVal&lt;RunOn::Device&gt;(0.,xbx);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        fab_CF.template     setVal&lt;RunOn::Device&gt;(0.,xbx);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <a class="code" href="classROMSX.html#ad3bb9347625aef307add2c82a9b21d10">vert_mean_3d</a>(xbx,1,0,u,Hz,DU_avg1,DC,CF,pm,nnew,N);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="comment">// Reset to zero on the box on which they&#39;ll be used</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        mf_DC[mfi].template setVal&lt;RunOn::Device&gt;(0.,ybx);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        fab_CF.template     setVal&lt;RunOn::Device&gt;(0.,ybx);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <a class="code" href="classROMSX.html#ad3bb9347625aef307add2c82a9b21d10">vert_mean_3d</a>(ybx,0,1,v,Hz,DV_avg1,DC,CF,pn,nnew,N);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="comment">// Reset to zero on the box on which they&#39;ll be used</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        mf_DC[mfi].template setVal&lt;RunOn::Device&gt;(0.,grow(xbx,IntVect(0,0,1)));</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        fab_CF.template     setVal&lt;RunOn::Device&gt;(0.,grow(xbx,IntVect(0,0,1)));</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <a class="code" href="classROMSX.html#a799fe579a21d193e4f1e1a6a1fc74cd9">update_massflux_3d</a>(xbx,1,0,u,ubar,Huon,Hz,on_u,DU_avg1,DU_avg2,DC,FC,nnew);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="comment">// Reset to zero on the box on which they&#39;ll be used</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        mf_DC[mfi].template setVal&lt;RunOn::Device&gt;(0.,grow(ybx,IntVect(0,0,1)));</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        fab_CF.template     setVal&lt;RunOn::Device&gt;(0.,grow(ybx,IntVect(0,0,1)));</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <a class="code" href="classROMSX.html#a799fe579a21d193e4f1e1a6a1fc74cd9">update_massflux_3d</a>(ybx,0,1,v,vbar,Hvom,Hz,om_v,DV_avg1,DV_avg2,DC,FC,nnew);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="comment">// Reset to zero on the box on which they&#39;ll be used</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        fab_FC.template setVal&lt;RunOn::Device&gt;(0.,gbx2);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        mf_DC[mfi].template setVal&lt;RunOn::Device&gt;(0.,grow(gbx2,IntVect(0,0,1)));</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <a class="code" href="classROMSX.html#a799fe579a21d193e4f1e1a6a1fc74cd9">update_massflux_3d</a>(gbx2,1,0,u,ubar,Huon,Hz,on_u,DU_avg1,DU_avg2,DC,FC,nnew);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="comment">// Reset to zero on the box on which they&#39;ll be used</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        fab_FC.template     setVal&lt;RunOn::Device&gt;(0.,gbx2);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        mf_DC[mfi].template setVal&lt;RunOn::Device&gt;(0.,grow(gbx2,IntVect(0,0,1)));</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <a class="code" href="classROMSX.html#a799fe579a21d193e4f1e1a6a1fc74cd9">update_massflux_3d</a>(gbx2,0,1,v,vbar,Hvom,Hz,om_v,DV_avg1,DV_avg2,DC,FC,nnew);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">// WE BELIEVE THESE VALUES SHOULD ALREADY BE FILLED</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// mf_Huon-&gt;FillBoundary(geom[lev].periodicity());</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// mf_Hvom-&gt;FillBoundary(geom[lev].periodicity());</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// ************************************************************************</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// This should fill both temp and salt with temp/salt currently in cons_old</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">// ************************************************************************</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(mf_cons, TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="comment">//Array4&lt;Real&gt; const&amp; tempstore = mf_tempstore-&gt;array(mfi);</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="comment">//Array4&lt;Real&gt; const&amp; saltstore = mf_saltstore-&gt;array(mfi);</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Hz  = mf_Hz-&gt;array(mfi);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Huon = mf_Huon-&gt;array(mfi);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Hvom = mf_Hvom-&gt;array(mfi);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; z_w= (mf_z_w)-&gt;array(mfi);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; h= (mf_h)-&gt;array(mfi);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        Box bx = mfi.tilebox();</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        Box gbx = mfi.growntilebox();</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        Box gbx1 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        Box gbx2 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        Box gbx11 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1));</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        Box gbx21 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1));</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        Box tbxp1 = bx;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        Box tbxp11 = bx;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        Box tbxp2 = bx;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        tbxp1.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        tbxp2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        tbxp11.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1));</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        FArrayBox fab_FC(gbx2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        FArrayBox fab_BC(gbx2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        FArrayBox fab_CF(gbx21,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        FArrayBox fab_oHz(gbx11,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        FArrayBox fab_pn(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        FArrayBox fab_pm(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        FArrayBox fab_W(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        FArrayBox fab_on_u(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        FArrayBox fab_om_v(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keyword">auto</span> FC  = fab_FC.array();</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keyword">auto</span> oHz = fab_oHz.array();</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keyword">auto</span> pn  = fab_pn.array();</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keyword">auto</span> pm  = fab_pm.array();</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keyword">auto</span> W= fab_W.array();</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="comment">// Update to u and v</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        ParallelFor(amrex::makeSlab(tbxp2,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            pm(i,j,0)=dxi[0];</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            pn(i,j,0)=dxi[1];</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        });</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        fab_on_u.template setVal&lt;RunOn::Device&gt;(dx[1],makeSlab(tbxp2,2,0));</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        fab_om_v.template setVal&lt;RunOn::Device&gt;(dx[0],makeSlab(tbxp2,2,0));</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="comment">//------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="comment">//  Vertically integrate horizontal mass flux divergence.</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="comment">//------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="comment">//Should really use gbx3uneven</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="comment">//TODO: go over these boxes and compare to other spots where we do the same thing</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        Box gbx1D = gbx1;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        gbx1D.makeSlab(2,0);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="comment">//  Starting with zero vertical velocity at the bottom, integrate</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="comment">//  from the bottom (k=0) to the free-surface (k=N).  The w(:,:,N(ng))</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="comment">//  contains the vertical velocity at the free-surface, d(zeta)/d(t).</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="comment">//  Notice that barotropic mass flux divergence is not used directly.</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        ParallelFor(gbx1D, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            W(i,j,0) = - (Huon(i+1,j,0)-Huon(i,j,0)) - (Hvom(i,j+1,0)-Hvom(i,j,0));</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=1; k&lt;=N; k++) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                W(i,j,k) = W(i,j,k-1) - (Huon(i+1,j,k)-Huon(i,j,k)) - (Hvom(i,j+1,k)-Hvom(i,j,k));</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        });</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="comment">//  Starting with zero vertical velocity at the bottom, integrate</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="comment">//  from the bottom (k=0) to the free-surface (k=N).  The w(:,:,N(ng))</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="comment">//  contains the vertical velocity at the free-surface, d(zeta)/d(t).</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="comment">//  Notice that barotropic mass flux divergence is not used directly.</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        ParallelFor(gbx1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> wrk_ij = W(i,j,N) / (z_w(i,j,N)+h(i,j,0,0));</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="keywordflow">if</span>(k!=N) {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                W(i,j,k) -=  wrk_ij * (z_w(i,j,k)+h(i,j,0,0));</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        });</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        ParallelFor(makeSlab(gbx1,2,N), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            W(i,j,N) = 0.0;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        });</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="comment">// rhs_t_3d</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_comp=0; i_comp &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i_comp++) {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            Array4&lt;Real&gt; <span class="keyword">const</span>&amp; sstore = mf_sstore-&gt;array(mfi, i_comp);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <a class="code" href="classROMSX.html#aaf9f32897499d17bad9d80230331db6a">rhs_t_3d</a>(bx, gbx, mf_cons.array(mfi,i_comp), sstore, Huon, Hvom, Hz, oHz, pn, pm, W, FC, nrhs, nnew, N,dt_lev);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev], mf_cons, <a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(mf_cons, TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; AK = mf_AK.array(mfi);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; DC = mf_DC.array(mfi);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Hzk = mf_Hzk.array(mfi);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; Hz  = mf_Hz-&gt;const_array(mfi);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        Box bx = mfi.tilebox();</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="comment">// Copy the tilebox</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        Box tbxp1 = bx;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        Box tbxp11 = bx;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        Box tbxp2 = bx;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        Box tbxp21 = bx;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="comment">//make only gbx be grown to match multifabs</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        tbxp21.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1));</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        tbxp2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        tbxp1.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        tbxp11.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1));</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        FArrayBox fab_FC(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        FArrayBox fab_BC(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        FArrayBox fab_CF(tbxp21,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        FArrayBox fab_oHz(tbxp11,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        FArrayBox fab_pn(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        FArrayBox fab_pm(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        FArrayBox fab_W(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        FArrayBox fab_on_u(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        FArrayBox fab_om_v(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="keyword">auto</span> FC = fab_FC.array();</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keyword">auto</span> BC = fab_BC.array();</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keyword">auto</span> CF = fab_CF.array();</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keyword">auto</span> oHz= fab_oHz.array();</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keyword">auto</span> pn=fab_pn.array();</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keyword">auto</span> pm=fab_pm.array();</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="comment">//From ini_fields and .in file</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="comment">//fab_Akt.setVal(1e-6);</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="comment">//From ana_grid.h and metrics.F</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="comment">// Update to u and v</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        ParallelFor(makeSlab(tbxp2,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            pm(i,j,0)=dxi[0];</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            pn(i,j,0)=dxi[1];</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        });</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        fab_on_u.template setVal&lt;RunOn::Device&gt;(dx[1],makeSlab(tbxp2,2,0));</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        fab_om_v.template setVal&lt;RunOn::Device&gt;(dx[0],makeSlab(tbxp2,2,0));</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_comp=0; i_comp &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i_comp++) {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <a class="code" href="classROMSX.html#a3a506eb0db4a850e63f4479269a97b38">vert_visc_3d</a>(bx,0,0,mf_cons.array(mfi,i_comp),Hz,Hzk,oHz,</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                    AK,mf_Akt-&gt;array(mfi,i_comp),BC,DC,FC,CF,nnew,N,dt_lev);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    } <span class="comment">// MFiter</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;}</div>
<div class="ttc" id="aIndexDefines_8H_html_ae3f12540307d28407f8d7dd4a169e325"><div class="ttname"><a href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a></div><div class="ttdeci">#define NCONS</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:11</div></div>
<div class="ttc" id="aclassROMSX_html_a3a506eb0db4a850e63f4479269a97b38"><div class="ttname"><a href="classROMSX.html#a3a506eb0db4a850e63f4479269a97b38">ROMSX::vert_visc_3d</a></div><div class="ttdeci">void vert_visc_3d(const amrex::Box &amp;bx, const int ioff, const int joff, amrex::Array4&lt; amrex::Real &gt; phi, amrex::Array4&lt; amrex::Real const &gt; Hz, amrex::Array4&lt; amrex::Real &gt; Hzk, amrex::Array4&lt; amrex::Real &gt; oHz, amrex::Array4&lt; amrex::Real &gt; AK, amrex::Array4&lt; amrex::Real &gt; Akv, amrex::Array4&lt; amrex::Real &gt; BC, amrex::Array4&lt; amrex::Real &gt; DC, amrex::Array4&lt; amrex::Real &gt; FC, amrex::Array4&lt; amrex::Real &gt; CF, const int nnew, const int N, const amrex::Real dt_lev)</div><div class="ttdef"><b>Definition:</b> ROMSX_vert_visc_3d.cpp:10</div></div>
<div class="ttc" id="aclassROMSX_html_a799fe579a21d193e4f1e1a6a1fc74cd9"><div class="ttname"><a href="classROMSX.html#a799fe579a21d193e4f1e1a6a1fc74cd9">ROMSX::update_massflux_3d</a></div><div class="ttdeci">void update_massflux_3d(const amrex::Box &amp;bx, const int ioff, const int joff, amrex::Array4&lt; amrex::Real &gt; phi, amrex::Array4&lt; amrex::Real &gt; phibar, amrex::Array4&lt; amrex::Real &gt; Hphi, amrex::Array4&lt; amrex::Real const &gt; Hz, amrex::Array4&lt; amrex::Real &gt; on_u_or_om_v, amrex::Array4&lt; amrex::Real const &gt; Dphi1, amrex::Array4&lt; amrex::Real const &gt; Dphi2, amrex::Array4&lt; amrex::Real &gt; DC, amrex::Array4&lt; amrex::Real &gt; FC, const int nnew)</div><div class="ttdef"><b>Definition:</b> ROMSX_update_massflux_3d.cpp:23</div></div>
<div class="ttc" id="aclassROMSX_html_aad35c03f38c28e55791b50da18f2604c"><div class="ttname"><a href="classROMSX.html#aad35c03f38c28e55791b50da18f2604c">ROMSX::stretch_transform</a></div><div class="ttdeci">void stretch_transform(int lev)</div><div class="ttdef"><b>Definition:</b> DepthStretchTransform.H:12</div></div>
<div class="ttc" id="aclassROMSX_html_aaf9f32897499d17bad9d80230331db6a"><div class="ttname"><a href="classROMSX.html#aaf9f32897499d17bad9d80230331db6a">ROMSX::rhs_t_3d</a></div><div class="ttdeci">void rhs_t_3d(const amrex::Box &amp;bx, const amrex::Box &amp;gbx, amrex::Array4&lt; amrex::Real &gt; t, amrex::Array4&lt; amrex::Real &gt; tempstore, amrex::Array4&lt; amrex::Real &gt; Huon, amrex::Array4&lt; amrex::Real &gt; Hvom, amrex::Array4&lt; amrex::Real &gt; Hz, amrex::Array4&lt; amrex::Real &gt; oHz, amrex::Array4&lt; amrex::Real &gt; pn, amrex::Array4&lt; amrex::Real &gt; pm, amrex::Array4&lt; amrex::Real &gt; W, amrex::Array4&lt; amrex::Real &gt; FC, int nrhs, int nnew, int N, const amrex::Real dt_lev)</div><div class="ttdef"><b>Definition:</b> ROMSX_rhs_t_3d.cpp:28</div></div>
<div class="ttc" id="aclassROMSX_html_ad3bb9347625aef307add2c82a9b21d10"><div class="ttname"><a href="classROMSX.html#ad3bb9347625aef307add2c82a9b21d10">ROMSX::vert_mean_3d</a></div><div class="ttdeci">void vert_mean_3d(const amrex::Box &amp;bx, const int ioff, const int joff, amrex::Array4&lt; amrex::Real &gt; phi, amrex::Array4&lt; amrex::Real const &gt; Hz, amrex::Array4&lt; amrex::Real const &gt; Dphi_avg1, amrex::Array4&lt; amrex::Real &gt; DC, amrex::Array4&lt; amrex::Real &gt; CF, amrex::Array4&lt; amrex::Real &gt; dxlen, const int nnew, const int N)</div><div class="ttdef"><b>Definition:</b> ROMSX_vert_mean_3d.cpp:10</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a77f393227b048d127b50340ea256a9cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77f393227b048d127b50340ea256a9cf">&#9670;&nbsp;</a></span>advance_3d_ml()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::advance_3d_ml </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>3D advance on a single level </p>
<div class="fragment"><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;{</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    <span class="comment">// Fill in three ways: 1) interpolate from coarse grid if lev &gt; 0; 2) fill from physical boundaries;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    <span class="comment">//                     3) fine-fine fill of ghost cells with FillBoundary call</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev], *<a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev], <a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>);</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev], *<a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev], <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev], *<a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev], <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev], *<a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[lev], <a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev], *<a class="code" href="classROMSX.html#a3d747b62e29b6c979763cd243e61a866">vec_sstore</a>[lev], GetVecOfPtrs(<a class="code" href="classROMSX.html#a3d747b62e29b6c979763cd243e61a866">vec_sstore</a>));</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keyword">auto</span> N = Geom(lev).Domain().size()[2]-1; <span class="comment">// Number of vertical &quot;levs&quot; aka, NZ</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <a class="code" href="classROMSX.html#a4e9c23866425937fcf943fc31dbf0884">advance_3d</a>(lev, *<a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev], *<a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev], *<a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev],</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;               <a class="code" href="classROMSX.html#a3d747b62e29b6c979763cd243e61a866">vec_sstore</a>[lev].get(),</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;               <a class="code" href="classROMSX.html#ab1343869d59f89fd4773bc7fa230aa73">vec_ru</a>[lev].get(), <a class="code" href="classROMSX.html#ab5041f0f370ab1ec4f7f7e16127c9039">vec_rv</a>[lev].get(),</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;               <a class="code" href="classROMSX.html#a18212e9657c0655cd29e0c6241c1224f">vec_DU_avg1</a>[lev], <a class="code" href="classROMSX.html#a883756f67229729f133b9bdf784c21ff">vec_DU_avg2</a>[lev],</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;               <a class="code" href="classROMSX.html#aa9738d90727df4f8aba2afb0ffed1e8f">vec_DV_avg1</a>[lev], <a class="code" href="classROMSX.html#a6847259dab9f6118da780bf623a9868a">vec_DV_avg2</a>[lev],</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;               <a class="code" href="classROMSX.html#a047f6faef02a00ced0a6c1766e4c9b5a">vec_ubar</a>[lev],  <a class="code" href="classROMSX.html#a2a375f2e83347418b7cf5d4bd812ee55">vec_vbar</a>[lev],</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;               <a class="code" href="classROMSX.html#aec2c137ce4314357035cbc7ae292338f">vec_Akv</a>[lev], <a class="code" href="classROMSX.html#a63d077c5232d18aa0c31f1824b63b5ca">vec_Akt</a>[lev], <a class="code" href="classROMSX.html#aa5461758b528d199101b5ea74f9a6c12">vec_Hz</a>[lev], <a class="code" href="classROMSX.html#a24f02b944df51884168ab0c08c736c91">vec_Huon</a>[lev], <a class="code" href="classROMSX.html#a21dcccced847102e553281c1852ce005">vec_Hvom</a>[lev],</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;               <a class="code" href="classROMSX.html#a7e2a55ae7fb02290e6ead16ec3e658fa">vec_z_w</a>[lev], <a class="code" href="classROMSX.html#a03b79a651abf3dc2bd37fadaca99fd46">vec_hOfTheConfusingName</a>[lev], N, dt_lev);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev], *<a class="code" href="classROMSX.html#a047f6faef02a00ced0a6c1766e4c9b5a">vec_ubar</a>[lev], GetVecOfPtrs(<a class="code" href="classROMSX.html#a047f6faef02a00ced0a6c1766e4c9b5a">vec_ubar</a>));</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev], *<a class="code" href="classROMSX.html#a2a375f2e83347418b7cf5d4bd812ee55">vec_vbar</a>[lev], GetVecOfPtrs(<a class="code" href="classROMSX.html#a2a375f2e83347418b7cf5d4bd812ee55">vec_vbar</a>));</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev], *<a class="code" href="classROMSX.html#a3d747b62e29b6c979763cd243e61a866">vec_sstore</a>[lev], GetVecOfPtrs(<a class="code" href="classROMSX.html#a3d747b62e29b6c979763cd243e61a866">vec_sstore</a>));</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">// Fill in three ways: 1) interpolate from coarse grid if lev &gt; 0; 2) fill from physical boundaries;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">//                     3) fine-fine fill of ghost cells with FillBoundary call</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// Note that we need the fine-fine and physical bc&#39;s in order to correctly move the particles</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev], *<a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev], <a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev], *<a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev], <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev], *<a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev], <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev], *<a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[lev], <a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#ifdef ROMSX_USE_PARTICLES</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">//***************************************************</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">//Advance particles</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">//***************************************************</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    particleData.advance_particles(lev, dt_lev, <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev], <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev], <a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[lev], <a class="code" href="classROMSX.html#a8e887c13b3d23581a26580f4e7e9aef0">vec_z_phys_nd</a>);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;}</div>
<div class="ttc" id="aclassROMSX_html_a21dcccced847102e553281c1852ce005"><div class="ttname"><a href="classROMSX.html#a21dcccced847102e553281c1852ce005">ROMSX::vec_Hvom</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_Hvom</div><div class="ttdef"><b>Definition:</b> ROMSX.H:205</div></div>
<div class="ttc" id="aclassROMSX_html_a24f02b944df51884168ab0c08c736c91"><div class="ttname"><a href="classROMSX.html#a24f02b944df51884168ab0c08c736c91">ROMSX::vec_Huon</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_Huon</div><div class="ttdef"><b>Definition:</b> ROMSX.H:203</div></div>
<div class="ttc" id="aclassROMSX_html_a3d747b62e29b6c979763cd243e61a866"><div class="ttname"><a href="classROMSX.html#a3d747b62e29b6c979763cd243e61a866">ROMSX::vec_sstore</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_sstore</div><div class="ttdef"><b>Definition:</b> ROMSX.H:272</div></div>
<div class="ttc" id="aclassROMSX_html_a4e9c23866425937fcf943fc31dbf0884"><div class="ttname"><a href="classROMSX.html#a4e9c23866425937fcf943fc31dbf0884">ROMSX::advance_3d</a></div><div class="ttdeci">void advance_3d(int lev, amrex::MultiFab &amp;mf_cons, amrex::MultiFab &amp;mf_u, amrex::MultiFab &amp;mf_v, amrex::MultiFab *mf_sstore, amrex::MultiFab *mf_ru, amrex::MultiFab *mf_rv, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DU_avg1, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DU_avg2, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DV_avg1, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_DV_avg2, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_ubar, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_vbar, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_Akv, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_Akt, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_Hz, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_Huon, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_Hvom, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_z_w, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_h, const int N, const amrex::Real dt_lev)</div><div class="ttdef"><b>Definition:</b> ROMSX_advance_3d.cpp:10</div></div>
<div class="ttc" id="aclassROMSX_html_a63d077c5232d18aa0c31f1824b63b5ca"><div class="ttname"><a href="classROMSX.html#a63d077c5232d18aa0c31f1824b63b5ca">ROMSX::vec_Akt</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_Akt</div><div class="ttdef"><b>Definition:</b> ROMSX.H:217</div></div>
<div class="ttc" id="aclassROMSX_html_a7e2a55ae7fb02290e6ead16ec3e658fa"><div class="ttname"><a href="classROMSX.html#a7e2a55ae7fb02290e6ead16ec3e658fa">ROMSX::vec_z_w</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_z_w</div><div class="ttdef"><b>Definition:</b> ROMSX.H:232</div></div>
<div class="ttc" id="aclassROMSX_html_a8e887c13b3d23581a26580f4e7e9aef0"><div class="ttname"><a href="classROMSX.html#a8e887c13b3d23581a26580f4e7e9aef0">ROMSX::vec_z_phys_nd</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_z_phys_nd</div><div class="ttdef"><b>Definition:</b> ROMSX.H:236</div></div>
<div class="ttc" id="aclassROMSX_html_aa5461758b528d199101b5ea74f9a6c12"><div class="ttname"><a href="classROMSX.html#aa5461758b528d199101b5ea74f9a6c12">ROMSX::vec_Hz</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_Hz</div><div class="ttdef"><b>Definition:</b> ROMSX.H:201</div></div>
<div class="ttc" id="aclassROMSX_html_aec2c137ce4314357035cbc7ae292338f"><div class="ttname"><a href="classROMSX.html#aec2c137ce4314357035cbc7ae292338f">ROMSX::vec_Akv</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_Akv</div><div class="ttdef"><b>Definition:</b> ROMSX.H:215</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5a73ffdd93eed4bef7f0d3c6bdac0e6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a73ffdd93eed4bef7f0d3c6bdac0e6e">&#9670;&nbsp;</a></span>AverageDown()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::AverageDown </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>set covered coarse cells to be the average of overlying fine cells </p>
<div class="fragment"><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;{</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = finest_level-1; lev &gt;= 0; --lev)</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <a class="code" href="classROMSX.html#a243ea260c190601764cb8b6368d18615">AverageDownTo</a>(lev);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    }</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;}</div>
<div class="ttc" id="aclassROMSX_html_a243ea260c190601764cb8b6368d18615"><div class="ttname"><a href="classROMSX.html#a243ea260c190601764cb8b6368d18615">ROMSX::AverageDownTo</a></div><div class="ttdeci">void AverageDownTo(int crse_lev)</div><div class="ttdef"><b>Definition:</b> ROMSX.cpp:569</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a243ea260c190601764cb8b6368d18615"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a243ea260c190601764cb8b6368d18615">&#9670;&nbsp;</a></span>AverageDownTo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::AverageDownTo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>crse_lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>more flexible version of <a class="el" href="classROMSX.html#a5a73ffdd93eed4bef7f0d3c6bdac0e6e">AverageDown()</a> that lets you average down across multiple levels </p>
<div class="fragment"><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;{</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    average_down(*<a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[crse_lev+1], *<a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[crse_lev],</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                 0, <a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[crse_lev]-&gt;nComp(), refRatio(crse_lev));</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    Array&lt;MultiFab*,AMREX_SPACEDIM&gt;  faces_crse;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    Array&lt;MultiFab*,AMREX_SPACEDIM&gt;  faces_fine;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    faces_crse[0] = <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[crse_lev];</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    faces_crse[1] = <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[crse_lev];</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    faces_crse[2] = <a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[crse_lev];</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    faces_fine[0] = <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[crse_lev+1];</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    faces_fine[1] = <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[crse_lev+1];</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    faces_fine[2] = <a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[crse_lev+1];</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    average_down_faces(GetArrOfConstPtrs(faces_fine), faces_crse,</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                       refRatio(crse_lev),geom[crse_lev]);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6c60bb81e7afd74c2a73020e3096bd32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c60bb81e7afd74c2a73020e3096bd32">&#9670;&nbsp;</a></span>build_fine_mask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MultiFab &amp; ROMSX::build_fine_mask </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Make mask to zero out covered cells </p>
<div class="fragment"><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;{</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// Mask for zeroing covered cells</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    AMREX_ASSERT(level &gt; 0);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keyword">const</span> BoxArray&amp; cba = grids[level-1];</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keyword">const</span> DistributionMapping&amp; cdm = dmap[level-1];</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">// TODO -- we should make a vector of these a member of ROMSX class</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="classROMSX.html#a6d17615a53d63c67d12c657c9b5dade5">fine_mask</a>.define(cba, cdm, 1, 0, MFInfo());</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="classROMSX.html#a6d17615a53d63c67d12c657c9b5dade5">fine_mask</a>.setVal(1.0);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    BoxArray fba = grids[level];</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    iMultiFab ifine_mask = makeFineMask(cba, cdm, fba, ref_ratio[level-1], 1, 0);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>  fma =  <a class="code" href="classROMSX.html#a6d17615a53d63c67d12c657c9b5dade5">fine_mask</a>.arrays();</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> ifma = ifine_mask.arrays();</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    ParallelFor(<a class="code" href="classROMSX.html#a6d17615a53d63c67d12c657c9b5dade5">fine_mask</a>, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> bno, <span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        fma[bno](i,j,k) = ifma[bno](i,j,k);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    });</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    Gpu::synchronize();</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classROMSX.html#a6d17615a53d63c67d12c657c9b5dade5">fine_mask</a>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;}</div>
<div class="ttc" id="aclassROMSX_html_a6d17615a53d63c67d12c657c9b5dade5"><div class="ttname"><a href="classROMSX.html#a6d17615a53d63c67d12c657c9b5dade5">ROMSX::fine_mask</a></div><div class="ttdeci">amrex::MultiFab fine_mask</div><div class="ttdef"><b>Definition:</b> ROMSX.H:889</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a57d541b3753f65c8359d606869b31a25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57d541b3753f65c8359d606869b31a25">&#9670;&nbsp;</a></span>ClearLevel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::ClearLevel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Delete level data Overrides the pure virtual function in AmrCore </p>
<div class="fragment"><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;{</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev]; <span class="keyword">delete</span> <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev];  <span class="keyword">delete</span> <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev];  <span class="keyword">delete</span> <a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[lev];</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classROMSX.html#a7a14aa971cac1b1ad0eb5d4b46b90343">cons_old</a>[lev]; <span class="keyword">delete</span> <a class="code" href="classROMSX.html#af0b5074dc426b753beb5511bd63df407">xvel_old</a>[lev];  <span class="keyword">delete</span> <a class="code" href="classROMSX.html#a87f0b7446438b8145bdea79012b985f5">yvel_old</a>[lev];  <span class="keyword">delete</span> <a class="code" href="classROMSX.html#acb72d33af4be09dede2005fa6c901686">zvel_old</a>[lev];</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b84298925e299d4f57401ef3020227b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b84298925e299d4f57401ef3020227b">&#9670;&nbsp;</a></span>ComputeDt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::ComputeDt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>a wrapper for <a class="el" href="classROMSX.html#aaf5a8c8dcd7e6c993fea4acf2845e3d0">estTimeStep()</a> </p>
<div class="fragment"><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;{</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    Vector&lt;Real&gt; dt_tmp(finest_level+1);</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    {</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        dt_tmp[lev] = <a class="code" href="classROMSX.html#aaf5a8c8dcd7e6c993fea4acf2845e3d0">estTimeStep</a>(lev);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    }</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    ParallelDescriptor::ReduceRealMin(&amp;dt_tmp[0], dt_tmp.size());</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dt_0 = dt_tmp[0];</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keywordtype">int</span> n_factor = 1;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        dt_tmp[lev] = amrex::min(dt_tmp[lev], <a class="code" href="classROMSX.html#afe5f357fc00e46eb1445f35f84cbdf8e">change_max</a>*<a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[lev]);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        n_factor *= <a class="code" href="classROMSX.html#ab02aa1c49bf90239a6bce4ca84da985d">nsubsteps</a>[lev];</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        dt_0 = amrex::min(dt_0, n_factor*dt_tmp[lev]);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    }</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="comment">// Limit dt&#39;s by the value of stop_time.</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> eps = 1.e-3*dt_0;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[0] + dt_0 &gt; <a class="code" href="classROMSX.html#a22dfd39392c026bd023c8f1d57fd0889">stop_time</a> - eps) {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        dt_0 = <a class="code" href="classROMSX.html#a22dfd39392c026bd023c8f1d57fd0889">stop_time</a> - <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[0];</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    }</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[0] = dt_0;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[lev] = <a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[lev-1] / <a class="code" href="classROMSX.html#ab02aa1c49bf90239a6bce4ca84da985d">nsubsteps</a>[lev];</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    }</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;}</div>
<div class="ttc" id="aclassROMSX_html_a22dfd39392c026bd023c8f1d57fd0889"><div class="ttname"><a href="classROMSX.html#a22dfd39392c026bd023c8f1d57fd0889">ROMSX::stop_time</a></div><div class="ttdeci">amrex::Real stop_time</div><div class="ttdef"><b>Definition:</b> ROMSX.H:778</div></div>
<div class="ttc" id="aclassROMSX_html_aaf5a8c8dcd7e6c993fea4acf2845e3d0"><div class="ttname"><a href="classROMSX.html#aaf5a8c8dcd7e6c993fea4acf2845e3d0">ROMSX::estTimeStep</a></div><div class="ttdeci">amrex::Real estTimeStep(int lev) const</div><div class="ttdef"><b>Definition:</b> ROMSX_ComputeTimestep.cpp:40</div></div>
<div class="ttc" id="aclassROMSX_html_afe5f357fc00e46eb1445f35f84cbdf8e"><div class="ttname"><a href="classROMSX.html#afe5f357fc00e46eb1445f35f84cbdf8e">ROMSX::change_max</a></div><div class="ttdeci">static amrex::Real change_max</div><div class="ttdef"><b>Definition:</b> ROMSX.H:786</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4e8f6e71ae2c366a6455882d029de926"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e8f6e71ae2c366a6455882d029de926">&#9670;&nbsp;</a></span>ComputeGhostCells()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE int ROMSX::ComputeGhostCells </td>
          <td>(</td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>spatial_order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                                                {</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <span class="keywordtype">int</span> nGhostCells;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160; </div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      <span class="keywordflow">switch</span> (spatial_order) {</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;          nGhostCells = 2; <span class="comment">// We need this many to compute the eddy viscosity in the ghost cells</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;          nGhostCells = 2;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;          nGhostCells = 2;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        <span class="keywordflow">case</span> 5:</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;          nGhostCells = 3;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <span class="keywordflow">case</span> 6:</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;          nGhostCells = 3;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;          amrex::Error(<span class="stringliteral">&quot;Must specify spatial order to be 2,3,4,5 or 6&quot;</span>);</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      }</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      <span class="keywordflow">return</span> nGhostCells;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="afa92192721003020501bef87d5f4a667"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa92192721003020501bef87d5f4a667">&#9670;&nbsp;</a></span>coriolis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::coriolis </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>xbx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>ybx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>uold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>vold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>ru</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>rv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>fomn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;{</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="comment">//  Add in Coriolis terms.</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    ParallelFor(xbx,</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    {</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> UFx_i   = 0.5 * Hz(i  ,j,k) * fomn(i  ,j,0) * (vold(i  ,j,k,nrhs)+vold(i  ,j+1,k,nrhs));</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> UFx_im1 = 0.5 * Hz(i-1,j,k) * fomn(i-1,j,0) * (vold(i-1,j,k,nrhs)+vold(i-1,j+1,k,nrhs));</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        ru(i,j,k,nr) += 0.5*(UFx_i + UFx_im1);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    });</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    ParallelFor(ybx,</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> VFe_j   = 0.5 * Hz(i,j  ,k) * fomn(i,j  ,0) * (uold(i,j  ,k,nrhs)+uold(i+1,j  ,k,nrhs));</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> VFe_jm1 = 0.5 * Hz(i,j-1,k) * fomn(i,j-1,0) * (uold(i,j-1,k,nrhs)+uold(i+1,j-1,k,nrhs));</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        rv(i,j,k,nr) -= 0.5*(VFe_j + VFe_jm1);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    });</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2cc7343babd4642f2cf727a3d40035f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cc7343babd4642f2cf727a3d40035f3">&#9670;&nbsp;</a></span>DataLog()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE std::ostream&amp; ROMSX::DataLog </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="keywordflow">return</span> *<a class="code" href="classROMSX.html#a854a34e778a776e3ca46f7eeac9813e4">datalog</a>[i];</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    }</div>
<div class="ttc" id="aclassROMSX_html_a854a34e778a776e3ca46f7eeac9813e4"><div class="ttname"><a href="classROMSX.html#a854a34e778a776e3ca46f7eeac9813e4">ROMSX::datalog</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; std::fstream &gt; &gt; datalog</div><div class="ttdef"><b>Definition:</b> ROMSX.H:970</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a34887f38557bf5026acaf46581e05375"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34887f38557bf5026acaf46581e05375">&#9670;&nbsp;</a></span>DataLogName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string ROMSX::DataLogName </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The filename of the ith datalog file. </p>
<div class="fragment"><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classROMSX.html#ae308f7068f2eb8e48913fc77d32f9065">datalogname</a>[i]; }</div>
<div class="ttc" id="aclassROMSX_html_ae308f7068f2eb8e48913fc77d32f9065"><div class="ttname"><a href="classROMSX.html#ae308f7068f2eb8e48913fc77d32f9065">ROMSX::datalogname</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; datalogname</div><div class="ttdef"><b>Definition:</b> ROMSX.H:971</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac3d2c692cc496f5f7a57b46f0c9e2f12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3d2c692cc496f5f7a57b46f0c9e2f12">&#9670;&nbsp;</a></span>ErrorEst()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::ErrorEst </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::TagBoxArray &amp;&#160;</td>
          <td class="paramname"><em>tags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ngrow</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Tag cells for refinement</p>
<p>Function to tag cells for refinement &ndash; this overrides the pure virtual function in AmrCore</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">level</td><td>level of refinement (0 is coarsest leve) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tags</td><td>array of tagged cells </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">time</td><td>current time </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;{</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> clearval = TagBox::CLEAR;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>   tagval = TagBox::SET;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; <a class="code" href="classROMSX.html#a335a655f6cf611277de2803029419c4c">ref_tags</a>.size(); ++j)</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    {</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        std::unique_ptr&lt;MultiFab&gt; mf;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        <span class="comment">// This allows dynamic refinement based on the value of the scalar</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a335a655f6cf611277de2803029419c4c">ref_tags</a>[j].Field() == <span class="stringliteral">&quot;scalar&quot;</span>)</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;            mf = std::make_unique&lt;MultiFab&gt;(grids[level], dmap[level], 1, 0);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;            MultiFab::Copy(*mf,*<a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[level],<a class="code" href="IndexDefines_8H.html#a4dd1335cac3e63bb654450bb807978a4">Scalar_comp</a>,0,1,0);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        }</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <a class="code" href="classROMSX.html#a335a655f6cf611277de2803029419c4c">ref_tags</a>[j](tags,mf.get(),clearval,tagval,time,level,geom[level]);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  }</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;}</div>
<div class="ttc" id="aIndexDefines_8H_html_a4dd1335cac3e63bb654450bb807978a4"><div class="ttname"><a href="IndexDefines_8H.html#a4dd1335cac3e63bb654450bb807978a4">Scalar_comp</a></div><div class="ttdeci">#define Scalar_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:10</div></div>
<div class="ttc" id="aclassROMSX_html_a335a655f6cf611277de2803029419c4c"><div class="ttname"><a href="classROMSX.html#a335a655f6cf611277de2803029419c4c">ROMSX::ref_tags</a></div><div class="ttdeci">static amrex::Vector&lt; amrex::AMRErrorTag &gt; ref_tags</div><div class="ttdef"><b>Definition:</b> ROMSX.H:883</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaf5a8c8dcd7e6c993fea4acf2845e3d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf5a8c8dcd7e6c993fea4acf2845e3d0">&#9670;&nbsp;</a></span>estTimeStep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> ROMSX::estTimeStep </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>compute dt from CFL considerations </p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  BL_PROFILE(<span class="stringliteral">&quot;ROMSX::estTimeStep()&quot;</span>);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  amrex::Real estdt_lowM = 1.e20;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> dxinv = geom[level].InvCellSizeArray();</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  MultiFab ccvel(grids[level],dmap[level],3,0);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  average_face_to_cellcenter(ccvel,0,</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      Array&lt;const MultiFab*,3&gt;{<a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[level], <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[level], <a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[level]});</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> estdt_lowM_inv = amrex::ReduceMax(ccvel, 0,</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;       [=] AMREX_GPU_HOST_DEVICE (Box <span class="keyword">const</span>&amp; b,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                                  Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; u) -&gt; <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;       {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;           <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> new_lm_dt = -1.e100;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;           amrex::Loop(b, [=,&amp;new_lm_dt] (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;           {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;               new_lm_dt = amrex::max(((amrex::Math::abs(u(i,j,k,0)))*dxinv[0]),</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                      ((amrex::Math::abs(u(i,j,k,1)))*dxinv[1]),</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                                      ((amrex::Math::abs(u(i,j,k,2)))*dxinv[2]), new_lm_dt);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;           });</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;           <span class="keywordflow">return</span> new_lm_dt;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;       });</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;   ParallelDescriptor::ReduceRealMax(estdt_lowM_inv);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   <span class="keywordflow">if</span> (estdt_lowM_inv &gt; 0.0_rt)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;       estdt_lowM = <a class="code" href="classROMSX.html#a87dc05168f41e1ad8b45d1030655f6e7">cfl</a> / estdt_lowM_inv;;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#ab37afaafcf05a9b10c0fba3180539610">verbose</a>) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a9f1ff8349f4357e88dc70143f163b392">fixed_dt</a> &lt;= 0.0) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Using cfl = &quot;</span> &lt;&lt; <a class="code" href="classROMSX.html#a87dc05168f41e1ad8b45d1030655f6e7">cfl</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">if</span> (estdt_lowM_inv &gt; 0.0_rt) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Slow  dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot;:  &quot;</span> &lt;&lt; estdt_lowM &lt;&lt; std::endl;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Slow  dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot;: undefined &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a9f1ff8349f4357e88dc70143f163b392">fixed_dt</a> &gt; 0.0) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Based on cfl of 1.0 &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">if</span> (estdt_lowM_inv &gt; 0.0_rt) {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Slow  dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot; would be:  &quot;</span> &lt;&lt; estdt_lowM/<a class="code" href="classROMSX.html#a87dc05168f41e1ad8b45d1030655f6e7">cfl</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Slow  dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot; would be undefined &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Fixed dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot;       is:  &quot;</span> &lt;&lt; <a class="code" href="classROMSX.html#a9f1ff8349f4357e88dc70143f163b392">fixed_dt</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a9f1ff8349f4357e88dc70143f163b392">fixed_dt</a> &gt; 0.0) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classROMSX.html#a9f1ff8349f4357e88dc70143f163b392">fixed_dt</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordflow">return</span> estdt_lowM;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;}</div>
<div class="ttc" id="aclassROMSX_html_a87dc05168f41e1ad8b45d1030655f6e7"><div class="ttname"><a href="classROMSX.html#a87dc05168f41e1ad8b45d1030655f6e7">ROMSX::cfl</a></div><div class="ttdeci">static amrex::Real cfl</div><div class="ttdef"><b>Definition:</b> ROMSX.H:784</div></div>
<div class="ttc" id="aclassROMSX_html_a9f1ff8349f4357e88dc70143f163b392"><div class="ttname"><a href="classROMSX.html#a9f1ff8349f4357e88dc70143f163b392">ROMSX::fixed_dt</a></div><div class="ttdeci">static amrex::Real fixed_dt</div><div class="ttdef"><b>Definition:</b> ROMSX.H:789</div></div>
<div class="ttc" id="aclassROMSX_html_ab37afaafcf05a9b10c0fba3180539610"><div class="ttname"><a href="classROMSX.html#ab37afaafcf05a9b10c0fba3180539610">ROMSX::verbose</a></div><div class="ttdeci">static int verbose</div><div class="ttdef"><b>Definition:</b> ROMSX.H:833</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2491883c8e50f6734a2c474d65817824"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2491883c8e50f6734a2c474d65817824">&#9670;&nbsp;</a></span>Evolve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::Evolve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Advance solution to final time </p>
<div class="fragment"><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;{</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cur_time = <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[0];</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// Take one coarse timestep by calling timeStep -- which recursively calls timeStep</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">//      for finer levels (with or without subcycling)</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> step = <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[0]; step &lt; <a class="code" href="classROMSX.html#ad895c0936e0bd64ca71ec355e5e164b6">max_step</a> &amp;&amp; cur_time &lt; <a class="code" href="classROMSX.html#a22dfd39392c026bd023c8f1d57fd0889">stop_time</a>; ++step)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;\nCoarse STEP &quot;</span> &lt;&lt; step+1 &lt;&lt; <span class="stringliteral">&quot; starts ...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <a class="code" href="classROMSX.html#a6b84298925e299d4f57401ef3020227b">ComputeDt</a>();</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordtype">int</span> iteration = 1;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">if</span> (max_level == 0) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <a class="code" href="classROMSX.html#a5abd4890b0a7b5939c66c6af3d9bb6c2">timeStep</a>(lev, cur_time, iteration);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <a class="code" href="classROMSX.html#af5f0052238ebf09ba49652188d59315a">timeStepML</a>(cur_time, iteration);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        cur_time  += <a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[0];</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Coarse STEP &quot;</span> &lt;&lt; step+1 &lt;&lt; <span class="stringliteral">&quot; ends.&quot;</span> &lt;&lt; <span class="stringliteral">&quot; TIME = &quot;</span> &lt;&lt; cur_time</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot; DT = &quot;</span> &lt;&lt; <a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[0]  &lt;&lt; std::endl;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#abaae04ebda466750a5480506239c6ca7">plot_int_1</a> &gt; 0 &amp;&amp; (step+1) % <a class="code" href="classROMSX.html#abaae04ebda466750a5480506239c6ca7">plot_int_1</a> == 0) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <a class="code" href="classROMSX.html#a3d94cb5986d9f35bc8becc666cfaea3d">last_plot_file_step_1</a> = step+1;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <a class="code" href="classROMSX.html#a0049697ad0398380ac5a058705fece48">WritePlotFile</a>(1,<a class="code" href="classROMSX.html#a6fd2ffd8760dc3b1d68392d18cc728ae">plot_var_names_1</a>);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#aa3cd25f16ca7432ac68b7a02a8880226">plot_int_2</a> &gt; 0 &amp;&amp; (step+1) % <a class="code" href="classROMSX.html#aa3cd25f16ca7432ac68b7a02a8880226">plot_int_2</a> == 0) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <a class="code" href="classROMSX.html#a25ecb4567ed2adbaf9be2fbae65d3640">last_plot_file_step_2</a> = step+1;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <a class="code" href="classROMSX.html#a0049697ad0398380ac5a058705fece48">WritePlotFile</a>(2,<a class="code" href="classROMSX.html#a9b9c22ebd57fa77b0bb64f3932acc51c">plot_var_names_2</a>);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a216e5a3eb30ef276aef23458bd6ebd98">check_int</a> &gt; 0 &amp;&amp; (step+1) % <a class="code" href="classROMSX.html#a216e5a3eb30ef276aef23458bd6ebd98">check_int</a> == 0) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <a class="code" href="classROMSX.html#a33906f6209da9e2a247b1022f60d24ac">last_check_file_step</a> = step+1;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor">#ifdef ROMSX_USE_NETCDF</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a72cbded1c13914c8b88cd81ee1a95824">check_type</a> == <span class="stringliteral">&quot;netcdf&quot;</span>) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;               WriteNCCheckpointFile();</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a72cbded1c13914c8b88cd81ee1a95824">check_type</a> == <span class="stringliteral">&quot;native&quot;</span>) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;               <a class="code" href="classROMSX.html#acc4b85fa57f43aa0f68f33c4edd82611">WriteCheckpointFile</a>();</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <a class="code" href="classROMSX.html#aae2265fdbf5360bf2409b673135281a7">post_timestep</a>(step, cur_time, <a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[0]);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="preprocessor">#ifdef AMREX_MEM_PROFILING</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            std::ostringstream ss;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            ss &lt;&lt; <span class="stringliteral">&quot;[STEP &quot;</span> &lt;&lt; step+1 &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            MemProfiler::report(ss.str());</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordflow">if</span> (cur_time &gt;= <a class="code" href="classROMSX.html#a22dfd39392c026bd023c8f1d57fd0889">stop_time</a> - 1.e-6*<a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[0]) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#abaae04ebda466750a5480506239c6ca7">plot_int_1</a> &gt; 0 &amp;&amp; <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[0] &gt; <a class="code" href="classROMSX.html#a3d94cb5986d9f35bc8becc666cfaea3d">last_plot_file_step_1</a>) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <a class="code" href="classROMSX.html#a0049697ad0398380ac5a058705fece48">WritePlotFile</a>(1,<a class="code" href="classROMSX.html#a6fd2ffd8760dc3b1d68392d18cc728ae">plot_var_names_1</a>);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#aa3cd25f16ca7432ac68b7a02a8880226">plot_int_2</a> &gt; 0 &amp;&amp; <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[0] &gt; <a class="code" href="classROMSX.html#a25ecb4567ed2adbaf9be2fbae65d3640">last_plot_file_step_2</a>) {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <a class="code" href="classROMSX.html#a0049697ad0398380ac5a058705fece48">WritePlotFile</a>(2,<a class="code" href="classROMSX.html#a9b9c22ebd57fa77b0bb64f3932acc51c">plot_var_names_2</a>);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a216e5a3eb30ef276aef23458bd6ebd98">check_int</a> &gt; 0 &amp;&amp; <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[0] &gt; <a class="code" href="classROMSX.html#a33906f6209da9e2a247b1022f60d24ac">last_check_file_step</a>) {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="preprocessor">#ifdef ROMSX_USE_NETCDF</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a72cbded1c13914c8b88cd81ee1a95824">check_type</a> == <span class="stringliteral">&quot;netcdf&quot;</span>) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;           WriteNCCheckpointFile();</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a72cbded1c13914c8b88cd81ee1a95824">check_type</a> == <span class="stringliteral">&quot;native&quot;</span>) {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;           <a class="code" href="classROMSX.html#acc4b85fa57f43aa0f68f33c4edd82611">WriteCheckpointFile</a>();</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;}</div>
<div class="ttc" id="aclassROMSX_html_a0049697ad0398380ac5a058705fece48"><div class="ttname"><a href="classROMSX.html#a0049697ad0398380ac5a058705fece48">ROMSX::WritePlotFile</a></div><div class="ttdeci">void WritePlotFile(int which, amrex::Vector&lt; std::string &gt; plot_var_names)</div><div class="ttdef"><b>Definition:</b> Plotfile.cpp:99</div></div>
<div class="ttc" id="aclassROMSX_html_a216e5a3eb30ef276aef23458bd6ebd98"><div class="ttname"><a href="classROMSX.html#a216e5a3eb30ef276aef23458bd6ebd98">ROMSX::check_int</a></div><div class="ttdeci">int check_int</div><div class="ttdef"><b>Definition:</b> ROMSX.H:811</div></div>
<div class="ttc" id="aclassROMSX_html_a25ecb4567ed2adbaf9be2fbae65d3640"><div class="ttname"><a href="classROMSX.html#a25ecb4567ed2adbaf9be2fbae65d3640">ROMSX::last_plot_file_step_2</a></div><div class="ttdeci">int last_plot_file_step_2</div><div class="ttdef"><b>Definition:</b> ROMSX.H:766</div></div>
<div class="ttc" id="aclassROMSX_html_a33906f6209da9e2a247b1022f60d24ac"><div class="ttname"><a href="classROMSX.html#a33906f6209da9e2a247b1022f60d24ac">ROMSX::last_check_file_step</a></div><div class="ttdeci">int last_check_file_step</div><div class="ttdef"><b>Definition:</b> ROMSX.H:770</div></div>
<div class="ttc" id="aclassROMSX_html_a3d94cb5986d9f35bc8becc666cfaea3d"><div class="ttname"><a href="classROMSX.html#a3d94cb5986d9f35bc8becc666cfaea3d">ROMSX::last_plot_file_step_1</a></div><div class="ttdeci">int last_plot_file_step_1</div><div class="ttdef"><b>Definition:</b> ROMSX.H:765</div></div>
<div class="ttc" id="aclassROMSX_html_a5abd4890b0a7b5939c66c6af3d9bb6c2"><div class="ttname"><a href="classROMSX.html#a5abd4890b0a7b5939c66c6af3d9bb6c2">ROMSX::timeStep</a></div><div class="ttdeci">void timeStep(int lev, amrex::Real time, int iteration)</div><div class="ttdef"><b>Definition:</b> ROMSX_TimeStep.cpp:9</div></div>
<div class="ttc" id="aclassROMSX_html_a6b84298925e299d4f57401ef3020227b"><div class="ttname"><a href="classROMSX.html#a6b84298925e299d4f57401ef3020227b">ROMSX::ComputeDt</a></div><div class="ttdeci">void ComputeDt()</div><div class="ttdef"><b>Definition:</b> ROMSX_ComputeTimestep.cpp:8</div></div>
<div class="ttc" id="aclassROMSX_html_a72cbded1c13914c8b88cd81ee1a95824"><div class="ttname"><a href="classROMSX.html#a72cbded1c13914c8b88cd81ee1a95824">ROMSX::check_type</a></div><div class="ttdeci">std::string check_type</div><div class="ttdef"><b>Definition:</b> ROMSX.H:809</div></div>
<div class="ttc" id="aclassROMSX_html_aa3cd25f16ca7432ac68b7a02a8880226"><div class="ttname"><a href="classROMSX.html#aa3cd25f16ca7432ac68b7a02a8880226">ROMSX::plot_int_2</a></div><div class="ttdeci">int plot_int_2</div><div class="ttdef"><b>Definition:</b> ROMSX.H:805</div></div>
<div class="ttc" id="aclassROMSX_html_aae2265fdbf5360bf2409b673135281a7"><div class="ttname"><a href="classROMSX.html#aae2265fdbf5360bf2409b673135281a7">ROMSX::post_timestep</a></div><div class="ttdeci">void post_timestep(int nstep, amrex::Real time, amrex::Real dt_lev)</div><div class="ttdef"><b>Definition:</b> ROMSX.cpp:214</div></div>
<div class="ttc" id="aclassROMSX_html_abaae04ebda466750a5480506239c6ca7"><div class="ttname"><a href="classROMSX.html#abaae04ebda466750a5480506239c6ca7">ROMSX::plot_int_1</a></div><div class="ttdeci">int plot_int_1</div><div class="ttdef"><b>Definition:</b> ROMSX.H:804</div></div>
<div class="ttc" id="aclassROMSX_html_acc4b85fa57f43aa0f68f33c4edd82611"><div class="ttname"><a href="classROMSX.html#acc4b85fa57f43aa0f68f33c4edd82611">ROMSX::WriteCheckpointFile</a></div><div class="ttdeci">void WriteCheckpointFile() const</div><div class="ttdef"><b>Definition:</b> Checkpoint.cpp:15</div></div>
<div class="ttc" id="aclassROMSX_html_ad895c0936e0bd64ca71ec355e5e164b6"><div class="ttname"><a href="classROMSX.html#ad895c0936e0bd64ca71ec355e5e164b6">ROMSX::max_step</a></div><div class="ttdeci">int max_step</div><div class="ttdef"><b>Definition:</b> ROMSX.H:777</div></div>
<div class="ttc" id="aclassROMSX_html_af5f0052238ebf09ba49652188d59315a"><div class="ttname"><a href="classROMSX.html#af5f0052238ebf09ba49652188d59315a">ROMSX::timeStepML</a></div><div class="ttdeci">void timeStepML(amrex::Real time, int iteration)</div><div class="ttdef"><b>Definition:</b> ROMSX_TimeStepML.cpp:9</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classROMSX_a2491883c8e50f6734a2c474d65817824_icgraph.png" border="0" usemap="#aclassROMSX_a2491883c8e50f6734a2c474d65817824_icgraph" alt=""/></div>
<map name="aclassROMSX_a2491883c8e50f6734a2c474d65817824_icgraph" id="aclassROMSX_a2491883c8e50f6734a2c474d65817824_icgraph">
<area shape="rect" title=" " alt="" coords="108,5,231,32"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="aa79a87e1aaab7555dbf9ce414b385bb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa79a87e1aaab7555dbf9ce414b385bb9">&#9670;&nbsp;</a></span>fill_rhs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::fill_rhs </td>
          <td>(</td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>rhs_mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>state_mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Geometry &amp;&#160;</td>
          <td class="paramname"><em>geom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="afcdff09eb45a7281877f6bd97c07738f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcdff09eb45a7281877f6bd97c07738f">&#9670;&nbsp;</a></span>FillCoarsePatch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::FillCoarsePatch </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_fine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab *&#160;</td>
          <td class="paramname"><em>mf_crse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>fill an entire multifab by interpolating from the coarser level this comes into play when a new level of refinement appears </p>
<div class="fragment"><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;{</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    BL_PROFILE_VAR(<span class="stringliteral">&quot;FillCoarsePatch()&quot;</span>,<a class="code" href="classROMSX.html#afcdff09eb45a7281877f6bd97c07738f">FillCoarsePatch</a>);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    AMREX_ASSERT(lev &gt; 0);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordtype">int</span> bccomp = 0;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordtype">int</span>  icomp = 0;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordtype">int</span>  ncomp = 1;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    amrex::Interpolater* mapper = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    Box box_mf = ((*mf_to_fill)[0]).box();</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">if</span> (box_mf.ixType() == IndexType(IntVect(0,0,0)))</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        bccomp = 0;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        mapper = &amp;cell_cons_interp;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        ncomp = <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (box_mf.ixType() == IndexType(IntVect(1,0,0)))</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        bccomp = <a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        mapper = &amp;face_linear_interp;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (box_mf.ixType() == IndexType(IntVect(0,1,0)))</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        bccomp = <a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        mapper = &amp;face_linear_interp;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (box_mf.ixType() == IndexType(IntVect(0,0,1)))</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        bccomp = <a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        mapper = &amp;face_linear_interp;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;          amrex::Abort(<span class="stringliteral">&quot;Dont recognize this box type in ROMSX_FillPatch&quot;</span>);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="structTimeInterpolatedData.html">TimeInterpolatedData</a> cdata = <a class="code" href="classROMSX.html#a1dc11d863a7ed83b76003eca972a8578">GetDataAtTime</a>(lev-1, time);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="structTimeInterpolatedData.html">TimeInterpolatedData</a> fdata = <a class="code" href="classROMSX.html#a1dc11d863a7ed83b76003eca972a8578">GetDataAtTime</a>(lev  , time);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    Vector&lt;Real&gt; ctime = {cdata.<a class="code" href="structTimeInterpolatedData.html#a3f1217eba0582186b1ea1b43babcc5f4">get_time</a>()};</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    Vector&lt;MultiFab*&gt; cmf = {mf_crse};</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    Vector&lt;Real&gt; ctime = {time};</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="classROMSXPhysBCFunct.html">ROMSXPhysBCFunct</a> cphysbc(lev-1,geom[lev-1],</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                             <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>,<a class="code" href="classROMSX.html#a04e9242a2702910e640d84f47a7aae3c">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                             cdata,</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                             <a class="code" href="classROMSX.html#a3e9e683aa14e1ce2cd331cc56e665faa">m_bc_extdir_vals</a></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;#ifdef ROMSX_USE_NETCDF</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                            ,ic_bc_type,bdy_data_xlo,bdy_data_xhi,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                             bdy_data_ylo,bdy_data_yhi,bdy_time_interval</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;#endif</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                            );</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="classROMSXPhysBCFunct.html">ROMSXPhysBCFunct</a> fphysbc(lev,geom[lev],</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                             <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>,<a class="code" href="classROMSX.html#a04e9242a2702910e640d84f47a7aae3c">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                             fdata,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                             <a class="code" href="classROMSX.html#a3e9e683aa14e1ce2cd331cc56e665faa">m_bc_extdir_vals</a></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;#ifdef ROMSX_USE_NETCDF</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                            ,ic_bc_type,bdy_data_xlo,bdy_data_xhi,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                             bdy_data_ylo,bdy_data_yhi,bdy_time_interval</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;#endif</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                            );</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">//  amrex::InterpFromCoarseLevel(mf, time, *cmf[0], 0, icomp, ncomp, geom[lev-1], geom[lev],</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">//                               cphysbc, 0, fphysbc, 0, refRatio(lev-1),</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">//                               mapper, domain_bcs_type, bccomp);</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    amrex::InterpFromCoarseLevel(*mf_to_fill, time, mf_crse[lev-1], 0, icomp, ncomp, geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                                 <a class="code" href="ROMSX__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, 0, <a class="code" href="ROMSX__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, 0, refRatio(lev-1),</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                 mapper, <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>, bccomp);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;}</div>
<div class="ttc" id="aROMSX__FillPatch_8cpp_html_a85a7293fad1a59ed566bcea306373abc"><div class="ttname"><a href="ROMSX__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a></div><div class="ttdeci">PhysBCFunctNoOp null_bc</div><div class="ttdef"><b>Definition:</b> ROMSX_FillPatch.cpp:8</div></div>
<div class="ttc" id="aclassROMSXPhysBCFunct_html"><div class="ttname"><a href="classROMSXPhysBCFunct.html">ROMSXPhysBCFunct</a></div><div class="ttdef"><b>Definition:</b> ROMSX_PhysBCFunct.H:34</div></div>
<div class="ttc" id="aclassROMSX_html_a003d617559e7196bba737b43e23f9fc4"><div class="ttname"><a href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">ROMSX::domain_bcs_type</a></div><div class="ttdeci">amrex::Vector&lt; amrex::BCRec &gt; domain_bcs_type</div><div class="ttdef"><b>Definition:</b> ROMSX.H:753</div></div>
<div class="ttc" id="aclassROMSX_html_a04e9242a2702910e640d84f47a7aae3c"><div class="ttname"><a href="classROMSX.html#a04e9242a2702910e640d84f47a7aae3c">ROMSX::domain_bcs_type_d</a></div><div class="ttdeci">amrex::Gpu::DeviceVector&lt; amrex::BCRec &gt; domain_bcs_type_d</div><div class="ttdef"><b>Definition:</b> ROMSX.H:754</div></div>
<div class="ttc" id="aclassROMSX_html_a1dc11d863a7ed83b76003eca972a8578"><div class="ttname"><a href="classROMSX.html#a1dc11d863a7ed83b76003eca972a8578">ROMSX::GetDataAtTime</a></div><div class="ttdeci">TimeInterpolatedData GetDataAtTime(int lev, amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ROMSX_FillPatch.cpp:100</div></div>
<div class="ttc" id="aclassROMSX_html_a3e9e683aa14e1ce2cd331cc56e665faa"><div class="ttname"><a href="classROMSX.html#a3e9e683aa14e1ce2cd331cc56e665faa">ROMSX::m_bc_extdir_vals</a></div><div class="ttdeci">amrex::Array&lt; amrex::Array&lt; amrex::Real, AMREX_SPACEDIM *2 &gt;, AMREX_SPACEDIM+NCONS &gt; m_bc_extdir_vals</div><div class="ttdef"><b>Definition:</b> ROMSX.H:760</div></div>
<div class="ttc" id="aclassROMSX_html_afcdff09eb45a7281877f6bd97c07738f"><div class="ttname"><a href="classROMSX.html#afcdff09eb45a7281877f6bd97c07738f">ROMSX::FillCoarsePatch</a></div><div class="ttdeci">void FillCoarsePatch(int lev, amrex::Real time, amrex::MultiFab *mf_fine, amrex::MultiFab *mf_crse)</div><div class="ttdef"><b>Definition:</b> ROMSX_FillPatch.cpp:161</div></div>
<div class="ttc" id="anamespaceBCVars_html_a6fd8f72c3055242c4af20c780f391073a03b35ec9e83f34bb1349a86965d34e34"><div class="ttname"><a href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a></div><div class="ttdeci">@ zvel_bc</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:23</div></div>
<div class="ttc" id="anamespaceBCVars_html_a6fd8f72c3055242c4af20c780f391073a98ad22810fdfe9e585bc6481fc12454e"><div class="ttname"><a href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a></div><div class="ttdeci">@ yvel_bc</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:22</div></div>
<div class="ttc" id="anamespaceBCVars_html_a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4"><div class="ttname"><a href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a></div><div class="ttdeci">@ xvel_bc</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:21</div></div>
<div class="ttc" id="astructTimeInterpolatedData_html"><div class="ttname"><a href="structTimeInterpolatedData.html">TimeInterpolatedData</a></div><div class="ttdef"><b>Definition:</b> TimeInterpolatedData.H:8</div></div>
<div class="ttc" id="astructTimeInterpolatedData_html_a3f1217eba0582186b1ea1b43babcc5f4"><div class="ttname"><a href="structTimeInterpolatedData.html#a3f1217eba0582186b1ea1b43babcc5f4">TimeInterpolatedData::get_time</a></div><div class="ttdeci">amrex::Real get_time()</div><div class="ttdef"><b>Definition:</b> TimeInterpolatedData.H:21</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classROMSX_afcdff09eb45a7281877f6bd97c07738f_cgraph.png" border="0" usemap="#aclassROMSX_afcdff09eb45a7281877f6bd97c07738f_cgraph" alt=""/></div>
<map name="aclassROMSX_afcdff09eb45a7281877f6bd97c07738f_cgraph" id="aclassROMSX_afcdff09eb45a7281877f6bd97c07738f_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,183,39"/>
<area shape="rect" href="structTimeInterpolatedData.html#a3f1217eba0582186b1ea1b43babcc5f4" title=" " alt="" coords="231,5,396,47"/>
</map>
</div>

</div>
</div>
<a id="abb9e3a06ecbafa6f4860576cc80db30c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb9e3a06ecbafa6f4860576cc80db30c">&#9670;&nbsp;</a></span>FillPatch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::FillPatch </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf_to_be_filled</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::MultiFab * &gt; const &amp;&#160;</td>
          <td class="paramname"><em>mfs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;{</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    BL_PROFILE_VAR(<span class="stringliteral">&quot;ROMSX::FillPatch()&quot;</span>,ROMSX_FillPatch);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keywordtype">int</span> bccomp;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    amrex::Interpolater* mapper = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> icomp = 0;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> ncomp = mf_to_fill.nComp();</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    Box mf_box(mf_to_fill.boxArray()[0]);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordflow">if</span> (mf_box.ixType() == IndexType(IntVect(0,0,0)))</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    {</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        bccomp = 0;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        mapper = &amp;cell_cons_interp;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    }</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mf_box.ixType() == IndexType(IntVect(1,0,0)))</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        bccomp = <a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        mapper = &amp;face_linear_interp;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    }</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mf_box.ixType() == IndexType(IntVect(0,1,0)))</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        bccomp = <a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        mapper = &amp;face_linear_interp;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mf_box.ixType() == IndexType(IntVect(0,0,1)))</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        bccomp = <a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        mapper = &amp;face_linear_interp;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    }</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        amrex::Abort(<span class="stringliteral">&quot;Dont recognize this box type in ROMSX_FillPatch&quot;</span>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">if</span> (lev == 0)</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        Vector&lt;MultiFab*&gt; fmf = {mfs[lev], mfs[lev]};</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        Vector&lt;Real&gt; ftime    = {<a class="code" href="classROMSX.html#ac395453aa10633a05bb7323b2946101e">t_old</a>[lev], <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev]};</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        amrex::FillPatchSingleLevel(mf_to_fill, time, fmf, ftime, icomp, icomp, ncomp,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                                    geom[lev], <a class="code" href="ROMSX__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, bccomp);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        Vector&lt;MultiFab*&gt; fmf = {mfs[lev], mfs[lev]};</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        Vector&lt;Real&gt; ftime    = {<a class="code" href="classROMSX.html#ac395453aa10633a05bb7323b2946101e">t_old</a>[lev], <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev]};</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        Vector&lt;MultiFab*&gt; cmf = {mfs[lev-1], mfs[lev-1]};</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        Vector&lt;Real&gt; ctime    = {<a class="code" href="classROMSX.html#ac395453aa10633a05bb7323b2946101e">t_old</a>[lev-1], <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev-1]};</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        amrex::FillPatchTwoLevels(mf_to_fill, time, cmf, ctime, fmf, ftime,</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                                  0, icomp, ncomp, geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                                  <a class="code" href="ROMSX__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, bccomp, <a class="code" href="ROMSX__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, bccomp, refRatio(lev-1),</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                                  mapper, <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>, bccomp);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    } <span class="comment">// lev &gt; 0</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// Physical bc&#39;s at domain boundary</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">// Enforce physical boundary conditions</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    (*<a class="code" href="classROMSX.html#a11e74dcdbeb3670a3f92a614366a7b32">physbcs</a>[lev])(mf_to_fill,0,ncomp,mf_to_fill.nGrowVect(),time,bccomp,<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a345dba1135888a3a3e422c9b6a010ebf">ic_bc_type</a>);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">// Also enforce free-slip at top boundary (on xvel or yvel)</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">if</span> ( (mf_box.ixType() == IndexType(IntVect(1,0,0))) ||</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;         (mf_box.ixType() == IndexType(IntVect(0,1,0))) )</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordtype">int</span> khi = geom[lev].Domain().bigEnd(2);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">for</span> (MFIter mfi(mf_to_fill); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            Box gbx  = mfi.growntilebox(); <span class="comment">// Note this is face-centered since vel is</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            gbx.setSmall(2,khi+1);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            <span class="keywordflow">if</span> (gbx.ok()) {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                Array4&lt;Real&gt; vel_arr = mf_to_fill.array(mfi);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                ParallelFor(gbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                    vel_arr(i,j,k) = vel_arr(i,j,khi);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                });</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div>
<div class="ttc" id="astructSolverChoice_html_a345dba1135888a3a3e422c9b6a010ebf"><div class="ttname"><a href="structSolverChoice.html#a345dba1135888a3a3e422c9b6a010ebf">SolverChoice::ic_bc_type</a></div><div class="ttdeci">IC_BC_Type ic_bc_type</div><div class="ttdef"><b>Definition:</b> DataStruct.H:172</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2b610851883faf8e10f6ac7f660e3e44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b610851883faf8e10f6ac7f660e3e44">&#9670;&nbsp;</a></span>getAdvFluxReg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE amrex::YAFluxRegister* ROMSX::getAdvFluxReg </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    {</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classROMSX.html#afc5b78f8bc38863080c02301dba5377f">advflux_reg</a>[lev];</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0103d20b9a7008fea63fa553b76726f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0103d20b9a7008fea63fa553b76726f2">&#9670;&nbsp;</a></span>getCPUTime()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ROMSX::getCPUTime </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    {</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      <span class="keywordtype">int</span> numCores = amrex::ParallelDescriptor::NProcs();</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      numCores = numCores * omp_get_max_threads();</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160; </div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      amrex::Real T =</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        numCores * (amrex::ParallelDescriptor::second() - <a class="code" href="classROMSX.html#ab3e7f280e92f9e5cbdad88a3f222069c">startCPUTime</a>) +</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        <a class="code" href="classROMSX.html#afe8d71bf62ec39dc02fb961910a79811">previousCPUTimeUsed</a>;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160; </div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      <span class="keywordflow">return</span> T;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    }</div>
<div class="ttc" id="aclassROMSX_html_ab3e7f280e92f9e5cbdad88a3f222069c"><div class="ttname"><a href="classROMSX.html#ab3e7f280e92f9e5cbdad88a3f222069c">ROMSX::startCPUTime</a></div><div class="ttdeci">static amrex::Real startCPUTime</div><div class="ttdef"><b>Definition:</b> ROMSX.H:939</div></div>
<div class="ttc" id="aclassROMSX_html_afe8d71bf62ec39dc02fb961910a79811"><div class="ttname"><a href="classROMSX.html#afe8d71bf62ec39dc02fb961910a79811">ROMSX::previousCPUTimeUsed</a></div><div class="ttdeci">static amrex::Real previousCPUTimeUsed</div><div class="ttdef"><b>Definition:</b> ROMSX.H:940</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classROMSX.html#ae886b3856fed4fa4d820c5dda7effb7c">writeJobInfo()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classROMSX_a0103d20b9a7008fea63fa553b76726f2_icgraph.png" border="0" usemap="#aclassROMSX_a0103d20b9a7008fea63fa553b76726f2_icgraph" alt=""/></div>
<map name="aclassROMSX_a0103d20b9a7008fea63fa553b76726f2_icgraph" id="aclassROMSX_a0103d20b9a7008fea63fa553b76726f2_icgraph">
<area shape="rect" title=" " alt="" coords="209,5,368,32"/>
<area shape="rect" href="classROMSX.html#ae886b3856fed4fa4d820c5dda7effb7c" title=" " alt="" coords="5,5,161,32"/>
</map>
</div>

</div>
</div>
<a id="a1dc11d863a7ed83b76003eca972a8578"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dc11d863a7ed83b76003eca972a8578">&#9670;&nbsp;</a></span>GetDataAtTime()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structTimeInterpolatedData.html">TimeInterpolatedData</a> ROMSX::GetDataAtTime </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>utility to copy in data from old and/or new state into another multifab </p>
<div class="fragment"><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;{</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    BL_PROFILE_VAR(<span class="stringliteral">&quot;GetDataAtTime()&quot;</span>,<a class="code" href="classROMSX.html#a1dc11d863a7ed83b76003eca972a8578">GetDataAtTime</a>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="structTimeInterpolatedData.html">TimeInterpolatedData</a> data;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">// HACK HACK HACK</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> teps = (<a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev] - <a class="code" href="classROMSX.html#ac395453aa10633a05bb7323b2946101e">t_old</a>[lev]) * 1.e-3;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">if</span> (time &gt; <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev] - teps &amp;&amp; time &lt; <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev] + teps)</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a0b88b0a3a03a3e787a7b27717ec64de7">Vars::NumTypes</a>; ++i) {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            data.<a class="code" href="structTimeInterpolatedData.html#a3b9292eb3012672361abacc2ab7d9b2c">add_var</a>(&amp;vars_new[lev][i], data.<a class="code" href="structTimeInterpolatedData.html#a39ab53c6a67f3b87c895483a89e2fc0f">non_owning</a>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        data.<a class="code" href="structTimeInterpolatedData.html#a0d6dcefbf7407a24669d2a37c7f558d4">set_time</a>(<a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev]);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (time &gt; <a class="code" href="classROMSX.html#ac395453aa10633a05bb7323b2946101e">t_old</a>[lev] - teps &amp;&amp; time &lt; <a class="code" href="classROMSX.html#ac395453aa10633a05bb7323b2946101e">t_old</a>[lev] + teps)</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a0b88b0a3a03a3e787a7b27717ec64de7">Vars::NumTypes</a>; ++i) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            data.<a class="code" href="structTimeInterpolatedData.html#a3b9292eb3012672361abacc2ab7d9b2c">add_var</a>(&amp;vars_old[lev][i], data.<a class="code" href="structTimeInterpolatedData.html#a39ab53c6a67f3b87c895483a89e2fc0f">non_owning</a>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        data.<a class="code" href="structTimeInterpolatedData.html#a0d6dcefbf7407a24669d2a37c7f558d4">set_time</a>(<a class="code" href="classROMSX.html#ac395453aa10633a05bb7323b2946101e">t_old</a>[lev]);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (time &gt; <a class="code" href="classROMSX.html#ac395453aa10633a05bb7323b2946101e">t_old</a>[lev] &amp;&amp; time &lt; <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev])</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="comment">// do first order interpolation in time between [t_old[lev], t_new[lev]]</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="comment">// time interpolation includes the ghost cells</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a0b88b0a3a03a3e787a7b27717ec64de7">Vars::NumTypes</a>; ++i) {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            MultiFab* mf_tmp = <span class="keyword">new</span> MultiFab(vars_new[lev][i].boxArray(),</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                                            vars_new[lev][i].DistributionMap(),</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                            vars_new[lev][i].nComp(), vars_new[lev][i].nGrowVect());</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            mf_tmp-&gt;setVal(0.0_rt);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dt_fraction = (time - <a class="code" href="classROMSX.html#ac395453aa10633a05bb7323b2946101e">t_old</a>[lev]) / (<a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev] - <a class="code" href="classROMSX.html#ac395453aa10633a05bb7323b2946101e">t_old</a>[lev]);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            MultiFab::Saxpy(*mf_tmp, 1.0_rt - dt_fraction, vars_old[lev][i], 0, 0, mf_tmp-&gt;nComp(), mf_tmp-&gt;nGrowVect());</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            MultiFab::Saxpy(*mf_tmp,          dt_fraction, vars_new[lev][i], 0, 0, mf_tmp-&gt;nComp(), mf_tmp-&gt;nGrowVect());</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            data.<a class="code" href="structTimeInterpolatedData.html#a3b9292eb3012672361abacc2ab7d9b2c">add_var</a>(mf_tmp, data.<a class="code" href="structTimeInterpolatedData.html#af9c5a331c09d13db10c98ad3033114d8">owning</a>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        data.<a class="code" href="structTimeInterpolatedData.html#a0d6dcefbf7407a24669d2a37c7f558d4">set_time</a>(time);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        amrex::Error(<span class="stringliteral">&quot;Requested data at a time outside the interval [t_old, t_new]&quot;</span>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">// We need to make sure to fill these before we compute the viscosity</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a0b88b0a3a03a3e787a7b27717ec64de7">Vars::NumTypes</a>; ++i) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        data.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(Vars::xvel).FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        data.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(Vars::yvel).FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        data.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(Vars::zvel).FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        data.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(Vars::cons).FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">return</span> data;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;}</div>
<div class="ttc" id="anamespaceBCVars_html_a6fd8f72c3055242c4af20c780f391073a0b88b0a3a03a3e787a7b27717ec64de7"><div class="ttname"><a href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a0b88b0a3a03a3e787a7b27717ec64de7">BCVars::NumTypes</a></div><div class="ttdeci">@ NumTypes</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:24</div></div>
<div class="ttc" id="astructTimeInterpolatedData_html_a0d6dcefbf7407a24669d2a37c7f558d4"><div class="ttname"><a href="structTimeInterpolatedData.html#a0d6dcefbf7407a24669d2a37c7f558d4">TimeInterpolatedData::set_time</a></div><div class="ttdeci">void set_time(amrex::Real time)</div><div class="ttdef"><b>Definition:</b> TimeInterpolatedData.H:17</div></div>
<div class="ttc" id="astructTimeInterpolatedData_html_a39ab53c6a67f3b87c895483a89e2fc0f"><div class="ttname"><a href="structTimeInterpolatedData.html#a39ab53c6a67f3b87c895483a89e2fc0f">TimeInterpolatedData::non_owning</a></div><div class="ttdeci">const int non_owning</div><div class="ttdef"><b>Definition:</b> TimeInterpolatedData.H:50</div></div>
<div class="ttc" id="astructTimeInterpolatedData_html_a3b9292eb3012672361abacc2ab7d9b2c"><div class="ttname"><a href="structTimeInterpolatedData.html#a3b9292eb3012672361abacc2ab7d9b2c">TimeInterpolatedData::add_var</a></div><div class="ttdeci">void add_var(amrex::MultiFab *var_data, int own_data)</div><div class="ttdef"><b>Definition:</b> TimeInterpolatedData.H:23</div></div>
<div class="ttc" id="astructTimeInterpolatedData_html_a65f3edf3f03a779a931f5c58bd438602"><div class="ttname"><a href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">TimeInterpolatedData::get_var</a></div><div class="ttdeci">amrex::MultiFab &amp; get_var(int var_idx)</div><div class="ttdef"><b>Definition:</b> TimeInterpolatedData.H:28</div></div>
<div class="ttc" id="astructTimeInterpolatedData_html_af9c5a331c09d13db10c98ad3033114d8"><div class="ttname"><a href="structTimeInterpolatedData.html#af9c5a331c09d13db10c98ad3033114d8">TimeInterpolatedData::owning</a></div><div class="ttdeci">const int owning</div><div class="ttdef"><b>Definition:</b> TimeInterpolatedData.H:49</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classROMSX_a1dc11d863a7ed83b76003eca972a8578_cgraph.png" border="0" usemap="#aclassROMSX_a1dc11d863a7ed83b76003eca972a8578_cgraph" alt=""/></div>
<map name="aclassROMSX_a1dc11d863a7ed83b76003eca972a8578_cgraph" id="aclassROMSX_a1dc11d863a7ed83b76003eca972a8578_cgraph">
<area shape="rect" title=" " alt="" coords="5,78,184,105"/>
<area shape="rect" href="structTimeInterpolatedData.html#a3b9292eb3012672361abacc2ab7d9b2c" title=" " alt="" coords="232,5,397,47"/>
<area shape="rect" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602" title=" " alt="" coords="232,71,397,112"/>
<area shape="rect" href="structTimeInterpolatedData.html#a0d6dcefbf7407a24669d2a37c7f558d4" title=" " alt="" coords="232,136,397,177"/>
</map>
</div>

</div>
</div>
<a id="a20d2ef21f22efe90f8939f86ebc40b54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20d2ef21f22efe90f8939f86ebc40b54">&#9670;&nbsp;</a></span>GotoNextLine()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::GotoNextLine </td>
          <td>(</td>
          <td class="paramtype">std::istream &amp;&#160;</td>
          <td class="paramname"><em>is</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;{</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    constexpr std::streamsize bl_ignore_max { 100000 };</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    is.ignore(bl_ignore_max, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2036cccb3cbb45cb3c57d6d26f4168c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2036cccb3cbb45cb3c57d6d26f4168c7">&#9670;&nbsp;</a></span>init1DArrays()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::init1DArrays </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="abba6cffe4a459932b33465a0d126d4d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abba6cffe4a459932b33465a0d126d4d8">&#9670;&nbsp;</a></span>init_bcs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::init_bcs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <span class="keyword">auto</span> f = [<span class="keyword">this</span>] (std::string <span class="keyword">const</span>&amp; bcid, Orientation ori)</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    {</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        <span class="comment">// These are simply defaults for Dirichlet faces -- they should be over-written below</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        <a class="code" href="classROMSX.html#a3e9e683aa14e1ce2cd331cc56e665faa">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a0d8c9f8308d3e1a0dedf68c3765d2205">BCVars::Temp_bc_comp</a>  ][ori] = 1.e19;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        <a class="code" href="classROMSX.html#a3e9e683aa14e1ce2cd331cc56e665faa">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab284ea9b749e574cd1d0493de25e459e">BCVars::Salt_bc_comp</a>  ][ori] = 1.e20;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        <a class="code" href="classROMSX.html#a3e9e683aa14e1ce2cd331cc56e665faa">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a59e20f7c1b74c9cbdbc9300394bbc335">BCVars::Scalar_bc_comp</a>][ori] = 1.e21;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        <a class="code" href="classROMSX.html#a3e9e683aa14e1ce2cd331cc56e665faa">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>][ori] = 0.0; <span class="comment">// default</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        <a class="code" href="classROMSX.html#a3e9e683aa14e1ce2cd331cc56e665faa">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>][ori] = 0.0;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        <a class="code" href="classROMSX.html#a3e9e683aa14e1ce2cd331cc56e665faa">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>][ori] = 0.0;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        ParmParse pp(bcid);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        std::string bc_type_in = <span class="stringliteral">&quot;null&quot;</span>;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        pp.query(<span class="stringliteral">&quot;type&quot;</span>, bc_type_in);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        std::string bc_type = amrex::toLower(bc_type_in);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;symmetry&quot;</span>)</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;            <a class="code" href="classROMSX.html#a99fc9ef2e303a2fd0cb70225fca95acb">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281a40e712f30d56083318ab20a2402921d2">ROMSX_BC::symmetry</a>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;            <a class="code" href="classROMSX.html#a3ebadda9dbf9fbf5fd040bb1df0f18c3">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;Symmetry&quot;</span>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        }</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;outflow&quot;</span>)</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;            <a class="code" href="classROMSX.html#a99fc9ef2e303a2fd0cb70225fca95acb">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281acac0c32caf84a889ec9b2b4cb2d56972">ROMSX_BC::outflow</a>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;            <a class="code" href="classROMSX.html#a3ebadda9dbf9fbf5fd040bb1df0f18c3">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;Outflow&quot;</span>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        }</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;inflow&quot;</span>)</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            <a class="code" href="classROMSX.html#a99fc9ef2e303a2fd0cb70225fca95acb">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281ad37e67db17cfd059f2852e2673b9e8ef">ROMSX_BC::inflow</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;            <a class="code" href="classROMSX.html#a3ebadda9dbf9fbf5fd040bb1df0f18c3">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;Inflow&quot;</span>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;            std::vector&lt;Real&gt; v;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;            pp.getarr(<span class="stringliteral">&quot;velocity&quot;</span>, v, 0, AMREX_SPACEDIM);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;            <a class="code" href="classROMSX.html#a3e9e683aa14e1ce2cd331cc56e665faa">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>][ori] = v[0];</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            <a class="code" href="classROMSX.html#a3e9e683aa14e1ce2cd331cc56e665faa">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>][ori] = v[1];</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            <a class="code" href="classROMSX.html#a3e9e683aa14e1ce2cd331cc56e665faa">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>][ori] = v[2];</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> scalar_in = 0.;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            <span class="keywordflow">if</span> (pp.query(<span class="stringliteral">&quot;scalar&quot;</span>, scalar_in))</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            <a class="code" href="classROMSX.html#a3e9e683aa14e1ce2cd331cc56e665faa">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a59e20f7c1b74c9cbdbc9300394bbc335">BCVars::Scalar_bc_comp</a>][ori] = scalar_in;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;noslipwall&quot;</span>)</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            <a class="code" href="classROMSX.html#a99fc9ef2e303a2fd0cb70225fca95acb">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281acb8c716b8d9b499d9bc323d8f8a410d3">ROMSX_BC::no_slip_wall</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            <a class="code" href="classROMSX.html#a3ebadda9dbf9fbf5fd040bb1df0f18c3">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;NoSlipWall&quot;</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            std::vector&lt;Real&gt; v;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            <span class="comment">// The values of m_bc_extdir_vals default to 0.</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            <span class="comment">// But if we find &quot;velocity&quot; in the inputs file, use those values instead.</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            <span class="keywordflow">if</span> (pp.queryarr(<span class="stringliteral">&quot;velocity&quot;</span>, v, 0, AMREX_SPACEDIM))</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                v[ori.coordDir()] = 0.0;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                <a class="code" href="classROMSX.html#a3e9e683aa14e1ce2cd331cc56e665faa">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>][ori] = v[0];</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                <a class="code" href="classROMSX.html#a3e9e683aa14e1ce2cd331cc56e665faa">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>][ori] = v[1];</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                <a class="code" href="classROMSX.html#a3e9e683aa14e1ce2cd331cc56e665faa">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>][ori] = v[2];</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;slipwall&quot;</span>)</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <a class="code" href="classROMSX.html#a99fc9ef2e303a2fd0cb70225fca95acb">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281a03ee6de9fd100444c5c0567ea01bd538">ROMSX_BC::slip_wall</a>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <a class="code" href="classROMSX.html#a3ebadda9dbf9fbf5fd040bb1df0f18c3">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;SlipWall&quot;</span>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <a class="code" href="classROMSX.html#a99fc9ef2e303a2fd0cb70225fca95acb">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281a5e543256c480ac577d30f76f9120eb74">ROMSX_BC::undefined</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordflow">if</span> (geom[0].isPeriodic(ori.coordDir()))</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <a class="code" href="classROMSX.html#a3ebadda9dbf9fbf5fd040bb1df0f18c3">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;Periodic&quot;</span>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a99fc9ef2e303a2fd0cb70225fca95acb">phys_bc_type</a>[ori] == <a class="code" href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281a5e543256c480ac577d30f76f9120eb74">ROMSX_BC::undefined</a>)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                <a class="code" href="classROMSX.html#a99fc9ef2e303a2fd0cb70225fca95acb">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281ae6ffdec5e14fce371eb7ae99edebbbee">ROMSX_BC::periodic</a>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                amrex::Abort(<span class="stringliteral">&quot;Wrong BC type for periodic boundary&quot;</span>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a99fc9ef2e303a2fd0cb70225fca95acb">phys_bc_type</a>[ori] == <a class="code" href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281a5e543256c480ac577d30f76f9120eb74">ROMSX_BC::undefined</a>)</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;             amrex::Print() &lt;&lt; <span class="stringliteral">&quot;BC Type specified for face &quot;</span> &lt;&lt; bcid &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt; bc_type_in &lt;&lt; std::endl;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;             amrex::Abort(<span class="stringliteral">&quot;This BC type is unknown&quot;</span>);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    };</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    f(<span class="stringliteral">&quot;xlo&quot;</span>, Orientation(Direction::x,Orientation::low));</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    f(<span class="stringliteral">&quot;xhi&quot;</span>, Orientation(Direction::x,Orientation::high));</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    f(<span class="stringliteral">&quot;ylo&quot;</span>, Orientation(Direction::y,Orientation::low));</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    f(<span class="stringliteral">&quot;yhi&quot;</span>, Orientation(Direction::y,Orientation::high));</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    f(<span class="stringliteral">&quot;zlo&quot;</span>, Orientation(Direction::z,Orientation::low));</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    f(<span class="stringliteral">&quot;zhi&quot;</span>, Orientation(Direction::z,Orientation::high));</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// *****************************************************************************</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">// Here we translate the physical boundary conditions -- one type per face --</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">//     into logical boundary conditions for each velocity component</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// *****************************************************************************</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>.resize(AMREX_SPACEDIM+<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <a class="code" href="classROMSX.html#a04e9242a2702910e640d84f47a7aae3c">domain_bcs_type_d</a>.resize(AMREX_SPACEDIM+<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordflow">for</span> (OrientationIter oit; oit; ++oit) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            Orientation ori = oit();</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <span class="keywordtype">int</span> dir = ori.coordDir();</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            Orientation::Side side = ori.faceDir();</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <span class="keyword">auto</span> <span class="keyword">const</span> bct = <a class="code" href="classROMSX.html#a99fc9ef2e303a2fd0cb70225fca95acb">phys_bc_type</a>[ori];</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="keywordflow">if</span> ( bct == <a class="code" href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281a40e712f30d56083318ab20a2402921d2">ROMSX_BC::symmetry</a> )</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                        <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81ea85a791a2c305ad887b26b131d91cb3fc">ROMSXBCType::reflect_even</a>);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                    <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+dir].setLo(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81ea9f8add981228e79241a7c5d2d38c5910">ROMSXBCType::reflect_odd</a>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                        <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81ea85a791a2c305ad887b26b131d91cb3fc">ROMSXBCType::reflect_even</a>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                    <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+dir].setHi(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81ea9f8add981228e79241a7c5d2d38c5910">ROMSXBCType::reflect_odd</a>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281acac0c32caf84a889ec9b2b4cb2d56972">ROMSX_BC::outflow</a>)</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                        <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81ea41abfed9daecbbf69d81938a9d1a61ae">ROMSXBCType::foextrap</a>);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                        <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81ea41abfed9daecbbf69d81938a9d1a61ae">ROMSXBCType::foextrap</a>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281ad37e67db17cfd059f2852e2673b9e8ef">ROMSX_BC::inflow</a>)</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                        <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81eacc659361b9824734b263d615fefee265">ROMSXBCType::ext_dir</a>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                    }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                        <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81eacc659361b9824734b263d615fefee265">ROMSXBCType::ext_dir</a>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                    }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281acb8c716b8d9b499d9bc323d8f8a410d3">ROMSX_BC::no_slip_wall</a>)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                        <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81eacc659361b9824734b263d615fefee265">ROMSXBCType::ext_dir</a>);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                        <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81eacc659361b9824734b263d615fefee265">ROMSXBCType::ext_dir</a>);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281a03ee6de9fd100444c5c0567ea01bd538">ROMSX_BC::slip_wall</a>)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                        <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81ea41abfed9daecbbf69d81938a9d1a61ae">ROMSXBCType::foextrap</a>);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                    <span class="comment">// Only normal direction has ext_dir</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                    <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+dir].setLo(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81eacc659361b9824734b263d615fefee265">ROMSXBCType::ext_dir</a>);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                        <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81ea41abfed9daecbbf69d81938a9d1a61ae">ROMSXBCType::foextrap</a>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                    <span class="comment">// Only normal direction has ext_dir</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                    <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+dir].setHi(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81eacc659361b9824734b263d615fefee265">ROMSXBCType::ext_dir</a>);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281ae6ffdec5e14fce371eb7ae99edebbbee">ROMSX_BC::periodic</a>)</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                        <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81ea0a4990a00b5710e86a6259a83089451a">ROMSXBCType::int_dir</a>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                        <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81ea0a4990a00b5710e86a6259a83089451a">ROMSXBCType::int_dir</a>);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// *****************************************************************************</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// Here we translate the physical boundary conditions -- one type per face --</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">//     into logical boundary conditions for each cell-centered variable</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">// *****************************************************************************</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordflow">for</span> (OrientationIter oit; oit; ++oit) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            Orientation ori = oit();</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <span class="keywordtype">int</span> dir = ori.coordDir();</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            Orientation::Side side = ori.faceDir();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="keyword">auto</span> <span class="keyword">const</span> bct = <a class="code" href="classROMSX.html#a99fc9ef2e303a2fd0cb70225fca95acb">phys_bc_type</a>[ori];</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="keywordflow">if</span> ( bct == <a class="code" href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281a40e712f30d56083318ab20a2402921d2">ROMSX_BC::symmetry</a> )</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i++)</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                        <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81ea85a791a2c305ad887b26b131d91cb3fc">ROMSXBCType::reflect_even</a>);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i++)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                        <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81ea85a791a2c305ad887b26b131d91cb3fc">ROMSXBCType::reflect_even</a>);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( bct == <a class="code" href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281acac0c32caf84a889ec9b2b4cb2d56972">ROMSX_BC::outflow</a> )</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i++)</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                        <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81ea41abfed9daecbbf69d81938a9d1a61ae">ROMSXBCType::foextrap</a>);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i++)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                        <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81ea41abfed9daecbbf69d81938a9d1a61ae">ROMSXBCType::foextrap</a>);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( bct == <a class="code" href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281acb8c716b8d9b499d9bc323d8f8a410d3">ROMSX_BC::no_slip_wall</a>)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i++)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                        <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81ea41abfed9daecbbf69d81938a9d1a61ae">ROMSXBCType::foextrap</a>);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i++)</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                        <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81ea41abfed9daecbbf69d81938a9d1a61ae">ROMSXBCType::foextrap</a>);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281a03ee6de9fd100444c5c0567ea01bd538">ROMSX_BC::slip_wall</a>)</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i++)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                        <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81ea41abfed9daecbbf69d81938a9d1a61ae">ROMSXBCType::foextrap</a>);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i++)</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                        <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81ea41abfed9daecbbf69d81938a9d1a61ae">ROMSXBCType::foextrap</a>);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281ad37e67db17cfd059f2852e2673b9e8ef">ROMSX_BC::inflow</a>)</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i++) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                        <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81eacc659361b9824734b263d615fefee265">ROMSXBCType::ext_dir</a>);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                    }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i++) {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                        <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81eacc659361b9824734b263d615fefee265">ROMSXBCType::ext_dir</a>);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                    }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281ae6ffdec5e14fce371eb7ae99edebbbee">ROMSX_BC::periodic</a>)</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i++)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                        <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81ea0a4990a00b5710e86a6259a83089451a">ROMSXBCType::int_dir</a>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i++)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                       <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81ea0a4990a00b5710e86a6259a83089451a">ROMSXBCType::int_dir</a>);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="preprocessor">#ifdef AMREX_USE_GPU</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    Gpu::htod_memcpy</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        (<a class="code" href="classROMSX.html#a04e9242a2702910e640d84f47a7aae3c">domain_bcs_type_d</a>.data(), <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>.data(),</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;         <span class="keyword">sizeof</span>(amrex::BCRec)*(<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>+AMREX_SPACEDIM));</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    std::memcpy</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        (<a class="code" href="classROMSX.html#a04e9242a2702910e640d84f47a7aae3c">domain_bcs_type_d</a>.data(), <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>.data(),</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;         <span class="keyword">sizeof</span>(amrex::BCRec)*(<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>+AMREX_SPACEDIM));</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;}</div>
<div class="ttc" id="aIndexDefines_8H_html_a8c2583d7b3aea3f36ba249890cc5e281a03ee6de9fd100444c5c0567ea01bd538"><div class="ttname"><a href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281a03ee6de9fd100444c5c0567ea01bd538">ROMSX_BC::slip_wall</a></div><div class="ttdeci">@ slip_wall</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a8c2583d7b3aea3f36ba249890cc5e281a40e712f30d56083318ab20a2402921d2"><div class="ttname"><a href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281a40e712f30d56083318ab20a2402921d2">ROMSX_BC::symmetry</a></div><div class="ttdeci">@ symmetry</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a8c2583d7b3aea3f36ba249890cc5e281a5e543256c480ac577d30f76f9120eb74"><div class="ttname"><a href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281a5e543256c480ac577d30f76f9120eb74">ROMSX_BC::undefined</a></div><div class="ttdeci">@ undefined</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a8c2583d7b3aea3f36ba249890cc5e281acac0c32caf84a889ec9b2b4cb2d56972"><div class="ttname"><a href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281acac0c32caf84a889ec9b2b4cb2d56972">ROMSX_BC::outflow</a></div><div class="ttdeci">@ outflow</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a8c2583d7b3aea3f36ba249890cc5e281acb8c716b8d9b499d9bc323d8f8a410d3"><div class="ttname"><a href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281acb8c716b8d9b499d9bc323d8f8a410d3">ROMSX_BC::no_slip_wall</a></div><div class="ttdeci">@ no_slip_wall</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a8c2583d7b3aea3f36ba249890cc5e281ad37e67db17cfd059f2852e2673b9e8ef"><div class="ttname"><a href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281ad37e67db17cfd059f2852e2673b9e8ef">ROMSX_BC::inflow</a></div><div class="ttdeci">@ inflow</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a8c2583d7b3aea3f36ba249890cc5e281ae6ffdec5e14fce371eb7ae99edebbbee"><div class="ttname"><a href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281ae6ffdec5e14fce371eb7ae99edebbbee">ROMSX_BC::periodic</a></div><div class="ttdeci">@ periodic</div></div>
<div class="ttc" id="aclassROMSX_html_a3ebadda9dbf9fbf5fd040bb1df0f18c3"><div class="ttname"><a href="classROMSX.html#a3ebadda9dbf9fbf5fd040bb1df0f18c3">ROMSX::domain_bc_type</a></div><div class="ttdeci">amrex::Array&lt; std::string, 2 *AMREX_SPACEDIM &gt; domain_bc_type</div><div class="ttdef"><b>Definition:</b> ROMSX.H:757</div></div>
<div class="ttc" id="aclassROMSX_html_a99fc9ef2e303a2fd0cb70225fca95acb"><div class="ttname"><a href="classROMSX.html#a99fc9ef2e303a2fd0cb70225fca95acb">ROMSX::phys_bc_type</a></div><div class="ttdeci">amrex::GpuArray&lt; ROMSX_BC, AMREX_SPACEDIM *2 &gt; phys_bc_type</div><div class="ttdef"><b>Definition:</b> ROMSX.H:763</div></div>
<div class="ttc" id="anamespaceBCVars_html_a6fd8f72c3055242c4af20c780f391073a0d8c9f8308d3e1a0dedf68c3765d2205"><div class="ttname"><a href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a0d8c9f8308d3e1a0dedf68c3765d2205">BCVars::Temp_bc_comp</a></div><div class="ttdeci">@ Temp_bc_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:18</div></div>
<div class="ttc" id="anamespaceBCVars_html_a6fd8f72c3055242c4af20c780f391073a59e20f7c1b74c9cbdbc9300394bbc335"><div class="ttname"><a href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073a59e20f7c1b74c9cbdbc9300394bbc335">BCVars::Scalar_bc_comp</a></div><div class="ttdeci">@ Scalar_bc_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:20</div></div>
<div class="ttc" id="anamespaceBCVars_html_a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec"><div class="ttname"><a href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073aaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a></div><div class="ttdeci">@ cons_bc</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:17</div></div>
<div class="ttc" id="anamespaceBCVars_html_a6fd8f72c3055242c4af20c780f391073ab284ea9b749e574cd1d0493de25e459e"><div class="ttname"><a href="namespaceBCVars.html#a6fd8f72c3055242c4af20c780f391073ab284ea9b749e574cd1d0493de25e459e">BCVars::Salt_bc_comp</a></div><div class="ttdeci">@ Salt_bc_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:19</div></div>
<div class="ttc" id="anamespaceROMSXBCType_html_af4e42fa51742c38508f617adb429d81ea0a4990a00b5710e86a6259a83089451a"><div class="ttname"><a href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81ea0a4990a00b5710e86a6259a83089451a">ROMSXBCType::int_dir</a></div><div class="ttdeci">@ int_dir</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:38</div></div>
<div class="ttc" id="anamespaceROMSXBCType_html_af4e42fa51742c38508f617adb429d81ea41abfed9daecbbf69d81938a9d1a61ae"><div class="ttname"><a href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81ea41abfed9daecbbf69d81938a9d1a61ae">ROMSXBCType::foextrap</a></div><div class="ttdeci">@ foextrap</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:40</div></div>
<div class="ttc" id="anamespaceROMSXBCType_html_af4e42fa51742c38508f617adb429d81ea85a791a2c305ad887b26b131d91cb3fc"><div class="ttname"><a href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81ea85a791a2c305ad887b26b131d91cb3fc">ROMSXBCType::reflect_even</a></div><div class="ttdeci">@ reflect_even</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:39</div></div>
<div class="ttc" id="anamespaceROMSXBCType_html_af4e42fa51742c38508f617adb429d81ea9f8add981228e79241a7c5d2d38c5910"><div class="ttname"><a href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81ea9f8add981228e79241a7c5d2d38c5910">ROMSXBCType::reflect_odd</a></div><div class="ttdeci">@ reflect_odd</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:37</div></div>
<div class="ttc" id="anamespaceROMSXBCType_html_af4e42fa51742c38508f617adb429d81eacc659361b9824734b263d615fefee265"><div class="ttname"><a href="namespaceROMSXBCType.html#af4e42fa51742c38508f617adb429d81eacc659361b9824734b263d615fefee265">ROMSXBCType::ext_dir</a></div><div class="ttdeci">@ ext_dir</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:41</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af3c54ec9fe911484d73ce5ba486ccfc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3c54ec9fe911484d73ce5ba486ccfc5">&#9670;&nbsp;</a></span>init_custom()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::init_custom </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;{</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_z_w = <a class="code" href="classROMSX.html#a7e2a55ae7fb02290e6ead16ec3e658fa">vec_z_w</a>[lev];</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_z_r = <a class="code" href="classROMSX.html#a0a9b1a5cf021018defc82b45cbecb2c5">vec_z_r</a>[lev];</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_Hz  = <a class="code" href="classROMSX.html#aa5461758b528d199101b5ea74f9a6c12">vec_Hz</a>[lev];</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_h  = <a class="code" href="classROMSX.html#a03b79a651abf3dc2bd37fadaca99fd46">vec_hOfTheConfusingName</a>[lev];</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_Zt_avg1  = <a class="code" href="classROMSX.html#ab962f23dc27b3ce17bb19e3b8c9991f8">vec_Zt_avg1</a>[lev];</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(*<a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <span class="keyword">const</span> Box &amp;bx = mfi.tilebox();</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;cons_arr = <a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;xvel_arr = <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;yvel_arr = <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;zvel_arr = <a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        Array4&lt;const Real&gt; <span class="keyword">const</span>&amp; z_w_arr = (mf_z_w)-&gt;array(mfi);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        Array4&lt;const Real&gt; <span class="keyword">const</span>&amp; z_r_arr = (mf_z_r)-&gt;array(mfi);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        Array4&lt;const Real&gt; <span class="keyword">const</span>&amp; Hz_arr  = (mf_Hz)-&gt;array(mfi);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        Array4&lt;const Real&gt; <span class="keyword">const</span>&amp; h_arr  = (mf_h)-&gt;array(mfi);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        Array4&lt;const Real&gt; <span class="keyword">const</span>&amp; Zt_avg1_arr  = (mf_Zt_avg1)-&gt;array(mfi);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <a class="code" href="prob__common_8H.html#adbedc34f482b6a491593d88706d948da">init_custom_prob</a>(bx, cons_arr, xvel_arr, yvel_arr, zvel_arr,</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                         z_w_arr, z_r_arr, Hz_arr, h_arr, Zt_avg1_arr, geom[lev].data(),</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                         <a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    } <span class="comment">//mfi</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="classROMSX.html#abd0ef9b9a56b5f6985a0903895d81e46">set_2darrays</a>(lev);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;}</div>
<div class="ttc" id="aclassROMSX_html_a0a9b1a5cf021018defc82b45cbecb2c5"><div class="ttname"><a href="classROMSX.html#a0a9b1a5cf021018defc82b45cbecb2c5">ROMSX::vec_z_r</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_z_r</div><div class="ttdef"><b>Definition:</b> ROMSX.H:230</div></div>
<div class="ttc" id="aclassROMSX_html_abd0ef9b9a56b5f6985a0903895d81e46"><div class="ttname"><a href="classROMSX.html#abd0ef9b9a56b5f6985a0903895d81e46">ROMSX::set_2darrays</a></div><div class="ttdeci">void set_2darrays(int lev)</div><div class="ttdef"><b>Definition:</b> ROMSX_init.cpp:49</div></div>
<div class="ttc" id="aprob__common_8H_html_adbedc34f482b6a491593d88706d948da"><div class="ttname"><a href="prob__common_8H.html#adbedc34f482b6a491593d88706d948da">init_custom_prob</a></div><div class="ttdeci">void init_custom_prob(const amrex::Box &amp;bx, amrex::Array4&lt; amrex::Real &gt; const &amp;state, amrex::Array4&lt; amrex::Real &gt; const &amp;x_vel, amrex::Array4&lt; amrex::Real &gt; const &amp;y_vel, amrex::Array4&lt; amrex::Real &gt; const &amp;z_vel, amrex::Array4&lt; amrex::Real const &gt; const &amp;z_w, amrex::Array4&lt; amrex::Real const &gt; const &amp;z_r, amrex::Array4&lt; amrex::Real const &gt; const &amp;Hz, amrex::Array4&lt; amrex::Real const &gt; const &amp;h, amrex::Array4&lt; amrex::Real const &gt; const &amp;Zt_avg1, amrex::GeometryData const &amp;geomdata, SolverChoice const &amp;m_solverChoice)</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classROMSX_af3c54ec9fe911484d73ce5ba486ccfc5_cgraph.png" border="0" usemap="#aclassROMSX_af3c54ec9fe911484d73ce5ba486ccfc5_cgraph" alt=""/></div>
<map name="aclassROMSX_af3c54ec9fe911484d73ce5ba486ccfc5_cgraph" id="aclassROMSX_af3c54ec9fe911484d73ce5ba486ccfc5_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,160,32"/>
<area shape="rect" href="prob__common_8H.html#adbedc34f482b6a491593d88706d948da" title=" " alt="" coords="208,5,343,32"/>
</map>
</div>

</div>
</div>
<a id="aae7ba5940968ecd9397fa506a7082933"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae7ba5940968ecd9397fa506a7082933">&#9670;&nbsp;</a></span>init_only()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::init_only </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Init (NOT restart or regrid) </p>
<div class="fragment"><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;{</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev] = time;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <a class="code" href="classROMSX.html#ac395453aa10633a05bb7323b2946101e">t_old</a>[lev] = time - 1.e200;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a345dba1135888a3a3e422c9b6a010ebf">ic_bc_type</a> == <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a90589c47f06eb971d548591f23c285af">IC_BC_Type::Custom</a>)</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <a class="code" href="classROMSX.html#af3c54ec9fe911484d73ce5ba486ccfc5">init_custom</a>(lev);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="preprocessor">#ifdef ROMSX_USE_NETCDF</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a345dba1135888a3a3e422c9b6a010ebf">ic_bc_type</a> == <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">IC_BC_Type::Real</a>) {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        init_from_netcdf(lev);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        Abort(<span class="stringliteral">&quot;Need to specify ic_bc_type&quot;</span>);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">// Ensure that the face-based data are the same on both sides of a periodic domain.</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="comment">// The data associated with the lower grid ID is considered the correct value.</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev]-&gt;OverrideSync(geom[lev].periodicity());</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev]-&gt;OverrideSync(geom[lev].periodicity());</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[lev]-&gt;OverrideSync(geom[lev].periodicity());</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;}</div>
<div class="ttc" id="aDataStruct_8H_html_aa307030d99f8c225e1a1adb20224ed36a90589c47f06eb971d548591f23c285af"><div class="ttname"><a href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a90589c47f06eb971d548591f23c285af">IC_BC_Type::Custom</a></div><div class="ttdeci">@ Custom</div></div>
<div class="ttc" id="aclassROMSX_html_af3c54ec9fe911484d73ce5ba486ccfc5"><div class="ttname"><a href="classROMSX.html#af3c54ec9fe911484d73ce5ba486ccfc5">ROMSX::init_custom</a></div><div class="ttdeci">void init_custom(int lev)</div><div class="ttdef"><b>Definition:</b> ROMSX_init.cpp:13</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a45591c69e52ac45b762eaa78880c6229"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45591c69e52ac45b762eaa78880c6229">&#9670;&nbsp;</a></span>init_stuff()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::init_stuff </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::BoxArray &amp;&#160;</td>
          <td class="paramname"><em>ba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::DistributionMapping &amp;&#160;</td>
          <td class="paramname"><em>dm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;{</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">// Initialize the boundary conditions</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="classROMSX.html#a11e74dcdbeb3670a3f92a614366a7b32">physbcs</a>[lev] = std::make_unique&lt;ROMSXPhysBCFunct&gt; (lev, geom[lev], <a class="code" href="classROMSX.html#a003d617559e7196bba737b43e23f9fc4">domain_bcs_type</a>, <a class="code" href="classROMSX.html#a04e9242a2702910e640d84f47a7aae3c">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                                       <a class="code" href="classROMSX.html#a3e9e683aa14e1ce2cd331cc56e665faa">m_bc_extdir_vals</a>);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    BoxList bl2d = ba.boxList();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; b : bl2d) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        b.setRange(2,0);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    BoxArray ba2d(std::move(bl2d));</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    BoxList bl1d = ba.boxList();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; b : bl1d) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        b.setRange(0,0);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        b.setRange(1,0);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    BoxArray ba1d(std::move(bl1d));</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// Map factors</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="classROMSX.html#a606d7f526ef409ef78feb8ce127f98c9">mapfac_m</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba2d,dm,1,0));</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="classROMSX.html#a865698971c9689455573c4b81ecaf26c">mapfac_u</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(1,0,0)),dm,1,0));</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="classROMSX.html#ad96e947b76f50a01928821d3cd2455f7">mapfac_v</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(0,1,0)),dm,1,0));</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="classROMSX.html#a606d7f526ef409ef78feb8ce127f98c9">mapfac_m</a>[lev]-&gt;setVal(1.);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="classROMSX.html#a865698971c9689455573c4b81ecaf26c">mapfac_u</a>[lev]-&gt;setVal(1.);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="classROMSX.html#ad96e947b76f50a01928821d3cd2455f7">mapfac_v</a>[lev]-&gt;setVal(1.);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    BoxArray ba_nd(ba);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    ba_nd.surroundingNodes();</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    BoxArray ba_w(ba);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    ba_w.surroundingNodes(2);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="classROMSX.html#a8e887c13b3d23581a26580f4e7e9aef0">vec_z_phys_nd</a>[lev].reset          (<span class="keyword">new</span> MultiFab(ba_nd,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">// z at psi points (nodes) MIGHT NEED NGROW+1</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="classROMSX.html#a03b79a651abf3dc2bd37fadaca99fd46">vec_hOfTheConfusingName</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba2d ,dm,2,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0))); <span class="comment">//2d, depth (double check if negative)</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="classROMSX.html#ab962f23dc27b3ce17bb19e3b8c9991f8">vec_Zt_avg1</a>[lev].reset            (<span class="keyword">new</span> MultiFab(ba2d ,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0))); <span class="comment">//2d, average of the free surface (zeta)</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="classROMSX.html#a2de6e4298de90faa955d8073a65f7cd9">vec_x_r</a>[lev].reset                (<span class="keyword">new</span> MultiFab(ba2d,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0))); <span class="comment">// x at r points (cell center)</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="classROMSX.html#a9a453443ec491d496adbd2cf5ac292d8">vec_y_r</a>[lev].reset                (<span class="keyword">new</span> MultiFab(ba2d,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0))); <span class="comment">// y at r points (cell center)</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="classROMSX.html#a7a3b7fb166ec3acf1b1057f53e08adad">vec_s_r</a>[lev].reset                (<span class="keyword">new</span> MultiFab(ba1d,dm,1,IntVect(    0,    0,0))); <span class="comment">// scaled vertical coordinate [0,1] , transforms to z</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <a class="code" href="classROMSX.html#a7e2a55ae7fb02290e6ead16ec3e658fa">vec_z_w</a>[lev].reset                (<span class="keyword">new</span> MultiFab(ba_w,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0))); <span class="comment">// z at w points (cell faces)</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="classROMSX.html#a0a9b1a5cf021018defc82b45cbecb2c5">vec_z_r</a>[lev].reset                (<span class="keyword">new</span> MultiFab(ba  ,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0))); <span class="comment">// z at r points (cell center)</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="classROMSX.html#aa5461758b528d199101b5ea74f9a6c12">vec_Hz</a>[lev].reset                 (<span class="keyword">new</span> MultiFab(ba  ,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1))); <span class="comment">// like in ROMS, thickness of cell in z</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="classROMSX.html#a24f02b944df51884168ab0c08c736c91">vec_Huon</a>[lev].reset               (<span class="keyword">new</span> MultiFab(convert(ba,IntVect(1,0,0)),dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">// mass flux for u component</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <a class="code" href="classROMSX.html#a21dcccced847102e553281c1852ce005">vec_Hvom</a>[lev].reset               (<span class="keyword">new</span> MultiFab(convert(ba,IntVect(0,1,0)),dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">// mass flux for v component</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="classROMSX.html#aec2c137ce4314357035cbc7ae292338f">vec_Akv</a>[lev].reset                (<span class="keyword">new</span> MultiFab(ba  ,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">// vertical mixing coefficient (.in)</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="classROMSX.html#a63d077c5232d18aa0c31f1824b63b5ca">vec_Akt</a>[lev].reset                (<span class="keyword">new</span> MultiFab(ba  ,dm,<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">// vertical mixing coefficient (.in)</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="classROMSX.html#a640f040827d96f0b2085a385f0faaa3b">vec_visc3d_r</a>[lev].reset           (<span class="keyword">new</span> MultiFab(ba  ,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">// not used</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">// check dimensionality</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="classROMSX.html#af83a943f37cd6bbaf25c52fcaceb0930">vec_visc2_p</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">// harmonic viscosity at psi points -- difference to 3d?</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="classROMSX.html#aa8fff925fc76e919ddc53de08b3725e9">vec_visc2_r</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">// harmonic viscosity at rho points</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="classROMSX.html#a2f47ec18ca3f2465e3253f92ca493bbc">vec_diff2</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba,dm,<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">// harmonic diffusivity temperature/salt</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="classROMSX.html#ab1343869d59f89fd4773bc7fa230aa73">vec_ru</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba,IntVect(1,0,0)),dm,2,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>))); <span class="comment">// RHS u (incl horizontal and vertical advection)</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="classROMSX.html#ab5041f0f370ab1ec4f7f7e16127c9039">vec_rv</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba,IntVect(0,1,0)),dm,2,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>))); <span class="comment">// RHS v</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">//2d, (incl advection terms and surface/bottom stresses, integral over the whole columnn, k=0)</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="classROMSX.html#ab5b7ff78a167e59ae727b22094b39079">vec_rufrc</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(1,0,0)),dm,2,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="classROMSX.html#a52a5f265a370595f128046c31b9f31d5">vec_rvfrc</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(0,1,0)),dm,2,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">//2d, same as above but v</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="code" href="classROMSX.html#a2082155131b8b7e0dec29068a92cece2">vec_sustr</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(1,0,0)),dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">//2d, surface stress</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="classROMSX.html#a44a44e4d82bc38d55daa03f281437113">vec_svstr</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(0,1,0)),dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">//2d</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">//2d, linear drag coefficient [m/s], defined at rho, somehow related to rdrg</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="classROMSX.html#ac49463f0fb789402ba8641f289906456">vec_rdrag</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba2d,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <a class="code" href="classROMSX.html#a607e27d43f6eaebcf557c4ae17b8039a">vec_bustr</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(1,0,0)),dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">//2d, bottom stress</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <a class="code" href="classROMSX.html#a5a981dafaf65d2d8d96f16e1e7467eb2">vec_bvstr</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(0,1,0)),dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">//all 2d -- all associated with the 2D advance</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">//2d DU: sum(height[incl free surface?] * u)</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="classROMSX.html#a18212e9657c0655cd29e0c6241c1224f">vec_DU_avg1</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(1,0,0)),dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">//2d like above, but correct(or)?</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="classROMSX.html#a883756f67229729f133b9bdf784c21ff">vec_DU_avg2</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(1,0,0)),dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <a class="code" href="classROMSX.html#aa9738d90727df4f8aba2afb0ffed1e8f">vec_DV_avg1</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(0,1,0)),dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="classROMSX.html#a6847259dab9f6118da780bf623a9868a">vec_DV_avg2</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(0,1,0)),dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="classROMSX.html#ab5d263be53bfdd397f6c64672ee77009">vec_rubar</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(1,0,0)),dm,4,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">// 2d RHS ubar</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="classROMSX.html#a83d781ead821f8ed29f6f2b9ef70a9aa">vec_rvbar</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(0,1,0)),dm,4,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="classROMSX.html#ac2324a5a8d5949f83ac7621ef79f8fdd">vec_rzeta</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba2d,dm,4,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0))); <span class="comment">// 2d RHS zeta</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">// starts off kind of like a depth-averaged u, but exists at more points and more timesteps (b/c fast 2D update) than full u</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="classROMSX.html#a047f6faef02a00ced0a6c1766e4c9b5a">vec_ubar</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(1,0,0)),dm,3,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <a class="code" href="classROMSX.html#a2a375f2e83347418b7cf5d4bd812ee55">vec_vbar</a>[lev].reset(<span class="keyword">new</span> MultiFab(convert(ba2d,IntVect(0,1,0)),dm,3,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <a class="code" href="classROMSX.html#ab026fffd3c4e9a9ef612cbb23132a1f5">vec_zeta</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba2d,dm,3,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0)));  <span class="comment">// 2d free surface</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">// tempstore, saltstore, etc</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="classROMSX.html#a3d747b62e29b6c979763cd243e61a866">vec_sstore</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba,dm,<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="classROMSX.html#a20d43f4b49b92542c1790c1ea01ca19c">vec_rhoS</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="classROMSX.html#a0978a71210c5f05a5541002532bd9cd2">vec_rhoA</a>[lev].reset(<span class="keyword">new</span> MultiFab(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)));</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="classROMSX.html#ab93d802ac3111e738dafe04367813135">set_bathymetry</a>(lev);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <a class="code" href="classROMSX.html#aad35c03f38c28e55791b50da18f2604c">stretch_transform</a>(lev);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="classROMSX.html#a48b99337b5ac313ce48a95ab0b9e73dc">set_vmix</a>(lev);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <a class="code" href="classROMSX.html#a5dd9fc911df600f1eb0e8f3c131d8353">set_hmixcoef</a>(lev);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <a class="code" href="classROMSX.html#a3ca3a726e1b0ecfc4339b2a07ade77b7">set_weights</a>(lev);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">//consider tracking ru and rv indexes more specifically or more similarly to indx</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="classROMSX.html#ab1343869d59f89fd4773bc7fa230aa73">vec_ru</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="classROMSX.html#ab5041f0f370ab1ec4f7f7e16127c9039">vec_rv</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <a class="code" href="classROMSX.html#a18212e9657c0655cd29e0c6241c1224f">vec_DU_avg1</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="classROMSX.html#a883756f67229729f133b9bdf784c21ff">vec_DU_avg2</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="classROMSX.html#aa9738d90727df4f8aba2afb0ffed1e8f">vec_DV_avg1</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="classROMSX.html#a6847259dab9f6118da780bf623a9868a">vec_DV_avg2</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="classROMSX.html#ab5d263be53bfdd397f6c64672ee77009">vec_rubar</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="code" href="classROMSX.html#a83d781ead821f8ed29f6f2b9ef70a9aa">vec_rvbar</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="classROMSX.html#ac2324a5a8d5949f83ac7621ef79f8fdd">vec_rzeta</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <a class="code" href="classROMSX.html#a047f6faef02a00ced0a6c1766e4c9b5a">vec_ubar</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <a class="code" href="classROMSX.html#a2a375f2e83347418b7cf5d4bd812ee55">vec_vbar</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="classROMSX.html#ab026fffd3c4e9a9ef612cbb23132a1f5">vec_zeta</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="comment">// Set initial linear drag coefficient</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="classROMSX.html#ac49463f0fb789402ba8641f289906456">vec_rdrag</a>[lev]-&gt;setVal(<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab32c6e7161ddf37e8051743fae717cf5">rdrag</a>);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;}</div>
<div class="ttc" id="aclassROMSX_html_a2082155131b8b7e0dec29068a92cece2"><div class="ttname"><a href="classROMSX.html#a2082155131b8b7e0dec29068a92cece2">ROMSX::vec_sustr</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_sustr</div><div class="ttdef"><b>Definition:</b> ROMSX.H:240</div></div>
<div class="ttc" id="aclassROMSX_html_a2de6e4298de90faa955d8073a65f7cd9"><div class="ttname"><a href="classROMSX.html#a2de6e4298de90faa955d8073a65f7cd9">ROMSX::vec_x_r</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_x_r</div><div class="ttdef"><b>Definition:</b> ROMSX.H:226</div></div>
<div class="ttc" id="aclassROMSX_html_a2f47ec18ca3f2465e3253f92ca493bbc"><div class="ttname"><a href="classROMSX.html#a2f47ec18ca3f2465e3253f92ca493bbc">ROMSX::vec_diff2</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_diff2</div><div class="ttdef"><b>Definition:</b> ROMSX.H:223</div></div>
<div class="ttc" id="aclassROMSX_html_a3ca3a726e1b0ecfc4339b2a07ade77b7"><div class="ttname"><a href="classROMSX.html#a3ca3a726e1b0ecfc4339b2a07ade77b7">ROMSX::set_weights</a></div><div class="ttdeci">void set_weights(int lev)</div><div class="ttdef"><b>Definition:</b> ROMSX_set_weights.cpp:10</div></div>
<div class="ttc" id="aclassROMSX_html_a44a44e4d82bc38d55daa03f281437113"><div class="ttname"><a href="classROMSX.html#a44a44e4d82bc38d55daa03f281437113">ROMSX::vec_svstr</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_svstr</div><div class="ttdef"><b>Definition:</b> ROMSX.H:242</div></div>
<div class="ttc" id="aclassROMSX_html_a48b99337b5ac313ce48a95ab0b9e73dc"><div class="ttname"><a href="classROMSX.html#a48b99337b5ac313ce48a95ab0b9e73dc">ROMSX::set_vmix</a></div><div class="ttdeci">void set_vmix(int lev)</div><div class="ttdef"><b>Definition:</b> ROMSX.cpp:372</div></div>
<div class="ttc" id="aclassROMSX_html_a5a981dafaf65d2d8d96f16e1e7467eb2"><div class="ttname"><a href="classROMSX.html#a5a981dafaf65d2d8d96f16e1e7467eb2">ROMSX::vec_bvstr</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_bvstr</div><div class="ttdef"><b>Definition:</b> ROMSX.H:248</div></div>
<div class="ttc" id="aclassROMSX_html_a5dd9fc911df600f1eb0e8f3c131d8353"><div class="ttname"><a href="classROMSX.html#a5dd9fc911df600f1eb0e8f3c131d8353">ROMSX::set_hmixcoef</a></div><div class="ttdeci">void set_hmixcoef(int lev)</div><div class="ttdef"><b>Definition:</b> ROMSX.cpp:381</div></div>
<div class="ttc" id="aclassROMSX_html_a606d7f526ef409ef78feb8ce127f98c9"><div class="ttname"><a href="classROMSX.html#a606d7f526ef409ef78feb8ce127f98c9">ROMSX::mapfac_m</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; mapfac_m</div><div class="ttdef"><b>Definition:</b> ROMSX.H:741</div></div>
<div class="ttc" id="aclassROMSX_html_a607e27d43f6eaebcf557c4ae17b8039a"><div class="ttname"><a href="classROMSX.html#a607e27d43f6eaebcf557c4ae17b8039a">ROMSX::vec_bustr</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_bustr</div><div class="ttdef"><b>Definition:</b> ROMSX.H:246</div></div>
<div class="ttc" id="aclassROMSX_html_a640f040827d96f0b2085a385f0faaa3b"><div class="ttname"><a href="classROMSX.html#a640f040827d96f0b2085a385f0faaa3b">ROMSX::vec_visc3d_r</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_visc3d_r</div><div class="ttdef"><b>Definition:</b> ROMSX.H:274</div></div>
<div class="ttc" id="aclassROMSX_html_a7a3b7fb166ec3acf1b1057f53e08adad"><div class="ttname"><a href="classROMSX.html#a7a3b7fb166ec3acf1b1057f53e08adad">ROMSX::vec_s_r</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_s_r</div><div class="ttdef"><b>Definition:</b> ROMSX.H:234</div></div>
<div class="ttc" id="aclassROMSX_html_a865698971c9689455573c4b81ecaf26c"><div class="ttname"><a href="classROMSX.html#a865698971c9689455573c4b81ecaf26c">ROMSX::mapfac_u</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; mapfac_u</div><div class="ttdef"><b>Definition:</b> ROMSX.H:742</div></div>
<div class="ttc" id="aclassROMSX_html_a9a453443ec491d496adbd2cf5ac292d8"><div class="ttname"><a href="classROMSX.html#a9a453443ec491d496adbd2cf5ac292d8">ROMSX::vec_y_r</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_y_r</div><div class="ttdef"><b>Definition:</b> ROMSX.H:228</div></div>
<div class="ttc" id="aclassROMSX_html_ab93d802ac3111e738dafe04367813135"><div class="ttname"><a href="classROMSX.html#ab93d802ac3111e738dafe04367813135">ROMSX::set_bathymetry</a></div><div class="ttdeci">void set_bathymetry(int lev)</div><div class="ttdef"><b>Definition:</b> ROMSX.cpp:362</div></div>
<div class="ttc" id="aclassROMSX_html_ac49463f0fb789402ba8641f289906456"><div class="ttname"><a href="classROMSX.html#ac49463f0fb789402ba8641f289906456">ROMSX::vec_rdrag</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vec_rdrag</div><div class="ttdef"><b>Definition:</b> ROMSX.H:244</div></div>
<div class="ttc" id="aclassROMSX_html_ad96e947b76f50a01928821d3cd2455f7"><div class="ttname"><a href="classROMSX.html#ad96e947b76f50a01928821d3cd2455f7">ROMSX::mapfac_v</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; mapfac_v</div><div class="ttdef"><b>Definition:</b> ROMSX.H:743</div></div>
<div class="ttc" id="astructSolverChoice_html_ab32c6e7161ddf37e8051743fae717cf5"><div class="ttname"><a href="structSolverChoice.html#ab32c6e7161ddf37e8051743fae717cf5">SolverChoice::rdrag</a></div><div class="ttdeci">amrex::Real rdrag</div><div class="ttdef"><b>Definition:</b> DataStruct.H:180</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a93658365b6d73248b584d7952b75a899"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93658365b6d73248b584d7952b75a899">&#9670;&nbsp;</a></span>InitData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::InitData </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize multilevel data </p>
<div class="fragment"><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;{</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">// Initialize the start time for our CPU-time tracker</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="classROMSX.html#ab3e7f280e92f9e5cbdad88a3f222069c">startCPUTime</a> = ParallelDescriptor::second();</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">// Map the words in the inputs file to BC types, then translate</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">//     those types into what they mean for each variable</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="classROMSX.html#abba6cffe4a459932b33465a0d126d4d8">init_bcs</a>();</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="classROMSX.html#a3d94cb5986d9f35bc8becc666cfaea3d">last_plot_file_step_1</a> = -1;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="classROMSX.html#a25ecb4567ed2adbaf9be2fbae65d3640">last_plot_file_step_2</a> = -1;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="classROMSX.html#a33906f6209da9e2a247b1022f60d24ac">last_check_file_step</a> = -1;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a> == <span class="stringliteral">&quot;&quot;</span>) {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="comment">// start simulation from the beginning</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> time = 0.0;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        InitFromScratch(time);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <a class="code" href="classROMSX.html#aae7ba5940968ecd9397fa506a7082933">init_only</a>(lev, time);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == <a class="code" href="DataStruct_8H.html#ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815">CouplingType::TwoWay</a>) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            <a class="code" href="classROMSX.html#a5a73ffdd93eed4bef7f0d3c6bdac0e6e">AverageDown</a>();</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="preprocessor">#ifdef ROMSX_USE_PARTICLES</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        particleData.init_particles((ParGDBBase*)GetParGDB(),<a class="code" href="classROMSX.html#a8e887c13b3d23581a26580f4e7e9aef0">vec_z_phys_nd</a>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// Restart from a checkpoint</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <a class="code" href="classROMSX.html#a9e841cff9ccca5ed1945876def44c681">restart</a>();</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">// Initialize flux registers (whether we start from scratch or restart)</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == <a class="code" href="DataStruct_8H.html#ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815">CouplingType::TwoWay</a>) {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <a class="code" href="classROMSX.html#afc5b78f8bc38863080c02301dba5377f">advflux_reg</a>[0] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            <a class="code" href="classROMSX.html#afc5b78f8bc38863080c02301dba5377f">advflux_reg</a>[lev] = <span class="keyword">new</span> YAFluxRegister(grids[lev], grids[lev-1],</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                                                   dmap[lev],  dmap[lev-1],</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                                                   geom[lev],  geom[lev-1],</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                                              ref_ratio[lev-1], lev, <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a> == <span class="stringliteral">&quot;&quot;</span> &amp;&amp; <a class="code" href="classROMSX.html#a216e5a3eb30ef276aef23458bd6ebd98">check_int</a> &gt; 0)</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="preprocessor">#ifdef ROMSX_USE_NETCDF</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a72cbded1c13914c8b88cd81ee1a95824">check_type</a> == <span class="stringliteral">&quot;netcdf&quot;</span>) {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;           WriteNCCheckpointFile();</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a72cbded1c13914c8b88cd81ee1a95824">check_type</a> == <span class="stringliteral">&quot;native&quot;</span>) {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;           <a class="code" href="classROMSX.html#acc4b85fa57f43aa0f68f33c4edd82611">WriteCheckpointFile</a>();</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <a class="code" href="classROMSX.html#a33906f6209da9e2a247b1022f60d24ac">last_check_file_step</a> = 0;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">if</span> ( (<a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a> == <span class="stringliteral">&quot;&quot;</span>) ||</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;         (<a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a> != <span class="stringliteral">&quot;&quot;</span> &amp;&amp; <a class="code" href="classROMSX.html#a90451fd26c3ca52a56982e35d2887214">plot_file_on_restart</a>) )</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#abaae04ebda466750a5480506239c6ca7">plot_int_1</a> &gt; 0)</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <a class="code" href="classROMSX.html#a0049697ad0398380ac5a058705fece48">WritePlotFile</a>(1,<a class="code" href="classROMSX.html#a6fd2ffd8760dc3b1d68392d18cc728ae">plot_var_names_1</a>);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <a class="code" href="classROMSX.html#a3d94cb5986d9f35bc8becc666cfaea3d">last_plot_file_step_1</a> = <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[0];</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#aa3cd25f16ca7432ac68b7a02a8880226">plot_int_2</a> &gt; 0)</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <a class="code" href="classROMSX.html#a0049697ad0398380ac5a058705fece48">WritePlotFile</a>(2,<a class="code" href="classROMSX.html#a9b9c22ebd57fa77b0bb64f3932acc51c">plot_var_names_2</a>);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <a class="code" href="classROMSX.html#a25ecb4567ed2adbaf9be2fbae65d3640">last_plot_file_step_2</a> = <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[0];</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a11fae6ec83db5a377afd32858e0a80a1">is_it_time_for_action</a>(<a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[0], <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[0], <a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[0], <a class="code" href="classROMSX.html#afcedb31381fd065fff2ca36196f8da40">sum_interval</a>, <a class="code" href="classROMSX.html#af638ada4294dcf5b33de335efef61de1">sum_per</a>)) {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <a class="code" href="classROMSX.html#a55bb606cb2f4fc86e05232b5c314a829">sum_integrated_quantities</a>(<a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[0]);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <a class="code" href="classROMSX.html#a6b84298925e299d4f57401ef3020227b">ComputeDt</a>();</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">// Fill ghost cells/faces</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev], *<a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev], <a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev], *<a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev], <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev], *<a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev], <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev], *<a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[lev], <a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="comment">// Copy from new into old just in case</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keywordtype">int</span> ngs   = <a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev]-&gt;nGrow();</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keywordtype">int</span> ngvel = <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev]-&gt;nGrow();</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        MultiFab::Copy(*<a class="code" href="classROMSX.html#a7a14aa971cac1b1ad0eb5d4b46b90343">cons_old</a>[lev],*<a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev],0,0,<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>,ngs);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        MultiFab::Copy(*<a class="code" href="classROMSX.html#af0b5074dc426b753beb5511bd63df407">xvel_old</a>[lev],*<a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev],0,0,1,ngvel);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        MultiFab::Copy(*<a class="code" href="classROMSX.html#a87f0b7446438b8145bdea79012b985f5">yvel_old</a>[lev],*<a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev],0,0,1,ngvel);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        MultiFab::Copy(*<a class="code" href="classROMSX.html#acb72d33af4be09dede2005fa6c901686">zvel_old</a>[lev],*<a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[lev],0,0,1,IntVect(ngvel,ngvel,0));</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    } <span class="comment">// lev</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;}</div>
<div class="ttc" id="aDataStruct_8H_html_ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815"><div class="ttname"><a href="DataStruct_8H.html#ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815">CouplingType::TwoWay</a></div><div class="ttdeci">@ TwoWay</div></div>
<div class="ttc" id="aclassROMSX_html_a11fae6ec83db5a377afd32858e0a80a1"><div class="ttname"><a href="classROMSX.html#a11fae6ec83db5a377afd32858e0a80a1">ROMSX::is_it_time_for_action</a></div><div class="ttdeci">bool is_it_time_for_action(int nstep, amrex::Real time, amrex::Real dt, int action_interval, amrex::Real action_per)</div><div class="ttdef"><b>Definition:</b> ROMSX_SumIQ.cpp:143</div></div>
<div class="ttc" id="aclassROMSX_html_a55bb606cb2f4fc86e05232b5c314a829"><div class="ttname"><a href="classROMSX.html#a55bb606cb2f4fc86e05232b5c314a829">ROMSX::sum_integrated_quantities</a></div><div class="ttdeci">void sum_integrated_quantities(amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ROMSX_SumIQ.cpp:9</div></div>
<div class="ttc" id="aclassROMSX_html_a5a73ffdd93eed4bef7f0d3c6bdac0e6e"><div class="ttname"><a href="classROMSX.html#a5a73ffdd93eed4bef7f0d3c6bdac0e6e">ROMSX::AverageDown</a></div><div class="ttdeci">void AverageDown()</div><div class="ttdef"><b>Definition:</b> ROMSX.cpp:559</div></div>
<div class="ttc" id="aclassROMSX_html_a90451fd26c3ca52a56982e35d2887214"><div class="ttname"><a href="classROMSX.html#a90451fd26c3ca52a56982e35d2887214">ROMSX::plot_file_on_restart</a></div><div class="ttdeci">int plot_file_on_restart</div><div class="ttdef"><b>Definition:</b> ROMSX.H:771</div></div>
<div class="ttc" id="aclassROMSX_html_a9e841cff9ccca5ed1945876def44c681"><div class="ttname"><a href="classROMSX.html#a9e841cff9ccca5ed1945876def44c681">ROMSX::restart</a></div><div class="ttdeci">void restart()</div><div class="ttdef"><b>Definition:</b> ROMSX.cpp:346</div></div>
<div class="ttc" id="aclassROMSX_html_aae7ba5940968ecd9397fa506a7082933"><div class="ttname"><a href="classROMSX.html#aae7ba5940968ecd9397fa506a7082933">ROMSX::init_only</a></div><div class="ttdeci">void init_only(int lev, amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ROMSX.cpp:401</div></div>
<div class="ttc" id="aclassROMSX_html_abba6cffe4a459932b33465a0d126d4d8"><div class="ttname"><a href="classROMSX.html#abba6cffe4a459932b33465a0d126d4d8">ROMSX::init_bcs</a></div><div class="ttdeci">void init_bcs()</div><div class="ttdef"><b>Definition:</b> ROMSX_init_bcs.cpp:9</div></div>
<div class="ttc" id="aclassROMSX_html_ae2d89ab211dd0d324dda03720b8c4bff"><div class="ttname"><a href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">ROMSX::restart_chkfile</a></div><div class="ttdeci">std::string restart_chkfile</div><div class="ttdef"><b>Definition:</b> ROMSX.H:781</div></div>
<div class="ttc" id="aclassROMSX_html_af638ada4294dcf5b33de335efef61de1"><div class="ttname"><a href="classROMSX.html#af638ada4294dcf5b33de335efef61de1">ROMSX::sum_per</a></div><div class="ttdeci">static amrex::Real sum_per</div><div class="ttdef"><b>Definition:</b> ROMSX.H:840</div></div>
<div class="ttc" id="aclassROMSX_html_afcedb31381fd065fff2ca36196f8da40"><div class="ttname"><a href="classROMSX.html#afcedb31381fd065fff2ca36196f8da40">ROMSX::sum_interval</a></div><div class="ttdeci">static int sum_interval</div><div class="ttdef"><b>Definition:</b> ROMSX.H:839</div></div>
<div class="ttc" id="astructSolverChoice_html_af976afa61859c07e6249963edc367c2d"><div class="ttname"><a href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">SolverChoice::coupling_type</a></div><div class="ttdeci">CouplingType coupling_type</div><div class="ttdef"><b>Definition:</b> DataStruct.H:169</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classROMSX_a93658365b6d73248b584d7952b75a899_icgraph.png" border="0" usemap="#aclassROMSX_a93658365b6d73248b584d7952b75a899_icgraph" alt=""/></div>
<map name="aclassROMSX_a93658365b6d73248b584d7952b75a899_icgraph" id="aclassROMSX_a93658365b6d73248b584d7952b75a899_icgraph">
<area shape="rect" title=" " alt="" coords="108,5,239,32"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="a1d1af171ee1ce7a7b4ab8e3908de7f1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d1af171ee1ce7a7b4ab8e3908de7f1d">&#9670;&nbsp;</a></span>initHSE()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::initHSE </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize HSE. </p>

</div>
</div>
<a id="acd827bd0a6a3e30ec9c105bc8a533a88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd827bd0a6a3e30ec9c105bc8a533a88">&#9670;&nbsp;</a></span>InitializeFromFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::InitializeFromFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a54b6fe8dfe7db9e4f0d5ae6af6b1156b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54b6fe8dfe7db9e4f0d5ae6af6b1156b">&#9670;&nbsp;</a></span>InitializeLevelFromData()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::InitializeLevelFromData </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>initial_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2e3c16fa9a25b28f842de8981ce7b00e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e3c16fa9a25b28f842de8981ce7b00e">&#9670;&nbsp;</a></span>initRayleigh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::initRayleigh </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize Rayleigh damping profiles. </p>

</div>
</div>
<a id="a11fae6ec83db5a377afd32858e0a80a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11fae6ec83db5a377afd32858e0a80a1">&#9670;&nbsp;</a></span>is_it_time_for_action()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ROMSX::is_it_time_for_action </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nstep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>action_interval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>action_per</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;{</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordtype">bool</span> int_test = (action_interval &gt; 0 &amp;&amp; nstep % action_interval == 0);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordtype">bool</span> per_test = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">if</span> (action_per &gt; 0.0) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_per_old = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(amrex::Math::floor((time - dtlev) / action_per));</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_per_new = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(amrex::Math::floor((time) / action_per));</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">if</span> (num_per_old != num_per_new) {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      per_test = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordflow">return</span> int_test || per_test;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8f756bf6c9c2c09f1d9f1d9ba0bf387e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f756bf6c9c2c09f1d9f1d9ba0bf387e">&#9670;&nbsp;</a></span>MakeNewLevelFromCoarse()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::MakeNewLevelFromCoarse </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::BoxArray &amp;&#160;</td>
          <td class="paramname"><em>ba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::DistributionMapping &amp;&#160;</td>
          <td class="paramname"><em>dm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Make a new level using provided BoxArray and DistributionMapping and fill with interpolated coarse level data. Overrides the pure virtual function in AmrCore </p>
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev]-&gt;define(ba, dm, <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>, <a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev-1]-&gt;nGrowVect());</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <a class="code" href="classROMSX.html#a7a14aa971cac1b1ad0eb5d4b46b90343">cons_old</a>[lev]-&gt;define(ba, dm, <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>, <a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev-1]-&gt;nGrowVect());</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev]-&gt;define(convert(ba, IntVect(1,0,0)), dm, 1, <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev-1]-&gt;nGrowVect());</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <a class="code" href="classROMSX.html#af0b5074dc426b753beb5511bd63df407">xvel_old</a>[lev]-&gt;define(convert(ba, IntVect(1,0,0)), dm, 1, <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev-1]-&gt;nGrowVect());</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev]-&gt;define(convert(ba, IntVect(0,1,0)), dm, 1, <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev-1]-&gt;nGrowVect());</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="classROMSX.html#a87f0b7446438b8145bdea79012b985f5">yvel_old</a>[lev]-&gt;define(convert(ba, IntVect(0,1,0)), dm, 1, <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev-1]-&gt;nGrowVect());</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[lev]-&gt;define(convert(ba, IntVect(0,0,1)), dm, 1, <a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[lev-1]-&gt;nGrowVect());</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="classROMSX.html#acb72d33af4be09dede2005fa6c901686">zvel_old</a>[lev]-&gt;define(convert(ba, IntVect(0,0,1)), dm, 1, <a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[lev-1]-&gt;nGrowVect());</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="classROMSX.html#aab4e25f240ebdc93f8fa58f522faf740">resize_stuff</a>(lev);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      <a class="code" href="classROMSX.html#a45591c69e52ac45b762eaa78880c6229">init_stuff</a>(lev, ba, dm);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev] = time;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="classROMSX.html#ac395453aa10633a05bb7323b2946101e">t_old</a>[lev] = time - 1.e200;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="classROMSX.html#afcdff09eb45a7281877f6bd97c07738f">FillCoarsePatch</a>(lev, time, <a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev], <a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev-1]);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="classROMSX.html#afcdff09eb45a7281877f6bd97c07738f">FillCoarsePatch</a>(lev, time, <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev], <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev-1]);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="classROMSX.html#afcdff09eb45a7281877f6bd97c07738f">FillCoarsePatch</a>(lev, time, <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev], <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev-1]);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="classROMSX.html#afcdff09eb45a7281877f6bd97c07738f">FillCoarsePatch</a>(lev, time, <a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[lev], <a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[lev-1]);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;}</div>
<div class="ttc" id="aclassROMSX_html_a45591c69e52ac45b762eaa78880c6229"><div class="ttname"><a href="classROMSX.html#a45591c69e52ac45b762eaa78880c6229">ROMSX::init_stuff</a></div><div class="ttdeci">void init_stuff(int lev, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm)</div><div class="ttdef"><b>Definition:</b> ROMSX_make_new_level.cpp:187</div></div>
<div class="ttc" id="aclassROMSX_html_aab4e25f240ebdc93f8fa58f522faf740"><div class="ttname"><a href="classROMSX.html#aab4e25f240ebdc93f8fa58f522faf740">ROMSX::resize_stuff</a></div><div class="ttdeci">void resize_stuff(int lev)</div><div class="ttdef"><b>Definition:</b> ROMSX_make_new_level.cpp:137</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac9e8dc15f5a291fb654b1ef1bdc47974"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9e8dc15f5a291fb654b1ef1bdc47974">&#9670;&nbsp;</a></span>MakeNewLevelFromScratch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::MakeNewLevelFromScratch </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::BoxArray &amp;&#160;</td>
          <td class="paramname"><em>ba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::DistributionMapping &amp;&#160;</td>
          <td class="paramname"><em>dm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Make a new level from scratch using provided BoxArray and DistributionMapping. Only used during initialization. Overrides the pure virtual function in AmrCore </p>
<div class="fragment"><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;{</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// Set BoxArray grids and DistributionMapping dmap in AMReX_AmrMesh.H class</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    SetBoxArray(lev, ba);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    SetDistributionMap(lev, dm);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;GRIDS AT LEVEL &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; ARE &quot;</span> &lt;&lt; ba &lt;&lt; std::endl;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// The number of ghost cells for density must be 1 greater than that for velocity</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">//     so that we can go back in forth between velocity and momentum on all faces</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">#if NGROW==2</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordtype">int</span> ngrow_state = <a class="code" href="classROMSX.html#a4e8f6e71ae2c366a6455882d029de926">ComputeGhostCells</a>(<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8e053ce39997ed619ac81aa4d5a1fd44">spatial_order</a>)+1;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordtype">int</span> ngrow_vels  = <a class="code" href="classROMSX.html#a4e8f6e71ae2c366a6455882d029de926">ComputeGhostCells</a>(<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8e053ce39997ed619ac81aa4d5a1fd44">spatial_order</a>)+1;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordtype">int</span> ngrow_state = <a class="code" href="classROMSX.html#a4e8f6e71ae2c366a6455882d029de926">ComputeGhostCells</a>(<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8e053ce39997ed619ac81aa4d5a1fd44">spatial_order</a>)+2;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordtype">int</span> ngrow_vels  = <a class="code" href="classROMSX.html#a4e8f6e71ae2c366a6455882d029de926">ComputeGhostCells</a>(<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8e053ce39997ed619ac81aa4d5a1fd44">spatial_order</a>)+2;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="classROMSX.html#a7a14aa971cac1b1ad0eb5d4b46b90343">cons_old</a>[lev] = <span class="keyword">new</span> MultiFab(ba, dm, <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>, ngrow_state);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev] = <span class="keyword">new</span> MultiFab(ba, dm, <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>, ngrow_state);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev] = <span class="keyword">new</span> MultiFab(convert(ba, IntVect(1,0,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="classROMSX.html#af0b5074dc426b753beb5511bd63df407">xvel_old</a>[lev] = <span class="keyword">new</span> MultiFab(convert(ba, IntVect(1,0,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev] = <span class="keyword">new</span> MultiFab(convert(ba, IntVect(0,1,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="classROMSX.html#a87f0b7446438b8145bdea79012b985f5">yvel_old</a>[lev] = <span class="keyword">new</span> MultiFab(convert(ba, IntVect(0,1,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[lev] = <span class="keyword">new</span> MultiFab(convert(ba, IntVect(0,0,1)), dm, 1, IntVect(ngrow_vels,ngrow_vels,0));</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="classROMSX.html#acb72d33af4be09dede2005fa6c901686">zvel_old</a>[lev] = <span class="keyword">new</span> MultiFab(convert(ba, IntVect(0,0,1)), dm, 1, IntVect(ngrow_vels,ngrow_vels,0));</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="classROMSX.html#aab4e25f240ebdc93f8fa58f522faf740">resize_stuff</a>(lev);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <a class="code" href="classROMSX.html#a45591c69e52ac45b762eaa78880c6229">init_stuff</a>(lev, ba, dm);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;}</div>
<div class="ttc" id="aclassROMSX_html_a4e8f6e71ae2c366a6455882d029de926"><div class="ttname"><a href="classROMSX.html#a4e8f6e71ae2c366a6455882d029de926">ROMSX::ComputeGhostCells</a></div><div class="ttdeci">AMREX_FORCE_INLINE int ComputeGhostCells(const int &amp;spatial_order)</div><div class="ttdef"><b>Definition:</b> ROMSX.H:893</div></div>
<div class="ttc" id="astructSolverChoice_html_a8e053ce39997ed619ac81aa4d5a1fd44"><div class="ttname"><a href="structSolverChoice.html#a8e053ce39997ed619ac81aa4d5a1fd44">SolverChoice::spatial_order</a></div><div class="ttdeci">int spatial_order</div><div class="ttdef"><b>Definition:</b> DataStruct.H:198</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adf6f2e4f8b883d81702ea424d90ff4de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf6f2e4f8b883d81702ea424d90ff4de">&#9670;&nbsp;</a></span>NumDataLogs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE int ROMSX::NumDataLogs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    {</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classROMSX.html#a854a34e778a776e3ca46f7eeac9813e4">datalog</a>.size();</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af8b5cf6a265b5815a0441e903e9f2dcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8b5cf6a265b5815a0441e903e9f2dcb">&#9670;&nbsp;</a></span>PlotFileName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ROMSX::PlotFileName </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>get plotfile name </p>

</div>
</div>
<a id="ae387d14721ffd15c0a57002fdbc150cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae387d14721ffd15c0a57002fdbc150cc">&#9670;&nbsp;</a></span>PlotFileVarNames()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vector&lt; std::string &gt; ROMSX::PlotFileVarNames </td>
          <td>(</td>
          <td class="paramtype">amrex::Vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>plot_var_names</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>set plotfile variables names </p>
<div class="fragment"><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;{</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    Vector&lt;std::string&gt; names;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    names.insert(names.end(), plot_var_names.begin(), plot_var_names.end());</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">return</span> names;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aae2265fdbf5360bf2409b673135281a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae2265fdbf5360bf2409b673135281a7">&#9670;&nbsp;</a></span>post_timestep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::post_timestep </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nstep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called after every level 0 timestep </p>
<div class="fragment"><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;{</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ROMSX::post_timestep()&quot;</span>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="preprocessor">#ifdef ROMSX_USE_PARTICLES</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    particleData.Redistribute();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == <a class="code" href="DataStruct_8H.html#ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815">CouplingType::TwoWay</a>)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = finest_level-1; lev &gt;= 0; lev--)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <span class="comment">// This call refluxes from the lev/lev+1 interface onto lev</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <a class="code" href="classROMSX.html#a2b610851883faf8e10f6ac7f660e3e44">getAdvFluxReg</a>(lev+1)-&gt;Reflux(*<a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev], 0, 0, <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <span class="comment">// We need to do this before anything else because refluxing changes the</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <span class="comment">// values of coarse cells underneath fine grids with the assumption they&#39;ll</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <span class="comment">// be over-written by averaging down</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <a class="code" href="classROMSX.html#a243ea260c190601764cb8b6368d18615">AverageDownTo</a>(lev);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a11fae6ec83db5a377afd32858e0a80a1">is_it_time_for_action</a>(nstep, time, dt_lev0, <a class="code" href="classROMSX.html#afcedb31381fd065fff2ca36196f8da40">sum_interval</a>, <a class="code" href="classROMSX.html#af638ada4294dcf5b33de335efef61de1">sum_per</a>)) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <a class="code" href="classROMSX.html#a55bb606cb2f4fc86e05232b5c314a829">sum_integrated_quantities</a>(time);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;}</div>
<div class="ttc" id="aclassROMSX_html_a2b610851883faf8e10f6ac7f660e3e44"><div class="ttname"><a href="classROMSX.html#a2b610851883faf8e10f6ac7f660e3e44">ROMSX::getAdvFluxReg</a></div><div class="ttdeci">AMREX_FORCE_INLINE amrex::YAFluxRegister * getAdvFluxReg(int lev)</div><div class="ttdef"><b>Definition:</b> ROMSX.H:920</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a514fa82950fa541fb1ebde3f9230eb51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a514fa82950fa541fb1ebde3f9230eb51">&#9670;&nbsp;</a></span>post_update()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::post_update </td>
          <td>(</td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>state_mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Geometry &amp;&#160;</td>
          <td class="paramname"><em>geom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a67ddc86fe4c43ffe1900646deba10f1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67ddc86fe4c43ffe1900646deba10f1c">&#9670;&nbsp;</a></span>prestep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::prestep </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf_uold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf_vold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_ru</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_rv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>S_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>S_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf_W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf_DC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_z_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_z_w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_sustr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_svstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_bustr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_bvstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nfirst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nstp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Wrapper function for prestep</p>
<p>prestep</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lev</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_uold</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_vold</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_u</td><td>(looks like reset in update_vel &lt;- prestep_uv_3d, so maybe just out </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_v</td><td>maybe just out </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_ru</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mf_rv</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">S_old</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">S_new</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">mf_W</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">[none</td><td>] mf_DC (temp) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_z_r</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_z_w</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_h</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_sustr</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_svstr</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_bustr</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_bvstr</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iic</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ntfirst</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnew</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nstp</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nrhs</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt_lev</td><td></td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;{</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> dxi              = Geom(lev).InvCellSizeArray();</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keyword">const</span> BoxArray&amp;            ba = S_old.boxArray();</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keyword">const</span> DistributionMapping&amp; dm = S_old.DistributionMap();</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">// Maybe not the best way to do this, but need to cache salt and temp since</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">// they get rewritten by prestep_t</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    MultiFab mf_saltcache(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    MultiFab mf_tempcache(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    MultiFab mf_scalarcache(ba,dm,<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    MultiFab::Copy(mf_scalarcache,S_new,0,0,<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    MultiFab::Copy(mf_saltcache,S_new,<a class="code" href="IndexDefines_8H.html#ab84ceec196f4b00670dab4fa7794d1cf">Salt_comp</a>,0,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    MultiFab::Copy(mf_tempcache,S_new,<a class="code" href="IndexDefines_8H.html#a2439ff23f4449b8ffa90ddc5bcb36173">Temp_comp</a>,0,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(S_new, TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; DC = mf_DC.array(mfi);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Akv = (<a class="code" href="classROMSX.html#aec2c137ce4314357035cbc7ae292338f">vec_Akv</a>[lev])-&gt;array(mfi);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Akt = (<a class="code" href="classROMSX.html#a63d077c5232d18aa0c31f1824b63b5ca">vec_Akt</a>[lev])-&gt;array(mfi);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Hz  = (<a class="code" href="classROMSX.html#aa5461758b528d199101b5ea74f9a6c12">vec_Hz</a>[lev])-&gt;array(mfi);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Huon  = (<a class="code" href="classROMSX.html#a24f02b944df51884168ab0c08c736c91">vec_Huon</a>[lev])-&gt;array(mfi);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Hvom  = (<a class="code" href="classROMSX.html#a21dcccced847102e553281c1852ce005">vec_Hvom</a>[lev])-&gt;array(mfi);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; z_r = (mf_z_r)-&gt;array(mfi);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; z_w= (mf_z_w)-&gt;array(mfi);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; h= (mf_h)-&gt;array(mfi);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; uold = (mf_uold).array(mfi);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; vold = (mf_vold).array(mfi);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; u = (mf_u).array(mfi);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; v = (mf_v).array(mfi);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; ru = (mf_ru)-&gt;array(mfi);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; rv = (mf_rv)-&gt;array(mfi);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; W = (mf_W).array(mfi);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; sustr = (mf_sustr)-&gt;array(mfi);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; svstr = (mf_svstr)-&gt;array(mfi);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; bustr = (mf_bustr)-&gt;array(mfi);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; bvstr = (mf_bvstr)-&gt;array(mfi);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> lambda = 1.0;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        Box bx = mfi.tilebox();</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        Box gbx = mfi.growntilebox();</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        Box gbx1 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        Box gbx2 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="comment">//Box gbx11 = mfi.growntilebox(IntVect(NGROW-1,NGROW-1,NGROW-1));</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="comment">//copy the tilebox</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        Box tbxp1 = bx;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        Box tbxp11 = bx;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        Box tbxp2 = bx;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="comment">//TODO: adjust for tiling</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="comment">//Box gbx3uneven(IntVect(AMREX_D_DECL(bx.smallEnd(0)-3,bx.smallEnd(1)-3,bx.smallEnd(2))),</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="comment">//               IntVect(AMREX_D_DECL(bx.bigEnd(0)+2,bx.bigEnd(1)+2,bx.bigEnd(2))));</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="comment">//Box gbx2uneven(IntVect(AMREX_D_DECL(bx.smallEnd(0)-2,bx.smallEnd(1)-2,bx.smallEnd(2))),</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="comment">//               IntVect(AMREX_D_DECL(bx.bigEnd(0)+1,bx.bigEnd(1)+1,bx.bigEnd(2))));</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="comment">//make only gbx be grown to match multifabs</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        tbxp2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        tbxp1.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        tbxp11.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1));</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        Box bxD = bx;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        bxD.makeSlab(2,0);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        Box gbx1D = gbx1;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        gbx1D.makeSlab(2,0);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        Box gbx2D = gbx2;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        gbx2D.makeSlab(2,0);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        Box tbxp1D = tbxp1;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        tbxp1D.makeSlab(2,0);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        Box tbxp2D = tbxp2;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        tbxp2D.makeSlab(2,0);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        FArrayBox fab_FC(tbxp2,1,amrex::The_Async_Arena()); <span class="comment">//3D</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        FArrayBox fab_pm(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        FArrayBox fab_pn(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        FArrayBox fab_on_u(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        FArrayBox fab_om_v(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        FArrayBox fab_om_u(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        FArrayBox fab_on_v(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        FArrayBox fab_om_r(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        FArrayBox fab_on_r(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        FArrayBox fab_om_p(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        FArrayBox fab_on_p(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        FArrayBox fab_pmon_u(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        FArrayBox fab_pnom_u(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        FArrayBox fab_pmon_v(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        FArrayBox fab_pnom_v(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="comment">//FArrayBox fab_oHz(gbx11,1,amrex::The_Async_Arena());</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keyword">auto</span> FC=fab_FC.array();</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keyword">auto</span> pm=fab_pm.array();</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keyword">auto</span> pn=fab_pn.array();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        ParallelFor(tbxp2D,</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <span class="comment">//Note: are the comment definitons right? Don&#39;t seem to match metrics.f90</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            pm(i,j,0) = dxi[0];</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            pn(i,j,0) = dxi[1];</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        });</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="comment">//From ini_fields and .in file</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="comment">//fab_Akt.setVal(1e-6);</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        FArrayBox fab_stflux(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keyword">auto</span> stflux= fab_stflux.array();</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        FArrayBox fab_btflux(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keyword">auto</span> btflux= fab_btflux.array();</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="comment">//From ini_fields and .in file</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="comment">//fab_stflux.setVal(0.0);</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="comment">//also set btflux=0 (as in ana_btflux.H)</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        ParallelFor(tbxp2,</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            stflux(i,j,k)=0.0;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            btflux(i,j,k)=0.0;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        });</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_comp=0; i_comp &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i_comp++) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            Array4&lt;Real&gt; <span class="keyword">const</span>&amp; sstore = (<a class="code" href="classROMSX.html#a3d747b62e29b6c979763cd243e61a866">vec_sstore</a>[lev])-&gt;array(mfi,i_comp);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <a class="code" href="classROMSX.html#a0d0910d02ead7f2406ba79c5b3474e05">prestep_t_advection</a>(bx, gbx, S_old.array(mfi,i_comp),</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                mf_scalarcache.array(mfi,i_comp), Hz, Huon, Hvom,</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                                pm, pn, W, DC, FC, sstore, z_w, h, iic, ntfirst,</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                                nrhs, N, dt_lev);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="comment">// Only do diffusion for salt and temperature, not other tracer(s)</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_comp=0; i_comp &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; i_comp++) {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <a class="code" href="classROMSX.html#a5357850164cf2ac2a2ba5eff1fb2b011">prestep_diffusion</a>(bx,gbx,0,0,S_new.array(mfi,i_comp), S_old.array(mfi,i_comp), ru,</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                              Hz, Akt, DC, FC, stflux, btflux, z_r, pm, pn, iic, iic, nnew, nstp,</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                              nrhs, N, lambda, dt_lev);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="comment">// prestep_uv_3d</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="comment">//updates u,v,ru,rv (ru and rv have multiple components)</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <a class="code" href="classROMSX.html#a5357850164cf2ac2a2ba5eff1fb2b011">prestep_diffusion</a>(tbxp1, gbx, 1, 0, u, uold, ru, Hz, Akv, DC, FC,</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                          sustr, bustr, z_r, pm, pn, iic, ntfirst, nnew, nstp, nrhs, N, lambda, dt_lev);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <a class="code" href="classROMSX.html#a5357850164cf2ac2a2ba5eff1fb2b011">prestep_diffusion</a>(tbxp1, gbx, 0, 1, v, vold, rv, Hz, Akv, DC, FC,</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                          svstr, bvstr, z_r, pm, pn, iic, ntfirst, nnew, nstp, nrhs, N, lambda, dt_lev);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;}</div>
<div class="ttc" id="aIndexDefines_8H_html_a2439ff23f4449b8ffa90ddc5bcb36173"><div class="ttname"><a href="IndexDefines_8H.html#a2439ff23f4449b8ffa90ddc5bcb36173">Temp_comp</a></div><div class="ttdeci">#define Temp_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:8</div></div>
<div class="ttc" id="aIndexDefines_8H_html_ab84ceec196f4b00670dab4fa7794d1cf"><div class="ttname"><a href="IndexDefines_8H.html#ab84ceec196f4b00670dab4fa7794d1cf">Salt_comp</a></div><div class="ttdeci">#define Salt_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:9</div></div>
<div class="ttc" id="aclassROMSX_html_a0d0910d02ead7f2406ba79c5b3474e05"><div class="ttname"><a href="classROMSX.html#a0d0910d02ead7f2406ba79c5b3474e05">ROMSX::prestep_t_advection</a></div><div class="ttdeci">void prestep_t_advection(const amrex::Box &amp;tbx, const amrex::Box &amp;gbx, amrex::Array4&lt; amrex::Real &gt; tempold, amrex::Array4&lt; amrex::Real &gt; tempcache, amrex::Array4&lt; amrex::Real &gt; Hz, amrex::Array4&lt; amrex::Real &gt; Huon, amrex::Array4&lt; amrex::Real &gt; Hvom, amrex::Array4&lt; amrex::Real &gt; pm, amrex::Array4&lt; amrex::Real &gt; pn, amrex::Array4&lt; amrex::Real &gt; W, amrex::Array4&lt; amrex::Real &gt; DC, amrex::Array4&lt; amrex::Real &gt; FC, amrex::Array4&lt; amrex::Real &gt; tempstore, amrex::Array4&lt; amrex::Real &gt; z_w, amrex::Array4&lt; amrex::Real &gt; h, int iic, int ntfirst, int nrhs, int N, const amrex::Real dt_lev)</div><div class="ttdef"><b>Definition:</b> ROMSX_prestep_t_advection.cpp:10</div></div>
<div class="ttc" id="aclassROMSX_html_a5357850164cf2ac2a2ba5eff1fb2b011"><div class="ttname"><a href="classROMSX.html#a5357850164cf2ac2a2ba5eff1fb2b011">ROMSX::prestep_diffusion</a></div><div class="ttdeci">void prestep_diffusion(const amrex::Box &amp;bx, const amrex::Box &amp;gbx, const int ioff, const int joff, amrex::Array4&lt; amrex::Real &gt; vel, amrex::Array4&lt; amrex::Real &gt; vel_old, amrex::Array4&lt; amrex::Real &gt; rvel, amrex::Array4&lt; amrex::Real &gt; Hz, amrex::Array4&lt; amrex::Real &gt; Akv, amrex::Array4&lt; amrex::Real &gt; pm, amrex::Array4&lt; amrex::Real &gt; pn, amrex::Array4&lt; amrex::Real &gt; DC, amrex::Array4&lt; amrex::Real &gt; FC, amrex::Array4&lt; amrex::Real &gt; sstr, amrex::Array4&lt; amrex::Real &gt; bstr, amrex::Array4&lt; amrex::Real &gt; z_r, const int iic, const int ntfirst, const int nnew, int nstp, int nrhs, int N, const amrex::Real lambda, const amrex::Real dt_lev)</div><div class="ttdef"><b>Definition:</b> ROMSX_prestep_diffusion.cpp:19</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5357850164cf2ac2a2ba5eff1fb2b011"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5357850164cf2ac2a2ba5eff1fb2b011">&#9670;&nbsp;</a></span>prestep_diffusion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::prestep_diffusion </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>gbx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ioff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>joff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>vel_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>rvel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>Akv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>pm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>pn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>DC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>FC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>sstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>bstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>z_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ntfirst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nstp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Update velocities or tracers with diffusion/viscosity as the last part of the prestep </p>
<div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;{</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    BoxArray ba_gbxvel = intersect(BoxArray(vel_bx), gbx);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    AMREX_ASSERT((ba_gbxvel.size() == 1));</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    Box gbxvel = ba_gbxvel[0];</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">//  Weighting coefficient for the newest (implicit) time step derivatives</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">//  using either a Crank-Nicolson implicit scheme (lambda=0.5) or a</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">//  backward implicit scheme (lambda=1.0).</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> oml_dt = dt_lev*(1.0-lambda);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">//N is one less than ROMS</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">//  Except the commented out part means lambda is always 1.0</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#ab37afaafcf05a9b10c0fba3180539610">verbose</a> &gt; 1) {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;in update_vel_3d with box &quot;</span> &lt;&lt; vel_bx &lt;&lt; std::endl;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;vel old &quot;</span> &lt;&lt; Box(vel_old) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;Akv &quot;</span> &lt;&lt; Box(Akv) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    ParallelFor(vel_bx,</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">if</span>(k+1&lt;=N&amp;&amp;k&gt;=0)</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = 1.0 / ( z_r(i,j,k+1)+z_r(i-ioff,j-joff,k+1)</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                              -z_r(i,j,k  )-z_r(i-ioff,j-joff,k  ));</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            FC(i,j,k) = oml_dt * cff * (vel_old(i,j,k+1,nstp)-vel_old(i,j,k,nstp)) *</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                                           (Akv(i,j,k)     +Akv(i-ioff,j-joff,k));</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k==-1)</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            FC(i,j,-1) = dt_lev*bstr(i,j,0);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k==N)</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            FC(i,j, N) = dt_lev*sstr(i,j,0);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        DC(i,j,k) = 0.25 * dt_lev * (pm(i,j,0)+pm(i-ioff,j-joff,0))</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                                      * (pn(i,j,0)+pn(i-ioff,j-joff,0));</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    });</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    ParallelFor(gbxvel,</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff3=dt_lev*(1.0-lambda);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1 = 0.0, cff2 = 0.0, cff4;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordtype">int</span> indx=0; <span class="comment">//nrhs-3</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">if</span> (iic==ntfirst)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            <span class="keywordflow">if</span> (k+1&lt;=N &amp;&amp; k&gt;=1)</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                cff1=vel_old(i,j,k,nstp)*0.5*(Hz(i,j,k)+Hz(i-ioff,j-joff,k));</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                cff2=FC(i,j,k)-FC(i,j,k-1);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                vel(i,j,k,nnew)=cff1+cff2;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(k==0)</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                cff1=vel_old(i,j,k,nstp)*0.5*(Hz(i,j,k)+Hz(i-ioff,j-joff,k));</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                cff2=FC(i,j,k)-dt_lev*bstr(i,j,0);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                vel(i,j,k,nnew)=cff1+cff2;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(k==N)</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                cff1=vel_old(i,j,k,nstp)*0.5*(Hz(i,j,k)+Hz(i-ioff,j-joff,k));</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                cff2=dt_lev*sstr(i,j,0)-FC(i,j,k-1); <span class="comment">//or: -FC(i,j,k-1)+dt_lev*sstr(i,j,0);</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                vel(i,j,k,nnew)=cff1+cff2;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(iic==ntfirst+1) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <span class="keywordflow">if</span> (k&lt;N &amp;&amp; k&gt;0) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                cff1=vel_old(i,j,k,nstp)*0.5*(Hz(i,j,k)+Hz(i-ioff,j-joff,k));</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                cff2=FC(i,j,k)-FC(i,j,k-1);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(k==0) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                cff1=vel_old(i,j,k,nstp)*0.5*(Hz(i,j,k)+Hz(i-ioff,j-joff,k));</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                cff2=FC(i,j,k)-dt_lev*bstr(i,j,0);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(k==N) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                cff1=vel_old(i,j,k,nstp)*0.5*(Hz(i,j,k)+Hz(i-ioff,j-joff,k));</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                cff2=dt_lev*sstr(i,j,0)-FC(i,j,k-1); <span class="comment">//or: -FC(i,j,k-1)+dt_lev*sstr(i,j,0);</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            cff3=0.5*DC(i,j,k);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="keywordflow">if</span>(ioff==0&amp;&amp;joff==0)</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                vel(i,j,k,nnew)=cff1 + cff2;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                indx=nrhs ? 0 : 1;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> r_swap= rvel(i,j,k,indx);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                rvel(i,j,k,indx) = rvel(i,j,k,nrhs);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                rvel(i,j,k,nrhs) = r_swap;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                vel(i,j,k,nnew)=cff1- cff3*rvel(i,j,k,indx)+ cff2;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            cff1= 5.0/12.0;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            cff2=16.0/12.0;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="keywordflow">if</span> (k==0) {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                cff3=vel_old(i,j,k,nstp)*0.5*(Hz(i,j,k)+Hz(i-ioff,j-joff,k));</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                cff4=FC(i,j,k)-dt_lev*bstr(i,j,0);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                <span class="comment">//cff4=FC(i,j,k)-FC(i,j,k-1);//-bustr(i,j,0);</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == N) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                cff3=vel_old(i,j,k,nstp)*0.5*(Hz(i,j,k)+Hz(i-ioff,j-joff,k));</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                cff4=dt_lev*sstr(i,j,0)-FC(i,j,k-1);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                cff3=vel_old(i,j,k,nstp)*0.5*(Hz(i,j,k)+Hz(i-ioff,j-joff,k));</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                cff4=FC(i,j,k)-FC(i,j,k-1);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <span class="keywordflow">if</span>(ioff==0&amp;&amp;joff==0)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                vel(i,j,k,nnew)=cff3 + cff4;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                indx=nrhs ? 0 : 1;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> r_swap= rvel(i,j,k,indx);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                rvel(i,j,k,indx) = rvel(i,j,k,nrhs);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                rvel(i,j,k,nrhs) = r_swap;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                vel(i,j,k,nnew)=cff3+</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                    DC(i,j,k)*(cff1*rvel(i,j,k,nrhs)-</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                               cff2*rvel(i,j,k,indx))+</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                    cff4;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                rvel(i,j,k,nrhs) = 0.0;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    });</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0d0910d02ead7f2406ba79c5b3474e05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d0910d02ead7f2406ba79c5b3474e05">&#9670;&nbsp;</a></span>prestep_t_advection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::prestep_t_advection </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>tbx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>gbx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>tempold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>tempcache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>Huon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>Hvom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>pm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>pn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>DC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>FC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>tempstore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>z_w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ntfirst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Prestep calculations for the tracers </p>
<div class="fragment"><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;{</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="comment">//copy the tilebox</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    Box gbx1 = tbx;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    Box gbx2 = tbx;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    Box tbxp1 = tbx;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    Box tbxp2 = tbx;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    tbxp1.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    tbxp2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    FArrayBox fab_FX(tbxp2,1,amrex::The_Async_Arena()); <span class="comment">//3D</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    FArrayBox fab_FE(tbxp2,1,amrex::The_Async_Arena()); <span class="comment">//3D</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    FArrayBox fab_curv(tbxp2,1,amrex::The_Async_Arena()); <span class="comment">//fab_curv.setVal(0.0);</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    FArrayBox fab_grad(tbxp2,1,amrex::The_Async_Arena()); <span class="comment">//fab_curv.setVal(0.0);</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keyword">auto</span> FX=fab_FX.array();</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keyword">auto</span> FE=fab_FE.array();</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keyword">auto</span> curv=fab_curv.array();</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keyword">auto</span> grad=fab_grad.array();</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    ParallelFor(tbxp2,</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        grad(i,j,k)=0.0;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        curv(i,j,k)=0.0;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        FX(i,j,k)=0.0;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        FE(i,j,k)=0.0;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    });</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    Box ubx = surroundingNodes(tbx,0);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    Box vbx = surroundingNodes(tbx,1);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    Box utbxp1 = surroundingNodes(tbxp1,0);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    Box vtbxp1 = surroundingNodes(tbxp1,1);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    Box gbx3uneven_init(IntVect(AMREX_D_DECL(tbx.smallEnd(0)-3,tbx.smallEnd(1)-3,tbx.smallEnd(2))),</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                   IntVect(AMREX_D_DECL(tbx.bigEnd(0)+2,tbx.bigEnd(1)+2,tbx.bigEnd(2))));</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    BoxArray ba_gbx3uneven = intersect(BoxArray(gbx3uneven_init), gbx);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    AMREX_ASSERT((ba_gbx3uneven.size() == 1));</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    Box gbx3uneven = ba_gbx3uneven[0];</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    gbx2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    BoxArray ba_gbx2 = intersect(BoxArray(gbx2), gbx);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    AMREX_ASSERT((ba_gbx2.size() == 1));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    gbx2 = ba_gbx2[0];</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    gbx1.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    BoxArray ba_gbx1 = intersect(BoxArray(gbx1), gbx);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    AMREX_ASSERT((ba_gbx1.size() == 1));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    gbx1 = ba_gbx1[0];</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">//------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">//  Vertically integrate horizontal mass flux divergence.</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">//------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">//Should really use gbx3uneven</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    Box gbx3unevenD = gbx3uneven;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    gbx3unevenD.makeSlab(2,0);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    Box gbx1D = gbx1;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    gbx1D.makeSlab(2,0);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    ParallelFor(gbx1D,</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="comment">//  Starting with zero vertical velocity at the bottom, integrate</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="comment">//  from the bottom (k=0) to the free-surface (k=N).  The w(:,:,N(ng))</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="comment">//  contains the vertical velocity at the free-surface, d(zeta)/d(t).</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="comment">//  Notice that barotropic mass flux divergence is not used directly.</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="comment">//W(i,j,-1)=0.0;</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordtype">int</span> k=0;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        W(i,j,k) = - (Huon(i+1,j,k)-Huon(i,j,k)) - (Hvom(i,j+1,k)-Hvom(i,j,k));</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordflow">for</span>(k=1;k&lt;=N;k++) {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            W(i,j,k) = W(i,j,k-1) - (Huon(i+1,j,k)-Huon(i,j,k)) - (Hvom(i,j+1,k)-Hvom(i,j,k));</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    });</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    ParallelFor(gbx1,</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="comment">//  Starting with zero vertical velocity at the bottom, integrate</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="comment">//  from the bottom (k=0) to the free-surface (k=N).  The w(:,:,N(ng))</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="comment">//  contains the vertical velocity at the free-surface, d(zeta)/d(t).</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="comment">//  Notice that barotropic mass flux divergence is not used directly.</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> wrk_i=W(i,j,N)/(z_w(i,j,N)+h(i,j,0,0));</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">if</span>(k!=N) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            W(i,j,k) = W(i,j,k)- wrk_i*(z_w(i,j,k)+h(i,j,0,0));</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    });</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    ParallelFor(gbx1,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordflow">if</span> (k == N) {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            W(i,j,N) = 0.0;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    });</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">//From ini_fields and .in file</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">//fab_Akt.setVal(1e-6);</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    FArrayBox fab_stflux(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keyword">auto</span> stflux= fab_stflux.array();</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    FArrayBox fab_btflux(tbxp2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keyword">auto</span> btflux= fab_btflux.array();</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">//From ini_fields and .in file</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">//fab_stflux.setVal(0.0);</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">//also set btflux=0 (as in ana_btflux.H)</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    ParallelFor(tbxp2,</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        stflux(i,j,k)=0.0;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        btflux(i,j,k)=0.0;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    });</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">//Use FC and DC as intermediate arrays for FX and FE</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">//First pass do centered 2d terms</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a57e1d7e053fa63774c4c44980272031a">flat_bathymetry</a>) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    ParallelFor(tbxp1,</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        FX(i,j,k)=Box(tempold).contains(i-1,j,k) ? Huon(i,j,k)*</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                    0.5*(tempold(i-1,j,k)+</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                         tempold(i  ,j,k)) : 1e34;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    });</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    ParallelFor(tbxp1,</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        FE(i,j,k)=Box(tempold).contains(i,j-1,k) ? Hvom(i,j,k)*</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                    0.5*(tempold(i,j-1,k)+</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                         tempold(i,j,k)) : 1e34;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    });</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    ParallelFor(utbxp1,</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="comment">//should be t index 3</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        FX(i,j,k)=tempold(i,j,k,nrhs)-tempold(i-1,j,k,nrhs);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    });</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    ParallelFor(vtbxp1,</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="comment">//should be t index 3</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        FE(i,j,k)=tempold(i,j,k,nrhs)-tempold(i,j-1,k,nrhs);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    });</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cffa=1.0/6.0;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cffb=1.0/3.0;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">Hadv_scheme</a> == <a class="code" href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca5b2d34872c0b46cfbabc832368e6ec7d">AdvectionScheme::upstream3</a>) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        ParallelFor(tbxp1,</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="comment">//Upstream3</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            curv(i,j,k)=-FX(i,j,k)+FX(i+1,j,k);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        });</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="comment">//HACK to avoid using the wrong index of t (using upstream3)</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        ParallelFor(tbxp1,</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> max_Huon=max(Huon(i,j,k),0.0); <span class="comment">//FArrayBox(Huon).max&lt;RunOn::Device&gt;();</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> min_Huon=min(Huon(i,j,k),0.0); <span class="comment">//FArrayBox(Huon).min&lt;RunOn::Device&gt;();</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            FX(i,j,k)=Huon(i,j,k)*0.5*(tempold(i,j,k)+tempold(i-1,j,k))-</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                cffa*(curv(i,j,k)*min_Huon+ curv(i-1,j,k)*max_Huon);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        });</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">Hadv_scheme</a> == <a class="code" href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca6d779455e4a7eebf97d6bcb893dd5235">AdvectionScheme::centered4</a>) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        ParallelFor(tbxp1,</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="comment">//Centered4</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            grad(i,j,k)=0.5*(FX(i,j,k)+FX(i+1,j,k));</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        });</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        ParallelFor(ubx,</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            FX(i,j,k)=Huon(i,j,k)*0.5*(tempold(i,j,k)+tempold(i-1,j,k)-</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                                       cffb*(grad(i,j,k)-grad(i-1,j,k)));</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        });</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        Error(<span class="stringliteral">&quot;Not a valid horizontal advection scheme&quot;</span>);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">Hadv_scheme</a> == <a class="code" href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca5b2d34872c0b46cfbabc832368e6ec7d">AdvectionScheme::upstream3</a>) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        ParallelFor(tbxp1,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            curv(i,j,k)=-FE(i,j,k)+FE(i,j+1,k);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        });</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="comment">//HACK to avoid using the wrong index of t (using upstream3)</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        ParallelFor(tbxp1,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> max_Hvom=max(Hvom(i,j,k),0.0); <span class="comment">//FArrayBox(Huon).max&lt;RunOn::Device&gt;();</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> min_Hvom=min(Hvom(i,j,k),0.0); <span class="comment">//FArrayBox(Huon).min&lt;RunOn::Device&gt;();</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            FE(i,j,k)=Hvom(i,j,k)*0.5*(tempold(i,j,k)+tempold(i,j-1,k))-</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                cffa*(curv(i,j,k)*min_Hvom+ curv(i,j-1,k)*max_Hvom);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        });</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">Hadv_scheme</a> == <a class="code" href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca6d779455e4a7eebf97d6bcb893dd5235">AdvectionScheme::centered4</a>) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        ParallelFor(tbxp1,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            grad(i,j,k)=0.5*(FE(i,j,k)+FE(i,j+1,k));</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        });</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        ParallelFor(vbx,</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            FE(i,j,k)=Hvom(i,j,k)*0.5*(tempold(i,j,k)+tempold(i,j-1,k)-</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                                       cffb*(grad(i,j,k)- grad(i,j-1,k)));</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        });</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        Error(<span class="stringliteral">&quot;Not a valid horizontal advection scheme&quot;</span>);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">//Intermediate tracer at 3</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">//  Time-step horizontal advection (m Tunits).</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1 = 0.0, cff2 = 0.0, cff;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> GammaT = 1.0/6.0;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">if</span> (iic==ntfirst)</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        cff=0.5*dt_lev;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        cff1=1.0;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        cff2=0.0;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        cff=(1-GammaT)*dt_lev;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        cff1=0.5+GammaT;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        cff2=0.5-GammaT;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    ParallelFor(tbx,</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        tempstore(i,j,k)=Hz(i,j,k)*(cff1*tempold(i,j,k)+</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                                    cff2*tempcache(i,j,k))-</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                                    cff*pm(i,j,0)*pn(i,j,0)*</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                                    (FX(i+1,j,k)-FX(i,j,k)+</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                     FE(i,j+1,k)-FE(i,j,k));</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    });</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">// Time-step vertical advection of tracers (Tunits). Impose artificial</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">// continuity equation.</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    ParallelFor(tbx,</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;              <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;              <span class="comment">//  Add in vertical advection.</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;              <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;              <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> c1=0.5;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;              <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> c2=7.0/12.0;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;              <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> c3=1.0/12.0;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;              <span class="keywordflow">if</span> (k&gt;=1 &amp;&amp; k&lt;=N-2)</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;              {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                      FC(i,j,k)=( c2*(tempold(i  ,j,k  ,nrhs)+ tempold(i,j,k+1,nrhs))</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                                 -c3*(tempold(i  ,j,k-1,nrhs)+ tempold(i,j,k+2,nrhs)) )*</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                                    ( W(i,j,k));</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;              }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;              <span class="keywordflow">else</span> <span class="comment">// this needs to be split up so that the following can be concurrent</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;              {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                  FC(i,j,N)=0.0;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                  FC(i,j,N-1) = ( c2*tempold(i,j,N-1,nrhs)+ c1*tempold(i,j,N,nrhs)-c3*tempold(i,j,N-2,nrhs) )</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                              * W(i,j,N-1);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                  FC(i,j,  0) = ( c2*tempold(i,j,  1,nrhs)+ c1*tempold(i,j,0,nrhs)-c3*tempold(i,j,2,nrhs) )</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                              * W(i,j,0);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;              }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    });</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    ParallelFor(tbxp1,</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keywordflow">if</span>(k-1&gt;=0) {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        DC(i,j,k)=1.0/(Hz(i,j,k)-</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                        cff*pm(i,j,0)*pn(i,j,0)*</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                        (Huon(i+1,j,k)-Huon(i,j,k)+</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                         Hvom(i,j+1,k)-Hvom(i,j,k)+</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                         (W(i,j,k)-W(i,j,k-1))));</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        DC(i,j,k)=1.0/(Hz(i,j,k)-</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                        cff*pm(i,j,0)*pn(i,j,0)*</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                        (Huon(i+1,j,k)-Huon(i,j,k)+</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                         Hvom(i,j+1,k)-Hvom(i,j,k)+</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                         (W(i,j,k))));</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    });</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    ParallelFor(tbx,</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> c1 = cff*pm(i,j,0)*pn(i,j,0);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> c4 = (k&gt;0) ? FC(i,j,k)-FC(i,j,k-1) : FC(i,j,k);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        tempstore(i,j,k) = DC(i,j,k)*(tempstore(i,j,k)-c1*c4);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    });</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;}</div>
<div class="ttc" id="aDataStruct_8H_html_a3ffde1e69b7cc5344b53bf310e4a212ca5b2d34872c0b46cfbabc832368e6ec7d"><div class="ttname"><a href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca5b2d34872c0b46cfbabc832368e6ec7d">AdvectionScheme::upstream3</a></div><div class="ttdeci">@ upstream3</div></div>
<div class="ttc" id="aDataStruct_8H_html_a3ffde1e69b7cc5344b53bf310e4a212ca6d779455e4a7eebf97d6bcb893dd5235"><div class="ttname"><a href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca6d779455e4a7eebf97d6bcb893dd5235">AdvectionScheme::centered4</a></div><div class="ttdeci">@ centered4</div></div>
<div class="ttc" id="astructSolverChoice_html_a4f1fced24fb1c3e55bc9b7333f211b9f"><div class="ttname"><a href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">SolverChoice::Hadv_scheme</a></div><div class="ttdeci">AdvectionScheme Hadv_scheme</div><div class="ttdef"><b>Definition:</b> DataStruct.H:166</div></div>
<div class="ttc" id="astructSolverChoice_html_a57e1d7e053fa63774c4c44980272031a"><div class="ttname"><a href="structSolverChoice.html#a57e1d7e053fa63774c4c44980272031a">SolverChoice::flat_bathymetry</a></div><div class="ttdeci">bool flat_bathymetry</div><div class="ttdef"><b>Definition:</b> DataStruct.H:153</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac8d98458b0900b3cd71925d37d248dde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8d98458b0900b3cd71925d37d248dde">&#9670;&nbsp;</a></span>prestep_uv_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::prestep_uv_3d </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>gbx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>uold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>vold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>ru</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>rv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>Akv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>pm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>pn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>DC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>FC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>z_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>sustr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>svstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>bustr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>bvstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ntfirst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nstp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Prestep calculations for momentum </p>

</div>
</div>
<a id="afae25c40f01d9ba6b5bca880660756e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afae25c40f01d9ba6b5bca880660756e3">&#9670;&nbsp;</a></span>prsgrd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::prsgrd </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>gbx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>utbx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>vtbx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>ru</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>rv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>on_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>om_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>FC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>z_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>z_w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nrhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;{</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keyword">auto</span> phi_bxD=phi_bx;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    phi_bxD.makeSlab(2,0);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keyword">auto</span> phi_gbxD=phi_gbx &amp; phi_bx;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    phi_gbxD.makeSlab(2,0);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    Box phi_ubx = surroundingNodes(phi_bx,0);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    Box phi_vbx = surroundingNodes(phi_bx,1);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keyword">auto</span> utbxD = utbx;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keyword">auto</span> vtbxD = vtbx;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    utbxD.makeSlab(2,0);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    vtbxD.makeSlab(2,0);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> OneFifth = 0.2_rt;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> OneTwelfth = 1.0_rt/12.0_rt;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> eps = 1.0E-10_rt;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> GRho=<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#aeee9d0099e1ac4105829345280a4f03c">g</a>/<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a87396b485f47a76010673143372cca17">rho0</a>;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> GRho0=1000.0_rt*GRho;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> HalfGRho=0.5_rt*GRho;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    FArrayBox fab_P(phi_bx,1,The_Async_Arena());</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    FArrayBox fab_aux(Box(z_r),1,The_Async_Arena());</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    FArrayBox fab_dR(phi_bx,1,The_Async_Arena());</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    FArrayBox fab_dZ(phi_bx,1,The_Async_Arena());</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    FArrayBox fab_dRx(phi_bx,1,The_Async_Arena());</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    FArrayBox fab_dZx(phi_bx,1,The_Async_Arena());</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keyword">auto</span> P=fab_P.array();</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keyword">auto</span> aux=fab_aux.array();</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keyword">auto</span> dR=fab_dR.array();</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keyword">auto</span> dZ=fab_dZ.array();</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keyword">auto</span> dRx=fab_dRx.array();</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keyword">auto</span> dZx=fab_dZx.array();</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">// Derivatives in the z direction</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    ParallelFor(phi_bx,</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">if</span>(k&gt;=0&amp;&amp;k&lt;N) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            dR(i,j,k)=rho(i,j,k+1)-rho(i,j,k);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            dZ(i,j,k)=z_r(i,j,k+1)-z_r(i,j,k);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            dR(i,j,N)=rho(i,j,N)-rho(i,j,N-1);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            dZ(i,j,N)=z_r(i,j,N)-z_r(i,j,N-1);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            <span class="comment">//This is really k=-1</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            <span class="comment">//dR(i,j,0)=dR(i,j,1);</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            <span class="comment">//dZ(i,j,0)=dZ(i,j,1);</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    });</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    ParallelFor(phi_bxD,</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=N;k&gt;=0;k--) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff= k&gt;0 ? 2.0*dR(i,j,k)*dR(i,j,k-1) : 2.0*dR(i,j,k)*dR(i,j,k);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keywordflow">if</span> (cff&gt;eps) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                dR(i,j,k)= k&gt;0 ? cff/(dR(i,j,k)+dR(i,j,k-1)) : cff/(dR(i,j,k)+dR(i,j,k));</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                dR(i,j,k)=0.0;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            dZ(i,j,k)= k&gt;0 ? 2.0_rt*dZ(i,j,k)*dZ(i,j,k-1)/(dZ(i,j,k)+dZ(i,j,k-1)) :</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                             2.0_rt*dZ(i,j,k)*dZ(i,j,k)/(dZ(i,j,k)+dZ(i,j,k));</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    });</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    ParallelFor(phi_bxD,</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=1.0_rt/(z_r(i,j,N)-z_r(i,j,N-1));</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2=0.5_rt*(rho(i,j,N)-rho(i,j,N-1))*(z_w(i,j,N)-z_r(i,j,N))*cff1;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        P(i,j,N)=GRho0*z_w(i,j,N)+GRho*(rho(i,j,N)+cff2)*(z_w(i,j,N)-z_r(i,j,N));</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=N-1;k&gt;=0;k--)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> rho_diff = rho(i,j,k+1)-rho(i,j,k) - OneTwelfth* (dR(i,j,k+1)+dR(i,j,k));</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>   z_diff = z_r(i,j,k+1)-z_r(i,j,k) - OneTwelfth* (dZ(i,j,k+1)+dZ(i,j,k));</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>   rz_avg = (rho(i,j,k+1)+rho(i,j,k)) * (z_r(i,j,k+1)-z_r(i,j,k));</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            P(i,j,k) = P(i,j,k+1) + HalfGRho * ( rz_avg -</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                          OneFifth* ( (dR(i,j,k+1)-dR(i,j,k)) *  z_diff -</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                      (dZ(i,j,k+1)-dZ(i,j,k)) * rho_diff ) );</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;         }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    });</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">//This should be nodal</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">// Derivatives in the x direction</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    ParallelFor(phi_ubx,</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        FC(i,j,k)=rho(i,j,k)-rho(i-1,j,k);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        aux(i,j,k)=z_r(i,j,k)-z_r(i-1,j,k);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    });</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">//This should be nodal aux and FC need wider boxes above</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">//dZx and dRx may have index mismatch issues at k=2 and k=N</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    ParallelFor(phi_bxD,</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=N;k&gt;=0;k--) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff= 2.0*aux(i,j,k)*aux(i+1,j,k);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="keywordflow">if</span> (cff&gt;eps) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1= 1.0_rt/(aux(i+1,j,k)+aux(i,j,k));</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                dZx(i,j,k)=cff*cff1;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                dZx(i,j,k)=0.0;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1= 2.0*FC(i,j,k)*FC(i+1,j,k);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="keywordflow">if</span> (cff1&gt;eps) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2= 1.0_rt/(FC(i,j,k)+FC(i+1,j,k));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                dRx(i,j,k)=cff1*cff2;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                dRx(i,j,k)=0.0;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    });</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">//This should be nodal aux and FC need wider boxes above</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    ParallelFor(utbxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=N;k&gt;=0;k--)</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> rho_diff   = rho(i,j,k)-rho(i-1,j,k)- OneTwelfth* (dRx(i,j,k)+dRx(i-1,j,k));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> z_r_diff   = z_r(i,j,k)-z_r(i-1,j,k)- OneTwelfth* (dZx(i,j,k)+dZx(i-1,j,k));</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>   Hz_avg   = 0.5_rt * (Hz(i,j,k)+Hz(i-1,j,k));</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            ru(i,j,k,nrhs) = on_u(i,j,0) * Hz_avg * (</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                            P(i-1,j,k) - P(i,j,k) - HalfGRho *</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                            ( (rho(i,j,k)+rho(i-1,j,k))*(z_r(i,j,k)-z_r(i-1,j,k))-</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                              OneFifth * ( (dRx(i,j,k)-dRx(i-1,j,k)) * z_r_diff -</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                                           (dZx(i,j,k)-dZx(i-1,j,k)) * rho_diff )</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                            )</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                                    );</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    });</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">//This should be nodal</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    ParallelFor(phi_vbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        FC(i,j,k)= rho(i,j,k)-rho(i,j-1,k);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        aux(i,j,k)= z_r(i,j,k)-z_r(i,j-1,k);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    });</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">//This should be nodal aux and FC need wider boxes above</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">//dZx and dRx may have index mismatch issues at k=2 and k=N</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    ParallelFor(phi_bxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=N;k&gt;=0;k--) {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff= 2.0*aux(i,j,k)*aux(i,j+1,k);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="keywordflow">if</span> (cff&gt;eps) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1= 1.0_rt/(aux(i,j+1,k)+aux(i,j,k));</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                dZx(i,j,k)=cff*cff1;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                dZx(i,j,k)=0.0;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1= 2.0*FC(i,j,k)*FC(i,j+1,k);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keywordflow">if</span> (cff1&gt;eps) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2= 1.0_rt/(FC(i,j,k)+FC(i,j+1,k));</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                dRx(i,j,k)=cff1*cff2;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                dRx(i,j,k)=0.0;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    });</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">//This should be nodal aux and FC need wider boxes above</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    ParallelFor(vtbxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=N;k&gt;=0;k--)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> rho_diff   = rho(i,j,k)-rho(i,j-1,k)- OneTwelfth* (dRx(i,j,k)+dRx(i,j-1,k));</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> z_r_diff   = z_r(i,j,k)-z_r(i,j-1,k)- OneTwelfth* (dZx(i,j,k)+dZx(i,j-1,k));</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>   Hz_avg   = 0.5_rt * (Hz(i,j,k)+Hz(i,j-1,k));</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            rv(i,j,k,nrhs) = om_v(i,j,0) * Hz_avg * (</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                            P(i,j-1,k) - P(i,j,k) - HalfGRho *</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                            ( (rho(i,j,k)+rho(i,j-1,k))*(z_r(i,j,k)-z_r(i,j-1,k))-</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                              OneFifth * ( (dRx(i,j,k)-dRx(i,j-1,k)) * z_r_diff -</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                           (dZx(i,j,k)-dZx(i,j-1,k)) * rho_diff )</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                            )</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                                                    );</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        } <span class="comment">// k</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    });</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;}</div>
<div class="ttc" id="astructSolverChoice_html_a87396b485f47a76010673143372cca17"><div class="ttname"><a href="structSolverChoice.html#a87396b485f47a76010673143372cca17">SolverChoice::rho0</a></div><div class="ttdeci">amrex::Real rho0</div><div class="ttdef"><b>Definition:</b> DataStruct.H:188</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a750d5e2613cd056f28a42a7eb950be05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a750d5e2613cd056f28a42a7eb950be05">&#9670;&nbsp;</a></span>ReadCheckpointFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::ReadCheckpointFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;{</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Restart from checkpoint &quot;</span> &lt;&lt; <a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">// Header</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    std::string File(<a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a> + <span class="stringliteral">&quot;/Header&quot;</span>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    VisMF::IO_Buffer io_buffer(VisMF::GetIOBufferSize());</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    Vector&lt;char&gt; fileCharPtr;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    ParallelDescriptor::ReadAndBcastFile(File, fileCharPtr);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    std::string fileCharPtrString(fileCharPtr.dataPtr());</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    std::istringstream is(fileCharPtrString, std::istringstream::in);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    std::string line, word;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordtype">int</span> chk_ncomp;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">// read in title line</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    std::getline(is, line);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">// read in finest_level</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    is &gt;&gt; finest_level;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="classROMSX.html#a20d2ef21f22efe90f8939f86ebc40b54">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">// read the number of components</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">// for each variable we store</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// conservative, cell-centered vars</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="classROMSX.html#a20d2ef21f22efe90f8939f86ebc40b54">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    AMREX_ASSERT(chk_ncomp == <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">// x-velocity on faces</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="classROMSX.html#a20d2ef21f22efe90f8939f86ebc40b54">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    AMREX_ASSERT(chk_ncomp == 1);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">// y-velocity on faces</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="classROMSX.html#a20d2ef21f22efe90f8939f86ebc40b54">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    AMREX_ASSERT(chk_ncomp == 1);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">// z-velocity on faces</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="classROMSX.html#a20d2ef21f22efe90f8939f86ebc40b54">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    AMREX_ASSERT(chk_ncomp == 1);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="classROMSX.html#a20d2ef21f22efe90f8939f86ebc40b54">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    AMREX_ASSERT(chk_ncomp == 2);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="classROMSX.html#a20d2ef21f22efe90f8939f86ebc40b54">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    AMREX_ASSERT(chk_ncomp == 2);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <a class="code" href="classROMSX.html#a20d2ef21f22efe90f8939f86ebc40b54">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    AMREX_ASSERT(chk_ncomp == 3);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="classROMSX.html#a20d2ef21f22efe90f8939f86ebc40b54">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    AMREX_ASSERT(chk_ncomp == 3);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">// read in array of istep</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    std::getline(is, line);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        std::istringstream lis(line);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordflow">while</span> (lis &gt;&gt; word) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[i++] = std::stoi(word);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">// read in array of dt</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    std::getline(is, line);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        std::istringstream lis(line);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keywordflow">while</span> (lis &gt;&gt; word) {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[i++] = std::stod(word);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">// read in array of t_new</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    std::getline(is, line);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        std::istringstream lis(line);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordflow">while</span> (lis &gt;&gt; word) {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[i++] = std::stod(word);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="comment">// read in level &#39;lev&#39; BoxArray from Header</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        BoxArray ba;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        ba.readFrom(is);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <a class="code" href="classROMSX.html#a20d2ef21f22efe90f8939f86ebc40b54">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="comment">// create a distribution mapping</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        DistributionMapping dm { ba, ParallelDescriptor::NProcs() };</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <a class="code" href="classROMSX.html#ac9e8dc15f5a291fb654b1ef1bdc47974">MakeNewLevelFromScratch</a> (lev, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev], ba, dm);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">// read in the MultiFab data</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        BoxList bl2d = grids[lev].boxList();</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; b : bl2d) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            b.setRange(2,0);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        BoxArray ba2d(std::move(bl2d));</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        MultiFab cons(grids[lev],dmap[lev],<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>,0);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        VisMF::Read(cons, amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Cell&quot;</span>));</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        MultiFab::Copy(*<a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev],cons,0,0,<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>,0);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        MultiFab xvel(convert(grids[lev],IntVect(1,0,0)),dmap[lev],1,0);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        VisMF::Read(xvel, amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;XFace&quot;</span>));</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        MultiFab::Copy(*<a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev],xvel,0,0,1,0);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        MultiFab yvel(convert(grids[lev],IntVect(0,1,0)),dmap[lev],1,0);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        VisMF::Read(yvel, amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;YFace&quot;</span>));</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        MultiFab::Copy(*<a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev],yvel,0,0,1,0);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        MultiFab zvel(convert(grids[lev],IntVect(0,0,1)),dmap[lev],1,0);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        VisMF::Read(zvel, amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;ZFace&quot;</span>));</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        MultiFab::Copy(*<a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[lev],zvel,0,0,1,0);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;       MultiFab mf_ru(grids[lev],dmap[lev],2,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;       VisMF::Read(mf_ru, amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;XRHS&quot;</span>));</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;       MultiFab::Copy(*(<a class="code" href="classROMSX.html#ab1343869d59f89fd4773bc7fa230aa73">vec_ru</a>[lev]),mf_ru,0,0,2,(<a class="code" href="classROMSX.html#ab1343869d59f89fd4773bc7fa230aa73">vec_ru</a>[lev])-&gt;nGrowVect());</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;       MultiFab mf_rv(grids[lev],dmap[lev],2,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;       VisMF::Read(mf_rv, amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;YRHS&quot;</span>));</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;       MultiFab::Copy(*(<a class="code" href="classROMSX.html#ab5041f0f370ab1ec4f7f7e16127c9039">vec_rv</a>[lev]),mf_rv,0,0,2,(<a class="code" href="classROMSX.html#ab5041f0f370ab1ec4f7f7e16127c9039">vec_rv</a>[lev])-&gt;nGrowVect());</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;       MultiFab mf_ubar(ba2d,dmap[lev],3,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;       VisMF::Read(mf_ubar, amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;XBar&quot;</span>));</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;       MultiFab::Copy(*(<a class="code" href="classROMSX.html#a047f6faef02a00ced0a6c1766e4c9b5a">vec_ubar</a>[lev]),mf_ubar,0,0,3,(<a class="code" href="classROMSX.html#a047f6faef02a00ced0a6c1766e4c9b5a">vec_ubar</a>[lev])-&gt;nGrowVect());</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;       MultiFab mf_vbar(ba2d,dmap[lev],3,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;       VisMF::Read(mf_vbar, amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;YBar&quot;</span>));</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;       MultiFab::Copy(*(<a class="code" href="classROMSX.html#a2a375f2e83347418b7cf5d4bd812ee55">vec_vbar</a>[lev]),mf_vbar,0,0,3,(<a class="code" href="classROMSX.html#a2a375f2e83347418b7cf5d4bd812ee55">vec_vbar</a>[lev])-&gt;nGrowVect());</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;       VisMF::Read(*(<a class="code" href="classROMSX.html#ab5b7ff78a167e59ae727b22094b39079">vec_rufrc</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;rufrc&quot;</span>));</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;       VisMF::Read(*(<a class="code" href="classROMSX.html#a52a5f265a370595f128046c31b9f31d5">vec_rvfrc</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;rvfrc&quot;</span>));</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;       VisMF::Read(*(<a class="code" href="classROMSX.html#a2082155131b8b7e0dec29068a92cece2">vec_sustr</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;sustr&quot;</span>));</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;       VisMF::Read(*(<a class="code" href="classROMSX.html#a44a44e4d82bc38d55daa03f281437113">vec_svstr</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;svstr&quot;</span>));</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;       VisMF::Read(*(<a class="code" href="classROMSX.html#ac49463f0fb789402ba8641f289906456">vec_rdrag</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;rdrag&quot;</span>));</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;       VisMF::Read(*(<a class="code" href="classROMSX.html#a607e27d43f6eaebcf557c4ae17b8039a">vec_bustr</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;bustr&quot;</span>));</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;       VisMF::Read(*(<a class="code" href="classROMSX.html#a5a981dafaf65d2d8d96f16e1e7467eb2">vec_bvstr</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;bvstr&quot;</span>));</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;       VisMF::Read(*(<a class="code" href="classROMSX.html#a18212e9657c0655cd29e0c6241c1224f">vec_DU_avg1</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;DU_avg1&quot;</span>));</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;       VisMF::Read(*(<a class="code" href="classROMSX.html#a883756f67229729f133b9bdf784c21ff">vec_DU_avg2</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;DU_avg2&quot;</span>));</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;       VisMF::Read(*(<a class="code" href="classROMSX.html#aa9738d90727df4f8aba2afb0ffed1e8f">vec_DV_avg1</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;DV_avg1&quot;</span>));</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;       VisMF::Read(*(<a class="code" href="classROMSX.html#a6847259dab9f6118da780bf623a9868a">vec_DV_avg2</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;DV_avg2&quot;</span>));</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;       VisMF::Read(*(<a class="code" href="classROMSX.html#ab026fffd3c4e9a9ef612cbb23132a1f5">vec_zeta</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;zeta&quot;</span>));</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;       VisMF::Read(*(<a class="code" href="classROMSX.html#ab962f23dc27b3ce17bb19e3b8c9991f8">vec_Zt_avg1</a>[lev]), amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Zt_avg1&quot;</span>));</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    }</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="preprocessor">#ifdef ROMSX_USE_PARTICLES</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   particleData.Restart((amrex::ParGDBBase*)GetParGDB(),<a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;}</div>
<div class="ttc" id="aclassROMSX_html_a20d2ef21f22efe90f8939f86ebc40b54"><div class="ttname"><a href="classROMSX.html#a20d2ef21f22efe90f8939f86ebc40b54">ROMSX::GotoNextLine</a></div><div class="ttdeci">static void GotoNextLine(std::istream &amp;is)</div><div class="ttdef"><b>Definition:</b> Checkpoint.cpp:8</div></div>
<div class="ttc" id="aclassROMSX_html_ac9e8dc15f5a291fb654b1ef1bdc47974"><div class="ttname"><a href="classROMSX.html#ac9e8dc15f5a291fb654b1ef1bdc47974">ROMSX::MakeNewLevelFromScratch</a></div><div class="ttdeci">virtual void MakeNewLevelFromScratch(int lev, amrex::Real time, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm) override</div><div class="ttdef"><b>Definition:</b> ROMSX_make_new_level.cpp:102</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae3543d5a8078423ea4ac399ee53a67b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3543d5a8078423ea4ac399ee53a67b9">&#9670;&nbsp;</a></span>ReadParameters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::ReadParameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>read in some parameters from inputs file </p>
<div class="fragment"><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;{</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        ParmParse pp;  <span class="comment">// Traditionally, max_step and stop_time do not have prefix.</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        pp.query(<span class="stringliteral">&quot;max_step&quot;</span>, <a class="code" href="classROMSX.html#ad895c0936e0bd64ca71ec355e5e164b6">max_step</a>);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        pp.query(<span class="stringliteral">&quot;stop_time&quot;</span>, <a class="code" href="classROMSX.html#a22dfd39392c026bd023c8f1d57fd0889">stop_time</a>);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    ParmParse pp(<a class="code" href="classROMSX.html#afda0f54b3ad1ed8dbb39bbef8ed48c92">pp_prefix</a>);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="comment">// The type of the file we restart from</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        pp.query(<span class="stringliteral">&quot;restart_type&quot;</span>, <a class="code" href="classROMSX.html#ae866db953617cc0cc4090aeedfd3103c">restart_type</a>);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        pp.query(<span class="stringliteral">&quot;regrid_int&quot;</span>, <a class="code" href="classROMSX.html#ab61e1364d5b301c8f727566234b9eb89">regrid_int</a>);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        pp.query(<span class="stringliteral">&quot;check_file&quot;</span>, <a class="code" href="classROMSX.html#a2e6058cb21bf6f6c2b491581fa742828">check_file</a>);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        pp.query(<span class="stringliteral">&quot;check_type&quot;</span>, <a class="code" href="classROMSX.html#a72cbded1c13914c8b88cd81ee1a95824">check_type</a>);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        pp.query(<span class="stringliteral">&quot;check_int&quot;</span>, <a class="code" href="classROMSX.html#a216e5a3eb30ef276aef23458bd6ebd98">check_int</a>);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        pp.query(<span class="stringliteral">&quot;restart&quot;</span>, <a class="code" href="classROMSX.html#ae2d89ab211dd0d324dda03720b8c4bff">restart_chkfile</a>);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keywordflow">if</span> (pp.contains(<span class="stringliteral">&quot;data_log&quot;</span>))</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            <span class="keywordtype">int</span> num_datalogs = pp.countval(<span class="stringliteral">&quot;data_log&quot;</span>);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            <a class="code" href="classROMSX.html#a854a34e778a776e3ca46f7eeac9813e4">datalog</a>.resize(num_datalogs);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <a class="code" href="classROMSX.html#ae308f7068f2eb8e48913fc77d32f9065">datalogname</a>.resize(num_datalogs);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            pp.queryarr(<span class="stringliteral">&quot;data_log&quot;</span>,<a class="code" href="classROMSX.html#ae308f7068f2eb8e48913fc77d32f9065">datalogname</a>,0,num_datalogs);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_datalogs; i++)</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                <a class="code" href="classROMSX.html#abdccbdf27483fa87a7fc769ef6aa16fd">setRecordDataInfo</a>(i,<a class="code" href="classROMSX.html#ae308f7068f2eb8e48913fc77d32f9065">datalogname</a>[i]);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="comment">// Verbosity</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        pp.query(<span class="stringliteral">&quot;v&quot;</span>, <a class="code" href="classROMSX.html#ab37afaafcf05a9b10c0fba3180539610">verbose</a>);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="comment">// Frequency of diagnostic output</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        pp.query(<span class="stringliteral">&quot;sum_interval&quot;</span>, <a class="code" href="classROMSX.html#afcedb31381fd065fff2ca36196f8da40">sum_interval</a>);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        pp.query(<span class="stringliteral">&quot;sum_period&quot;</span>  , <a class="code" href="classROMSX.html#af638ada4294dcf5b33de335efef61de1">sum_per</a>);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="comment">// Time step controls</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        pp.query(<span class="stringliteral">&quot;cfl&quot;</span>, <a class="code" href="classROMSX.html#a87dc05168f41e1ad8b45d1030655f6e7">cfl</a>);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        pp.query(<span class="stringliteral">&quot;init_shrink&quot;</span>, <a class="code" href="classROMSX.html#afc2d5ca5334b8dc2acb9c6c57febbcf1">init_shrink</a>);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        pp.query(<span class="stringliteral">&quot;change_max&quot;</span>, <a class="code" href="classROMSX.html#afe5f357fc00e46eb1445f35f84cbdf8e">change_max</a>);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        pp.query(<span class="stringliteral">&quot;fixed_dt&quot;</span>, <a class="code" href="classROMSX.html#a9f1ff8349f4357e88dc70143f163b392">fixed_dt</a>);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        pp.query(<span class="stringliteral">&quot;fixed_fast_dt&quot;</span>, <a class="code" href="classROMSX.html#a9b13ff6c8fec8f7ac0eb7330732d9bcc">fixed_fast_dt</a>);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        pp.query(<span class="stringliteral">&quot;fixed_ndtfast_ratio&quot;</span>, <a class="code" href="classROMSX.html#a676fc3cc2402734727ca9e04e050d171">fixed_ndtfast_ratio</a>);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <span class="comment">// If all three are specified, they must be consistent</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a9f1ff8349f4357e88dc70143f163b392">fixed_dt</a> &gt; 0. &amp;&amp; <a class="code" href="classROMSX.html#a9b13ff6c8fec8f7ac0eb7330732d9bcc">fixed_fast_dt</a> &gt; 0. &amp;&amp;  <a class="code" href="classROMSX.html#a676fc3cc2402734727ca9e04e050d171">fixed_ndtfast_ratio</a> &gt; 0)</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        {</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a9f1ff8349f4357e88dc70143f163b392">fixed_dt</a> / <a class="code" href="classROMSX.html#a9b13ff6c8fec8f7ac0eb7330732d9bcc">fixed_fast_dt</a> != <a class="code" href="classROMSX.html#a676fc3cc2402734727ca9e04e050d171">fixed_ndtfast_ratio</a>)</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                amrex::Abort(<span class="stringliteral">&quot;Dt is over-specfied&quot;</span>);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        }</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="comment">// If two are specified, initialize fixed_ndtfast_ratio</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a9f1ff8349f4357e88dc70143f163b392">fixed_dt</a> &gt; 0. &amp;&amp; <a class="code" href="classROMSX.html#a9b13ff6c8fec8f7ac0eb7330732d9bcc">fixed_fast_dt</a> &gt; 0. &amp;&amp;  <a class="code" href="classROMSX.html#a676fc3cc2402734727ca9e04e050d171">fixed_ndtfast_ratio</a> &lt;= 0)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            <a class="code" href="classROMSX.html#a676fc3cc2402734727ca9e04e050d171">fixed_ndtfast_ratio</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classROMSX.html#a9f1ff8349f4357e88dc70143f163b392">fixed_dt</a> / <a class="code" href="classROMSX.html#a9b13ff6c8fec8f7ac0eb7330732d9bcc">fixed_fast_dt</a>);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        pp.query(<span class="stringliteral">&quot;do_substep&quot;</span>, <a class="code" href="classROMSX.html#a116ad0a8fa0753367f3458e5744c8e8e">do_substep</a>);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        AMREX_ASSERT(<a class="code" href="classROMSX.html#a87dc05168f41e1ad8b45d1030655f6e7">cfl</a> &gt; 0. || <a class="code" href="classROMSX.html#a9f1ff8349f4357e88dc70143f163b392">fixed_dt</a> &gt; 0.);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="comment">// We use this to keep track of how many boxes we read in from WRF initialization</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <a class="code" href="classROMSX.html#adb84a2eea3c51e9954981176e98341c3">num_files_at_level</a>.resize(max_level+1,0);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="comment">// We use this to keep track of how many boxes are specified thru the refinement indicators</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <a class="code" href="classROMSX.html#a2b67bb92b64c187e9869d8f8726e4e42">num_boxes_at_level</a>.resize(max_level+1,0);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            <a class="code" href="classROMSX.html#ab8125e3b638f29f6f08872c2cefd5335">boxes_at_level</a>.resize(max_level+1);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="comment">// We always have exactly one file at level 0</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <a class="code" href="classROMSX.html#a2b67bb92b64c187e9869d8f8726e4e42">num_boxes_at_level</a>[0] = 1;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <a class="code" href="classROMSX.html#ab8125e3b638f29f6f08872c2cefd5335">boxes_at_level</a>[0].resize(1);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <a class="code" href="classROMSX.html#ab8125e3b638f29f6f08872c2cefd5335">boxes_at_level</a>[0][0] = geom[0].Domain();</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="comment">// Output format</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        pp.query(<span class="stringliteral">&quot;plotfile_type&quot;</span>, <a class="code" href="classROMSX.html#a802f6c0afcdf21170461376c39e9701a">plotfile_type</a>);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a802f6c0afcdf21170461376c39e9701a">plotfile_type</a> != <span class="stringliteral">&quot;amrex&quot;</span> &amp;&amp;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            <a class="code" href="classROMSX.html#a802f6c0afcdf21170461376c39e9701a">plotfile_type</a> != <span class="stringliteral">&quot;netcdf&quot;</span> &amp;&amp; <a class="code" href="classROMSX.html#a802f6c0afcdf21170461376c39e9701a">plotfile_type</a> != <span class="stringliteral">&quot;NetCDF&quot;</span>)</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;User selected plotfile_type = &quot;</span> &lt;&lt; <a class="code" href="classROMSX.html#a802f6c0afcdf21170461376c39e9701a">plotfile_type</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            amrex::Abort(<span class="stringliteral">&quot;Dont know this plotfile_type&quot;</span>);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="preprocessor">#ifndef ROMSX_USE_NETCDF</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a802f6c0afcdf21170461376c39e9701a">plotfile_type</a> == <span class="stringliteral">&quot;netcdf&quot;</span> || <a class="code" href="classROMSX.html#a802f6c0afcdf21170461376c39e9701a">plotfile_type</a> == <span class="stringliteral">&quot;NetCDF&quot;</span>)</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            amrex::Abort(<span class="stringliteral">&quot;Please compile with NetCDF in order to enable NetCDF plotfiles&quot;</span>);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        }</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="preprocessor">#ifdef ROMSX_USE_NETCDF</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <a class="code" href="classROMSX.html#ae637f59528ab8ecd6d5780a4b9e667e5">nc_init_file</a>.resize(max_level+1);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="comment">// NetCDF initialization files -- possibly multiple files at each of multiple levels</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <span class="comment">//        but we always have exactly one file at level 0</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= max_level; lev++)</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            <span class="keyword">const</span> std::string nc_file_names = amrex::Concatenate(<span class="stringliteral">&quot;nc_init_file_&quot;</span>,lev,1);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            <span class="keywordflow">if</span> (pp.contains(nc_file_names.c_str()))</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            {</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                <span class="keywordtype">int</span> num_files = pp.countval(nc_file_names.c_str());</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                <a class="code" href="classROMSX.html#adb84a2eea3c51e9954981176e98341c3">num_files_at_level</a>[lev] = num_files;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                <a class="code" href="classROMSX.html#ae637f59528ab8ecd6d5780a4b9e667e5">nc_init_file</a>[lev].resize(num_files);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                pp.queryarr(nc_file_names.c_str(), <a class="code" href="classROMSX.html#ae637f59528ab8ecd6d5780a4b9e667e5">nc_init_file</a>[lev],0,num_files);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; num_files; j++)</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Reading NC init file names at level &quot;</span> &lt;&lt; lev &lt;&lt;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                                       <span class="stringliteral">&quot; and index &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; <a class="code" href="classROMSX.html#ae637f59528ab8ecd6d5780a4b9e667e5">nc_init_file</a>[lev][j] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        pp.query(<span class="stringliteral">&quot;plot_file_1&quot;</span>, <a class="code" href="classROMSX.html#a05371cb6acdebe55d3aa25bebbaa65e2">plot_file_1</a>);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        pp.query(<span class="stringliteral">&quot;plot_file_2&quot;</span>, <a class="code" href="classROMSX.html#aa0f18c68a94b27d41e87d49662ec0ac1">plot_file_2</a>);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        pp.query(<span class="stringliteral">&quot;plot_int_1&quot;</span>, <a class="code" href="classROMSX.html#abaae04ebda466750a5480506239c6ca7">plot_int_1</a>);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        pp.query(<span class="stringliteral">&quot;plot_int_2&quot;</span>, <a class="code" href="classROMSX.html#aa3cd25f16ca7432ac68b7a02a8880226">plot_int_2</a>);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="preprocessor">#ifdef ROMSX_USE_PARTICLES</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        particleData.init_particle_params();</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    }</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4829661b558b213e32970a02e147077f">init_params</a>();</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;}</div>
<div class="ttc" id="aclassROMSX_html_a05371cb6acdebe55d3aa25bebbaa65e2"><div class="ttname"><a href="classROMSX.html#a05371cb6acdebe55d3aa25bebbaa65e2">ROMSX::plot_file_1</a></div><div class="ttdeci">std::string plot_file_1</div><div class="ttdef"><b>Definition:</b> ROMSX.H:802</div></div>
<div class="ttc" id="aclassROMSX_html_a2b67bb92b64c187e9869d8f8726e4e42"><div class="ttname"><a href="classROMSX.html#a2b67bb92b64c187e9869d8f8726e4e42">ROMSX::num_boxes_at_level</a></div><div class="ttdeci">amrex::Vector&lt; int &gt; num_boxes_at_level</div><div class="ttdef"><b>Definition:</b> ROMSX.H:725</div></div>
<div class="ttc" id="aclassROMSX_html_a2e6058cb21bf6f6c2b491581fa742828"><div class="ttname"><a href="classROMSX.html#a2e6058cb21bf6f6c2b491581fa742828">ROMSX::check_file</a></div><div class="ttdeci">std::string check_file</div><div class="ttdef"><b>Definition:</b> ROMSX.H:808</div></div>
<div class="ttc" id="aclassROMSX_html_a802f6c0afcdf21170461376c39e9701a"><div class="ttname"><a href="classROMSX.html#a802f6c0afcdf21170461376c39e9701a">ROMSX::plotfile_type</a></div><div class="ttdeci">static std::string plotfile_type</div><div class="ttdef"><b>Definition:</b> ROMSX.H:843</div></div>
<div class="ttc" id="aclassROMSX_html_a9b13ff6c8fec8f7ac0eb7330732d9bcc"><div class="ttname"><a href="classROMSX.html#a9b13ff6c8fec8f7ac0eb7330732d9bcc">ROMSX::fixed_fast_dt</a></div><div class="ttdeci">static amrex::Real fixed_fast_dt</div><div class="ttdef"><b>Definition:</b> ROMSX.H:790</div></div>
<div class="ttc" id="aclassROMSX_html_aa0f18c68a94b27d41e87d49662ec0ac1"><div class="ttname"><a href="classROMSX.html#aa0f18c68a94b27d41e87d49662ec0ac1">ROMSX::plot_file_2</a></div><div class="ttdeci">std::string plot_file_2</div><div class="ttdef"><b>Definition:</b> ROMSX.H:803</div></div>
<div class="ttc" id="aclassROMSX_html_ab61e1364d5b301c8f727566234b9eb89"><div class="ttname"><a href="classROMSX.html#ab61e1364d5b301c8f727566234b9eb89">ROMSX::regrid_int</a></div><div class="ttdeci">int regrid_int</div><div class="ttdef"><b>Definition:</b> ROMSX.H:799</div></div>
<div class="ttc" id="aclassROMSX_html_ab8125e3b638f29f6f08872c2cefd5335"><div class="ttname"><a href="classROMSX.html#ab8125e3b638f29f6f08872c2cefd5335">ROMSX::boxes_at_level</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Box &gt; &gt; boxes_at_level</div><div class="ttdef"><b>Definition:</b> ROMSX.H:727</div></div>
<div class="ttc" id="aclassROMSX_html_abdccbdf27483fa87a7fc769ef6aa16fd"><div class="ttname"><a href="classROMSX.html#abdccbdf27483fa87a7fc769ef6aa16fd">ROMSX::setRecordDataInfo</a></div><div class="ttdeci">void setRecordDataInfo(int i, const std::string &amp;filename)</div><div class="ttdef"><b>Definition:</b> ROMSX.H:957</div></div>
<div class="ttc" id="aclassROMSX_html_adb84a2eea3c51e9954981176e98341c3"><div class="ttname"><a href="classROMSX.html#adb84a2eea3c51e9954981176e98341c3">ROMSX::num_files_at_level</a></div><div class="ttdeci">amrex::Vector&lt; int &gt; num_files_at_level</div><div class="ttdef"><b>Definition:</b> ROMSX.H:726</div></div>
<div class="ttc" id="aclassROMSX_html_ae637f59528ab8ecd6d5780a4b9e667e5"><div class="ttname"><a href="classROMSX.html#ae637f59528ab8ecd6d5780a4b9e667e5">ROMSX::nc_init_file</a></div><div class="ttdeci">static amrex::Vector&lt; amrex::Vector&lt; std::string &gt; &gt; nc_init_file</div><div class="ttdef"><b>Definition:</b> ROMSX.H:846</div></div>
<div class="ttc" id="aclassROMSX_html_ae866db953617cc0cc4090aeedfd3103c"><div class="ttname"><a href="classROMSX.html#ae866db953617cc0cc4090aeedfd3103c">ROMSX::restart_type</a></div><div class="ttdeci">std::string restart_type</div><div class="ttdef"><b>Definition:</b> ROMSX.H:810</div></div>
<div class="ttc" id="aclassROMSX_html_afc2d5ca5334b8dc2acb9c6c57febbcf1"><div class="ttname"><a href="classROMSX.html#afc2d5ca5334b8dc2acb9c6c57febbcf1">ROMSX::init_shrink</a></div><div class="ttdeci">static amrex::Real init_shrink</div><div class="ttdef"><b>Definition:</b> ROMSX.H:785</div></div>
<div class="ttc" id="aclassROMSX_html_afda0f54b3ad1ed8dbb39bbef8ed48c92"><div class="ttname"><a href="classROMSX.html#afda0f54b3ad1ed8dbb39bbef8ed48c92">ROMSX::pp_prefix</a></div><div class="ttdeci">std::string pp_prefix</div><div class="ttdef"><b>Definition:</b> ROMSX.H:182</div></div>
<div class="ttc" id="astructSolverChoice_html_a4829661b558b213e32970a02e147077f"><div class="ttname"><a href="structSolverChoice.html#a4829661b558b213e32970a02e147077f">SolverChoice::init_params</a></div><div class="ttdeci">void init_params()</div><div class="ttdef"><b>Definition:</b> DataStruct.H:35</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a95cf73016433f9bc8822da57b7f3736e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95cf73016433f9bc8822da57b7f3736e">&#9670;&nbsp;</a></span>refinement_criteria_setup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::refinement_criteria_setup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to define the refinement criteria based on user input </p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordflow">if</span> (max_level &gt; 0)</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        ParmParse pp(<a class="code" href="classROMSX.html#afda0f54b3ad1ed8dbb39bbef8ed48c92">pp_prefix</a>);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        Vector&lt;std::string&gt; refinement_indicators;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        pp.queryarr(<span class="stringliteral">&quot;refinement_indicators&quot;</span>,refinement_indicators,0,pp.countval(<span class="stringliteral">&quot;refinement_indicators&quot;</span>));</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;refinement_indicators.size(); ++i)</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            std::string ref_prefix = <a class="code" href="classROMSX.html#afda0f54b3ad1ed8dbb39bbef8ed48c92">pp_prefix</a> + <span class="stringliteral">&quot;.&quot;</span> + refinement_indicators[i];</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            ParmParse ppr(ref_prefix);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            RealBox realbox;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            <span class="keywordtype">int</span> lev_for_box;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;in_box_lo&quot;</span>)) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                std::vector&lt;Real&gt; box_lo(3), box_hi(3);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                ppr.get(<span class="stringliteral">&quot;max_level&quot;</span>,lev_for_box);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                <span class="keywordflow">if</span> (lev_for_box &lt;= max_level)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                    ppr.getarr(<span class="stringliteral">&quot;in_box_lo&quot;</span>,box_lo,0,2);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                    ppr.getarr(<span class="stringliteral">&quot;in_box_hi&quot;</span>,box_hi,0,2);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                    box_lo[2] = geom[0].ProbLo(2);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                    box_hi[2] = geom[0].ProbHi(2);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                    realbox = RealBox(&amp;(box_lo[0]),&amp;(box_hi[0]));</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Reading &quot;</span> &lt;&lt; realbox &lt;&lt; <span class="stringliteral">&quot; at level &quot;</span> &lt;&lt; lev_for_box &lt;&lt; std::endl;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                    <a class="code" href="classROMSX.html#a2b67bb92b64c187e9869d8f8726e4e42">num_boxes_at_level</a>[lev_for_box] += 1;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                    <span class="keyword">const</span> <span class="keyword">auto</span>* dx  = geom[lev_for_box].CellSize();</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>* plo = geom[lev_for_box].ProbLo();</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                    <span class="keywordtype">int</span> ilo = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((box_lo[0] - plo[0])/dx[0]);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                    <span class="keywordtype">int</span> jlo = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((box_lo[1] - plo[1])/dx[1]);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                    <span class="keywordtype">int</span> klo = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((box_lo[2] - plo[2])/dx[2]);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                    <span class="keywordtype">int</span> ihi = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((box_hi[0] - plo[0])/dx[0]-1);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                    <span class="keywordtype">int</span> jhi = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((box_hi[1] - plo[1])/dx[1]-1);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                    <span class="keywordtype">int</span> khi = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((box_hi[2] - plo[2])/dx[2]-1);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                    Box bx(IntVect(ilo,jlo,klo),IntVect(ihi,jhi,khi));</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                    <span class="keywordflow">if</span> ( (ilo%ref_ratio[lev_for_box-1][0] != 0) || ((ihi+1)%ref_ratio[lev_for_box-1][0] != 0) ||</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                         (jlo%ref_ratio[lev_for_box-1][1] != 0) || ((jhi+1)%ref_ratio[lev_for_box-1][1] != 0) )</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                         amrex::Error(<span class="stringliteral">&quot;Fine box is not legit with this ref_ratio&quot;</span>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                    <a class="code" href="classROMSX.html#ab8125e3b638f29f6f08872c2cefd5335">boxes_at_level</a>[lev_for_box].push_back(bx);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Saving in &#39;boxes at level&#39; as &quot;</span> &lt;&lt; bx &lt;&lt; std::endl;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                } <span class="comment">// lev</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            AMRErrorTagInfo info;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <span class="keywordflow">if</span> (realbox.ok()) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                info.SetRealBox(realbox);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;start_time&quot;</span>) &gt; 0) {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> ref_min_time; ppr.get(<span class="stringliteral">&quot;start_time&quot;</span>,ref_min_time);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                info.SetMinTime(ref_min_time);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;end_time&quot;</span>) &gt; 0) {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> ref_max_time; ppr.get(<span class="stringliteral">&quot;end_time&quot;</span>,ref_max_time);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                info.SetMaxTime(ref_max_time);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;max_level&quot;</span>) &gt; 0) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                <span class="keywordtype">int</span> ref_max_level; ppr.get(<span class="stringliteral">&quot;max_level&quot;</span>,ref_max_level);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                info.SetMaxLevel(ref_max_level);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;value_greater&quot;</span>)) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                <span class="keywordtype">int</span> num_val = ppr.countval(<span class="stringliteral">&quot;value_greater&quot;</span>);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                Vector&lt;Real&gt; value(num_val);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                ppr.getarr(<span class="stringliteral">&quot;value_greater&quot;</span>,value,0,num_val);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                std::string field; ppr.get(<span class="stringliteral">&quot;field_name&quot;</span>,field);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                <a class="code" href="classROMSX.html#a335a655f6cf611277de2803029419c4c">ref_tags</a>.push_back(AMRErrorTag(value,AMRErrorTag::GREATER,field,info));</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;value_less&quot;</span>)) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                <span class="keywordtype">int</span> num_val = ppr.countval(<span class="stringliteral">&quot;value_less&quot;</span>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                Vector&lt;Real&gt; value(num_val);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                ppr.getarr(<span class="stringliteral">&quot;value_less&quot;</span>,value,0,num_val);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                std::string field; ppr.get(<span class="stringliteral">&quot;field_name&quot;</span>,field);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                <a class="code" href="classROMSX.html#a335a655f6cf611277de2803029419c4c">ref_tags</a>.push_back(AMRErrorTag(value,AMRErrorTag::LESS,field,info));</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;adjacent_difference_greater&quot;</span>)) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                <span class="keywordtype">int</span> num_val = ppr.countval(<span class="stringliteral">&quot;adjacent_difference_greater&quot;</span>);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                Vector&lt;Real&gt; value(num_val);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                ppr.getarr(<span class="stringliteral">&quot;adjacent_difference_greater&quot;</span>,value,0,num_val);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                std::string field; ppr.get(<span class="stringliteral">&quot;field_name&quot;</span>,field);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                <a class="code" href="classROMSX.html#a335a655f6cf611277de2803029419c4c">ref_tags</a>.push_back(AMRErrorTag(value,AMRErrorTag::GRAD,field,info));</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (realbox.ok())</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                <a class="code" href="classROMSX.html#a335a655f6cf611277de2803029419c4c">ref_tags</a>.push_back(AMRErrorTag(info));</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                Abort(std::string(<span class="stringliteral">&quot;Unrecognized refinement indicator for &quot;</span> + refinement_indicators[i]).c_str());</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        } <span class="comment">// loop over criteria</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    } <span class="comment">// if max_level &gt; 0</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a366c20991d6dd6d7057ff0a593c8c11f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a366c20991d6dd6d7057ff0a593c8c11f">&#9670;&nbsp;</a></span>RemakeLevel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::RemakeLevel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::BoxArray &amp;&#160;</td>
          <td class="paramname"><em>ba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::DistributionMapping &amp;&#160;</td>
          <td class="paramname"><em>dm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Remake an existing level using provided BoxArray and DistributionMapping and fill with existing fine and coarse data. Overrides the pure virtual function in AmrCore </p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#if (NGROW==2)</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordtype">int</span> ngrow_state = <a class="code" href="classROMSX.html#a4e8f6e71ae2c366a6455882d029de926">ComputeGhostCells</a>(<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8e053ce39997ed619ac81aa4d5a1fd44">spatial_order</a>)+1;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordtype">int</span> ngrow_vels  = <a class="code" href="classROMSX.html#a4e8f6e71ae2c366a6455882d029de926">ComputeGhostCells</a>(<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8e053ce39997ed619ac81aa4d5a1fd44">spatial_order</a>)+1;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordtype">int</span> ngrow_state = <a class="code" href="classROMSX.html#a4e8f6e71ae2c366a6455882d029de926">ComputeGhostCells</a>(<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8e053ce39997ed619ac81aa4d5a1fd44">spatial_order</a>)+2;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordtype">int</span> ngrow_vels  = <a class="code" href="classROMSX.html#a4e8f6e71ae2c366a6455882d029de926">ComputeGhostCells</a>(<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8e053ce39997ed619ac81aa4d5a1fd44">spatial_order</a>)+2;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    MultiFab* tmp_cons_new; tmp_cons_new-&gt;define(ba, dm, <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>, ngrow_state);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    MultiFab* tmp_cons_old; tmp_cons_old-&gt;define(ba, dm, <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>, ngrow_state);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    MultiFab* tmp_xvel_new; tmp_xvel_new-&gt;define(convert(ba, IntVect(1,0,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    MultiFab* tmp_xvel_old; tmp_xvel_old-&gt;define(convert(ba, IntVect(1,0,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    MultiFab* tmp_yvel_new; tmp_yvel_new-&gt;define(convert(ba, IntVect(0,1,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    MultiFab* tmp_yvel_old; tmp_yvel_old-&gt;define(convert(ba, IntVect(0,1,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    MultiFab* tmp_zvel_new; tmp_zvel_new-&gt;define(convert(ba, IntVect(0,0,1)), dm, 1, IntVect(ngrow_vels,ngrow_vels,0));</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    MultiFab* tmp_zvel_old; tmp_zvel_old-&gt;define(convert(ba, IntVect(0,0,1)), dm, 1, IntVect(ngrow_vels,ngrow_vels,0));</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">// This will fill the temporary MultiFabs with data from previous fine data as well as coarse where needed</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *tmp_cons_new, <a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *tmp_xvel_new, <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *tmp_yvel_new, <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *tmp_zvel_new, <a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    MultiFab::Copy(*tmp_cons_old,*tmp_cons_new,0,0,<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>,tmp_cons_new[lev].nGrowVect());</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    MultiFab::Copy(*tmp_xvel_old,*tmp_xvel_new,0,0,   1,tmp_xvel_new[lev].nGrowVect());</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    MultiFab::Copy(*tmp_yvel_old,*tmp_yvel_new,0,0,   1,tmp_yvel_new[lev].nGrowVect());</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    MultiFab::Copy(*tmp_zvel_old,*tmp_zvel_new,0,0,   1,tmp_zvel_new[lev].nGrowVect());</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    std::swap(tmp_cons_new, <a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev]);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    std::swap(tmp_cons_old, <a class="code" href="classROMSX.html#a7a14aa971cac1b1ad0eb5d4b46b90343">cons_old</a>[lev]);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    std::swap(tmp_xvel_new, <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev]);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    std::swap(tmp_xvel_old, <a class="code" href="classROMSX.html#af0b5074dc426b753beb5511bd63df407">xvel_old</a>[lev]);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    std::swap(tmp_yvel_new, <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev]);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    std::swap(tmp_yvel_old, <a class="code" href="classROMSX.html#a87f0b7446438b8145bdea79012b985f5">yvel_old</a>[lev]);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    std::swap(tmp_zvel_new, <a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[lev]);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    std::swap(tmp_zvel_old, <a class="code" href="classROMSX.html#acb72d33af4be09dede2005fa6c901686">zvel_old</a>[lev]);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev] = time;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="classROMSX.html#ac395453aa10633a05bb7323b2946101e">t_old</a>[lev] = time - 1.e200;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="classROMSX.html#a45591c69e52ac45b762eaa78880c6229">init_stuff</a>(lev, ba, dm);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aab4e25f240ebdc93f8fa58f522faf740"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab4e25f240ebdc93f8fa58f522faf740">&#9670;&nbsp;</a></span>resize_stuff()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::resize_stuff </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;{</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="classROMSX.html#a8e887c13b3d23581a26580f4e7e9aef0">vec_z_phys_nd</a>.resize(lev+1);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="classROMSX.html#a03b79a651abf3dc2bd37fadaca99fd46">vec_hOfTheConfusingName</a>.resize(lev+1);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="classROMSX.html#ab962f23dc27b3ce17bb19e3b8c9991f8">vec_Zt_avg1</a>.resize(lev+1);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="classROMSX.html#a7a3b7fb166ec3acf1b1057f53e08adad">vec_s_r</a>.resize(lev+1);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="classROMSX.html#a7e2a55ae7fb02290e6ead16ec3e658fa">vec_z_w</a>.resize(lev+1);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="classROMSX.html#a0a9b1a5cf021018defc82b45cbecb2c5">vec_z_r</a>.resize(lev+1);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="classROMSX.html#a9a453443ec491d496adbd2cf5ac292d8">vec_y_r</a>.resize(lev+1);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="classROMSX.html#a2de6e4298de90faa955d8073a65f7cd9">vec_x_r</a>.resize(lev+1);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="classROMSX.html#aa5461758b528d199101b5ea74f9a6c12">vec_Hz</a>.resize(lev+1);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="classROMSX.html#a24f02b944df51884168ab0c08c736c91">vec_Huon</a>.resize(lev+1);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="classROMSX.html#a21dcccced847102e553281c1852ce005">vec_Hvom</a>.resize(lev+1);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="classROMSX.html#aec2c137ce4314357035cbc7ae292338f">vec_Akv</a>.resize(lev+1);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="classROMSX.html#a63d077c5232d18aa0c31f1824b63b5ca">vec_Akt</a>.resize(lev+1);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="classROMSX.html#a640f040827d96f0b2085a385f0faaa3b">vec_visc3d_r</a>.resize(lev+1);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="classROMSX.html#af83a943f37cd6bbaf25c52fcaceb0930">vec_visc2_p</a>.resize(lev+1);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="classROMSX.html#aa8fff925fc76e919ddc53de08b3725e9">vec_visc2_r</a>.resize(lev+1);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="classROMSX.html#a2f47ec18ca3f2465e3253f92ca493bbc">vec_diff2</a>.resize(lev+1);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="classROMSX.html#ab1343869d59f89fd4773bc7fa230aa73">vec_ru</a>.resize(lev+1);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <a class="code" href="classROMSX.html#ab5041f0f370ab1ec4f7f7e16127c9039">vec_rv</a>.resize(lev+1);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="classROMSX.html#ab5b7ff78a167e59ae727b22094b39079">vec_rufrc</a>.resize(lev+1);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <a class="code" href="classROMSX.html#a52a5f265a370595f128046c31b9f31d5">vec_rvfrc</a>.resize(lev+1);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="classROMSX.html#a2082155131b8b7e0dec29068a92cece2">vec_sustr</a>.resize(lev+1);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="classROMSX.html#a44a44e4d82bc38d55daa03f281437113">vec_svstr</a>.resize(lev+1);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="classROMSX.html#ac49463f0fb789402ba8641f289906456">vec_rdrag</a>.resize(lev+1);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="classROMSX.html#a607e27d43f6eaebcf557c4ae17b8039a">vec_bustr</a>.resize(lev+1);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="classROMSX.html#a5a981dafaf65d2d8d96f16e1e7467eb2">vec_bvstr</a>.resize(lev+1);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="classROMSX.html#a18212e9657c0655cd29e0c6241c1224f">vec_DU_avg1</a>.resize(lev+1);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="classROMSX.html#a883756f67229729f133b9bdf784c21ff">vec_DU_avg2</a>.resize(lev+1);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="classROMSX.html#aa9738d90727df4f8aba2afb0ffed1e8f">vec_DV_avg1</a>.resize(lev+1);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="classROMSX.html#a6847259dab9f6118da780bf623a9868a">vec_DV_avg2</a>.resize(lev+1);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="classROMSX.html#ab5d263be53bfdd397f6c64672ee77009">vec_rubar</a>.resize(lev+1);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="classROMSX.html#a83d781ead821f8ed29f6f2b9ef70a9aa">vec_rvbar</a>.resize(lev+1);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="classROMSX.html#ac2324a5a8d5949f83ac7621ef79f8fdd">vec_rzeta</a>.resize(lev+1);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="classROMSX.html#a047f6faef02a00ced0a6c1766e4c9b5a">vec_ubar</a>.resize(lev+1);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="classROMSX.html#a2a375f2e83347418b7cf5d4bd812ee55">vec_vbar</a>.resize(lev+1);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="classROMSX.html#ab026fffd3c4e9a9ef612cbb23132a1f5">vec_zeta</a>.resize(lev+1);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="classROMSX.html#a3d747b62e29b6c979763cd243e61a866">vec_sstore</a>.resize(lev+1);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="classROMSX.html#a20d43f4b49b92542c1790c1ea01ca19c">vec_rhoS</a>.resize(lev+1);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="classROMSX.html#a0978a71210c5f05a5541002532bd9cd2">vec_rhoA</a>.resize(lev+1);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="classROMSX.html#a606d7f526ef409ef78feb8ce127f98c9">mapfac_m</a>.resize(lev+1);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="classROMSX.html#a865698971c9689455573c4b81ecaf26c">mapfac_u</a>.resize(lev+1);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="classROMSX.html#ad96e947b76f50a01928821d3cd2455f7">mapfac_v</a>.resize(lev+1);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9e841cff9ccca5ed1945876def44c681"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e841cff9ccca5ed1945876def44c681">&#9670;&nbsp;</a></span>restart()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::restart </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Restart </p>
<div class="fragment"><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;{</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="preprocessor">#ifdef ROMSX_USE_NETCDF</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#ae866db953617cc0cc4090aeedfd3103c">restart_type</a> == <span class="stringliteral">&quot;netcdf&quot;</span>) {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;       ReadNCCheckpointFile();</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#ae866db953617cc0cc4090aeedfd3103c">restart_type</a> == <span class="stringliteral">&quot;native&quot;</span>) {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;       <a class="code" href="classROMSX.html#a750d5e2613cd056f28a42a7eb950be05">ReadCheckpointFile</a>();</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">// We set this here so that we don&#39;t over-write the checkpoint file we just started from</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="classROMSX.html#a33906f6209da9e2a247b1022f60d24ac">last_check_file_step</a> = <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[0];</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;}</div>
<div class="ttc" id="aclassROMSX_html_a750d5e2613cd056f28a42a7eb950be05"><div class="ttname"><a href="classROMSX.html#a750d5e2613cd056f28a42a7eb950be05">ROMSX::ReadCheckpointFile</a></div><div class="ttdeci">void ReadCheckpointFile()</div><div class="ttdef"><b>Definition:</b> Checkpoint.cpp:177</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa21a56eb75e6c5565402a56d818c179e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa21a56eb75e6c5565402a56d818c179e">&#9670;&nbsp;</a></span>rho_eos()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::rho_eos </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real const &gt;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>rhoA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>rhoS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real const &gt;&#160;</td>
          <td class="paramname"><em>Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real const &gt;&#160;</td>
          <td class="paramname"><em>z_w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real const &gt;&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>rho_eos</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bx</td><td>box for calculation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">state</td><td>state holds temp, salt </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rho</td><td>density </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rhoA</td><td>vertically-averaged density </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rhoS</td><td>density perturbation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Hz</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z_w</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td></td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    AMREX_ASSERT(bx.smallEnd(2) == 0 &amp;&amp; bx.bigEnd(2) == N);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">//  Linear equation of state.</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//  Compute &quot;in situ&quot; density anomaly (kg/m3 - 1000) using the linear</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//  equation of state.</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> R0 = <a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a7f081843ab68cd0a410afd74a27dfc30">R0</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> S0 = <a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#af8337b0c99a50300e9880db3e8296d91">S0</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> T0 = <a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab66cd9af0320c884173b77917e1dcf82">T0</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Tcoef = <a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a45cf7364024323178dd5f67d3996e9ef">Tcoef</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Scoef = <a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#ae8dbad91ad7a9be8eb4c2db5a62f5c47">Scoef</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        rho(i,j,k)  = R0 - R0*Tcoef*(state(i,j,k,<a class="code" href="IndexDefines_8H.html#a2439ff23f4449b8ffa90ddc5bcb36173">Temp_comp</a>)-T0)</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                         + R0*Scoef*(state(i,j,k,<a class="code" href="IndexDefines_8H.html#ab84ceec196f4b00670dab4fa7794d1cf">Salt_comp</a>)-S0)</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                         - 1000.0_rt;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    });</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//  Compute vertical averaged density (rhoA) and density perturbation</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">//  used (rhoS) in barotropic pressure gradient.</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2 =1.0_rt/<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a87396b485f47a76010673143372cca17">rho0</a>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    ParallelFor(makeSlab(bx,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff0 = rho(i,j,N)*Hz(i,j,N);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        rhoS(i,j,0) = 0.5_rt*cff0*Hz(i,j,N);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        rhoA(i,j,0) = cff0;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt;= N; ++k) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=rho(i,j,N-k)*Hz(i,j,N-k);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            rhoS(i,j,0) += Hz(i,j,N-k)*(rhoA(i,j,0)+0.5_rt*cff1);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            rhoA(i,j,0) += cff1;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff11 =1.0_rt/(z_w(i,j,N)+h(i,j,0,0));</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        rhoA(i,j,0) *= cff2*cff11;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        rhoS(i,j,0) *= 2.0_rt*cff11*cff11*cff2;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    });</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div>
<div class="ttc" id="astructSolverChoice_html_a45cf7364024323178dd5f67d3996e9ef"><div class="ttname"><a href="structSolverChoice.html#a45cf7364024323178dd5f67d3996e9ef">SolverChoice::Tcoef</a></div><div class="ttdeci">amrex::Real Tcoef</div><div class="ttdef"><b>Definition:</b> DataStruct.H:186</div></div>
<div class="ttc" id="astructSolverChoice_html_a7f081843ab68cd0a410afd74a27dfc30"><div class="ttname"><a href="structSolverChoice.html#a7f081843ab68cd0a410afd74a27dfc30">SolverChoice::R0</a></div><div class="ttdeci">amrex::Real R0</div><div class="ttdef"><b>Definition:</b> DataStruct.H:183</div></div>
<div class="ttc" id="astructSolverChoice_html_ab66cd9af0320c884173b77917e1dcf82"><div class="ttname"><a href="structSolverChoice.html#ab66cd9af0320c884173b77917e1dcf82">SolverChoice::T0</a></div><div class="ttdeci">amrex::Real T0</div><div class="ttdef"><b>Definition:</b> DataStruct.H:185</div></div>
<div class="ttc" id="astructSolverChoice_html_ae8dbad91ad7a9be8eb4c2db5a62f5c47"><div class="ttname"><a href="structSolverChoice.html#ae8dbad91ad7a9be8eb4c2db5a62f5c47">SolverChoice::Scoef</a></div><div class="ttdeci">amrex::Real Scoef</div><div class="ttdef"><b>Definition:</b> DataStruct.H:187</div></div>
<div class="ttc" id="astructSolverChoice_html_af8337b0c99a50300e9880db3e8296d91"><div class="ttname"><a href="structSolverChoice.html#af8337b0c99a50300e9880db3e8296d91">SolverChoice::S0</a></div><div class="ttdeci">amrex::Real S0</div><div class="ttdef"><b>Definition:</b> DataStruct.H:184</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaf9f32897499d17bad9d80230331db6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf9f32897499d17bad9d80230331db6a">&#9670;&nbsp;</a></span>rhs_t_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::rhs_t_3d </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>gbx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>tempstore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>Huon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>Hvom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>oHz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>pn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>pm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>FC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>rhs_t_3d</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bx</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xbx</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ybx</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tempstore</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Huon</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Hvom</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Hz</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">oHz</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pn</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pm</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">W</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">FC</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nrhs</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnew</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt_lev</td><td></td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;{</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="comment">//copy the tilebox</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    Box tbxp1 = bx;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    Box tbxp2 = bx;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">//make only gbx be grown to match multifabs</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    tbxp2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    tbxp1.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">// Because grad, curv, FX, FE, are all local, do surroundinNodes</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    Box utbxp1 = surroundingNodes(tbxp1, 0);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    Box vtbxp1 = surroundingNodes(tbxp1, 1);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    Box ubx = surroundingNodes(bx, 0);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    Box vbx = surroundingNodes(bx, 1);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    BoxArray ba_gbx1 = intersect(BoxArray(tbxp1),gbx);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    AMREX_ASSERT((ba_gbx1.size() == 1));</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">// Scratch space</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    FArrayBox fab_grad(tbxp2,1,amrex::The_Async_Arena()); <span class="comment">//fab_grad.setVal(0.0);</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    FArrayBox fab_curv(tbxp2,1,amrex::The_Async_Arena()); <span class="comment">//fab_curv.setVal(0.0);</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    FArrayBox fab_FX(tbxp2,1,amrex::The_Async_Arena()); <span class="comment">//fab_FX.setVal(0.0);</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    FArrayBox fab_FE(tbxp2,1,amrex::The_Async_Arena()); <span class="comment">//fab_FE.setVal(0.0);</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keyword">auto</span> curv=fab_curv.array();</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keyword">auto</span> grad=fab_grad.array();</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keyword">auto</span> FX=fab_FX.array();</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keyword">auto</span> FE=fab_FE.array();</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    fab_grad.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    fab_curv.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    fab_FX.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    fab_FE.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    ParallelFor(bx,</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        oHz(i,j,k) = 1.0/ Hz(i,j,k);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    });</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    ParallelFor(utbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="comment">//should be t index 3</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        FX(i,j,k)=tempstore(i,j,k,nrhs)-tempstore(i-1,j,k,nrhs);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    });</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cffa=1.0/6.0;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cffb=1.0/3.0;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a57e1d7e053fa63774c4c44980272031a">flat_bathymetry</a>) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">Hadv_scheme</a> == <a class="code" href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca5b2d34872c0b46cfbabc832368e6ec7d">AdvectionScheme::upstream3</a>) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            ParallelFor(tbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                <span class="comment">//Upstream3</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                curv(i,j,k)=-FX(i,j,k)+FX(i+1,j,k);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            });</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <span class="comment">//HACK to avoid using the wrong index of t (using upstream3)</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> max_Huon=FArrayBox(Huon).max&lt;RunOn::Device&gt;();</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> min_Huon=FArrayBox(Huon).min&lt;RunOn::Device&gt;();</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            ParallelFor(ubx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                FX(i,j,k)=Huon(i,j,k)*0.5*(tempstore(i,j,k)+tempstore(i-1,j,k))+</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                    cffa*(curv(i,j,k)*min_Huon+ curv(i-1,j,k)*max_Huon);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            });</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">Hadv_scheme</a> == <a class="code" href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca6d779455e4a7eebf97d6bcb893dd5235">AdvectionScheme::centered4</a>) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            ParallelFor(tbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                <span class="comment">//Centered4</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                grad(i,j,k)=0.5*(FX(i,j,k)+FX(i+1,j,k));</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            });</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            ParallelFor(ubx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                FX(i,j,k)=Huon(i,j,k)*0.5*(tempstore(i,j,k)+tempstore(i-1,j,k))+</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                    cffb*(grad(i,j,k)+ grad(i-1,j,k));</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            });</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            Error(<span class="stringliteral">&quot;Not a valid horizontal advection scheme&quot;</span>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">Hadv_scheme</a> == <a class="code" href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca5b2d34872c0b46cfbabc832368e6ec7d">AdvectionScheme::upstream3</a>) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            ParallelFor(tbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                <span class="comment">//Upstream3</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                curv(i,j,k)=-FX(i,j,k)+FX(i+1,j,k);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            });</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="comment">//HACK to avoid using the wrong index of t (using upstream3)</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            ParallelFor(ubx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> max_Huon = std::max(Huon(i,j,k),0.0);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> min_Huon = std::min(Huon(i,j,k),0.0);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                FX(i,j,k)=Huon(i,j,k)*0.5*(tempstore(i,j,k)+tempstore(i-1,j,k))-</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                    cffa*(curv(i,j,k)*min_Huon+ curv(i-1,j,k)*max_Huon);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            });</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">Hadv_scheme</a> == <a class="code" href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca6d779455e4a7eebf97d6bcb893dd5235">AdvectionScheme::centered4</a>) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            ParallelFor(tbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                <span class="comment">//Centered4</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                grad(i,j,k)=0.5*(FX(i,j,k)+FX(i+1,j,k));</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            });</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            ParallelFor(ubx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                FX(i,j,k)=Huon(i,j,k)*0.5*(tempstore(i,j,k)+tempstore(i-1,j,k)-</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                           cffb*(grad(i,j,k)- grad(i-1,j,k)));</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            });</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            Error(<span class="stringliteral">&quot;Not a valid horizontal advection scheme&quot;</span>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    } <span class="comment">// flat bathymetry?</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    ParallelFor(vtbxp1, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="comment">//should be t index 3</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        FE(i,j,k)=tempstore(i,j,k,nrhs)-tempstore(i,j-1,k,nrhs);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    });</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    cffa=1.0/6.0;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    cffb=1.0/3.0;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a57e1d7e053fa63774c4c44980272031a">flat_bathymetry</a>) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">Hadv_scheme</a> == <a class="code" href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca5b2d34872c0b46cfbabc832368e6ec7d">AdvectionScheme::upstream3</a>) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            ParallelFor(tbxp1,</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                curv(i,j,k)=-FE(i,j,k)+FE(i,j+1,k);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            });</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="comment">//HACK to avoid using the wrong index of t (using upstream3)</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> max_Hvom=FArrayBox(Hvom).max&lt;RunOn::Device&gt;();</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> min_Hvom=FArrayBox(Hvom).min&lt;RunOn::Device&gt;();</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            ParallelFor(vbx,</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                FE(i,j,k)=Hvom(i,j,k)*0.5*(tempstore(i,j,k)+tempstore(i,j-1,k))+</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                    cffa*(curv(i,j,k)*min_Hvom+ curv(i,j-1,k)*max_Hvom);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            });</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">Hadv_scheme</a> == <a class="code" href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca6d779455e4a7eebf97d6bcb893dd5235">AdvectionScheme::centered4</a>) {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            ParallelFor(tbxp1,</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                grad(i,j,k)=0.5*(FE(i,j,k)+FE(i,j+1,k));</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            });</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            ParallelFor(vbx,</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                FE(i,j,k)=Hvom(i,j,k)*0.5*(tempstore(i,j,k)+tempstore(i,j-1,k))+</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                    cffb*(grad(i,j,k)+ grad(i,j-1,k));</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            });</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            Error(<span class="stringliteral">&quot;Not a valid horizontal advection scheme&quot;</span>);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">Hadv_scheme</a> == <a class="code" href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca5b2d34872c0b46cfbabc832368e6ec7d">AdvectionScheme::upstream3</a>) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            ParallelFor(tbxp1,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                curv(i,j,k)=-FE(i,j,k)+FE(i,j+1,k);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            });</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            <span class="comment">//HACK to avoid using the wrong index of t (using upstream3)</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            ParallelFor(vbx,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> max_Hvom=max(Hvom(i,j,k),0.0); <span class="comment">//FArrayBox(Huon).max&lt;RunOn::Device&gt;();</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> min_Hvom=min(Hvom(i,j,k),0.0); <span class="comment">//FArrayBox(Huon).min&lt;RunOn::Device&gt;();</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                FE(i,j,k)=Hvom(i,j,k)*0.5*(tempstore(i,j,k)+tempstore(i,j-1,k))-</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                    cffa*(curv(i,j,k)*min_Hvom+ curv(i,j-1,k)*max_Hvom);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            });</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4f1fced24fb1c3e55bc9b7333f211b9f">Hadv_scheme</a> == <a class="code" href="DataStruct_8H.html#a3ffde1e69b7cc5344b53bf310e4a212ca6d779455e4a7eebf97d6bcb893dd5235">AdvectionScheme::centered4</a>) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            ParallelFor(tbxp1,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                grad(i,j,k)=0.5*(FE(i,j,k)+FE(i,j+1,k));</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            });</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            ParallelFor(vbx,</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                FE(i,j,k)=Hvom(i,j,k)*0.5*(tempstore(i,j,k)+tempstore(i,j-1,k)-</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                                           cffb*(grad(i,j,k)- grad(i,j-1,k)));</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            });</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            Error(<span class="stringliteral">&quot;Not a valid horizontal advection scheme&quot;</span>);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        ParallelFor(bx,</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;              <span class="comment">//</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;              <span class="comment">//  Add in horizontal advection.</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;              <span class="comment">//</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;              <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = dt_lev*pm(i,j,0)*pn(i,j,0);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;              <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=cff*(FX(i+1,j,k)-FX(i,j,k));</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;              <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2=cff*(FE(i,j+1,k)-FE(i,j,k));</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;              <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff3=cff1+cff2;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;              t(i,j,k,nnew) -= cff3;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    });</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="comment">//  Time-step vertical advection term.</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="comment">//Check which type of differences:</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="comment">//  Fourth-order, central differences vertical advective flux</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="comment">//  (Tunits m3/s).</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    ParallelFor(bx,</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;              <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;              <span class="comment">//  Add in vertical advection.</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;              <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;              <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=0.5;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;              <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2=7.0/12.0;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;              <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff3=1.0/12.0;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;              <span class="keywordflow">if</span> (k&gt;=1 &amp;&amp; k&lt;=N-2)</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;              {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                      FC(i,j,k)=( cff2*(tempstore(i  ,j,k  )+ tempstore(i,j,k+1))</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                                 -cff3*(tempstore(i  ,j,k-1)+ tempstore(i,j,k+2)) ) * ( W(i,j,k));</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;              } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                  FC(i,j,N)=0.0;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                  FC(i,j,N-1)=( cff2*tempstore(i  ,j,N-1)+ cff1*tempstore(i,j,N  )</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                               -cff3*tempstore(i  ,j,N-2) ) * ( W(i  ,j,N-1));</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                  FC(i,j,0)=( cff2*tempstore(i  ,j,1)+ cff1*tempstore(i,j,0)</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                             -cff3*tempstore(i  ,j,2) ) * ( W(i  ,j,0));</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;              }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    });</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    ParallelFor(bx,</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=dt_lev*pm(i,j,0)*pn(i,j,0);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff4;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordflow">if</span>(k-1&gt;=0) {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            cff4=FC(i,j,k)-FC(i,j,k-1);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            cff4=FC(i,j,k);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        t(i,j,k)=oHz(i,j,k)*(t(i,j,k)-cff1*cff4);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    });</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1c78b061e07c56adac2e9732485480fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c78b061e07c56adac2e9732485480fc">&#9670;&nbsp;</a></span>rhs_uv_2d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::rhs_uv_2d </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>xbx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>ybx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>uold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>vold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>ru</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>rv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>Huon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>Hvom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>rhs_uv_2d</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xbx</td><td>Box for operations on x-velocity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ybx</td><td>Box for operations on y-velocity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ubar</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vbar</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rhs_ubar</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rhs_vbar</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DUon</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DVom</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">krhs</td><td></td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;{</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="comment">// Scratch space</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    FArrayBox fab_UFx(growLo(xbx,0,1),1,amrex::The_Async_Arena()); fab_UFx.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    FArrayBox fab_UFe(growHi(xbx,1,1),1,amrex::The_Async_Arena()); fab_UFe.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    FArrayBox fab_VFe(growLo(ybx,1,1),1,amrex::The_Async_Arena()); fab_VFe.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    FArrayBox fab_VFx(growHi(ybx,0,1),1,amrex::The_Async_Arena()); fab_VFx.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keyword">auto</span> UFx=fab_UFx.array();</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keyword">auto</span> UFe=fab_UFe.array();</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keyword">auto</span> VFx=fab_VFx.array();</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keyword">auto</span> VFe=fab_VFe.array();</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">// *************************************************************</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">// UPDATING U</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// *************************************************************</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// Think of the cell-centered box as                              [ 0:nx-1, 0:ny-1] (0,0,0) cc</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">// xbx is the x-face-centered box on which we update ubar (with rhs_ubar)  [ 0:nx  , 0:ny-1] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">//   to do so requires                                           UFx on    [-1:nx  , 0:ny-1] (0,0,0) cc</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">//      which requires                                           ubar on   [-2:nx+2, 0:ny-1] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">//       and  requires                                           DUon on   [-2:nx+2, 0:ny-1] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">//   to do so requires                                           UFe on    [ 0:nx  , 0:ny  ] (1,1,0) xy-nodes</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">//      which requires                                           ubar on   [ 0:nx  ,-2:ny+1] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">//       and  requires                                           DVom on   [-2:nx+1, 0:ny-1] (0,1,0) y-faces</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">// Define UFx, the x-fluxes at cell centers for updating u</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">// (Note that grow arguments are (bx, dir, ng)</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    ParallelFor(growLo(xbx,0,1),</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> uxx_i   = ubar(i-1,j,0,krhs)-2.0*ubar(i  ,j,0,krhs)+ubar(i+1,j,0,krhs);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> uxx_ip1 = ubar(i  ,j,0,krhs)-2.0*ubar(i+1,j,0,krhs)+ubar(i+2,j,0,krhs);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> uxx_avg = uxx_i + uxx_ip1;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Huxx_i   = DUon(i-1,j,0)-2.0*DUon(i  ,j,0)+DUon(i+1,j,0);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Huxx_ip1 = DUon(i  ,j,0)-2.0*DUon(i+1,j,0)+DUon(i+2,j,0);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff=1.0/6.0;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> ubar_avg=ubar(i  ,j,0,krhs)+ubar(i+1,j,0,krhs);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        UFx(i,j,0)=0.25*(ubar_avg-cff*uxx_avg) * (DUon(i,j,0)+ DUon(i+1,j,0)-cff*(Huxx_i+ Huxx_ip1));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    });</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">// Define UFe, the y-fluxes at nodes for updating u</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    ParallelFor(growHi(xbx,1,1),</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="comment">//should not include grow cells</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> uee_j   = ubar(i,j-1,0,krhs)-2.0*ubar(i,j  ,0,krhs)+ubar(i,j+1,0,krhs);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> uee_jm1 = ubar(i,j-2,0,krhs)-2.0*ubar(i,j-1,0,krhs)+ubar(i,j  ,0,krhs);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> uee_avg = uee_j + uee_jm1;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Hvxx_i   = DVom(i-1,j,0)-2.0*DVom(i  ,j,0)+DVom(i+1,j,0);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Hvxx_im1 = DVom(i-2,j,0)-2.0*DVom(i-1,j,0)+DVom(i  ,j,0);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff=1.0/6.0;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=ubar(i,j  ,0,krhs)+ubar(i,j-1,0,krhs);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2=DVom(i,j,0)+DVom(i-1,j,0);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        UFe(i,j,0)=0.25*(cff1-uee_avg*cff)*</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;          (cff2-cff*(Hvxx_i+Hvxx_im1));</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    });</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">//  Add in horizontal advection.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    ParallelFor(makeSlab(xbx,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;         <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=UFx(i,j  ,0)-UFx(i-1,j,0);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;         <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2=UFe(i,j+1,0)-UFe(i  ,j,0);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;         rhs_ubar(i,j,0) -= (cff1 + cff2);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    });</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// *************************************************************</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">// UPDATING V</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">// *************************************************************</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// Think of the cell-centered box as                              [ 0:nx-1, 0:ny-1] (0,0,0) cc</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// ybx is the y-face-centered box on which we update vbar (with rhs_vbar)  [ 0:nx-1, 0:ny  ] (1,0,0)  y-faces</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">//   to do so requires                                  VFe on    [ 0:nx-1,-1:ny  ] (1,1,0)  xy-nodes</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">//      which requires                                    vbar on [ 0:nx-1,-2:ny+2] (1,0,0)  y-faces</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">//       and  requires                                    DVom on [ 0:nx-1,-2:ny+2] (0,1,0)  x-faces</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">//   to do so requires                                  VFx on    [ 0:nx  , 0:ny  ] (0,0,0)  cc</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">//      which requires                                    vbar on [-2:nx+1, 0:ny  ] (1,0,0)  y-faces</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">//       and  requires                                    DUon on [ 0:nx-1,-2:ny+1] (0,0,0)  y-faces</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// Grow ybx by one in high x-direction</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    ParallelFor(growHi(ybx,0,1),</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff=1.0/6.0;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> vxx_i   = vbar(i-1,j,0,krhs)-2.0*vbar(i  ,j,0,krhs)+vbar(i+1,j,0,krhs);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> vxx_im1 = vbar(i-2,j,0,krhs)-2.0*vbar(i-1,j,0,krhs)+vbar(i  ,j,0,krhs);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> vxx_avg = vxx_i + vxx_im1;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="comment">//auto vxx_im1 = (i == gbx1.smallEnd(0)) ? vxx(i-1,j,k) :</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="comment">//    (vbar(i-2,j,0,krhs)-2.0*vbar(i-1,j,0,krhs)+vbar(i,j,0,krhs));</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="comment">//neglecting terms about periodicity since testing only periodic for now</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Huee_j   = DUon(i,j-1,0)-2.0*DUon(i,j  ,0)+DUon(i,j+1,0);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Huee_jm1 = DUon(i,j-2,0)-2.0*DUon(i,j-1,0)+DUon(i,j  ,0);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=vbar(i  ,j,0,krhs)+vbar(i-1,j,0,krhs);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2=DUon(i,j,0)+DUon(i,j-1,0);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="comment">//auto Huee_jm1 = (j == gbx1.smallEnd(1)) ? Huee(i,j-1,k) :</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="comment">//    (DUon(i,j-2,k)-2.0*DUon(i,j-1,k)+DUon(i,j,k));</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        VFx(i,j,0)=0.25*(cff1-vxx_avg*cff)* (cff2-cff*(Huee_j+ Huee_jm1));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    });</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    ParallelFor(growLo(ybx,1,1),</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> vee_j    = vbar(i,j-1,0,krhs)-2.0*vbar(i,j  ,0,krhs)+vbar(i,j+1,0,krhs);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> vee_jp1  = vbar(i,j  ,0,krhs)-2.0*vbar(i,j+1,0,krhs)+vbar(i,j+2,0,krhs);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> vee_avg  = vee_j + vee_jp1;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Hvee_j   = DVom(i,j-1,0)-2.0*DVom(i,j  ,0)+DVom(i,j+1,0);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Hvee_jp1 = DVom(i,j  ,0)-2.0*DVom(i,j+1,0)+DVom(i,j+2,0);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff=1.0/6.0;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=vbar(i,j  ,0,krhs)+vbar(i,j+1,0,krhs);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        VFe(i,j,0) = 0.25 * (cff1-vee_avg*cff) * (DVom(i,j  ,0)+ DVom(i,j+1,0) -</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                                           cff  * (Hvee_j+ Hvee_jp1));</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    });</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    ParallelFor(makeSlab(ybx,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=VFx(i+1,j,0)-VFx(i  ,j,0);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2=VFe(i  ,j,0)-VFe(i,j-1,0);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        rhs_vbar(i,j,0) -= (cff1 + cff2);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    });</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aed11841ea026316e25162880b8c455c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed11841ea026316e25162880b8c455c9">&#9670;&nbsp;</a></span>rhs_uv_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::rhs_uv_3d </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>xbx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>ybx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>uold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>vold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>ru</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>rv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>rufrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>rvfrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>sustr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>svstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>bustr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>bvstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>Huon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>Hvom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>on_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>om_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>om_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>on_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>FC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculation of the RHS</p>
<p>rhs_uv_2d</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xbx</td><td>Box for operations on x-velocity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ybx</td><td>Box for operations on y-velocity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">uold</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vold</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ru</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rv</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rufrc</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rvfrc</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sustr</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">svstr</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">bustr</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">bvstr</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Huon</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Hvom</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">on_u</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">om_v</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">W</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">FC</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nrhs</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td></td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;{</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">// Scratch space</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    FArrayBox fab_UFx(growLo(xbx,0,1),1,amrex::The_Async_Arena()); fab_UFx.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    FArrayBox fab_UFe(growHi(xbx,1,1),1,amrex::The_Async_Arena()); fab_UFe.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    FArrayBox fab_VFe(growLo(ybx,1,1),1,amrex::The_Async_Arena()); fab_VFe.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    FArrayBox fab_VFx(growHi(ybx,0,1),1,amrex::The_Async_Arena()); fab_VFx.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keyword">auto</span> UFx=fab_UFx.array();</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keyword">auto</span> UFe=fab_UFe.array();</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keyword">auto</span> VFx=fab_VFx.array();</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keyword">auto</span> VFe=fab_VFe.array();</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">//check this////////////</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Gadv = -0.25;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">// *************************************************************</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">// UPDATING U</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">// *************************************************************</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// Think of the cell-centered box as                              [ 0:nx-1, 0:ny-1] (0,0,0) cc</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="comment">// xbx is the x-face-centered box on which we update u (with ru)  [ 0:nx  , 0:ny-1] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">//   to do so requires                                  UFx on    [-1:nx  , 0:ny-1] (0,0,0) cc</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">//      which requires                                  uold on   [-2:nx+2, 0:ny-1] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">//       and  requires                                  Huon on   [-2:nx+2, 0:ny-1] (0,0,0) x-faces</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">//   to do so requires                                  UFe on    [ 0:nx  , 0:ny  ] (1,1,0) xy-nodes</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">//      which requires                                  uold on   [ 0:nx  ,-2:ny+1] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">//       and  requires                                  Hvom on   [-2:nx+1, 0:ny-1] (0,1,0) y-faces</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">// Define UFx, the x-fluxes at cell centers for updating u</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">// (Note that grow arguments are (bx, dir, ng)</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    ParallelFor(growLo(xbx,0,1), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1 = uold(i,j,k,nrhs)+uold(i+1,j,k,nrhs);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="comment">// Upwinding</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = (cff1 &gt; 0.0) ? uold(i-1,j,k,nrhs)-2.0*uold(i  ,j,k,nrhs)+uold(i+1,j,k,nrhs) :</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                                  uold(i  ,j,k,nrhs)-2.0*uold(i+1,j,k,nrhs)+uold(i+2,j,k,nrhs);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Huxx_i   = Huon(i-1,j,k)-2.0*Huon(i  ,j,k)+Huon(i+1,j,k);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Huxx_ip1 = Huon(i  ,j,k)-2.0*Huon(i+1,j,k)+Huon(i+2,j,k);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Huxx_avg = 0.5 * (Huxx_i + Huxx_ip1);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Huon_avg = (Huon(i,j,k) + Huon(i+1,j,k));</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        UFx(i,j,k) = 0.25*(cff1+Gadv*cff) * ( Huon_avg + Gadv*Huxx_avg );</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    });</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">// Define UFe, the y-fluxes at nodes for updating u</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    ParallelFor(growHi(xbx,1,1), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1 = uold(i,j,k,nrhs) + uold(i  ,j-1,k,nrhs);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2 = Hvom(i,j,k)      + Hvom(i-1,j  ,k);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="comment">// Upwinding</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = (cff2 &gt; 0.0) ?  uold(i,j-2,k,nrhs) - 2.0*uold(i,j-1,k,nrhs) + uold(i  ,j,k,nrhs) :</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                   uold(i,j-1,k,nrhs) - 2.0*uold(i,j  ,k,nrhs) + uold(i,j+1,k,nrhs);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Hvxx_i   = Hvom(i-1,j,k)-2.0*Hvom(i  ,j,k)+Hvom(i+1,j,k);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Hvxx_im1 = Hvom(i-2,j,k)-2.0*Hvom(i-1,j,k)+Hvom(i  ,j,k);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        UFe(i,j,k) = 0.25 * (cff1+Gadv*cff)* (cff2+Gadv*0.5*(Hvxx_i + Hvxx_im1));</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    });</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">// Define the RHS for u by differencing fluxes</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    ParallelFor(xbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;          ru(i,j,k,nrhs) -= ( (UFx(i,j,k)-UFx(i-1,j,k)) + (UFe(i,j+1,k)-UFe(i  ,j,k)) );</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    });</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    ParallelFor(xbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;          <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;          <span class="comment">//  Add in vertical advection.</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;          <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=9.0/16.0;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2=1.0/16.0;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;          <span class="keywordflow">if</span> (k&gt;=1 &amp;&amp; k&lt;=N-2)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;          {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                  FC(i,j,k)=( cff1*(uold(i  ,j,k  ,nrhs)+ uold(i,j,k+1,nrhs))</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                             -cff2*(uold(i  ,j,k-1,nrhs)+ uold(i,j,k+2,nrhs)) )*</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                                ( cff1*(   W(i  ,j,k)+ W(i-1,j,k))</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                                 -cff2*(   W(i+1,j,k)+ W(i-2,j,k)) );</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;          <span class="keywordflow">else</span> <span class="comment">// this needs to be split up so that the following can be concurrent</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;          {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;              FC(i,j,N)=0.0;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;              FC(i,j,N-1)=( cff1*(uold(i  ,j,N-1,nrhs)+ uold(i,j,N  ,nrhs))</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                           -cff2*(uold(i  ,j,N-2,nrhs)+ uold(i,j,N  ,nrhs)) )*</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                              ( cff1*(   W(i  ,j,N-1)+ W(i-1,j,N-1))</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                               -cff2*(   W(i+1,j,N-1)+ W(i-2,j,N-1)) );</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;              FC(i,j,0)=( cff1*(uold(i  ,j,0,nrhs)+ uold(i,j,1,nrhs))</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                         -cff2*(uold(i  ,j,0,nrhs)+ uold(i,j,2,nrhs)) )*</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                            ( cff1*(   W(i  ,j,0)+ W(i-1,j,0))</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                             -cff2*(   W(i+1,j,0)+ W(i-2,j,0)) );</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;              <span class="comment">//              FC(i,0,-1)=0.0;</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;          }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    });</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    ParallelFor(xbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = (k &gt;= 1) ? FC(i,j,k)-FC(i,j,k-1) : FC(i,j,k);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        ru(i,j,k,nrhs) -= cff;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    });</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    Gpu::synchronize();</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    AMREX_ASSERT(xbx.smallEnd(2) == 0 &amp;&amp; xbx.bigEnd(2) == N);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    ParallelFor(makeSlab(xbx,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= N; ++k)</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;       {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;          rufrc(i,j,0) += ru(i,j,k,nrhs);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff  = om_u(i,j,0)*on_u(i,j,0);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1 = (k == N) ?  sustr(i,j,0)*cff : 0.0;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2 = (k == 0) ? -bustr(i,j,0)*cff : 0.0;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;          rufrc(i,j,0) += cff1+cff2;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;       }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    });</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">// *************************************************************</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">// UPDATING V</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">// *************************************************************</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// Think of the cell-centered box as                              [ 0:nx-1, 0:ny-1] (0,0,0) cc</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// ybx is the y-face-centered box on which we update v (with rv)  [ 0:nx-1, 0:ny  ] (1,0,0)  y-faces</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">//   to do so requires                                  VFe on    [ 0:nx-1,-1:ny  ] (1,1,0)  xy-nodes</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">//      which requires                                    vold on [ 0:nx-1,-2:ny+2] (1,0,0)  y-faces</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">//       and  requires                                    Hvom on [ 0:nx-1,-2:ny+2] (0,1,0)  x-faces</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">//   to do so requires                                  VFx on    [ 0:nx  , 0:ny  ] (0,0,0)  cc</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">//      which requires                                    vold on [-2:nx+1, -:ny  ] (1,0,0)  y-faces</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">//       and  requires                                    Hvom on [ 0:nx-1,-2:ny+1] (0,0,0)  y-faces</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">// Grow ybx by one in low y-direction</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    ParallelFor(growLo(ybx,1,1), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=vold(i,j,k,nrhs)+vold(i,j+1,k,nrhs);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="comment">// Upwinding</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = (cff1 &gt; 0.0) ? vold(i,j-1,k,nrhs)-2.0*vold(i,j,k,nrhs)+ vold(i,j+1,k,nrhs) :</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                                  vold(i,j,k,nrhs)-2.0*vold(i,j+1,k,nrhs)+ vold(i,j+2,k,nrhs);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Hvee_j   = Hvom(i,j-1,k)-2.0*Hvom(i,j  ,k)+Hvom(i,j+1,k);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Hvee_jp1 = Hvom(i,j  ,k)-2.0*Hvom(i,j+1,k)+Hvom(i,j+2,k);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        VFe(i,j,k) = 0.25 * (cff1+Gadv*cff) * ( Hvom(i,j  ,k)+ Hvom(i,j+1,k) + 0.5 * Gadv * (Hvee_j + Hvee_jp1) );</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    });</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// Grow ybx by one in high x-direction</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    ParallelFor(growHi(ybx,0,1), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1 = vold(i,j,k,nrhs) + vold(i-1,j  ,k,nrhs);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2 = Huon(i,j,k)      + Huon(i  ,j-1,k);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="comment">// Upwinding</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = (cff2 &gt; 0.0) ? vold(i-2,j,k,nrhs)-2.0*vold(i-1,j,k,nrhs)+vold(i  ,j,k,nrhs) :</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                                  vold(i-1,j,k,nrhs)-2.0*vold(i  ,j,k,nrhs)+vold(i+1,j,k,nrhs);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Huee_j   = Huon(i,j-1,k)-2.0*Huon(i,j  ,k)+Huon(i,j+1,k);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Huee_jm1 = Huon(i,j-2,k)-2.0*Huon(i,j-1,k)+Huon(i,j  ,k);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        VFx(i,j,k) = 0.25*(cff1+Gadv*cff)* (cff2+Gadv*0.5*(Huee_j + Huee_jm1));</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    });</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    ParallelFor(ybx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;          rv(i,j,k,nrhs) -= ( (VFx(i+1,j,k)-VFx(i,j,k)) + (VFe(i,j,k)-VFe(i,j-1,k)) );</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    });</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    ParallelFor(ybx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=9.0/16.0;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2=1.0/16.0;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;          <span class="keywordflow">if</span> (k&gt;=1 &amp;&amp; k&lt;=N-2)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;          {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;              FC(i,j,k)=( cff1*(vold(i,j,k  ,nrhs)+ vold(i,j,k+1,nrhs))</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                         -cff2*(vold(i,j,k-1,nrhs)+ vold(i,j,k+2,nrhs)) )*</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                            ( cff1*(W(i,j  ,k)+ W(i,j-1,k))</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                             -cff2*(W(i,j+1,k)+ W(i,j-2,k)) );</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;          }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;          <span class="keywordflow">else</span> <span class="comment">// this needs to be split up so that the following can be concurrent</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;          {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;              FC(i,j,N)=0.0;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;              FC(i,j,N-1)=( cff1*(vold(i,j,N-1,nrhs)+ vold(i,j,N  ,nrhs))</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                           -cff2*(vold(i,j,N-2,nrhs)+ vold(i,j,N  ,nrhs)) )*</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                              ( cff1*(W(i,j  ,N-1)+ W(i,j-1,N-1))</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                               -cff2*(W(i,j+1,N-1)+ W(i,j-2,N-1)) );</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;              FC(i,j,0)=( cff1*(vold(i,j,0,nrhs)+ vold(i,j,1,nrhs))</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                             -cff2*(vold(i,j,0,nrhs)+ vold(i,j,2,nrhs)) )*</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                            ( cff1*(W(i,j  ,0)+ W(i,j-1,0))</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                             -cff2*(W(i,j+1,0)+ W(i,j-2,0)) );</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;              <span class="comment">//              FC(i,0,-1)=0.0;</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;          }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    }); Gpu::synchronize();</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    ParallelFor(ybx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = (k &gt;= 1) ? FC(i,j,k)-FC(i,j,k-1) : FC(i,j,k);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        rv(i,j,k,nrhs) -= cff;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    });</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    Gpu::synchronize();</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    AMREX_ASSERT(ybx.smallEnd(2) == 0 &amp;&amp; ybx.bigEnd(2) == N);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    ParallelFor(makeSlab(ybx,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= N; ++k)</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;       {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;          rvfrc(i,j,0) += rv(i,j,k,nrhs);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = om_v(i,j,0)*on_v(i,j,0);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1 = (k == N) ?  svstr(i,j,0)*cff : 0.0;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff2 = (k == 0) ? -bvstr(i,j,0)*cff : 0.0;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;          rvfrc(i,j,0) += cff1+cff2;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;       }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    });</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad462a3ade367c29008f7e42e4063410e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad462a3ade367c29008f7e42e4063410e">&#9670;&nbsp;</a></span>romsx_advance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::romsx_advance </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>cons_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>cons_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>xvel_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>yvel_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>zvel_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>xvel_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>yvel_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>zvel_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Geometry&#160;</td>
          <td class="paramname"><em>fine_geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Interface for advancing the data at one level by one "slow" timestep </p>

</div>
</div>
<a id="abd0ef9b9a56b5f6985a0903895d81e46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd0ef9b9a56b5f6985a0903895d81e46">&#9670;&nbsp;</a></span>set_2darrays()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::set_2darrays </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_x_r = <a class="code" href="classROMSX.html#a2de6e4298de90faa955d8073a65f7cd9">vec_x_r</a>[lev];</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_y_r = <a class="code" href="classROMSX.html#a9a453443ec491d496adbd2cf5ac292d8">vec_y_r</a>[lev];</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keyword">auto</span> N = Geom(lev).Domain().size()[2]-1; <span class="comment">// Number of vertical &quot;levs&quot; aka, NZ</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(*(mf_x_r), TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      Array4&lt;Real&gt; <span class="keyword">const</span>&amp; x_r = (mf_x_r)-&gt;array(mfi);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      Array4&lt;Real&gt; <span class="keyword">const</span>&amp; y_r = (mf_y_r)-&gt;array(mfi);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="keyword">const</span> Box&amp; bx = mfi.growntilebox();</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> &amp; geomdata = Geom(lev).data();</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      Gpu::synchronize();</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      amrex::ParallelFor(amrex::makeSlab(bx,2,0),</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>  )</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> prob_lo         = geomdata.ProbLo();</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> dx              = geomdata.CellSize();</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        x_r(i,j,0) = prob_lo[0] + (i + 0.5) * dx[0];</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        y_r(i,j,0) = prob_lo[1] + (j + 0.5) * dx[1];</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="comment">//        const Real z = prob_lo[2] + (k + 0.5) * dx[2];</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      });</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    MultiFab* U_old = <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev];</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    MultiFab* V_old = <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev];</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_ubar = <a class="code" href="classROMSX.html#a047f6faef02a00ced0a6c1766e4c9b5a">vec_ubar</a>[lev];</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_vbar = <a class="code" href="classROMSX.html#a2a375f2e83347418b7cf5d4bd812ee55">vec_vbar</a>[lev];</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_Hz  = <a class="code" href="classROMSX.html#aa5461758b528d199101b5ea74f9a6c12">vec_Hz</a>[lev];</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordtype">int</span> nstp = 0;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordtype">int</span> kstp = 0;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordtype">int</span> knew = 0;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(*<a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; ubar = (mf_ubar)-&gt;array(mfi);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; vbar = (mf_vbar)-&gt;array(mfi);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        Array4&lt;const Real&gt; <span class="keyword">const</span>&amp; Hz       = mf_Hz-&gt;const_array(mfi);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        Array4&lt;const Real&gt; <span class="keyword">const</span>&amp; u        = U_old-&gt;const_array(mfi);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        Array4&lt;const Real&gt; <span class="keyword">const</span>&amp; v        = V_old-&gt;const_array(mfi);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        Box ubx2 = mfi.nodaltilebox(0); ubx2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>  ,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>  ,0)); <span class="comment">// x-face-centered, grown by 2</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        Box vbx2 = mfi.nodaltilebox(1); vbx2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>  ,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>  ,0)); <span class="comment">// y-face-centered, grown by 2</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        amrex::ParallelFor(makeSlab(ubx2,2,0),</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> CF = 0.;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> sum_of_hz = 0.;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;=N; k++) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> avg_hz = 0.5*(Hz(i,j,k)+Hz(i-1,j,k));</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                    sum_of_hz += avg_hz;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                    CF += avg_hz*u(i,j,k,nstp);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                ubar(i,j,0,kstp) = CF / sum_of_hz;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                ubar(i,j,0,knew) = CF / sum_of_hz;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            });</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        amrex::ParallelFor(makeSlab(vbx2,2,0),</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> CF = 0.;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> sum_of_hz = 0.;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;=N; k++) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> avg_hz = 0.5*(Hz(i,j,k)+Hz(i,j-1,k));</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                    sum_of_hz += avg_hz;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                    CF += avg_hz*v(i,j,k,nstp);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                vbar(i,j,0,kstp) = CF / sum_of_hz;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                vbar(i,j,0,knew) = CF / sum_of_hz;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            });</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">// DEBUGGING NOTE -- DoublyPeriodic fails if these are commented out</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> time = 0.0;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev,time, *<a class="code" href="classROMSX.html#a047f6faef02a00ced0a6c1766e4c9b5a">vec_ubar</a>[lev], GetVecOfPtrs(<a class="code" href="classROMSX.html#a047f6faef02a00ced0a6c1766e4c9b5a">vec_ubar</a>));</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev,time, *<a class="code" href="classROMSX.html#a2a375f2e83347418b7cf5d4bd812ee55">vec_vbar</a>[lev], GetVecOfPtrs(<a class="code" href="classROMSX.html#a2a375f2e83347418b7cf5d4bd812ee55">vec_vbar</a>));</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab93d802ac3111e738dafe04367813135"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab93d802ac3111e738dafe04367813135">&#9670;&nbsp;</a></span>set_bathymetry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::set_bathymetry </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;{</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <a class="code" href="prob__common_8H.html#a2a1089aaebf4e1bffc2452c15a45e988">init_custom_bathymetry</a>(geom[lev], *<a class="code" href="classROMSX.html#a03b79a651abf3dc2bd37fadaca99fd46">vec_hOfTheConfusingName</a>[lev], *<a class="code" href="classROMSX.html#ab962f23dc27b3ce17bb19e3b8c9991f8">vec_Zt_avg1</a>[lev], <a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> time = 0.0;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#ab962f23dc27b3ce17bb19e3b8c9991f8">vec_Zt_avg1</a>[lev], GetVecOfPtrs(<a class="code" href="classROMSX.html#ab962f23dc27b3ce17bb19e3b8c9991f8">vec_Zt_avg1</a>));</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#a03b79a651abf3dc2bd37fadaca99fd46">vec_hOfTheConfusingName</a>[lev], GetVecOfPtrs(<a class="code" href="classROMSX.html#a03b79a651abf3dc2bd37fadaca99fd46">vec_hOfTheConfusingName</a>));</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;}</div>
<div class="ttc" id="aprob__common_8H_html_a2a1089aaebf4e1bffc2452c15a45e988"><div class="ttname"><a href="prob__common_8H.html#a2a1089aaebf4e1bffc2452c15a45e988">init_custom_bathymetry</a></div><div class="ttdeci">void init_custom_bathymetry(const amrex::Geometry &amp;geom, amrex::MultiFab &amp;mf_h, amrex::MultiFab &amp;mf_Zt_avg1, SolverChoice const &amp;m_solverChoice)</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classROMSX_ab93d802ac3111e738dafe04367813135_cgraph.png" border="0" usemap="#aclassROMSX_ab93d802ac3111e738dafe04367813135_cgraph" alt=""/></div>
<map name="aclassROMSX_ab93d802ac3111e738dafe04367813135_cgraph" id="aclassROMSX_ab93d802ac3111e738dafe04367813135_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,187,32"/>
<area shape="rect" href="prob__common_8H.html#a2a1089aaebf4e1bffc2452c15a45e988" title=" " alt="" coords="235,5,416,32"/>
</map>
</div>

</div>
</div>
<a id="afbc1fc6bd3f6ededfed2346989ccf055"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbc1fc6bd3f6ededfed2346989ccf055">&#9670;&nbsp;</a></span>set_drag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::set_drag </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5dd9fc911df600f1eb0e8f3c131d8353"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dd9fc911df600f1eb0e8f3c131d8353">&#9670;&nbsp;</a></span>set_hmixcoef()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::set_hmixcoef </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;{</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <a class="code" href="prob__common_8H.html#ac03b2472176ba10b0edc225576774769">init_custom_hmix</a>(geom[lev], *<a class="code" href="classROMSX.html#af83a943f37cd6bbaf25c52fcaceb0930">vec_visc2_p</a>[lev], *<a class="code" href="classROMSX.html#aa8fff925fc76e919ddc53de08b3725e9">vec_visc2_r</a>[lev], *<a class="code" href="classROMSX.html#a2f47ec18ca3f2465e3253f92ca493bbc">vec_diff2</a>[lev], <a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> time = 0.0;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#af83a943f37cd6bbaf25c52fcaceb0930">vec_visc2_p</a>[lev], GetVecOfPtrs(<a class="code" href="classROMSX.html#af83a943f37cd6bbaf25c52fcaceb0930">vec_visc2_p</a>));</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#aa8fff925fc76e919ddc53de08b3725e9">vec_visc2_r</a>[lev], GetVecOfPtrs(<a class="code" href="classROMSX.html#aa8fff925fc76e919ddc53de08b3725e9">vec_visc2_r</a>));</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#a2f47ec18ca3f2465e3253f92ca493bbc">vec_diff2</a>[lev]  , GetVecOfPtrs(<a class="code" href="classROMSX.html#a2f47ec18ca3f2465e3253f92ca493bbc">vec_diff2</a>));</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;}</div>
<div class="ttc" id="aprob__common_8H_html_ac03b2472176ba10b0edc225576774769"><div class="ttname"><a href="prob__common_8H.html#ac03b2472176ba10b0edc225576774769">init_custom_hmix</a></div><div class="ttdeci">void init_custom_hmix(const amrex::Geometry &amp;geom, amrex::MultiFab &amp;mf_visc2_p, amrex::MultiFab &amp;mf_visc2_r, amrex::MultiFab &amp;mf_diff2, SolverChoice const &amp;m_solverChoice)</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classROMSX_a5dd9fc911df600f1eb0e8f3c131d8353_cgraph.png" border="0" usemap="#aclassROMSX_a5dd9fc911df600f1eb0e8f3c131d8353_cgraph" alt=""/></div>
<map name="aclassROMSX_a5dd9fc911df600f1eb0e8f3c131d8353_cgraph" id="aclassROMSX_a5dd9fc911df600f1eb0e8f3c131d8353_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,172,32"/>
<area shape="rect" href="prob__common_8H.html#ac03b2472176ba10b0edc225576774769" title=" " alt="" coords="220,5,359,32"/>
</map>
</div>

</div>
</div>
<a id="a58c4b17d8ae67640e6248d93d3317581"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58c4b17d8ae67640e6248d93d3317581">&#9670;&nbsp;</a></span>set_massflux_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::set_massflux_3d </td>
          <td>(</td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>Hu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>on_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>Hv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>om_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real const &gt;&#160;</td>
          <td class="paramname"><em>Hz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>set_massflux_3d</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>velocity in x-direction </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Hu</td><td>H-weighted velocity in x-direction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">on_u</td><td>weighting for u </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>velocity in y-direction </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Hv</td><td>H-weighted velocity in y-direction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">om_v</td><td>weighting for v </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="comment">//  Compute horizontal mass fluxes, Hz*u/n and Hz*v/m.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    ParallelFor(Box(Hu), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    {</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        Hu(i,j,k)=0.5*(Hz(i,j,k)+Hz(i-1,j,k))*u(i,j,k)* on_u(i,j,0);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    });</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    ParallelFor(Box(Hv), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        Hv(i,j,k)=0.5*(Hz(i,j,k)+Hz(i,j-1,k))*v(i,j,k)* om_v(i,j,0);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    });</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7137f5e39d218263180f04072cb93b73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7137f5e39d218263180f04072cb93b73">&#9670;&nbsp;</a></span>set_smflux()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::set_smflux </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;{</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <a class="code" href="prob__common_8H.html#a36a5501b26f66b3ec6d4d187236bc3bc">init_custom_smflux</a>(geom[lev], time, *<a class="code" href="classROMSX.html#a2082155131b8b7e0dec29068a92cece2">vec_sustr</a>[lev], *<a class="code" href="classROMSX.html#a44a44e4d82bc38d55daa03f281437113">vec_svstr</a>[lev], <a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="comment">// FillPatch(lev, time, *vec_sustr[lev], GetVecOfPtrs(vec_sustr));</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">// FillPatch(lev, time, *vec_svstr[lev], GetVecOfPtrs(vec_svstr));</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;}</div>
<div class="ttc" id="aprob__common_8H_html_a36a5501b26f66b3ec6d4d187236bc3bc"><div class="ttname"><a href="prob__common_8H.html#a36a5501b26f66b3ec6d4d187236bc3bc">init_custom_smflux</a></div><div class="ttdeci">void init_custom_smflux(const amrex::Geometry &amp;geom, amrex::Real time, amrex::MultiFab &amp;mf_sustr, amrex::MultiFab &amp;mf_svstr, SolverChoice const &amp;m_solverChoice)</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classROMSX_a7137f5e39d218263180f04072cb93b73_cgraph.png" border="0" usemap="#aclassROMSX_a7137f5e39d218263180f04072cb93b73_cgraph" alt=""/></div>
<map name="aclassROMSX_a7137f5e39d218263180f04072cb93b73_cgraph" id="aclassROMSX_a7137f5e39d218263180f04072cb93b73_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,155,32"/>
<area shape="rect" href="prob__common_8H.html#a36a5501b26f66b3ec6d4d187236bc3bc" title=" " alt="" coords="203,5,352,32"/>
</map>
</div>

</div>
</div>
<a id="a48b99337b5ac313ce48a95ab0b9e73dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48b99337b5ac313ce48a95ab0b9e73dc">&#9670;&nbsp;</a></span>set_vmix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::set_vmix </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                       {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <a class="code" href="prob__common_8H.html#a3aabbde4e8cfbf5eeb55157f2ac5fe98">init_custom_vmix</a>(geom[lev], *<a class="code" href="classROMSX.html#aec2c137ce4314357035cbc7ae292338f">vec_Akv</a>[lev], *<a class="code" href="classROMSX.html#a63d077c5232d18aa0c31f1824b63b5ca">vec_Akt</a>[lev], *<a class="code" href="classROMSX.html#a7e2a55ae7fb02290e6ead16ec3e658fa">vec_z_w</a>[lev], <a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> time = 0.0;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#aec2c137ce4314357035cbc7ae292338f">vec_Akv</a>[lev], GetVecOfPtrs(<a class="code" href="classROMSX.html#aec2c137ce4314357035cbc7ae292338f">vec_Akv</a>));</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#a63d077c5232d18aa0c31f1824b63b5ca">vec_Akt</a>[lev], GetVecOfPtrs(<a class="code" href="classROMSX.html#a63d077c5232d18aa0c31f1824b63b5ca">vec_Akt</a>));</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;}</div>
<div class="ttc" id="aprob__common_8H_html_a3aabbde4e8cfbf5eeb55157f2ac5fe98"><div class="ttname"><a href="prob__common_8H.html#a3aabbde4e8cfbf5eeb55157f2ac5fe98">init_custom_vmix</a></div><div class="ttdeci">void init_custom_vmix(const amrex::Geometry &amp;geom, amrex::MultiFab &amp;mf_Akv, amrex::MultiFab &amp;mf_Akt, amrex::MultiFab &amp;mf_z_w, SolverChoice const &amp;m_solverChoice)</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classROMSX_a48b99337b5ac313ce48a95ab0b9e73dc_cgraph.png" border="0" usemap="#aclassROMSX_a48b99337b5ac313ce48a95ab0b9e73dc_cgraph" alt=""/></div>
<map name="aclassROMSX_a48b99337b5ac313ce48a95ab0b9e73dc_cgraph" id="aclassROMSX_a48b99337b5ac313ce48a95ab0b9e73dc_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,144,32"/>
<area shape="rect" href="prob__common_8H.html#a3aabbde4e8cfbf5eeb55157f2ac5fe98" title=" " alt="" coords="192,5,331,32"/>
</map>
</div>

</div>
</div>
<a id="a3ca3a726e1b0ecfc4339b2a07ade77b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ca3a726e1b0ecfc4339b2a07ade77b7">&#9670;&nbsp;</a></span>set_weights()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::set_weights </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;                              {</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> gamma, scale;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> wsum, shift, cff;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="comment">//HACK should possibly store fixed_ndtfast elsewhere</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keywordtype">int</span> ndtfast=<a class="code" href="classROMSX.html#a676fc3cc2402734727ca9e04e050d171">fixed_ndtfast_ratio</a>&gt;0 ? <a class="code" href="classROMSX.html#a676fc3cc2402734727ca9e04e050d171">fixed_ndtfast_ratio</a> : <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classROMSX.html#a9b13ff6c8fec8f7ac0eb7330732d9bcc">fixed_fast_dt</a> / <a class="code" href="classROMSX.html#a9f1ff8349f4357e88dc70143f163b392">fixed_dt</a>);</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="comment">//From mod_scalars</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Falpha = 2.0_rt;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Fbeta = 4.0_rt;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Fgamma = 0.284_rt;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <a class="code" href="classROMSX.html#a55d028f9a1e55a035ab877607ac326fe">vec_weight1</a>.resize(2*ndtfast+1);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <a class="code" href="classROMSX.html#a1781a7c54d695e8889f2d394062b85a7">vec_weight2</a>.resize(2*ndtfast+1);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keyword">auto</span> weight1 = <a class="code" href="classROMSX.html#a55d028f9a1e55a035ab877607ac326fe">vec_weight1</a>.dataPtr();</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keyword">auto</span> weight2 = <a class="code" href="classROMSX.html#a1781a7c54d695e8889f2d394062b85a7">vec_weight2</a>.dataPtr();</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">//  Compute time-averaging filter for barotropic fields.</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">//  Initialize both sets of weights to zero.</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>=0;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;=2*ndtfast;i++) {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        weight1[i-1]=0.0_rt;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        weight2[i-1]=0.0_rt;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//  Power-law shape filters.</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">//  The power-law shape filters are given by:</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">//     F(xi)=xi^Falpha*(1-xi^Fbeta)-Fgamma*xi</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">//  where xi=scale*i/ndtfast; and scale, Falpha, Fbeta, Fgamma, and</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">//  normalization are chosen to yield the correct zeroth-order</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">//  (normalization), first-order (consistency), and second-order moments,</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">//  resulting in overall second-order temporal accuracy for time-averaged</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">//  barotropic motions resolved by baroclinic time step.</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      scale=(Falpha+1.0_rt)*(Falpha+Fbeta+1.0_rt)/</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      ((Falpha+2.0_rt)*(Falpha+Fbeta+2.0_rt)*<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(ndtfast));</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">//  Find center of gravity of the primary weighting shape function and</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">//  iteratively adjust &quot;scale&quot; to place the  centroid exactly at</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">//  &quot;ndtfast&quot;.</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      gamma=Fgamma*max(0.0_rt, 1.0_rt-10.0_rt/<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(ndtfast));</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iter=1;iter&lt;=16;iter++) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;          <a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>=0;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;=2*ndtfast;i++) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;          cff=scale*<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(i);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;          weight1[i-1]=pow(cff,Falpha)-pow(cff,(Falpha+Fbeta))-gamma*cff;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;          <span class="keywordflow">if</span> (weight1[i-1]&gt;0.0_rt) <a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>=i;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;          <span class="keywordflow">if</span> ((<a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>&gt;0)&amp;&amp;(weight1[i-1]&lt;0.0_rt)) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            weight1[i-1]=0.0_rt;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;          }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        wsum=0.0_rt;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        shift=0.0_rt;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;=<a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>;i++) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;          wsum=wsum+weight1[i-1];</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;          shift=shift+weight1[i-1]*<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(i);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        scale=scale*shift/(wsum*<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(ndtfast));</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">//  Post-processing of primary weights.</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">//  Although it is assumed that the initial settings of the primary</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">//  weights has its center of gravity &quot;reasonably close&quot; to NDTFAST,</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">//  it may be not so according to the discrete rules of integration.</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">//  The following procedure is designed to put the center of gravity</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">//  exactly to NDTFAST by computing mismatch (NDTFAST-shift) and</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">//  applying basically an upstream advection of weights to eliminate</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">//  the mismatch iteratively. Once this procedure is complete primary</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">//  weights are normalized.</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">//  Find center of gravity of the primary weights and subsequently</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">//  calculate the mismatch to be compensated.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iter=1;iter&lt;=ndtfast;iter++) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        wsum=0.0_rt;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        shift=0.0_rt;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;=<a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>;i++) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;          wsum=wsum+weight1[i-1];</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;          shift=shift+<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(i)*weight1[i-1];</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        shift=shift/wsum;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        cff=<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(ndtfast)-shift;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">//  Apply advection step using either whole, or fractional shifts.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">//  Notice that none of the four loops here is reversible.</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordflow">if</span> (cff&gt;1.0_rt) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;          <a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>=<a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>+1;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=<a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>;i&gt;=2;i--) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            weight1[i-1]=weight1[i-1-1];</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;          }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;          weight1[1-1]=0.0_rt;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cff&gt;0.0_rt) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;          wsum=1.0_rt-cff;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=<a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>;i&gt;=2;i--) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;          weight1[i-1]=wsum*weight1[i-1]+cff*weight1[i-1-1];</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;          }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;          weight1[1-1]=wsum*weight1[1-1];</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cff&lt;-1.0_rt) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;          <a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>=<a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>-1;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;=<a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>;i++) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;          weight1[i-1]=weight1[i+1-1];</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;          }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;          weight1[<a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>+1-1]=0.0_rt;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cff&lt;0.0_rt) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;          wsum=1.0_rt+cff;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;=<a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>-1;i++) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;          weight1[i-1]=wsum*weight1[i-1]-cff*weight1[i+1-1];</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;          weight1[<a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>-1]=wsum*weight1[<a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>-1];</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">//  Set SECONDARY weights assuming that backward Euler time step is used</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">//  for free surface.  Notice that array weight2[i] is assumed to</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">//  have all-zero status at entry in this segment of code.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=1;j&lt;=<a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>;j++) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        cff=weight1[j-1];</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;=j;i++) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            weight2[i-1]=weight2[i-1]+cff;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">//  Normalize both set of weights.</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      wsum=0.0_rt;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      cff=0.0_rt;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;=<a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>;i++) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        wsum=wsum+weight1[i-1];</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        cff=cff+weight2[i-1];</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      wsum=1.0_rt/wsum;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      cff=1.0_rt/cff;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;=<a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>;i++) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        weight1[i-1]=wsum*weight1[i-1];</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        weight2[i-1]=cff*weight2[i-1];</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">//  Report weights.</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1, cff2;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        Print().SetPrecision(18)&lt;&lt;ParallelDescriptor::NProcs()&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;ndtfast&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;wsum&lt;&lt;std::endl;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        cff=0.0_rt;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        cff1=0.0_rt;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        cff2=0.0_rt;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        wsum=0.0_rt;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        shift=0.0_rt;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;=<a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>;i++) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;          cff=cff+weight1[i-1];</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;          cff1=cff1+weight1[i-1]*<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(i);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;          cff2=cff2+weight1[i-1]*<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(i*i);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;          wsum=wsum+weight2[i-1];</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;          shift=shift+weight2[i-1]*(<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(i)-0.5_rt);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;          Print().SetPrecision(18)&lt;&lt;<span class="stringliteral">&quot;i=&quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;weight1[i-1]&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;weight2[i-1]&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;cff&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;wsum&lt;&lt;std::endl;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        cff1=cff1/<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(ndtfast);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        cff2=cff2/(<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(ndtfast)*<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(ndtfast));</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        shift=shift/<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(ndtfast);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        Print().SetPrecision(18)&lt;&lt;ndtfast &lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt; <a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(<a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a>)/<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(ndtfast)&lt;&lt;std::endl;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        Print().SetPrecision(18)&lt;&lt;cff1&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;cff2&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;shift&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;cff&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;wsum&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;Fgamma&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;gamma&lt;&lt;std::endl;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keywordflow">if</span> (cff2&lt;1.0001_rt) Print()&lt;&lt;<span class="stringliteral">&quot;\n\n\n&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a570a9208f8598e95442e4c5717902638"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a570a9208f8598e95442e4c5717902638">&#9670;&nbsp;</a></span>setPlotVariables()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::setPlotVariables </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>pp_plot_var_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>plot_var_names</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>set which variables and derived quantities go into plotfiles </p>
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    ParmParse pp(<a class="code" href="classROMSX.html#afda0f54b3ad1ed8dbb39bbef8ed48c92">pp_prefix</a>);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="keywordflow">if</span> (pp.contains(pp_plot_var_names.c_str()))</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        std::string nm;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        <span class="keywordtype">int</span> nPltVars = pp.countval(pp_plot_var_names.c_str());</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nPltVars; i++)</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        {</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;            pp.get(pp_plot_var_names.c_str(), nm, i);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;            <span class="comment">// Add the named variable to our list of plot variables</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;            <span class="comment">// if it is not already in the list</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="ROMSX_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, nm)) {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                plot_var_names.push_back(nm);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;            }</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        }</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <span class="comment">// The default is to add none of the variables to the list</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        plot_var_names.clear();</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    }</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="comment">// Get state variables in the same order as we define them,</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">// since they may be in any order in the input list</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    Vector&lt;std::string&gt; tmp_plot_names;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; ++i) {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="ROMSX_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <a class="code" href="classROMSX.html#afd7f32f1e2d2c5152773534f6f8ab5a0">cons_names</a>[i]) ) {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;            tmp_plot_names.push_back(<a class="code" href="classROMSX.html#afd7f32f1e2d2c5152773534f6f8ab5a0">cons_names</a>[i]);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">// Check for velocity since it&#39;s not in cons_names</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">// If we are asked for any velocity component, we will need them all</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ROMSX_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;x_velocity&quot;</span>) ||</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <a class="code" href="ROMSX_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;y_velocity&quot;</span>) ||</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <a class="code" href="ROMSX_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;z_velocity&quot;</span>)) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        tmp_plot_names.push_back(<span class="stringliteral">&quot;x_velocity&quot;</span>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        tmp_plot_names.push_back(<span class="stringliteral">&quot;y_velocity&quot;</span>);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        tmp_plot_names.push_back(<span class="stringliteral">&quot;z_velocity&quot;</span>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">// If we are asked for any location component, we will provide them all</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ROMSX_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;x_cc&quot;</span>) ||</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <a class="code" href="ROMSX_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;y_cc&quot;</span>) ||</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <a class="code" href="ROMSX_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;z_cc&quot;</span>)) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        tmp_plot_names.push_back(<span class="stringliteral">&quot;x_cc&quot;</span>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        tmp_plot_names.push_back(<span class="stringliteral">&quot;y_cc&quot;</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        tmp_plot_names.push_back(<span class="stringliteral">&quot;z_cc&quot;</span>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classROMSX.html#ab221b060f02f422f90d511e71b5c13d6">derived_names</a>.size(); ++i) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="ROMSX_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <a class="code" href="classROMSX.html#ab221b060f02f422f90d511e71b5c13d6">derived_names</a>[i]) ) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#ifdef ROMSX_USE_PARTICLES</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            <span class="keywordflow">if</span> (particleData.use_tracer_particles || (<a class="code" href="classROMSX.html#ab221b060f02f422f90d511e71b5c13d6">derived_names</a>[i] != <span class="stringliteral">&quot;tracer_particle_count&quot;</span>)) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;               tmp_plot_names.push_back(<a class="code" href="classROMSX.html#ab221b060f02f422f90d511e71b5c13d6">derived_names</a>[i]);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#ifdef ROMSX_USE_PARTICLES</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        } <span class="comment">// if</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    } <span class="comment">// i</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">// Check to see if we found all the requested variables</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> plot_name : plot_var_names) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="ROMSX_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(tmp_plot_names, plot_name)) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;           Warning(<span class="stringliteral">&quot;\nWARNING: Requested to plot variable &#39;&quot;</span> + plot_name + <span class="stringliteral">&quot;&#39; but it is not available&quot;</span>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    plot_var_names = tmp_plot_names;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;}</div>
<div class="ttc" id="aROMSX_8H_html_a1f8554e7b211b0acfc202e8a600e7d67"><div class="ttname"><a href="ROMSX_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a></div><div class="ttdeci">bool containerHasElement(const V &amp;iterable, const T &amp;query)</div><div class="ttdef"><b>Definition:</b> ROMSX.H:63</div></div>
<div class="ttc" id="aclassROMSX_html_ab221b060f02f422f90d511e71b5c13d6"><div class="ttname"><a href="classROMSX.html#ab221b060f02f422f90d511e71b5c13d6">ROMSX::derived_names</a></div><div class="ttdeci">const amrex::Vector&lt; std::string &gt; derived_names</div><div class="ttdef"><b>Definition:</b> ROMSX.H:821</div></div>
<div class="ttc" id="aclassROMSX_html_afd7f32f1e2d2c5152773534f6f8ab5a0"><div class="ttname"><a href="classROMSX.html#afd7f32f1e2d2c5152773534f6f8ab5a0">ROMSX::cons_names</a></div><div class="ttdeci">const amrex::Vector&lt; std::string &gt; cons_names</div><div class="ttdef"><b>Definition:</b> ROMSX.H:815</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classROMSX_a570a9208f8598e95442e4c5717902638_cgraph.png" border="0" usemap="#aclassROMSX_a570a9208f8598e95442e4c5717902638_cgraph" alt=""/></div>
<map name="aclassROMSX_a570a9208f8598e95442e4c5717902638_cgraph" id="aclassROMSX_a570a9208f8598e95442e4c5717902638_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,188,32"/>
<area shape="rect" href="ROMSX_8H.html#a1f8554e7b211b0acfc202e8a600e7d67" title=" " alt="" coords="236,5,399,32"/>
</map>
</div>

</div>
</div>
<a id="abdccbdf27483fa87a7fc769ef6aa16fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdccbdf27483fa87a7fc769ef6aa16fd">&#9670;&nbsp;</a></span>setRecordDataInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::setRecordDataInfo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        <span class="keywordflow">if</span> (amrex::ParallelDescriptor::IOProcessor())</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        {</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            <a class="code" href="classROMSX.html#a854a34e778a776e3ca46f7eeac9813e4">datalog</a>[i] = std::make_unique&lt;std::fstream&gt;();</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            <a class="code" href="classROMSX.html#a854a34e778a776e3ca46f7eeac9813e4">datalog</a>[i]-&gt;open(filename.c_str(),std::ios::out|std::ios::app);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classROMSX.html#a854a34e778a776e3ca46f7eeac9813e4">datalog</a>[i]-&gt;good()) {</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                amrex::FileOpenFailed(filename);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            }</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        }</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        amrex::ParallelDescriptor::Barrier(<span class="stringliteral">&quot;ROMSX::setRecordDataInfo&quot;</span>);</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a62d0fa7d294be023f9050f71bb0ad221"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62d0fa7d294be023f9050f71bb0ad221">&#9670;&nbsp;</a></span>setup_step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::setup_step </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set everything up for a step on a level </p>
<div class="fragment"><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;{</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ROMSX::setup_step()&quot;</span>);</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160; </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    MultiFab&amp; S_old = *<a class="code" href="classROMSX.html#a7a14aa971cac1b1ad0eb5d4b46b90343">cons_old</a>[lev];</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    MultiFab&amp; S_new = *<a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev];</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    MultiFab&amp; U_old = *<a class="code" href="classROMSX.html#af0b5074dc426b753beb5511bd63df407">xvel_old</a>[lev];</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    MultiFab&amp; V_old = *<a class="code" href="classROMSX.html#a87f0b7446438b8145bdea79012b985f5">yvel_old</a>[lev];</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    MultiFab&amp; W_old = *<a class="code" href="classROMSX.html#acb72d33af4be09dede2005fa6c901686">zvel_old</a>[lev];</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    MultiFab&amp; U_new = *<a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev];</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    MultiFab&amp; V_new = *<a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev];</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    MultiFab&amp; W_new = *<a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[lev];</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keywordtype">int</span> nvars = S_old.nComp();</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="comment">// Fill ghost cells/faces at old time</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#a7a14aa971cac1b1ad0eb5d4b46b90343">cons_old</a>[lev], <a class="code" href="classROMSX.html#a7a14aa971cac1b1ad0eb5d4b46b90343">cons_old</a>);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#af0b5074dc426b753beb5511bd63df407">xvel_old</a>[lev], <a class="code" href="classROMSX.html#af0b5074dc426b753beb5511bd63df407">xvel_old</a>);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#a87f0b7446438b8145bdea79012b985f5">yvel_old</a>[lev], <a class="code" href="classROMSX.html#a87f0b7446438b8145bdea79012b985f5">yvel_old</a>);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#acb72d33af4be09dede2005fa6c901686">zvel_old</a>[lev], <a class="code" href="classROMSX.html#acb72d33af4be09dede2005fa6c901686">zvel_old</a>);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">    //////////    //pre_step3d corrections to boundaries</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keyword">const</span> BoxArray&amp;            ba = S_old.boxArray();</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keyword">const</span> DistributionMapping&amp; dm = S_old.DistributionMap();</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nrhs  = 0;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nstp  = 0;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">// Place-holder for source array -- for now just set to 0</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    MultiFab source(ba,dm,nvars,1);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    source.setVal(0.0);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">//  Time step momentum equation</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">//Only used locally, probably should be rearranged into FArrayBox declaration</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    MultiFab mf_AK(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0)); <span class="comment">//2d missing j coordinate</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    MultiFab mf_DC(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1)); <span class="comment">//2d missing j coordinate</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    MultiFab mf_Hzk(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1)); <span class="comment">//2d missing j coordinate</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_z_r = <a class="code" href="classROMSX.html#a0a9b1a5cf021018defc82b45cbecb2c5">vec_z_r</a>[lev];</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_z_w = <a class="code" href="classROMSX.html#a7e2a55ae7fb02290e6ead16ec3e658fa">vec_z_w</a>[lev];</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_h = <a class="code" href="classROMSX.html#a03b79a651abf3dc2bd37fadaca99fd46">vec_hOfTheConfusingName</a>[lev];</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">//Consider passing these into the advance function or renaming relevant things</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    MultiFab mf_rho(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_rhoS = <a class="code" href="classROMSX.html#a20d43f4b49b92542c1790c1ea01ca19c">vec_rhoS</a>[lev];</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_rhoA = <a class="code" href="classROMSX.html#a0978a71210c5f05a5541002532bd9cd2">vec_rhoA</a>[lev];</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_ru = <a class="code" href="classROMSX.html#ab1343869d59f89fd4773bc7fa230aa73">vec_ru</a>[lev];</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_rv = <a class="code" href="classROMSX.html#ab5041f0f370ab1ec4f7f7e16127c9039">vec_rv</a>[lev];</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_rufrc = <a class="code" href="classROMSX.html#ab5b7ff78a167e59ae727b22094b39079">vec_rufrc</a>[lev];</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_rvfrc = <a class="code" href="classROMSX.html#a52a5f265a370595f128046c31b9f31d5">vec_rvfrc</a>[lev];</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_sustr = <a class="code" href="classROMSX.html#a2082155131b8b7e0dec29068a92cece2">vec_sustr</a>[lev];</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_svstr = <a class="code" href="classROMSX.html#a44a44e4d82bc38d55daa03f281437113">vec_svstr</a>[lev];</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_rdrag = <a class="code" href="classROMSX.html#ac49463f0fb789402ba8641f289906456">vec_rdrag</a>[lev];</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_bustr = <a class="code" href="classROMSX.html#a607e27d43f6eaebcf557c4ae17b8039a">vec_bustr</a>[lev];</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_bvstr = <a class="code" href="classROMSX.html#a5a981dafaf65d2d8d96f16e1e7467eb2">vec_bvstr</a>[lev];</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    MultiFab mf_rw(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_visc2_p = <a class="code" href="classROMSX.html#af83a943f37cd6bbaf25c52fcaceb0930">vec_visc2_p</a>[lev];</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_visc2_r = <a class="code" href="classROMSX.html#aa8fff925fc76e919ddc53de08b3725e9">vec_visc2_r</a>[lev];</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">// We need to set these because otherwise in the first call to romsx_advance we may</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">//    read uninitialized data on ghost values in setting the bc&#39;s on the velocities</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    mf_rho.setVal(0.e34,IntVect(AMREX_D_DECL(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0)));</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    mf_rhoS-&gt;setVal(0.e34,IntVect(AMREX_D_DECL(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0)));</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    mf_rhoA-&gt;setVal(0.e34,IntVect(AMREX_D_DECL(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0)));</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    mf_DC.setVal(0);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#a7a14aa971cac1b1ad0eb5d4b46b90343">cons_old</a>[lev], <a class="code" href="classROMSX.html#a7a14aa971cac1b1ad0eb5d4b46b90343">cons_old</a>);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#af0b5074dc426b753beb5511bd63df407">xvel_old</a>[lev], <a class="code" href="classROMSX.html#af0b5074dc426b753beb5511bd63df407">xvel_old</a>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#a87f0b7446438b8145bdea79012b985f5">yvel_old</a>[lev], <a class="code" href="classROMSX.html#a87f0b7446438b8145bdea79012b985f5">yvel_old</a>);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev], <a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev], <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev], <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    mf_rw.setVal(0.0);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    mf_rufrc-&gt;setVal(0);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    mf_rvfrc-&gt;setVal(0);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">int</span> iic = <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[lev];</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordtype">int</span> ntfirst = 0;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">if</span>(iic==ntfirst) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        MultiFab::Copy(S_new,S_old,0,0,S_new.nComp(),S_new.nGrowVect());</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        MultiFab::Copy(U_new,U_old,0,0,U_new.nComp(),U_new.nGrowVect());</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        MultiFab::Copy(V_new,V_old,0,0,V_new.nComp(),V_new.nGrowVect());</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        MultiFab::Copy(W_new,W_old,0,0,W_new.nComp(),W_new.nGrowVect());</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="classROMSX.html#a7137f5e39d218263180f04072cb93b73">set_smflux</a>(lev,<a class="code" href="classROMSX.html#ac395453aa10633a05bb7323b2946101e">t_old</a>[lev]);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keyword">auto</span> N = Geom(lev).Domain().size()[2]-1; <span class="comment">// Number of vertical &quot;levs&quot; aka, NZ</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> prob_lo          = Geom(lev).ProbLoArray();</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> dxi              = Geom(lev).InvCellSizeArray();</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> dx               = Geom(lev).CellSizeArray();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">//MFIter::allowMultipleMFIters(true);</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(S_new, TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; h = (<a class="code" href="classROMSX.html#a03b79a651abf3dc2bd37fadaca99fd46">vec_hOfTheConfusingName</a>[lev])-&gt;const_array(mfi);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; Hz  = (<a class="code" href="classROMSX.html#aa5461758b528d199101b5ea74f9a6c12">vec_Hz</a>[lev])-&gt;const_array(mfi);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; Huon  = (<a class="code" href="classROMSX.html#a24f02b944df51884168ab0c08c736c91">vec_Huon</a>[lev])-&gt;array(mfi);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; Hvom  = (<a class="code" href="classROMSX.html#a21dcccced847102e553281c1852ce005">vec_Hvom</a>[lev])-&gt;array(mfi);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; z_w = (mf_z_w)-&gt;const_array(mfi);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; uold = U_old.array(mfi);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; vold = V_old.array(mfi);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; rho = (mf_rho).array(mfi);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; rhoA = (mf_rhoA)-&gt;array(mfi);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; rhoS = (mf_rhoS)-&gt;array(mfi);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; rdrag = (mf_rdrag)-&gt;array(mfi);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; bustr = (mf_bustr)-&gt;array(mfi);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        Array4&lt;Real      &gt; <span class="keyword">const</span>&amp; bvstr = (mf_bvstr)-&gt;array(mfi);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        Box  bx = mfi.tilebox();</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        Box ubx = Box(uold);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        Box vbx = Box(vold);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        Box gbx1 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        Box gbx2 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="comment">//TODO: adjust for tiling</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="comment">//Box gbx3uneven(IntVect(AMREX_D_DECL(bx.smallEnd(0)-3,bx.smallEnd(1)-3,bx.smallEnd(2))),</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="comment">//               IntVect(AMREX_D_DECL(bx.bigEnd(0)+2,bx.bigEnd(1)+2,bx.bigEnd(2))));</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="comment">//Box gbx2uneven(IntVect(AMREX_D_DECL(bx.smallEnd(0)-2,bx.smallEnd(1)-2,bx.smallEnd(2))),</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="comment">//               IntVect(AMREX_D_DECL(bx.bigEnd(0)+1,bx.bigEnd(1)+1,bx.bigEnd(2))));</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        Box bxD = bx;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        bxD.makeSlab(2,0);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        Box gbx1D = gbx1;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        gbx1D.makeSlab(2,0);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        Box gbx2D = gbx2;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        gbx2D.makeSlab(2,0);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        FArrayBox fab_FC(gbx2,1,amrex::The_Async_Arena()); <span class="comment">//3D</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        FArrayBox fab_FX(gbx2,1,amrex::The_Async_Arena()); <span class="comment">//3D</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        FArrayBox fab_FE(gbx2,1,amrex::The_Async_Arena()); <span class="comment">//3D</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        FArrayBox fab_BC(gbx2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        FArrayBox fab_CF(gbx2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        FArrayBox fab_pn(gbx2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        FArrayBox fab_pm(gbx2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        FArrayBox fab_om_r(gbx2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        FArrayBox fab_on_r(gbx2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        FArrayBox fab_om_p(gbx2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        FArrayBox fab_on_p(gbx2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        FArrayBox fab_pmon_u(gbx2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        FArrayBox fab_pnom_u(gbx2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        FArrayBox fab_pmon_v(gbx2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        FArrayBox fab_pnom_v(gbx2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        FArrayBox fab_on_u(makeSlab(ubx,2,0),1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        FArrayBox fab_om_v(makeSlab(vbx,2,0),1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        FArrayBox fab_om_u(gbx2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        FArrayBox fab_on_v(gbx2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keyword">auto</span> on_u=fab_on_u.array();</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keyword">auto</span> om_v=fab_om_v.array();</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keyword">auto</span> om_u=fab_om_u.array();</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keyword">auto</span> on_v=fab_on_v.array();</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keyword">auto</span> om_r=fab_om_r.array();</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keyword">auto</span> on_r=fab_on_r.array();</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keyword">auto</span> om_p=fab_om_p.array();</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keyword">auto</span> on_p=fab_on_p.array();</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keyword">auto</span> pmon_u=fab_pmon_u.array();</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keyword">auto</span> pnom_u=fab_pnom_u.array();</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keyword">auto</span> pmon_v=fab_pmon_v.array();</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keyword">auto</span> pnom_v=fab_pnom_v.array();</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        ParallelFor(ubx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;          on_u(i,j,0)=1.0/dxi[1]; <span class="comment">// 2/(pm(i,j-1)+pm(i,j))</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        });</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        ParallelFor(vbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;          om_v(i,j,0)=1.0/dxi[0]; <span class="comment">// 2/(pm(i,j-1)+pm(i,j))</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        });</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        ParallelFor(gbx2D, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;          <span class="comment">//Note: are the comment definitons right? Don&#39;t seem to match metrics.f90</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;          om_r(i,j,0)=1.0/dxi[0]; <span class="comment">// 1/pm(i,j)</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;          on_r(i,j,0)=1.0/dxi[1]; <span class="comment">// 1/pn(i,j)</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;          <span class="comment">//todo: om_p on_p</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;          om_p(i,j,0)=1.0/dxi[0]; <span class="comment">// 4/(pm(i-1,j-1)+pm(i-1,j)+pm(i,j-1)+pm(i,j))</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;          on_p(i,j,0)=1.0/dxi[1]; <span class="comment">// 4/(pn(i-1,j-1)+pn(i-1,j)+pn(i,j-1)+pn(i,j))</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;          on_v(i,j,0)=1.0/dxi[1]; <span class="comment">// 2/(pn(i-1,j)+pn(i,j))</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;          om_u(i,j,0)=1.0/dxi[0]; <span class="comment">// 2/(pm(i-1,j)+pm(i,j))</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;          pmon_u(i,j,0)=1.0;        <span class="comment">// (pm(i-1,j)+pm(i,j))/(pn(i-1,j)+pn(i,j))</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;          pnom_u(i,j,0)=1.0;        <span class="comment">// (pn(i-1,j)+pn(i,j))/(pm(i-1,j)+pm(i,j))</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;          pmon_v(i,j,0)=1.0;        <span class="comment">// (pm(i,j-1)+pm(i,j))/(pn(i,j-1)+pn(i,j))</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;          pnom_v(i,j,0)=1.0;        <span class="comment">// (pn(i,j-1)+pn(i,j))/(pm(i,j-1)+pm(i,j))</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        });</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        ParallelFor(gbx2, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;          Huon(i,j,k,0)=0.0;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;          Hvom(i,j,k,0)=0.0;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        });</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="comment">// Set bottom stress as defined in set_vbx.F</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        ParallelFor(gbx1D, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            bustr(i,j,0) = 0.5 * (rdrag(i-1,j,0)+rdrag(i,j,0))*(uold(i,j,0));</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            bvstr(i,j,0) = 0.5 * (rdrag(i,j-1,0)+rdrag(i,j,0))*(vold(i,j,0));</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        });</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="comment">// Updates Huon and Hvom</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <a class="code" href="classROMSX.html#a58c4b17d8ae67640e6248d93d3317581">set_massflux_3d</a>(uold,Huon,on_u,vold,Hvom,om_v,Hz);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; state_old = S_old.const_array(mfi);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <a class="code" href="classROMSX.html#aa21a56eb75e6c5565402a56d818c179e">rho_eos</a>(gbx2,state_old,rho,rhoA,rhoS,Hz,z_w,h,N);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    MultiFab mf_W(ba,dm,1,IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0));</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    mf_W.setVal(0.0);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#aef43f702963efac7f3e0c2b43249fbb6">use_prestep</a>) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> nnew  = 0;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <a class="code" href="classROMSX.html#a67ddc86fe4c43ffe1900646deba10f1c">prestep</a>(lev, U_old, V_old, U_new, V_new,</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                mf_ru, mf_rv,</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                S_old, S_new, mf_W,</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                mf_DC, mf_z_r, mf_z_w, mf_h, mf_sustr, mf_svstr, mf_bustr,</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                mf_bvstr, iic, ntfirst, nnew, nstp, nrhs, N, dt_lev);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">// We use FillBoundary not FillPatch here since mf_W is single-level scratch space</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    mf_W.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(S_old, TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Hz  = (<a class="code" href="classROMSX.html#aa5461758b528d199101b5ea74f9a6c12">vec_Hz</a>[lev])-&gt;array(mfi);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Huon  = (<a class="code" href="classROMSX.html#a24f02b944df51884168ab0c08c736c91">vec_Huon</a>[lev])-&gt;array(mfi);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Hvom  = (<a class="code" href="classROMSX.html#a21dcccced847102e553281c1852ce005">vec_Hvom</a>[lev])-&gt;array(mfi);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; z_r = (mf_z_r)-&gt;array(mfi);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; z_w = (mf_z_w)-&gt;array(mfi);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; uold = U_old.array(mfi);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; vold = V_old.array(mfi);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; u    = U_new.array(mfi);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; v    = V_new.array(mfi);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; rho = (mf_rho).array(mfi);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; ru = (mf_ru)-&gt;array(mfi);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; rv = (mf_rv)-&gt;array(mfi);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; rufrc = (mf_rufrc)-&gt;array(mfi);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; rvfrc = (mf_rvfrc)-&gt;array(mfi);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; W = (mf_W).array(mfi);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; sustr = (mf_sustr)-&gt;array(mfi);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; svstr = (mf_svstr)-&gt;array(mfi);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; bustr = (mf_bustr)-&gt;array(mfi);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; bvstr = (mf_bvstr)-&gt;array(mfi);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; visc2_p = (mf_visc2_p)-&gt;array(mfi);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; visc2_r = (mf_visc2_r)-&gt;array(mfi);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; zeta = (<a class="code" href="classROMSX.html#ab026fffd3c4e9a9ef612cbb23132a1f5">vec_zeta</a>[lev])-&gt;array(mfi);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Zt_avg1 = (<a class="code" href="classROMSX.html#ab962f23dc27b3ce17bb19e3b8c9991f8">vec_Zt_avg1</a>[lev])-&gt;array(mfi);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        Box bx = mfi.tilebox();</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        Box tbxp1 = bx;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        Box tbxp2 = bx;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        Box xbx = mfi.nodaltilebox(0);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        Box ybx = mfi.nodaltilebox(1);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        Box gbx1 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        Box gbx2 = mfi.growntilebox(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        Box ubx = Box(uold);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        Box vbx = Box(vold);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        Box utbx = mfi.nodaltilebox(0);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        Box vtbx = mfi.nodaltilebox(1);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        tbxp1.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0));</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        tbxp2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        Box bxD = bx;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        bxD.makeSlab(2,0);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        Box gbx1D = gbx1;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        gbx1D.makeSlab(2,0);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        Box gbx2D = gbx2;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        gbx2D.makeSlab(2,0);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        Box tbxp1D = tbxp1;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        tbxp1D.makeSlab(2,0);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        Box tbxp2D = tbxp2;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        tbxp2D.makeSlab(2,0);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        FArrayBox fab_FC(tbxp2,1,amrex::The_Async_Arena()); <span class="comment">//3D</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        FArrayBox fab_FX(gbx2,1,amrex::The_Async_Arena()); <span class="comment">//3D</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        FArrayBox fab_FE(gbx2,1,amrex::The_Async_Arena()); <span class="comment">//3D</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        FArrayBox fab_BC(gbx2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        FArrayBox fab_CF(gbx2,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        FArrayBox fab_pn(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        FArrayBox fab_pm(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        FArrayBox fab_om_u(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        FArrayBox fab_on_v(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        FArrayBox fab_om_r(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        FArrayBox fab_on_r(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        FArrayBox fab_om_p(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        FArrayBox fab_on_p(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        FArrayBox fab_pmon_u(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        FArrayBox fab_pnom_u(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        FArrayBox fab_pmon_v(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        FArrayBox fab_pnom_v(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        FArrayBox fab_fomn(tbxp2D,1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        FArrayBox fab_on_u(makeSlab(ubx,2,0),1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        FArrayBox fab_om_v(makeSlab(vbx,2,0),1,amrex::The_Async_Arena());</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="keyword">auto</span> FC=fab_FC.array();</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keyword">auto</span> pn=fab_pn.array();</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keyword">auto</span> pm=fab_pm.array();</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keyword">auto</span> on_u=fab_on_u.array();</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keyword">auto</span> om_v=fab_om_v.array();</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="keyword">auto</span> om_u=fab_om_u.array();</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keyword">auto</span> on_v=fab_on_v.array();</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keyword">auto</span> om_r=fab_om_r.array();</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keyword">auto</span> on_r=fab_on_r.array();</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keyword">auto</span> om_p=fab_om_p.array();</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keyword">auto</span> on_p=fab_on_p.array();</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keyword">auto</span> pmon_u=fab_pmon_u.array();</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keyword">auto</span> pnom_u=fab_pnom_u.array();</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keyword">auto</span> pmon_v=fab_pmon_v.array();</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keyword">auto</span> pnom_v=fab_pnom_v.array();</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="keyword">auto</span> fomn=fab_fomn.array();</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> coriolis_f0 = <a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a3a0b717e880c818de989b2e92c199d34">coriolis_f0</a>;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> coriolis_beta = <a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a0d7c9053be4054e355768bf3c17bf029">coriolis_beta</a>;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Esize=geom[lev].ProbHi()[1] - geom[lev].ProbLo()[1];</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        ParallelFor(tbxp2D,</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>  )</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            pm(i,j,0) = dxi[0];</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            pn(i,j,0) = dxi[1];</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01a415290769594460e2e485922904f345d">y</a> = prob_lo[1] + (j + 0.5) * dx[1];</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> f=coriolis_f0 + coriolis_beta*(<a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01a415290769594460e2e485922904f345d">y</a>-.5*Esize);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            fomn(i,j,0)=f*(1.0/(pm(i,j,0)*pn(i,j,0)));</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        });</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        ParallelFor(ubx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            on_u(i,j,0)=1.0/dxi[1]; <span class="comment">// 2/(pm(i,j-1)+pm(i,j))</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        });</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        ParallelFor(vbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            om_v(i,j,0)=1.0/dxi[0]; <span class="comment">// 2/(pm(i,j-1)+pm(i,j))</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        });</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        ParallelFor(tbxp2D, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;          <span class="comment">//Note: are the comment definitons right? Don&#39;t seem to match metrics.f90</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;          om_r(i,j,0)=1.0/dxi[0]; <span class="comment">// 1/pm(i,j)</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;          on_r(i,j,0)=1.0/dxi[1]; <span class="comment">// 1/pn(i,j)</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;          <span class="comment">//todo: om_p on_p</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;          om_p(i,j,0)=1.0/dxi[0]; <span class="comment">// 4/(pm(i-1,j-1)+pm(i-1,j)+pm(i,j-1)+pm(i,j))</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;          on_p(i,j,0)=1.0/dxi[1]; <span class="comment">// 4/(pn(i-1,j-1)+pn(i-1,j)+pn(i,j-1)+pn(i,j))</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;          on_v(i,j,0)=1.0/dxi[1]; <span class="comment">// 2/(pn(i-1,j)+pn(i,j))</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;          om_u(i,j,0)=1.0/dxi[0]; <span class="comment">// 2/(pm(i-1,j)+pm(i,j))</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;          pmon_u(i,j,0)=1.0;        <span class="comment">// (pm(i-1,j)+pm(i,j))/(pn(i-1,j)+pn(i,j))</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;          pnom_u(i,j,0)=1.0;        <span class="comment">// (pn(i-1,j)+pn(i,j))/(pm(i-1,j)+pm(i,j))</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;          pmon_v(i,j,0)=1.0;        <span class="comment">// (pm(i,j-1)+pm(i,j))/(pn(i,j-1)+pn(i,j))</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;          pnom_v(i,j,0)=1.0;        <span class="comment">// (pn(i,j-1)+pn(i,j))/(pm(i,j-1)+pm(i,j))</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        });</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        ParallelFor(gbx2, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            FC(i,j,k)=0.0;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        });</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <a class="code" href="classROMSX.html#afae25c40f01d9ba6b5bca880660756e3">prsgrd</a>(tbxp1,gbx1,utbx,vtbx,ru,rv,on_u,om_v,rho,FC,Hz,z_r,z_w,nrhs,N);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="comment">// Apply mixing to temperature and, if use_salt, salt</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="keywordtype">int</span> ncomp = <a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#afc652006d7343f1e01f5b9967604a0aa">use_salt</a> ? 2 : 1;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp;     s_arr = S_old.array(mfi);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; diff2_arr = <a class="code" href="classROMSX.html#a2f47ec18ca3f2465e3253f92ca493bbc">vec_diff2</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <a class="code" href="classROMSX.html#af208e1fa3f6e5250df093a4d6ad34e77">t3dmix</a>(bx, s_arr, diff2_arr, Hz, pm, pn, pmon_u, pnom_v, dt_lev, ncomp);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; diff2_arr_scalar = <a class="code" href="classROMSX.html#a2f47ec18ca3f2465e3253f92ca493bbc">vec_diff2</a>[lev]-&gt;array(mfi,<a class="code" href="IndexDefines_8H.html#a4dd1335cac3e63bb654450bb807978a4">Scalar_comp</a>);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <a class="code" href="classROMSX.html#af208e1fa3f6e5250df093a4d6ad34e77">t3dmix</a>(bx, S_old.array(mfi,<a class="code" href="IndexDefines_8H.html#a4dd1335cac3e63bb654450bb807978a4">Scalar_comp</a>), diff2_arr_scalar, Hz, pm, pn, pmon_u, pnom_v, dt_lev, 1);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a9e86533aa6df5bf6408d91f0dfd23606">use_coriolis</a>) {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            <span class="comment">// coriolis</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            <span class="comment">// ru, rv updated</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <span class="comment">// In ROMS, coriolis is the first (un-ifdefed) thing to happen in rhs3d_tile, which gets called after t3dmix</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            <a class="code" href="classROMSX.html#afa92192721003020501bef87d5f4a667">coriolis</a>(xbx, ybx, uold, vold, ru, rv, Hz, fomn, nrhs, nrhs);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">        ////rufrc from 3d is set to ru, then the wind stress (and bottom stress) is added, then the mixing is added</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment"></span>        <span class="comment">//rufrc=ru+sustr*om_u*on_u</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <a class="code" href="classROMSX.html#aed11841ea026316e25162880b8c455c9">rhs_uv_3d</a>(xbx, ybx, uold, vold, ru, rv, rufrc, rvfrc,</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                  sustr, svstr, bustr, bvstr, Huon, Hvom,</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                  on_u, om_v, om_u, on_v, W, FC, nrhs, N);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a11fa6da1900fa3ad034197da861432ba">use_uv3dmix</a>) {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> nnew = 0;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <a class="code" href="classROMSX.html#ace94faecb215ee9b4fdbc03e0cdaabdb">uv3dmix</a>(xbx, ybx, u, v, uold, vold, rufrc, rvfrc, visc2_p, visc2_r, Hz, om_r, on_r, om_p, on_p, pm, pn, nrhs, nnew, dt_lev);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="comment">// Set first two components of zeta to time-averaged values before barotropic update</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        ParallelFor(gbx2D, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            zeta(i,j,0,0) = Zt_avg1(i,j,0);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            zeta(i,j,0,1) = Zt_avg1(i,j,0);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        });</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    } <span class="comment">// MFIter</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">// Update Akv with new depth. NOTE: this happens before set_zeta in ROMS</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <a class="code" href="classROMSX.html#a48b99337b5ac313ce48a95ab0b9e73dc">set_vmix</a>(lev);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#a7a14aa971cac1b1ad0eb5d4b46b90343">cons_old</a>[lev], <a class="code" href="classROMSX.html#a7a14aa971cac1b1ad0eb5d4b46b90343">cons_old</a>);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev], <a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#a3d747b62e29b6c979763cd243e61a866">vec_sstore</a>[lev], GetVecOfPtrs(<a class="code" href="classROMSX.html#a3d747b62e29b6c979763cd243e61a866">vec_sstore</a>));</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#a24f02b944df51884168ab0c08c736c91">vec_Huon</a>[lev], GetVecOfPtrs(<a class="code" href="classROMSX.html#a24f02b944df51884168ab0c08c736c91">vec_Huon</a>));</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#a21dcccced847102e553281c1852ce005">vec_Hvom</a>[lev], GetVecOfPtrs(<a class="code" href="classROMSX.html#a21dcccced847102e553281c1852ce005">vec_Hvom</a>));</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;}</div>
<div class="ttc" id="aclassROMSX_html_a58c4b17d8ae67640e6248d93d3317581"><div class="ttname"><a href="classROMSX.html#a58c4b17d8ae67640e6248d93d3317581">ROMSX::set_massflux_3d</a></div><div class="ttdeci">void set_massflux_3d(amrex::Array4&lt; amrex::Real &gt; u, amrex::Array4&lt; amrex::Real &gt; Hu, amrex::Array4&lt; amrex::Real &gt; on_u, amrex::Array4&lt; amrex::Real &gt; v, amrex::Array4&lt; amrex::Real &gt; Hv, amrex::Array4&lt; amrex::Real &gt; om_v, amrex::Array4&lt; amrex::Real const &gt; Hz)</div><div class="ttdef"><b>Definition:</b> ROMSX_set_massflux_3d.cpp:17</div></div>
<div class="ttc" id="aclassROMSX_html_a67ddc86fe4c43ffe1900646deba10f1c"><div class="ttname"><a href="classROMSX.html#a67ddc86fe4c43ffe1900646deba10f1c">ROMSX::prestep</a></div><div class="ttdeci">void prestep(int lev, amrex::MultiFab &amp;mf_uold, amrex::MultiFab &amp;mf_vold, amrex::MultiFab &amp;mf_u, amrex::MultiFab &amp;mf_v, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_ru, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_rv, amrex::MultiFab &amp;S_old, amrex::MultiFab &amp;S_new, amrex::MultiFab &amp;mf_W, amrex::MultiFab &amp;mf_DC, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_z_r, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_z_w, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_h, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_sustr, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_svstr, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_bustr, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf_bvstr, const int iic, const int nfirst, const int nnew, int nstp, int nrhs, int N, const amrex::Real dt_lev)</div><div class="ttdef"><b>Definition:</b> ROMSX_prestep.cpp:36</div></div>
<div class="ttc" id="aclassROMSX_html_a7137f5e39d218263180f04072cb93b73"><div class="ttname"><a href="classROMSX.html#a7137f5e39d218263180f04072cb93b73">ROMSX::set_smflux</a></div><div class="ttdeci">void set_smflux(int lev, amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ROMSX.cpp:392</div></div>
<div class="ttc" id="aclassROMSX_html_aa21a56eb75e6c5565402a56d818c179e"><div class="ttname"><a href="classROMSX.html#aa21a56eb75e6c5565402a56d818c179e">ROMSX::rho_eos</a></div><div class="ttdeci">void rho_eos(const amrex::Box &amp;bx, amrex::Array4&lt; amrex::Real const &gt; state, amrex::Array4&lt; amrex::Real &gt; rho, amrex::Array4&lt; amrex::Real &gt; rhoA, amrex::Array4&lt; amrex::Real &gt; rhoS, amrex::Array4&lt; amrex::Real const &gt; Hz, amrex::Array4&lt; amrex::Real const &gt; z_w, amrex::Array4&lt; amrex::Real const &gt; h, const int N)</div><div class="ttdef"><b>Definition:</b> ROMSX_rho_eos.cpp:20</div></div>
<div class="ttc" id="aclassROMSX_html_aed11841ea026316e25162880b8c455c9"><div class="ttname"><a href="classROMSX.html#aed11841ea026316e25162880b8c455c9">ROMSX::rhs_uv_3d</a></div><div class="ttdeci">void rhs_uv_3d(const amrex::Box &amp;xbx, const amrex::Box &amp;ybx, amrex::Array4&lt; amrex::Real &gt; uold, amrex::Array4&lt; amrex::Real &gt; vold, amrex::Array4&lt; amrex::Real &gt; ru, amrex::Array4&lt; amrex::Real &gt; rv, amrex::Array4&lt; amrex::Real &gt; rufrc, amrex::Array4&lt; amrex::Real &gt; rvfrc, amrex::Array4&lt; amrex::Real &gt; sustr, amrex::Array4&lt; amrex::Real &gt; svstr, amrex::Array4&lt; amrex::Real &gt; bustr, amrex::Array4&lt; amrex::Real &gt; bvstr, amrex::Array4&lt; amrex::Real &gt; Huon, amrex::Array4&lt; amrex::Real &gt; Hvom, amrex::Array4&lt; amrex::Real &gt; on_u, amrex::Array4&lt; amrex::Real &gt; om_v, amrex::Array4&lt; amrex::Real &gt; om_u, amrex::Array4&lt; amrex::Real &gt; on_v, amrex::Array4&lt; amrex::Real &gt; W, amrex::Array4&lt; amrex::Real &gt; FC, int nrhs, int N)</div><div class="ttdef"><b>Definition:</b> ROMSX_rhs_uv_3d.cpp:31</div></div>
<div class="ttc" id="aclassROMSX_html_af208e1fa3f6e5250df093a4d6ad34e77"><div class="ttname"><a href="classROMSX.html#af208e1fa3f6e5250df093a4d6ad34e77">ROMSX::t3dmix</a></div><div class="ttdeci">void t3dmix(const amrex::Box &amp;bx, amrex::Array4&lt; amrex::Real &gt; state, amrex::Array4&lt; amrex::Real &gt; diff2, amrex::Array4&lt; amrex::Real &gt; Hz, amrex::Array4&lt; amrex::Real &gt; pm, amrex::Array4&lt; amrex::Real &gt; pn, amrex::Array4&lt; amrex::Real &gt; pmon_u, amrex::Array4&lt; amrex::Real &gt; pnom_v, const amrex::Real dt_lev, const int ncomp)</div><div class="ttdef"><b>Definition:</b> ROMSX_t3dmix.cpp:6</div></div>
<div class="ttc" id="aclassROMSX_html_afae25c40f01d9ba6b5bca880660756e3"><div class="ttname"><a href="classROMSX.html#afae25c40f01d9ba6b5bca880660756e3">ROMSX::prsgrd</a></div><div class="ttdeci">void prsgrd(const amrex::Box &amp;bx, const amrex::Box &amp;gbx, const amrex::Box &amp;utbx, const amrex::Box &amp;vtbx, amrex::Array4&lt; amrex::Real &gt; ru, amrex::Array4&lt; amrex::Real &gt; rv, amrex::Array4&lt; amrex::Real &gt; on_u, amrex::Array4&lt; amrex::Real &gt; om_v, amrex::Array4&lt; amrex::Real &gt; rho, amrex::Array4&lt; amrex::Real &gt; FC, amrex::Array4&lt; amrex::Real &gt; Hz, amrex::Array4&lt; amrex::Real &gt; z_r, amrex::Array4&lt; amrex::Real &gt; z_w, const int nrhs, const int N)</div><div class="ttdef"><b>Definition:</b> ROMSX_prsgrd.cpp:6</div></div>
<div class="ttc" id="astructSolverChoice_html_a11fa6da1900fa3ad034197da861432ba"><div class="ttname"><a href="structSolverChoice.html#a11fa6da1900fa3ad034197da861432ba">SolverChoice::use_uv3dmix</a></div><div class="ttdeci">bool use_uv3dmix</div><div class="ttdef"><b>Definition:</b> DataStruct.H:162</div></div>
<div class="ttc" id="astructSolverChoice_html_aef43f702963efac7f3e0c2b43249fbb6"><div class="ttname"><a href="structSolverChoice.html#aef43f702963efac7f3e0c2b43249fbb6">SolverChoice::use_prestep</a></div><div class="ttdeci">bool use_prestep</div><div class="ttdef"><b>Definition:</b> DataStruct.H:161</div></div>
<div class="ttc" id="astructSolverChoice_html_afc652006d7343f1e01f5b9967604a0aa"><div class="ttname"><a href="structSolverChoice.html#afc652006d7343f1e01f5b9967604a0aa">SolverChoice::use_salt</a></div><div class="ttdeci">bool use_salt</div><div class="ttdef"><b>Definition:</b> DataStruct.H:155</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aad35c03f38c28e55791b50da18f2604c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad35c03f38c28e55791b50da18f2604c">&#9670;&nbsp;</a></span>stretch_transform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::stretch_transform </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;{</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_z_w = <a class="code" href="classROMSX.html#a7e2a55ae7fb02290e6ead16ec3e658fa">vec_z_w</a>[lev];</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_z_r = <a class="code" href="classROMSX.html#a0a9b1a5cf021018defc82b45cbecb2c5">vec_z_r</a>[lev];</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_s_r = <a class="code" href="classROMSX.html#a7a3b7fb166ec3acf1b1057f53e08adad">vec_s_r</a>[lev];</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_Hz  = <a class="code" href="classROMSX.html#aa5461758b528d199101b5ea74f9a6c12">vec_Hz</a>[lev];</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_h  = <a class="code" href="classROMSX.html#a03b79a651abf3dc2bd37fadaca99fd46">vec_hOfTheConfusingName</a>[lev];</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_Zt_avg1  = <a class="code" href="classROMSX.html#ab962f23dc27b3ce17bb19e3b8c9991f8">vec_Zt_avg1</a>[lev];</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    std::unique_ptr&lt;MultiFab&gt;&amp; mf_z_phys_nd  = <a class="code" href="classROMSX.html#a8e887c13b3d23581a26580f4e7e9aef0">vec_z_phys_nd</a>[lev];</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keyword">auto</span> N_loop = Geom(lev).Domain().size()[2]-1; <span class="comment">// Number of vertical &quot;levs&quot; aka, NZ</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(*<a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    {</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;      Array4&lt;Real&gt; <span class="keyword">const</span>&amp; z_w = (mf_z_w)-&gt;array(mfi);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;      Array4&lt;Real&gt; <span class="keyword">const</span>&amp; z_r = (mf_z_r)-&gt;array(mfi);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;      Array4&lt;Real&gt; <span class="keyword">const</span>&amp; s_r = (mf_s_r)-&gt;array(mfi);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;      Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Hz  = (mf_Hz)-&gt;array(mfi);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;      Array4&lt;Real&gt; <span class="keyword">const</span>&amp; h  = (mf_h)-&gt;array(mfi);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;      Array4&lt;Real&gt; <span class="keyword">const</span>&amp; Zt_avg1  = (mf_Zt_avg1)-&gt;array(mfi);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      Box bx = mfi.tilebox();</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      Box gbx2 = bx;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      gbx2.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>,0));</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      Box gbx3 = bx;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      gbx3.grow(IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>+1,0));</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      Box gbx2D = gbx2;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      gbx2D.makeSlab(2,0);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      Box gbx3D = gbx3;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      gbx3D.makeSlab(2,0);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      Box wgbx3 = gbx3.surroundingNodes(2);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> &amp; geomdata = Geom(lev).data();</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="keywordtype">int</span> nz = geom[lev].Domain().length(2);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <span class="keyword">auto</span> N = nz; <span class="comment">// Number of vertical &quot;levels&quot; aka, NZ</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="comment">//forcing tcline to be the same as probhi for now, one in DataStruct.H other in inputs</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> hc=-min(geomdata.ProbHi(2),-<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8567bc83a2159c88c5372ea30770725e">tcline</a>); <span class="comment">// Do we need to enforce min here?</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> local_theta_s = <a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a6c6e710a8470aace72066b3dfdd69017">theta_s</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> local_theta_b = <a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a6b82e27f159d8bc0bf4e3429cecce8b5">theta_b</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      amrex::ParallelFor(wgbx3,</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;          z_w(i,j,k) = h(i,j,0);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      });</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="comment">// ROMS Transform 2</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      Gpu::streamSynchronize();</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      amrex::ParallelFor(gbx3D,</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=-1; k&lt;=N_loop; k++) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="comment">//        const Real z = prob_lo[2] + (k + 0.5) * dx[2];</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="comment">// const auto prob_lo         = geomdata.ProbLo();</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="comment">// const auto dx              = geomdata.CellSize();</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="comment">// This is the z for the bottom of the cell this k corresponds to</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="comment">//   if we weren&#39;t stretching and transforming</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="comment">//        const Real z = prob_lo[2] + (k) * dx[2];</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="comment">//        h(i,j,0) = -prob_lo[2]; // conceptually</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">        ////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"></span>        <span class="comment">//ROMS Stretching 4</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="comment">// Move this block to it&#39;s own function for maintainability if needed</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="comment">// Information about the problem dimension would need to be added</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="comment">// This file would need a k dependent function to return the</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="comment">// stretching scalars, or access to 4 vectors of length prob_length(2)</span><span class="comment"></span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">        /////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"></span>        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> ds = 1.0_rt / <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(N);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff_r, cff_w, cff1_r, cff1_w, cff2_r, cff2_w, Csur, Cbot;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> sc_r,sc_w,Cs_r,Cs_w;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordflow">if</span>(k==N) <span class="comment">// end of array // pretend we&#39;re storing 0?</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        sc_w=0.0; <span class="comment">//sc_w / hc</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        Cs_w=0.0; <span class="comment">//Cs_w</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k==0) <span class="comment">// beginning of array</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        sc_w=-1.0; <span class="comment">//sc_w / hc</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        Cs_w=-1.0; <span class="comment">//Cs_w</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;          sc_w=ds*(k-N);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;          <span class="keywordflow">if</span> (local_theta_s &gt; 0.0_rt) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            Csur=(1.0_rt-std::cosh(local_theta_s*sc_w))/</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;              (std::cosh(local_theta_s)-1.0_rt);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            Csur=-sc_w*sc_w;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;          }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;          <span class="keywordflow">if</span> (local_theta_b &gt; 0.0_rt) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            Cbot=(std::exp(local_theta_b*Csur)-1.0_rt)/</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;              (1.0_rt-std::exp(-local_theta_b));</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            Cs_w=Cbot;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            Cs_w=Csur;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;          }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        cff_w=hc*sc_w;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        cff1_w=Cs_w;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="comment">//cff_r =&gt; sc_r *hc</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="comment">//cff1_r =&gt; Cs_r</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="comment">//Don&#39;t do anything special for first/last index</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;          sc_r=ds*(k-N+0.5_rt);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;          <span class="keywordflow">if</span> (local_theta_s &gt; 0.0_rt) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            Csur=(1.0_rt-std::cosh(local_theta_s*sc_r))/</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;              (std::cosh(local_theta_s)-1.0_rt);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            Csur=-sc_r*sc_r;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;          }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;          <span class="keywordflow">if</span> (local_theta_b &gt; 0.0_rt) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            Cbot=(std::exp(local_theta_b*Csur)-1.0_rt)/</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;              (1.0_rt-std::exp(-local_theta_b));</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            Cs_r=Cbot;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            Cs_r=Csur;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;          }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">if</span> (i==0&amp;&amp;j==0&amp;&amp;k&lt;N&amp;&amp;k&gt;=0) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            s_r(0,0,k) = sc_r;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        cff_r=hc*sc_r;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        cff1_r=Cs_r;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">        ////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"></span>        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> hwater=h(i,j,0);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">        if(k==0)</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">         {</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">          //extra guess added (maybe not actually defined in ROMS)</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">        Real hinv=1.0_rt/(hc+hwater);</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">         cff2_r=(cff_r+cff1_r*hwater)*hinv;</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">         //         z_w(i,j,k-2) = hwater;</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">         //         z_w(i,j,k-1)= -hwater;</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">         z_r(i,j,k) = Zt_avg1(i,j,0)+(Zt_avg1(i,j,0)+hwater)*cff2_r;</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">         Hz(i,j,k)=z_w(i,j,k)+hwater;//-z_w(i,j,k-1);</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">         }</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">        else</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">        */</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="comment">//Note, we are not supporting ICESHELF flag</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> hinv=1.0_rt/(hc+hwater);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;          cff2_r=(cff_r+cff1_r*hwater)*hinv;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          cff2_w=(cff_w+cff1_w*hwater)*hinv;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;          <span class="keywordflow">if</span>(k==0) {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;              <span class="comment">// HACK: should actually be the normal expression with coeffs evaluated at k=N-1</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;              z_w(i,j,N-1)=Zt_avg1(i,j,0);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;          }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span>(k==-1)</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;              h(i,j,0,1)=Zt_avg1(i,j,0)+(Zt_avg1(i,j,0)+hwater)*cff2_w;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;              z_w(i,j,k-1)=Zt_avg1(i,j,0)+(Zt_avg1(i,j,0)+hwater)*cff2_w;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;          }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;          <span class="keywordflow">if</span>(k!=-1) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;          z_r(i,j,k)=Zt_avg1(i,j,0)+(Zt_avg1(i,j,0)+hwater)*cff2_r;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;          }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      });</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      Gpu::streamSynchronize();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      amrex::ParallelFor(gbx3,</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;          <span class="keywordflow">if</span> (k==0) {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;              Hz(i,j,k)=z_w(i,j,k)+h(i,j,0);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;              Hz(i,j,k)=z_w(i,j,k)-z_w(i,j,k-1);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;          }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      });</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> time = <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev];</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#a7e2a55ae7fb02290e6ead16ec3e658fa">vec_z_w</a>[lev], GetVecOfPtrs(<a class="code" href="classROMSX.html#a7e2a55ae7fb02290e6ead16ec3e658fa">vec_z_w</a>));</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#a0a9b1a5cf021018defc82b45cbecb2c5">vec_z_r</a>[lev], GetVecOfPtrs(<a class="code" href="classROMSX.html#a0a9b1a5cf021018defc82b45cbecb2c5">vec_z_r</a>));</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#a7a3b7fb166ec3acf1b1057f53e08adad">vec_s_r</a>[lev], GetVecOfPtrs(<a class="code" href="classROMSX.html#a7a3b7fb166ec3acf1b1057f53e08adad">vec_s_r</a>));</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, time, *<a class="code" href="classROMSX.html#aa5461758b528d199101b5ea74f9a6c12">vec_Hz</a>[lev] , GetVecOfPtrs(<a class="code" href="classROMSX.html#aa5461758b528d199101b5ea74f9a6c12">vec_Hz</a>));</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// Define nodal z as average of z on w-faces</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(*<a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      Array4&lt;Real&gt; <span class="keyword">const</span>&amp; z_w = (mf_z_w)-&gt;array(mfi);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      Array4&lt;Real&gt; <span class="keyword">const</span>&amp; z_phys_nd  = (mf_z_phys_nd)-&gt;array(mfi);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      Box z_w_box = Box(z_w);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keyword">auto</span> <span class="keyword">const</span> lo = amrex::lbound(z_w_box);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keyword">auto</span> <span class="keyword">const</span> hi = amrex::ubound(z_w_box);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="comment">// WARNING: z_w(i,j,k)       refers to the face on the HIGH side of cell (i,j,k)</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <span class="comment">// WARNING: z_phys_nd(i,j,k) refers to the node on the LOW  side of cell (i,j,k)</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      ParallelFor(Box(z_phys_nd), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;          <span class="comment">// For now assume all boundaries are constant height --</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          <span class="comment">//     we will enforce periodicity below</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          <span class="keywordtype">int</span> kk = (k == 0) ? hi.z : k-1;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;          if ( i &gt;= lo.x &amp;&amp; i &lt;= hi.x-1 &amp;&amp; j &gt;= lo.y &amp;&amp; j &lt;= hi.y-1 )</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;          {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;              z_phys_nd(i,j,k)=0.25*( z_w(i,j  ,kk) + z_w(i+1,j  ,kk) +</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                                      z_w(i,j+1,kk) + z_w(i+1,j+1,kk) );</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;             <span class="keywordtype">int</span> ii = std::min(std::max(i, lo.x), hi.x);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;             <span class="keywordtype">int</span> jj = std::min(std::max(j, lo.y), hi.y);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;             z_phys_nd(i,j,k) = z_w(ii,jj,kk);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;          }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          <span class="keywordflow">if</span> (k == 0)  z_phys_nd(i,j,k) *= -1.;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      });</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    } <span class="comment">// mf</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">// Note that we do *not* want to do a multilevel fill here -- we have</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">// already filled z_phys_nd on the grown boxes, but we enforce periodicity just in case</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="classROMSX.html#a8e887c13b3d23581a26580f4e7e9aef0">vec_z_phys_nd</a>[lev]-&gt;FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;}</div>
<div class="ttc" id="astructSolverChoice_html_a6b82e27f159d8bc0bf4e3429cecce8b5"><div class="ttname"><a href="structSolverChoice.html#a6b82e27f159d8bc0bf4e3429cecce8b5">SolverChoice::theta_b</a></div><div class="ttdeci">amrex::Real theta_b</div><div class="ttdef"><b>Definition:</b> DataStruct.H:176</div></div>
<div class="ttc" id="astructSolverChoice_html_a6c6e710a8470aace72066b3dfdd69017"><div class="ttname"><a href="structSolverChoice.html#a6c6e710a8470aace72066b3dfdd69017">SolverChoice::theta_s</a></div><div class="ttdeci">amrex::Real theta_s</div><div class="ttdef"><b>Definition:</b> DataStruct.H:175</div></div>
<div class="ttc" id="astructSolverChoice_html_a8567bc83a2159c88c5372ea30770725e"><div class="ttname"><a href="structSolverChoice.html#a8567bc83a2159c88c5372ea30770725e">SolverChoice::tcline</a></div><div class="ttdeci">amrex::Real tcline</div><div class="ttdef"><b>Definition:</b> DataStruct.H:177</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a55bb606cb2f4fc86e05232b5c314a829"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55bb606cb2f4fc86e05232b5c314a829">&#9670;&nbsp;</a></span>sum_integrated_quantities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::sum_integrated_quantities </td>
          <td>(</td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Integrate conserved quantities for diagnostics </p>
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ROMSX::sum_integrated_quantities()&quot;</span>);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#ab37afaafcf05a9b10c0fba3180539610">verbose</a> &lt;= 0)</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keywordtype">int</span> datwidth = 14;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keywordtype">int</span> datprecision = 6;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> scalar = 0.0;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> kineng = 0.0;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    {</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        MultiFab kineng_mf(grids[lev], dmap[lev], 1, 0);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        MultiFab cc_vel_mf(grids[lev], dmap[lev], 3, 0);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        average_face_to_cellcenter(cc_vel_mf,0,</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;            Array&lt;const MultiFab*,3&gt;{<a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev],<a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev],<a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[lev]});</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="keywordflow">for</span> (MFIter mfi(*<a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;            <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;            <span class="keyword">const</span> Array4&lt;      Real&gt; kineng_arr = kineng_mf.array(mfi);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;            <span class="keyword">const</span> Array4&lt;const Real&gt;    vel_arr = cc_vel_mf.const_array(mfi);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;            ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;            {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                kineng_arr(i,j,k) = 0.5 * ( vel_arr(i,j,k,0)*vel_arr(i,j,k,0) + vel_arr(i,j,k,1)*vel_arr(i,j,k,1) +</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                                            vel_arr(i,j,k,2)*vel_arr(i,j,k,2) );</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            });</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        scalar += <a class="code" href="classROMSX.html#a65203858561c0499791ef95ef51f3447">volWgtSumMF</a>(lev,*<a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev],<a class="code" href="IndexDefines_8H.html#a4dd1335cac3e63bb654450bb807978a4">Scalar_comp</a>,<span class="keyword">false</span>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        kineng += <a class="code" href="classROMSX.html#a65203858561c0499791ef95ef51f3447">volWgtSumMF</a>(lev,kineng_mf     ,             0,<span class="keyword">false</span>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#ab37afaafcf05a9b10c0fba3180539610">verbose</a> &gt; 0) {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> nfoo = 2;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> foo[nfoo] = {scalar,kineng};</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#ifdef AMREX_LAZY</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        Lazy::QueueReduction([=]() <span class="keyword">mutable</span> {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        ParallelDescriptor::ReduceRealSum(</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            foo, nfoo, ParallelDescriptor::IOProcessorNumber());</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;          <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            scalar = foo[i++];</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            kineng = foo[i++];</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            amrex::Print() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;TIME= &quot;</span> &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; SCALAR      = &quot;</span> &lt;&lt; scalar &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;TIME= &quot;</span> &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; KIN. ENG.   = &quot;</span> &lt;&lt; kineng &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#adf6f2e4f8b883d81702ea424d90ff4de">NumDataLogs</a>() &gt; 0) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                std::ostream&amp; data_log1 = <a class="code" href="classROMSX.html#a2cc7343babd4642f2cf727a3d40035f3">DataLog</a>(0);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                <span class="keywordflow">if</span> (data_log1.good()) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                    <span class="keywordflow">if</span> (time == 0.0) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                        data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; <span class="stringliteral">&quot;          time&quot;</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                        data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; <span class="stringliteral">&quot;        scalar&quot;</span>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                        data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; <span class="stringliteral">&quot;        kineng&quot;</span>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                        data_log1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                    }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                  <span class="comment">// Write the quantities at this time</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                  data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; time;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                  data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                            &lt;&lt; scalar;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                  data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision)</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                            &lt;&lt; kineng;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                  data_log1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;              }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;          }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#ifdef AMREX_LAZY</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        });</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;}</div>
<div class="ttc" id="aclassROMSX_html_a2cc7343babd4642f2cf727a3d40035f3"><div class="ttname"><a href="classROMSX.html#a2cc7343babd4642f2cf727a3d40035f3">ROMSX::DataLog</a></div><div class="ttdeci">AMREX_FORCE_INLINE std::ostream &amp; DataLog(int i)</div><div class="ttdef"><b>Definition:</b> ROMSX.H:927</div></div>
<div class="ttc" id="aclassROMSX_html_a65203858561c0499791ef95ef51f3447"><div class="ttname"><a href="classROMSX.html#a65203858561c0499791ef95ef51f3447">ROMSX::volWgtSumMF</a></div><div class="ttdeci">amrex::Real volWgtSumMF(int lev, const amrex::MultiFab &amp;mf, int comp, bool local, bool finemask)</div><div class="ttdef"><b>Definition:</b> ROMSX_SumIQ.cpp:89</div></div>
<div class="ttc" id="aclassROMSX_html_adf6f2e4f8b883d81702ea424d90ff4de"><div class="ttname"><a href="classROMSX.html#adf6f2e4f8b883d81702ea424d90ff4de">ROMSX::NumDataLogs</a></div><div class="ttdeci">AMREX_FORCE_INLINE int NumDataLogs() noexcept</div><div class="ttdef"><b>Definition:</b> ROMSX.H:934</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af208e1fa3f6e5250df093a4d6ad34e77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af208e1fa3f6e5250df093a4d6ad34e77">&#9670;&nbsp;</a></span>t3dmix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::t3dmix </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>diff2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>pm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>pn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>pmon_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>pnom_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ncomp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Harmonic diffusivity for tracers </p>
<div class="fragment"><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;{</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="comment">//  Add in harmonic diffusivity s terms.</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    Box xbx(bx); xbx.surroundingNodes(0);</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    Box ybx(bx); ybx.surroundingNodes(1);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    FArrayBox fab_FX(xbx,ncomp,The_Async_Arena());</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    FArrayBox fab_FE(ybx,ncomp,The_Async_Arena());</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keyword">auto</span> FX=fab_FX.array();</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keyword">auto</span> FE=fab_FE.array();</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    ParallelFor(xbx, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n)</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        {</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;            <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = 0.25 * (diff2(i,j,n) + diff2(i-1,j,n)) * pmon_u(i,j,0);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;            FX(i,j,k,n) = cff * (Hz(i,j,k) + Hz(i+1,j,k)) * (state(i,j,k,n)-state(i-1,j,k,n));</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        });</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    ParallelFor(ybx, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n)</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;            <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = 0.25*(diff2(i,j,n)+diff2(i,j-1,n)) * pnom_v(i,j,0);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;            FE(i,j,k,n) = cff * (Hz(i,j,k) + Hz(i,j-1,k)) * (state(i,j,k,n) - state(i,j-1,k,n));</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        });</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">     Time-step harmonic, S-surfaces diffusion term.</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    ParallelFor(bx, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n)</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;            <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff = dt_lev*pm(i,j,0)*pn(i,j,0);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            state(i,j,k,n) += cff * ( (FX(i+1,j  ,k,n)-FX(i,j,k,n))</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                                     +(FE(i  ,j+1,k,n)-FE(i,j,k,n)) );</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        });</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5abd4890b0a7b5939c66c6af3d9bb6c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5abd4890b0a7b5939c66c6af3d9bb6c2">&#9670;&nbsp;</a></span>timeStep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::timeStep </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iteration</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>advance a level by dt, includes a recursive call for finer levels </p>
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#ab61e1364d5b301c8f727566234b9eb89">regrid_int</a> &gt; 0)  <span class="comment">// We may need to regrid</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    {</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        <span class="comment">// help keep track of whether a level was already regridded</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        <span class="comment">// from a coarser level call to regrid</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        <span class="keyword">static</span> Vector&lt;int&gt; last_regrid_step(max_level+1, 0);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        <span class="comment">// regrid changes level &quot;lev+1&quot; so we don&#39;t regrid on max_level</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        <span class="comment">// also make sure we don&#39;t regrid fine levels again if</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        <span class="comment">// it was taken care of during a coarser regrid</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        <span class="keywordflow">if</span> (lev &lt; max_level &amp;&amp; <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[lev] &gt; last_regrid_step[lev])</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        {</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[lev] % <a class="code" href="classROMSX.html#ab61e1364d5b301c8f727566234b9eb89">regrid_int</a> == 0)</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;            {</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;                <span class="comment">// regrid could add newly refine levels (if finest_level &lt; max_level)</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;                <span class="comment">// so we save the previous finest level index</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                <span class="keywordtype">int</span> old_finest = finest_level;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                regrid(lev, time);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;                <span class="comment">// Mark that we have regridded this level already</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = lev; k &lt;= finest_level; ++k) {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                    last_regrid_step[k] = <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[k];</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                }</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                <span class="comment">// If there are newly created levels, set the time step</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = old_finest+1; k &lt;= finest_level; ++k) {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                    <a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[k] = <a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[k-1] / MaxRefRatio(k-1);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                }</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;            }</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        }</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// Update what we call &quot;old&quot; and &quot;new&quot; time</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="classROMSX.html#ac395453aa10633a05bb7323b2946101e">t_old</a>[lev] = <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev];</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev] += <a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[lev];</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">if</span> (Verbose()) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;[Level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; step &quot;</span> &lt;&lt; <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[lev]+1 &lt;&lt; <span class="stringliteral">&quot;] &quot;</span>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;ADVANCE from time = &quot;</span> &lt;&lt; <a class="code" href="classROMSX.html#ac395453aa10633a05bb7323b2946101e">t_old</a>[lev] &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev]</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot; with dt = &quot;</span> &lt;&lt; <a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[lev] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">// We must swap the pointers so the previous step&#39;s &quot;new&quot; is now this step&#39;s &quot;old&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    std::swap(<a class="code" href="classROMSX.html#a7a14aa971cac1b1ad0eb5d4b46b90343">cons_old</a>[lev], <a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev]);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    std::swap(<a class="code" href="classROMSX.html#af0b5074dc426b753beb5511bd63df407">xvel_old</a>[lev], <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev]);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    std::swap(<a class="code" href="classROMSX.html#a87f0b7446438b8145bdea79012b985f5">yvel_old</a>[lev], <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev]);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    std::swap(<a class="code" href="classROMSX.html#acb72d33af4be09dede2005fa6c901686">zvel_old</a>[lev], <a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[lev]);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="comment">// Advance a single level for a single time step</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="classROMSX.html#a5d120bfdaf2972b92fda49a4c1bbc43d">Advance</a>(lev, time, <a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[lev], iteration, <a class="code" href="classROMSX.html#ab02aa1c49bf90239a6bce4ca84da985d">nsubsteps</a>[lev]);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    ++<a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[lev];</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">if</span> (Verbose())</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;[Level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; step &quot;</span> &lt;&lt; <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[lev] &lt;&lt; <span class="stringliteral">&quot;] &quot;</span>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Advanced &quot;</span> &lt;&lt; CountCells(lev) &lt;&lt; <span class="stringliteral">&quot; cells&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">if</span> (lev &lt; finest_level)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="comment">// recursive call for next-finer level</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= <a class="code" href="classROMSX.html#ab02aa1c49bf90239a6bce4ca84da985d">nsubsteps</a>[lev+1]; ++i)</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <a class="code" href="classROMSX.html#a5abd4890b0a7b5939c66c6af3d9bb6c2">timeStep</a>(lev+1, time+(i-1)*<a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[lev+1], i);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == <a class="code" href="DataStruct_8H.html#ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815">CouplingType::TwoWay</a>) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            <a class="code" href="classROMSX.html#a243ea260c190601764cb8b6368d18615">AverageDownTo</a>(lev); <span class="comment">// average lev+1 down to lev</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;}</div>
<div class="ttc" id="aclassROMSX_html_a5d120bfdaf2972b92fda49a4c1bbc43d"><div class="ttname"><a href="classROMSX.html#a5d120bfdaf2972b92fda49a4c1bbc43d">ROMSX::Advance</a></div><div class="ttdeci">void Advance(int lev, amrex::Real time, amrex::Real dt_lev, int iteration, int ncycle)</div><div class="ttdef"><b>Definition:</b> ROMSX_Advance.cpp:7</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af5f0052238ebf09ba49652188d59315a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5f0052238ebf09ba49652188d59315a">&#9670;&nbsp;</a></span>timeStepML()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::timeStepML </td>
          <td>(</td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iteration</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>advance all levels by dt, loops over finer levels </p>
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <span class="comment">// HACK HACK so lev is defined and compiler won&#39;t complain, but always say regrid_int=-1</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev=0; lev &lt;= finest_level;lev++) {</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#ab61e1364d5b301c8f727566234b9eb89">regrid_int</a> &gt; 0)  <span class="comment">// We may need to regrid</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;            <span class="comment">// help keep track of whether a level was already regridded</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;            <span class="comment">// from a coarser level call to regrid</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;            <span class="keyword">static</span> Vector&lt;int&gt; last_regrid_step(max_level+1, 0);</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;            <span class="comment">// regrid changes level &quot;lev+1&quot; so we don&#39;t regrid on max_level</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;            <span class="comment">// also make sure we don&#39;t regrid fine levels again if</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;            <span class="comment">// it was taken care of during a coarser regrid</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;            <span class="keywordflow">if</span> (lev &lt; max_level &amp;&amp; <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[lev] &gt; last_regrid_step[lev])</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;            {</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[lev] % <a class="code" href="classROMSX.html#ab61e1364d5b301c8f727566234b9eb89">regrid_int</a> == 0)</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;                {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                    <span class="comment">// regrid could add newly refine levels (if finest_level &lt; max_level)</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                    <span class="comment">// so we save the previous finest level index</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;                    <span class="keywordtype">int</span> old_finest = finest_level;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;                    regrid(lev, time);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                    <span class="comment">// Mark that we have regridded this level already</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = lev; k &lt;= finest_level; ++k) {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;                        last_regrid_step[k] = <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[k];</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                    }</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                    <span class="comment">// If there are newly created levels, set the time step</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = old_finest+1; k &lt;= finest_level; ++k) {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                        <a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[k] = <a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[k-1] / MaxRefRatio(k-1);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                    }</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            }</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev=0; lev &lt;= finest_level;lev++)</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="comment">// Update what we call &quot;old&quot; and &quot;new&quot; time</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <a class="code" href="classROMSX.html#ac395453aa10633a05bb7323b2946101e">t_old</a>[lev] = <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev];</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev] += <a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[lev];</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keywordflow">if</span> (Verbose()) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;[Level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; step &quot;</span> &lt;&lt; <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[lev]+1 &lt;&lt; <span class="stringliteral">&quot;] &quot;</span>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;ADVANCE from time = &quot;</span> &lt;&lt; <a class="code" href="classROMSX.html#ac395453aa10633a05bb7323b2946101e">t_old</a>[lev] &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev]</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                           &lt;&lt; <span class="stringliteral">&quot; with dt = &quot;</span> &lt;&lt; <a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[lev] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="comment">// We must swap the pointers so the previous step&#39;s &quot;new&quot; is now this step&#39;s &quot;old&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        std::swap(<a class="code" href="classROMSX.html#a7a14aa971cac1b1ad0eb5d4b46b90343">cons_old</a>[lev], <a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev]);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        std::swap(<a class="code" href="classROMSX.html#af0b5074dc426b753beb5511bd63df407">xvel_old</a>[lev], <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev]);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        std::swap(<a class="code" href="classROMSX.html#a87f0b7446438b8145bdea79012b985f5">yvel_old</a>[lev], <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev]);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        std::swap(<a class="code" href="classROMSX.html#acb72d33af4be09dede2005fa6c901686">zvel_old</a>[lev], <a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[lev]);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <a class="code" href="classROMSX.html#a62d0fa7d294be023f9050f71bb0ad221">setup_step</a>(lev, time, <a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[lev]);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#a2a6fbf7ebea6ac5d9faddcbfe36771bd">use_barotropic</a>)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordtype">int</span> nfast_counter=<a class="code" href="classROMSX.html#ac248f5de275736769f83c3e6bfc6b550">nfast</a> + 1;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev=0; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <span class="comment">//Compute fast timestep from dt_lev and ratio</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dtfast_lev=<a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[lev]/<a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(<a class="code" href="classROMSX.html#a676fc3cc2402734727ca9e04e050d171">fixed_ndtfast_ratio</a>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> my_iif = 0; my_iif &lt; nfast_counter; my_iif++) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                <a class="code" href="classROMSX.html#a8fa9ebf787a2bcd053f235b50e5dbac3">advance_2d_onestep</a>(lev, <a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[lev], dtfast_lev, my_iif, nfast_counter);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            } <span class="comment">// my_iif</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        } <span class="comment">// lev</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    } <span class="comment">// use_barotropic</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev=0; lev &lt;= finest_level; lev++) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <a class="code" href="classROMSX.html#a77f393227b048d127b50340ea256a9cf">advance_3d_ml</a>(lev, <a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[lev]);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        ++<a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[lev];</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordflow">if</span> (Verbose())</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;[Level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; step &quot;</span> &lt;&lt; <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[lev] &lt;&lt; <span class="stringliteral">&quot;] &quot;</span>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Advanced &quot;</span> &lt;&lt; CountCells(lev) &lt;&lt; <span class="stringliteral">&quot; cells&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a21df816ace6144ce0ed78d0031eaa946">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == <a class="code" href="DataStruct_8H.html#ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815">CouplingType::TwoWay</a>) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev=0; lev &lt;= finest_level-1; lev++) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <a class="code" href="classROMSX.html#a243ea260c190601764cb8b6368d18615">AverageDownTo</a>(lev); <span class="comment">// average lev+1 down to lev</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a799fe579a21d193e4f1e1a6a1fc74cd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a799fe579a21d193e4f1e1a6a1fc74cd9">&#9670;&nbsp;</a></span>update_massflux_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::update_massflux_3d </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ioff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>joff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>phibar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>Hphi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real const &gt;&#160;</td>
          <td class="paramname"><em>Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>on_u_or_om_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real const &gt;&#160;</td>
          <td class="paramname"><em>Dphi1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real const &gt;&#160;</td>
          <td class="paramname"><em>Dphi2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>DC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>FC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nnew</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>update_massflux_3d</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bx</td><td>box on which to update </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ioff</td><td>offset in x-direction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">joff</td><td>offset in y-direction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">phi</td><td>u or v </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Hphi</td><td>H-weighted u or v </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Hz</td><td>weighting </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">om_v_or_on_u</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Dphi_avg1</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Dphi_avg2</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">DC</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">FC</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnew</td><td>component of velocity </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">// const int Mn = Geom(0).Domain().size()[0];</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">// const int Mm = Geom(0).Domain().size()[1];</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keyword">auto</span> N = Geom(0).Domain().size()[2]-1; <span class="comment">// Number of vertical &quot;levs&quot; aka, NZ</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keyword">auto</span> bxD=bx;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keyword">auto</span> bx_g1z=bx;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    bxD.makeSlab(2,0);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    bx_g1z.grow(IntVect(0,0,1));</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">// auto geomdata = Geom(0).data();</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// bool NSPeriodic = geomdata.isPeriodic(1);</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">// bool EWPeriodic = geomdata.isPeriodic(0);</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">//Copied depth of water column calculation from DepthStretchTransform</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">//Compute thicknesses of U-boxes DC(i,j,0:N-1), total depth of the water column DC(i,j,-1)</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">//This takes advantage of Hz being an extra grow cell size</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        DC(i,j,k)=0.5*om_v_or_on_u(i,j,0)*(Hz(i,j,k)+Hz(i-ioff,j-joff,k));</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    });</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    ParallelFor(bxD, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="comment">// Real CF = 0.;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;=N; k++) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            DC(i,j,-1)=DC(i,j,-1)+DC(i,j,k);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            <span class="comment">// CF += DC(i,j,k)*phi(i,j,k,nnew);</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        DC(i,j,-1) = 1.0/DC(i,j,-1);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="comment">// CF = DC(i,j,-1) * (CF-Dphi_avg1(i,j,0));</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;=N; k++) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">//          BOUNDARY CONDITIONS</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">//          if (!(NSPeriodic&amp;&amp;EWPeriodic))</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">//          {</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">//              if ( ( ((i&lt;0)||(i&gt;=Mn+1)) &amp;&amp; !EWPeriodic ) ||  ( ((j&lt;0)||(j&gt;=Mm+1)) &amp;&amp; !NSPeriodic ) )</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">//              {</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">//                  phi(i,j,k) -= CF;</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">//              }</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">//          }</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            Hphi(i,j,k) = 0.5 * (Hphi(i,j,k)+phi(i,j,k,nnew)*DC(i,j,k));</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            FC(i,j,0)  += Hphi(i,j,k);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        } <span class="comment">// k</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        FC(i,j,0) = DC(i,j,-1)*(FC(i,j,0)-Dphi_avg2(i,j,0));</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    });</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        Hphi(i,j,k) -= DC(i,j,k)*FC(i,j,0);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    });</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    ParallelFor(bxD, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        phibar(i,j,0,0) = DC(i,j,-1) * Dphi_avg1(i,j,0);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        phibar(i,j,0,1) = phibar(i,j,0,0);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    });</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ace94faecb215ee9b4fdbc03e0cdaabdb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace94faecb215ee9b4fdbc03e0cdaabdb">&#9670;&nbsp;</a></span>uv3dmix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::uv3dmix </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>xbx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>ybx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>uold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>vold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>rufrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>rvfrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>visc2_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>visc2_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>om_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>on_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>om_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>on_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>pm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>pn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Harmonic viscosity </p>
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;{</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="comment">//  Add in harmonic viscosity s terms.</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    FArrayBox fab_UFx(growLo(xbx,0,1),1,amrex::The_Async_Arena()); fab_UFx.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    FArrayBox fab_UFe(growHi(xbx,1,1),1,amrex::The_Async_Arena()); fab_UFe.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    FArrayBox fab_VFe(growLo(ybx,1,1),1,amrex::The_Async_Arena()); fab_VFe.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    FArrayBox fab_VFx(growHi(ybx,0,1),1,amrex::The_Async_Arena()); fab_VFx.template setVal&lt;RunOn::Device&gt;(0.);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keyword">auto</span> UFx=fab_UFx.array();</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keyword">auto</span> UFe=fab_UFe.array();</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keyword">auto</span> VFx=fab_VFx.array();</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keyword">auto</span> VFe=fab_VFe.array();</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">// Think of the cell-centered box as                              [ 0:nx-1, 0:ny-1] (0,0,0) cc</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="comment">// xbx is the x-face-centered box on which we update u  [ 0:nx  , 0:ny-1] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="comment">//   to do so requires                        UFx on    [-1:nx  , 0:ny-1] (0,0,0) cc</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">//      which requires                        uold on   [-1:nx+1, 0:ny-1] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">//        and requires                        vold on   [-1:nx  , 0:ny  ] (0,1,0) y-faces</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">//   to do so requires                        UFe on    [ 0:nx  , 0:ny  ] (1,1,0) xy-nodes</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">//      which requires                        uold on   [ 0:nx  ,-1:ny  ] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">//       and  requires                        vold on   [ -1:nx , 0:ny  ] (0,1,0) y-faces</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    ParallelFor(growLo(xbx,0,1),</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keyword">const</span> amrex::Real cff = 0.5*Hz(i,j,k) * (pm(i,j,0) / pn(i,j,0) *</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                                    ((pn(i,  j,0) + pn(i+1,j,0)) * uold(i+1,j,k,nrhs)-</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                    (pn(i-1,j,0) + pn(i,  j,0)) * uold(i  ,j,k,nrhs))-</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                                pn(i,j,0) / pm(i,j,0) *</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                                    ((pm(i,j  ,0)+pm(i,j+1,0))*vold(i,j+1,k,nrhs)-</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                                    (pm(i,j-1,0)+pm(i,j  ,0))*vold(i,j  ,k,nrhs)));</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        UFx(i,j,k) = on_r(i,j,0)*on_r(i,j,0)*visc2_r(i,j,0)*cff;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    });</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    ParallelFor(growHi(xbx,1,1),</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keyword">const</span> amrex::Real cff = 0.125 * (Hz(i-1,j  ,k)+Hz(i,j ,k)+</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                              Hz(i-1,j-1,k)+Hz(i,j-1,k))*</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                    (pm(i,j,0)/pn(i,j,0)*</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                     ((pn(i  ,j-1,0)+pn(i  ,j,0))*vold(i  ,j,k,nrhs)-</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                      (pn(i-1,j-1,0)+pn(i-1,j,0))*vold(i-1,j,k,nrhs))+</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                     pn(i,j,0)/pm(i,j,0)*</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                     ((pm(i-1,j  ,0)+pm(i,j  ,0))*uold(i,j  ,k,nrhs)-</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                      (pm(i-1,j-1,0)+pm(i,j-1,0))*uold(i,j-1,k,nrhs)));</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        UFe(i,j,k) = om_p(i,j,0)*om_p(i,j,0)*visc2_p(i,j,0)*cff;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    });</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    ParallelFor(xbx,</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keyword">const</span> amrex::Real cff=dt_lev*0.25*(pm(i-1,j,0)+pm(i,j,0))*(pn(i-1,j,0)+pn(i,j,0));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keyword">const</span> amrex::Real cff1=0.5*(pn(i-1,j,0)+pn(i,j,0))*(UFx(i,j  ,k)-UFx(i-1,j,k));</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keyword">const</span> amrex::Real cff2=0.5*(pm(i-1,j,0)+pm(i,j,0))*(UFe(i,j+1,k)-UFe(i  ,j,k));</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keyword">const</span> amrex::Real cff3=cff*(cff1+cff2);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        amrex::Gpu::Atomic::Add(&amp;(rufrc(i,j,0)), cff1+cff2);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        u(i,j,k,nnew)=u(i,j,k,nnew)+cff3;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    });</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">// Think of the cell-centered box as                              [ 0:nx-1, 0:ny-1] (0,0,0) cc</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// ybx is the y-face-centered box on which we update v  [ 0:nx-1, 0:ny  ] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">//   to do so requires                        VFe on    [ 0:nx-1,-1:ny  ] (0,0,0) cc</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">//      which requires                        uold on   [ 0:nx  ,-1:ny  ] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">//        and requires                        vold on   [ 0:nx-1,-1:ny+1] (0,1,0) y-faces</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">//   to do so requires                        VFx on    [ 0:nx  , 0:ny  ] (1,1,0) xy-nodes</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">//      which requires                        uold on   [ 0:nx  ,-1:ny  ] (1,0,0) x-faces</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">//       and  requires                        vold on   [-1:nx  , 0:ny  ] (0,1,0) y-faces</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    ParallelFor(growLo(ybx,1,1),</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="comment">// cff depends on k, but UFx and VFe will only be affected by the last cell?</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keyword">const</span> amrex::Real cff = 0.5*Hz(i,j,k) * (pm(i,j,0) / pn(i,j,0) *</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                ((pn(i,  j,0) + pn(i+1,j,0)) * uold(i+1,j,k,nrhs)-</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                 (pn(i-1,j,0) + pn(i,  j,0)) * uold(i  ,j,k,nrhs))-</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                pn(i,j,0) / pm(i,j,0) *</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                ((pm(i,j  ,0)+pm(i,j+1,0))*vold(i,j+1,k,nrhs)-</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                 (pm(i,j-1,0)+pm(i,j  ,0))*vold(i,j  ,k,nrhs)));</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        VFe(i,j,k) = om_r(i,j,0)*om_r(i,j,0)*visc2_r(i,j,0)*cff;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    });</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    ParallelFor(growHi(ybx,0,1),</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keyword">const</span> amrex::Real cff = 0.125 * (Hz(i-1,j  ,k)+Hz(i,j ,k)+</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                              Hz(i-1,j-1,k)+Hz(i,j-1,k))*</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                    (pm(i,j,0)/pn(i,j,0)*</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                     ((pn(i  ,j-1,0)+pn(i  ,j,0))*vold(i  ,j,k,nrhs)-</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                      (pn(i-1,j-1,0)+pn(i-1,j,0))*vold(i-1,j,k,nrhs))+</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                     pn(i,j,0)/pm(i,j,0)*</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                     ((pm(i-1,j  ,0)+pm(i,j  ,0))*uold(i,j  ,k,nrhs)-</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                      (pm(i-1,j-1,0)+pm(i,j-1,0))*uold(i,j-1,k,nrhs)));</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        VFx(i,j,k) = on_p(i,j,0)*on_p(i,j,0)*visc2_p(i,j,0)*cff;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    });</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    ParallelFor(ybx,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keyword">const</span> amrex::Real cff=dt_lev*0.25*(pm(i,j,0)+pm(i,j-1,0))*(pn(i,j,0)+pn(i,j-1,0));</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keyword">const</span> amrex::Real cff1=0.5*(pn(i,j-1,0)+pn(i,j,0))*(VFx(i+1,j,k)-VFx(i,j  ,k));</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keyword">const</span> amrex::Real cff2=0.5*(pm(i,j-1,0)+pm(i,j,0))*(VFe(i  ,j,k)-VFe(i,j-1,k));</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keyword">const</span> amrex::Real cff3=cff*(cff1-cff2);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        amrex::Gpu::Atomic::Add(&amp;(rvfrc(i,j,0)), cff1-cff2);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        v(i,j,k,nnew)=v(i,j,k,nnew)+cff3;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    });</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad3bb9347625aef307add2c82a9b21d10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3bb9347625aef307add2c82a9b21d10">&#9670;&nbsp;</a></span>vert_mean_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::vert_mean_3d </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ioff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>joff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real const &gt;&#160;</td>
          <td class="paramname"><em>Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real const &gt;&#160;</td>
          <td class="paramname"><em>Dphi_avg1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>DC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>CF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>dxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;{</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    ParallelFor(makeSlab(phi_bx,2,0),</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    {</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;      <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> Hzk_on_face = 0.5*(Hz(i-ioff,j-joff,0)+Hz(i,j,0));</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;      CF(i,j,-1) =                 Hzk_on_face;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;      DC(i,j,-1) = phi(i,j,0,nnew)*Hzk_on_face;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=1; k&lt;=N; k++) {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;          Hzk_on_face = 0.5*(Hz(i-ioff,j-joff,k)+Hz(i,j,k));</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;          CF(i,j,-1) +=                 Hzk_on_face;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;          DC(i,j,-1) += phi(i,j,k,nnew)*Hzk_on_face;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;      }</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    });</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    Gpu::synchronize();</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    ParallelFor(makeSlab(phi_bx,2,0),</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=1.0/(CF(i,j,-1)*(1.0/dxlen(i,j,0)));</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        DC(i,j,-1) = (DC(i,j,-1)*(1.0/dxlen(i,j,0)) - Dphi_avg1(i,j,0))*cff1; <span class="comment">// recursive</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    });</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    ParallelFor(phi_bx,</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        phi(i,j,k) -= DC(i,j,-1);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    });</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3a506eb0db4a850e63f4479269a97b38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a506eb0db4a850e63f4479269a97b38">&#9670;&nbsp;</a></span>vert_visc_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::vert_visc_3d </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ioff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>joff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real const &gt;&#160;</td>
          <td class="paramname"><em>Hz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>Hzk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>oHz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>AK</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>Akv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>DC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>FC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt;&#160;</td>
          <td class="paramname"><em>CF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;{</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="comment">// Put Hzk on the x- or y-face as appropriate, or leave on cell center for tracers</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#ab37afaafcf05a9b10c0fba3180539610">verbose</a> &gt; 1)</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;updating on box in vert_visc_3d: &quot;</span> &lt;&lt; phi_bx &lt;&lt; std::endl;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    ParallelFor(phi_bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        Hzk(i,j,k)=0.5*(Hz(i-ioff,j-joff,k)+Hz(i,j,k));</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        oHz(i,j,k) = 1.0/ Hzk(i,j,k);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    });</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">// Put Akv on the x- or y-face as appropriate, or leave on cell center for tracers</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    ParallelFor(phi_bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        AK(i,j,k) = 0.5 * (Akv(i-ioff,j-joff,k)+Akv(i,j,k));</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    });</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    Gpu::streamSynchronize();</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#ifdef AMREX_USE_GPU</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    Gpu::synchronize();</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#endif</span><span class="comment"></span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">    /////////////////// This and the following loop is the first non-matching thing that affects plotfile comparison for cuda</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"></span>    <span class="comment">// Begin vertical viscosity term</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">// NOTE: vertical viscosity term for tracers is identical except AK=Akt</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    ParallelFor(makeSlab(phi_bx,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;=N; k++)</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            <span class="comment">//  Use conservative, parabolic spline reconstruction of vertical</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            <span class="comment">//  viscosity derivatives.  Then, time step vertical viscosity term</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            <span class="comment">//  implicitly by solving a tridiagonal system.</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff1=1.0/6.0;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            FC(i,j,k) = (k &gt;= 1) ? cff1*Hzk(i,j,k  )-dt_lev*AK(i,j,k-1)*oHz(i,j,k  ):</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                                   cff1*Hzk(i,j,k);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            <span class="keywordflow">if</span>(k&lt;=N-1)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                CF(i,j,k)=cff1*Hzk(i,j,k+1)-dt_lev*AK(i,j,k+1)*oHz(i,j,k+1);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            cff1=1.0/3.0;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            <span class="keywordflow">if</span> (k==0)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                BC(i,j,k)=cff1*(Hzk(i,j,k)+Hzk(i,j,k+1))+</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                        dt_lev*AK(i,j,k)*(oHz(i,j,k)+oHz(i,j,k+1));</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                cff=1.0/(BC(i,j,k)-FC(i,j,k)*0.0);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                CF(i,j,k) *= cff;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                DC(i,j,k) = cff*(phi(i,j,k+1,nnew)-phi(i,j,k,nnew)-FC(i,j,k)*0.0);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k+1&lt;=N) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                    BC(i,j,k)=cff1*(Hzk(i,j,k)+Hzk(i,j,k+1))+</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                        dt_lev*AK(i,j,k)*(oHz(i,j,k)+oHz(i,j,k+1));</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                    cff=1.0/(BC(i,j,k)-FC(i,j,k)*CF(i,j,k-1));</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                CF(i,j,k) *= cff;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                DC(i,j,k) = cff*(phi(i,j,k+1,nnew)-phi(i,j,k,nnew)-FC(i,j,k)*DC(i,j,k-1));</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        } <span class="comment">// k</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    });</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#ifdef AMREX_USE_GPU</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    Gpu::synchronize();</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    Gpu::streamSynchronize();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    ParallelFor(makeSlab(phi_bx,2,0), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> )</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;=N; k++) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;           <span class="comment">//</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;           <span class="comment">//  Backward substitution.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;           <span class="comment">//</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;           DC(i,j,N)=0.0;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;           <span class="keywordflow">if</span>(N-k+1&lt;=N &amp;&amp; N&gt;=k) <span class="comment">//-N,1,-1 =&gt; kidx =N-k+1</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;           {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;               <span class="keywordflow">if</span>(N+1&lt;k || N+2&lt;k) amrex::Abort(<span class="stringliteral">&quot;-1 here&quot;</span>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;               DC(i,j,N-k) -= CF(i,j,N-k)*DC(i,j,N-k+1);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;           }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;       }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    });</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">#ifdef AMREX_USE_GPU</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    Gpu::synchronize();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    ParallelFor(phi_bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        DC(i,j,k) *= AK(i,j,k);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    });</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    ParallelFor(phi_bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cff;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">if</span>(k-1&gt;=0) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            cff = dt_lev*oHz(i,j,k)*(DC(i,j,k)-DC(i,j,k-1));</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            cff = dt_lev*oHz(i,j,k)*(DC(i,j,k));</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        phi(i,j,k) += cff;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;     });</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a65203858561c0499791ef95ef51f3447"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65203858561c0499791ef95ef51f3447">&#9670;&nbsp;</a></span>volWgtSumMF()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> ROMSX::volWgtSumMF </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>comp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>finemask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;{</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ROMSX::volWgtSumMF()&quot;</span>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> sum = 0.0;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    MultiFab tmp(grids[lev], dmap[lev], 1, 0);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    MultiFab::Copy(tmp, mf, comp, 0, 1, 0);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">if</span> (lev &lt; finest_level &amp;&amp; finemask) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keyword">const</span> MultiFab&amp; mask = <a class="code" href="classROMSX.html#a6c60bb81e7afd74c2a73020e3096bd32">build_fine_mask</a>(lev+1);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        MultiFab::Multiply(tmp, mask, 0, 0, 1, 0);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    MultiFab volume(grids[lev], dmap[lev], 1, 0);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>&amp; dx = geom[lev].CellSizeArray();</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cell_vol = dx[0]*dx[1]*dx[2];</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    volume.setVal(cell_vol);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    sum = MultiFab::Dot(tmp, 0, volume, 0, 1, 0, local);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">if</span> (!local)</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      ParallelDescriptor::ReduceRealSum(sum);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">return</span> sum;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;}</div>
<div class="ttc" id="aclassROMSX_html_a6c60bb81e7afd74c2a73020e3096bd32"><div class="ttname"><a href="classROMSX.html#a6c60bb81e7afd74c2a73020e3096bd32">ROMSX::build_fine_mask</a></div><div class="ttdeci">amrex::MultiFab &amp; build_fine_mask(int lev)</div><div class="ttdef"><b>Definition:</b> ROMSX_SumIQ.cpp:115</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a08b14a766ed31e1f6a9ccec0c7f64618"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08b14a766ed31e1f6a9ccec0c7f64618">&#9670;&nbsp;</a></span>writeBuildInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::writeBuildInfo </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;{</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  std::string PrettyLine = std::string(78, <span class="charliteral">&#39;=&#39;</span>) + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  std::string OtherLine = std::string(78, <span class="charliteral">&#39;-&#39;</span>) + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  std::string SkipSpace = std::string(8, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">// build information</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  os &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot; ROMSX Build Information\n&quot;</span>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  os &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;build date:    &quot;</span> &lt;&lt; amrex::buildInfoGetBuildDate() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;build machine: &quot;</span> &lt;&lt; amrex::buildInfoGetBuildMachine() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;build dir:     &quot;</span> &lt;&lt; amrex::buildInfoGetBuildDir() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;AMReX dir:     &quot;</span> &lt;&lt; amrex::buildInfoGetAMReXDir() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;COMP:          &quot;</span> &lt;&lt; amrex::buildInfoGetComp() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;COMP version:  &quot;</span> &lt;&lt; amrex::buildInfoGetCompVersion() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;C++ compiler:  &quot;</span> &lt;&lt; amrex::buildInfoGetCXXName() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;C++ flags:     &quot;</span> &lt;&lt; amrex::buildInfoGetCXXFlags() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;Link flags:    &quot;</span> &lt;&lt; amrex::buildInfoGetLinkFlags() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;Libraries:     &quot;</span> &lt;&lt; amrex::buildInfoGetLibraries() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; n &lt;= amrex::buildInfoGetNumModules(); n++) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    os &lt;&lt; amrex::buildInfoGetModuleName(n) &lt;&lt; <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;       &lt;&lt; amrex::buildInfoGetModuleVal(n) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* githash1 = amrex::buildInfoGetGitHash(1);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* githash2 = amrex::buildInfoGetGitHash(2);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">if</span> (strlen(githash1) &gt; 0) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;ROMSX       git hash: &quot;</span> &lt;&lt; githash1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordflow">if</span> (strlen(githash2) &gt; 0) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;AMReX       git hash: &quot;</span> &lt;&lt; githash2 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgithash = amrex::buildInfoGetBuildGitHash();</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgitname = amrex::buildInfoGetBuildGitName();</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">if</span> (strlen(buildgithash) &gt; 0) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    os &lt;&lt; buildgitname &lt;&lt; <span class="stringliteral">&quot; git hash: &quot;</span> &lt;&lt; buildgithash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot; ROMSX Compile time variables: \n&quot;</span>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot; ROMSX Defines: \n&quot;</span>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;_OPENMP &quot;</span> &lt;&lt; std::setw(6) &lt;&lt; <span class="stringliteral">&quot;ON&quot;</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;     &lt;&lt; std::endl;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;_OPENMP &quot;</span> &lt;&lt; std::setw(6) &lt;&lt; <span class="stringliteral">&quot;OFF&quot;</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;     &lt;&lt; std::endl;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="preprocessor">#ifdef MPI_VERSION</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;MPI_VERSION &quot;</span> &lt;&lt; std::setw(6)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;     &lt;&lt; MPI_VERSION &lt;&lt; std::endl;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;MPI_VERSION &quot;</span> &lt;&lt; std::setw(6)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;UNDEFINED&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor">#ifdef MPI_SUBVERSION</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;MPI_SUBVERSION &quot;</span> &lt;&lt; std::setw(6)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;     &lt;&lt; MPI_SUBVERSION &lt;&lt; std::endl;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;MPI_SUBVERSION &quot;</span> &lt;&lt; std::setw(6)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;UNDEFINED&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classROMSX_a08b14a766ed31e1f6a9ccec0c7f64618_icgraph.png" border="0" usemap="#aclassROMSX_a08b14a766ed31e1f6a9ccec0c7f64618_icgraph" alt=""/></div>
<map name="aclassROMSX_a08b14a766ed31e1f6a9ccec0c7f64618_icgraph" id="aclassROMSX_a08b14a766ed31e1f6a9ccec0c7f64618_icgraph">
<area shape="rect" title=" " alt="" coords="108,5,277,32"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="acc4b85fa57f43aa0f68f33c4edd82611"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc4b85fa57f43aa0f68f33c4edd82611">&#9670;&nbsp;</a></span>WriteCheckpointFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::WriteCheckpointFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;{</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="comment">// chk00010            write a checkpoint file with this root directory</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="comment">// chk00010/Header     this contains information you need to save (e.g., finest_level, t_new, etc.) and also</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="comment">//                     the BoxArrays at each level</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="comment">// chk00010/Level_0/</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="comment">// chk00010/Level_1/</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="comment">// etc.                these subdirectories will hold the MultiFab data at each level of refinement</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="comment">// checkpoint file name, e.g., chk00010</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keyword">const</span> std::string&amp; checkpointname = amrex::Concatenate(<a class="code" href="classROMSX.html#a2e6058cb21bf6f6c2b491581fa742828">check_file</a>,<a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[0],5);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Writing checkpoint &quot;</span> &lt;&lt; checkpointname &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels = finest_level+1;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">// ---- prebuild a hierarchy of directories</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">// ---- dirName is built first.  if dirName exists, it is renamed.  then build</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">// ---- dirName/subDirPrefix_0 .. dirName/subDirPrefix_nlevels-1</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// ---- if callBarrier is true, call ParallelDescriptor::Barrier()</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="comment">// ---- after all directories are built</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="comment">// ---- ParallelDescriptor::IOProcessor() creates the directories</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    amrex::PreBuildDirectorHierarchy(checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, nlevels, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">// write Header file</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;   <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;       std::string HeaderFileName(checkpointname + <span class="stringliteral">&quot;/Header&quot;</span>);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;       VisMF::IO_Buffer io_buffer(VisMF::IO_Buffer_Size);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;       std::ofstream HeaderFile;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;       HeaderFile.rdbuf()-&gt;pubsetbuf(io_buffer.dataPtr(), io_buffer.size());</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;       HeaderFile.open(HeaderFileName.c_str(), std::ofstream::out   |</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                               std::ofstream::trunc |</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                                               std::ofstream::binary);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;       <span class="keywordflow">if</span>( ! HeaderFile.good()) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;           amrex::FileOpenFailed(HeaderFileName);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;       }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;       HeaderFile.precision(17);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;       <span class="comment">// write out title line</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;       HeaderFile &lt;&lt; <span class="stringliteral">&quot;Checkpoint file for ROMSX\n&quot;</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;       <span class="comment">// write out finest_level</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;       HeaderFile &lt;&lt; finest_level &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;       <span class="comment">// write the number of components</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;       <span class="comment">// for each variable we store</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;       <span class="comment">// conservative, cell-centered vars</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;       HeaderFile &lt;&lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;       <span class="comment">// x-velocity on faces</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;       HeaderFile &lt;&lt; 1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;       <span class="comment">// y-velocity on faces</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;       HeaderFile &lt;&lt; 1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;       <span class="comment">// z-velocity on faces</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;       HeaderFile &lt;&lt; 1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;       HeaderFile &lt;&lt; 2 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;       HeaderFile &lt;&lt; 2 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;       HeaderFile &lt;&lt; 3 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;       HeaderFile &lt;&lt; 3 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;       <span class="comment">// write out array of istep</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>.size(); ++i) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;           HeaderFile &lt;&lt; <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;       }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;       HeaderFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;       <span class="comment">// write out array of dt</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>.size(); ++i) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;           HeaderFile &lt;&lt; <a class="code" href="classROMSX.html#aa8a469941edd719ce7c6052afc30d067">dt</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;       }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;       HeaderFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;       <span class="comment">// write out array of t_new</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>.size(); ++i) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;           HeaderFile &lt;&lt; <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;       }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;       HeaderFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;       <span class="comment">// write the BoxArray at each level</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;           boxArray(lev).writeOn(HeaderFile);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;           HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;       }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   <span class="comment">// write the MultiFab data to, e.g., chk00010/Level_0/</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   <span class="comment">// Here we make copies of the MultiFab with no ghost cells</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;       BoxList bl2d = grids[lev].boxList();</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;       <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; b : bl2d) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;           b.setRange(2,0);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;       }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;       BoxArray ba2d(std::move(bl2d));</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;       MultiFab cons(grids[lev],dmap[lev],<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>,0);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;       MultiFab::Copy(cons,*<a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev],0,0,<a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>,0);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;       VisMF::Write(cons, amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Cell&quot;</span>));</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;       MultiFab xvel(convert(grids[lev],IntVect(1,0,0)),dmap[lev],1,0);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;       MultiFab::Copy(xvel,*<a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev],0,0,1,0);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;       VisMF::Write(xvel, amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;XFace&quot;</span>));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;       MultiFab yvel(convert(grids[lev],IntVect(0,1,0)),dmap[lev],1,0);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;       MultiFab::Copy(yvel,*<a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev],0,0,1,0);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;       VisMF::Write(yvel, amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;YFace&quot;</span>));</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;       MultiFab zvel(convert(grids[lev],IntVect(0,0,1)),dmap[lev],1,0);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;       MultiFab::Copy(zvel,*<a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[lev],0,0,1,0);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;       VisMF::Write(zvel, amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;ZFace&quot;</span>));</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;       MultiFab mf_ru(grids[lev],dmap[lev],2,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;       MultiFab::Copy(mf_ru,*<a class="code" href="classROMSX.html#ab1343869d59f89fd4773bc7fa230aa73">vec_ru</a>[lev],0,0,2,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;       VisMF::Write(mf_ru, amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;XRHS&quot;</span>));</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;       MultiFab mf_rv(grids[lev],dmap[lev],2,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;       MultiFab::Copy(mf_rv,*<a class="code" href="classROMSX.html#ab5041f0f370ab1ec4f7f7e16127c9039">vec_rv</a>[lev],0,0,2,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;       VisMF::Write(mf_rv, amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;YRHS&quot;</span>));</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;       MultiFab mf_ubar(ba2d,dmap[lev],3,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;       MultiFab::Copy(mf_ubar,*(<a class="code" href="classROMSX.html#a047f6faef02a00ced0a6c1766e4c9b5a">vec_ubar</a>[lev]),0,0,3,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;       VisMF::Write(mf_ubar, amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;XBar&quot;</span>));</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;       MultiFab mf_vbar(ba2d,dmap[lev],3,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;       MultiFab::Copy(mf_vbar,*(<a class="code" href="classROMSX.html#a2a375f2e83347418b7cf5d4bd812ee55">vec_vbar</a>[lev]),0,0,3,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;       VisMF::Write(mf_vbar, amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;YBar&quot;</span>));</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;       VisMF::Write(*(<a class="code" href="classROMSX.html#ab5b7ff78a167e59ae727b22094b39079">vec_rufrc</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;rufrc&quot;</span>));</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;       VisMF::Write(*(<a class="code" href="classROMSX.html#a52a5f265a370595f128046c31b9f31d5">vec_rvfrc</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;rvfrc&quot;</span>));</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;       VisMF::Write(*(<a class="code" href="classROMSX.html#a2082155131b8b7e0dec29068a92cece2">vec_sustr</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;sustr&quot;</span>));</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;       VisMF::Write(*(<a class="code" href="classROMSX.html#a44a44e4d82bc38d55daa03f281437113">vec_svstr</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;svstr&quot;</span>));</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;       VisMF::Write(*(<a class="code" href="classROMSX.html#ac49463f0fb789402ba8641f289906456">vec_rdrag</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;rdrag&quot;</span>));</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;       VisMF::Write(*(<a class="code" href="classROMSX.html#a607e27d43f6eaebcf557c4ae17b8039a">vec_bustr</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;bustr&quot;</span>));</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;       VisMF::Write(*(<a class="code" href="classROMSX.html#a5a981dafaf65d2d8d96f16e1e7467eb2">vec_bvstr</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;bvstr&quot;</span>));</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;       VisMF::Write(*(<a class="code" href="classROMSX.html#a18212e9657c0655cd29e0c6241c1224f">vec_DU_avg1</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;DU_avg1&quot;</span>));</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;       VisMF::Write(*(<a class="code" href="classROMSX.html#a883756f67229729f133b9bdf784c21ff">vec_DU_avg2</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;DU_avg2&quot;</span>));</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;       VisMF::Write(*(<a class="code" href="classROMSX.html#aa9738d90727df4f8aba2afb0ffed1e8f">vec_DV_avg1</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;DV_avg1&quot;</span>));</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;       VisMF::Write(*(<a class="code" href="classROMSX.html#a6847259dab9f6118da780bf623a9868a">vec_DV_avg2</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;DV_avg2&quot;</span>));</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;       VisMF::Write(*(<a class="code" href="classROMSX.html#ab026fffd3c4e9a9ef612cbb23132a1f5">vec_zeta</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;zeta&quot;</span>));</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;       VisMF::Write(*(<a class="code" href="classROMSX.html#ab962f23dc27b3ce17bb19e3b8c9991f8">vec_Zt_avg1</a>[lev]), amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Zt_avg1&quot;</span>));</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="preprocessor">#ifdef ROMSX_USE_PARTICLES</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;   particleData.Checkpoint(checkpointname);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a63d0268875b00ab11fad450c2f5a5dfd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63d0268875b00ab11fad450c2f5a5dfd">&#9670;&nbsp;</a></span>WriteGenericPlotfileHeaderWithBathymetry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::WriteGenericPlotfileHeaderWithBathymetry </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>HeaderFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlevels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; amrex::BoxArray &gt; &amp;&#160;</td>
          <td class="paramname"><em>bArray</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>varnames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>level_steps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>versionName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>levelPrefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>mfPrefix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;{</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        BL_ASSERT(nlevels &lt;= bArray.size());</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        BL_ASSERT(nlevels &lt;= ref_ratio.size()+1);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        BL_ASSERT(nlevels &lt;= level_steps.size());</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        HeaderFile.precision(17);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="comment">// ---- this is the generic plot file type name</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        HeaderFile &lt;&lt; versionName &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        HeaderFile &lt;&lt; varnames.size() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar = 0; ivar &lt; varnames.size(); ++ivar) {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            HeaderFile &lt;&lt; varnames[ivar] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        HeaderFile &lt;&lt; AMREX_SPACEDIM &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        HeaderFile &lt;&lt; time &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        HeaderFile &lt;&lt; finest_level &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; ++i) {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            HeaderFile &lt;&lt; geom[0].ProbLo(i) &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; ++i) {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            HeaderFile &lt;&lt; geom[0].ProbHi(i) &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; finest_level; ++i) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            HeaderFile &lt;&lt; ref_ratio[i][0] &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= finest_level; ++i) {</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            HeaderFile &lt;&lt; geom[i].Domain() &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= finest_level; ++i) {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            HeaderFile &lt;&lt; level_steps[i] &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= finest_level; ++i) {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; AMREX_SPACEDIM; ++k) {</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                HeaderFile &lt;&lt; geom[i].CellSize()[k] &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        HeaderFile &lt;&lt; (int) geom[0].<a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01">Coord</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        HeaderFile &lt;&lt; <span class="stringliteral">&quot;0\n&quot;</span>;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> level = 0; level &lt;= finest_level; ++level) {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            HeaderFile &lt;&lt; level &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; bArray[level].size() &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; time &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            HeaderFile &lt;&lt; level_steps[level] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            <span class="keyword">const</span> IntVect&amp; domain_lo = geom[level].Domain().smallEnd();</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; bArray[level].size(); ++i)</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                <span class="comment">// Need to shift because the RealBox ctor we call takes the</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                <span class="comment">// physical location of index (0,0,0).  This does not affect</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                <span class="comment">// the usual cases where the domain index starts with 0.</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                <span class="keyword">const</span> Box&amp; b = shift(bArray[level][i], -domain_lo);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                RealBox loc = RealBox(b, geom[level].CellSize(), geom[level].ProbLo());</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; AMREX_SPACEDIM; ++n) {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                    HeaderFile &lt;&lt; loc.lo(n) &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; loc.hi(n) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                }</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            }</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            HeaderFile &lt;&lt; MultiFabHeaderPath(level, levelPrefix, mfPrefix) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        HeaderFile &lt;&lt; <span class="stringliteral">&quot;1&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        HeaderFile &lt;&lt; <span class="stringliteral">&quot;3&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        HeaderFile &lt;&lt; <span class="stringliteral">&quot;amrexvec_nu_x&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        HeaderFile &lt;&lt; <span class="stringliteral">&quot;amrexvec_nu_y&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        HeaderFile &lt;&lt; <span class="stringliteral">&quot;amrexvec_nu_z&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        std::string mf_nodal_prefix = <span class="stringliteral">&quot;Nu_nd&quot;</span>;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> level = 0; level &lt;= finest_level; ++level) {</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            HeaderFile &lt;&lt; MultiFabHeaderPath(level, levelPrefix, mf_nodal_prefix) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        }</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;}</div>
<div class="ttc" id="aDataStruct_8H_html_a627f1f843904477f763577ad1460de01"><div class="ttname"><a href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01">Coord</a></div><div class="ttdeci">Coord</div><div class="ttdef"><b>Definition:</b> DataStruct.H:17</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae886b3856fed4fa4d820c5dda7effb7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae886b3856fed4fa4d820c5dda7effb7c">&#9670;&nbsp;</a></span>writeJobInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::writeJobInfo </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>dir</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;{</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  <span class="comment">// job_info file with details about the run</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  std::ofstream jobInfoFile;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  std::string FullPathJobInfoFile = dir;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  FullPathJobInfoFile += <span class="stringliteral">&quot;/job_info&quot;</span>;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  jobInfoFile.open(FullPathJobInfoFile.c_str(), std::ios::out);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  std::string PrettyLine = <span class="stringliteral">&quot;===================================================&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;                           <span class="stringliteral">&quot;============================\n&quot;</span>;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  std::string OtherLine = <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                          <span class="stringliteral">&quot;----------------------------\n&quot;</span>;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  std::string SkipSpace = <span class="stringliteral">&quot;        &quot;</span>;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="comment">// job information</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; ROMSX Job Information\n&quot;</span>;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;inputs file: &quot;</span> &lt;&lt; <a class="code" href="writeJobInfo_8cpp.html#aabaa127a3a319c1b86090d6c88568965">inputs_name</a> &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;number of MPI processes: &quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;              &lt;&lt; amrex::ParallelDescriptor::NProcs() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;number of threads:       &quot;</span> &lt;&lt; omp_get_max_threads() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;CPU time used since start of simulation (CPU-hours): &quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;              &lt;&lt; <a class="code" href="classROMSX.html#a0103d20b9a7008fea63fa553b76726f2">getCPUTime</a>() / 3600.0;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="comment">// plotfile information</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Plotfile Information\n&quot;</span>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  time_t now = time(0);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="comment">// Convert now to tm struct for local timezone</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  tm* localtm = localtime(&amp;now);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;output data / time: &quot;</span> &lt;&lt; asctime(localtm);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  std::string currentDir = amrex::FileSystem::CurrentPath();</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;output dir:         &quot;</span> &lt;&lt; currentDir &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="comment">// build information</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Build Information\n&quot;</span>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;build date:    &quot;</span> &lt;&lt; amrex::buildInfoGetBuildDate() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;build machine: &quot;</span> &lt;&lt; amrex::buildInfoGetBuildMachine() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;build dir:     &quot;</span> &lt;&lt; amrex::buildInfoGetBuildDir() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;AMReX dir:     &quot;</span> &lt;&lt; amrex::buildInfoGetAMReXDir() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;COMP:          &quot;</span> &lt;&lt; amrex::buildInfoGetComp() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;COMP version:  &quot;</span> &lt;&lt; amrex::buildInfoGetCompVersion() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; n &lt;= amrex::buildInfoGetNumModules(); n++) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    jobInfoFile &lt;&lt; amrex::buildInfoGetModuleName(n) &lt;&lt; <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                &lt;&lt; amrex::buildInfoGetModuleVal(n) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* githash1 = amrex::buildInfoGetGitHash(1);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* githash2 = amrex::buildInfoGetGitHash(2);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordflow">if</span> (strlen(githash1) &gt; 0) {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;ROMSX       git hash: &quot;</span> &lt;&lt; githash1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">if</span> (strlen(githash2) &gt; 0) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;AMReX       git hash: &quot;</span> &lt;&lt; githash2 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgithash = amrex::buildInfoGetBuildGitHash();</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgitname = amrex::buildInfoGetBuildGitName();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">if</span> (strlen(buildgithash) &gt; 0) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    jobInfoFile &lt;&lt; buildgitname &lt;&lt; <span class="stringliteral">&quot; git hash: &quot;</span> &lt;&lt; buildgithash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">// grid information</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Grid Information\n&quot;</span>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordtype">int</span> f_lev = finest_level;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= f_lev; i++) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot; level: &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   number of boxes = &quot;</span> &lt;&lt; grids[i].size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   maximum zones   = &quot;</span>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; AMREX_SPACEDIM; n++) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      jobInfoFile &lt;&lt; geom[i].Domain().length(n) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Boundary conditions\n&quot;</span>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   -x: &quot;</span> &lt;&lt; <a class="code" href="classROMSX.html#a3ebadda9dbf9fbf5fd040bb1df0f18c3">domain_bc_type</a>[0] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   +x: &quot;</span> &lt;&lt; <a class="code" href="classROMSX.html#a3ebadda9dbf9fbf5fd040bb1df0f18c3">domain_bc_type</a>[3] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   -y: &quot;</span> &lt;&lt; <a class="code" href="classROMSX.html#a3ebadda9dbf9fbf5fd040bb1df0f18c3">domain_bc_type</a>[1] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   +y: &quot;</span> &lt;&lt; <a class="code" href="classROMSX.html#a3ebadda9dbf9fbf5fd040bb1df0f18c3">domain_bc_type</a>[4] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   -z: &quot;</span> &lt;&lt; <a class="code" href="classROMSX.html#a3ebadda9dbf9fbf5fd040bb1df0f18c3">domain_bc_type</a>[2] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   +z: &quot;</span> &lt;&lt; <a class="code" href="classROMSX.html#a3ebadda9dbf9fbf5fd040bb1df0f18c3">domain_bc_type</a>[5] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="comment">// runtime parameters</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Inputs File Parameters\n&quot;</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  amrex::ParmParse::dumpTable(jobInfoFile, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  jobInfoFile.close();</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div>
<div class="ttc" id="aclassROMSX_html_a0103d20b9a7008fea63fa553b76726f2"><div class="ttname"><a href="classROMSX.html#a0103d20b9a7008fea63fa553b76726f2">ROMSX::getCPUTime</a></div><div class="ttdeci">amrex::Real getCPUTime() const</div><div class="ttdef"><b>Definition:</b> ROMSX.H:943</div></div>
<div class="ttc" id="awriteJobInfo_8cpp_html_aabaa127a3a319c1b86090d6c88568965"><div class="ttname"><a href="writeJobInfo_8cpp.html#aabaa127a3a319c1b86090d6c88568965">inputs_name</a></div><div class="ttdeci">std::string inputs_name</div><div class="ttdef"><b>Definition:</b> main.cpp:9</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classROMSX_ae886b3856fed4fa4d820c5dda7effb7c_cgraph.png" border="0" usemap="#aclassROMSX_ae886b3856fed4fa4d820c5dda7effb7c_cgraph" alt=""/></div>
<map name="aclassROMSX_ae886b3856fed4fa4d820c5dda7effb7c_cgraph" id="aclassROMSX_ae886b3856fed4fa4d820c5dda7effb7c_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,161,32"/>
<area shape="rect" href="classROMSX.html#a0103d20b9a7008fea63fa553b76726f2" title=" " alt="" coords="209,5,368,32"/>
</map>
</div>

</div>
</div>
<a id="a5d697ec8b659282c8b02f559b3eabe34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d697ec8b659282c8b02f559b3eabe34">&#9670;&nbsp;</a></span>WriteMultiLevelPlotfileWithBathymetry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::WriteMultiLevelPlotfileWithBathymetry </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>plotfilename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlevels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; const amrex::MultiFab * &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; const amrex::MultiFab * &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_nd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>varnames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>level_steps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>versionName</em> = <code>&quot;HyperCLaw-V1.1&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>levelPrefix</em> = <code>&quot;Level_&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>mfPrefix</em> = <code>&quot;Cell&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>extra_dirs</em> = <code>amrex::Vector&lt;std::string&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;{</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;WriteMultiLevelPlotfileWithBathymetry()&quot;</span>);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    BL_ASSERT(nlevels &lt;= mf.size());</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    BL_ASSERT(nlevels &lt;= ref_ratio.size()+1);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    BL_ASSERT(nlevels &lt;= level_steps.size());</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    BL_ASSERT(mf[0]-&gt;nComp() == varnames.size());</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordtype">bool</span> callBarrier(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    PreBuildDirectorHierarchy(plotfilename, levelPrefix, nlevels, callBarrier);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">if</span> (!extra_dirs.empty()) {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; d : extra_dirs) {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            <span class="keyword">const</span> std::string ed = plotfilename+<span class="stringliteral">&quot;/&quot;</span>+d;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            PreBuildDirectorHierarchy(ed, levelPrefix, nlevels, callBarrier);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    ParallelDescriptor::Barrier();</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordflow">if</span> (ParallelDescriptor::MyProc() == ParallelDescriptor::NProcs()-1) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        Vector&lt;BoxArray&gt; boxArrays(nlevels);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> level(0); level &lt; boxArrays.size(); ++level) {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            boxArrays[level] = mf[level]-&gt;boxArray();</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <span class="keyword">auto</span> f = [=]() {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            VisMF::IO_Buffer io_buffer(VisMF::IO_Buffer_Size);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            std::string HeaderFileName(plotfilename + <span class="stringliteral">&quot;/Header&quot;</span>);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            std::ofstream HeaderFile;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            HeaderFile.rdbuf()-&gt;pubsetbuf(io_buffer.dataPtr(), io_buffer.size());</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            HeaderFile.open(HeaderFileName.c_str(), std::ofstream::out   |</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                                                    std::ofstream::trunc |</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                                                    std::ofstream::binary);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            <span class="keywordflow">if</span>( ! HeaderFile.good()) FileOpenFailed(HeaderFileName);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            <a class="code" href="classROMSX.html#a63d0268875b00ab11fad450c2f5a5dfd">WriteGenericPlotfileHeaderWithBathymetry</a>(HeaderFile, nlevels, boxArrays, varnames,</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                                     time, level_steps, versionName,</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                                                     levelPrefix, mfPrefix);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        };</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keywordflow">if</span> (AsyncOut::UseAsyncOut()) {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            AsyncOut::Submit(std::move(f));</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            f();</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    std::string mf_nodal_prefix = <span class="stringliteral">&quot;Nu_nd&quot;</span>;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> level = 0; level &lt;= finest_level; ++level)</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">if</span> (AsyncOut::UseAsyncOut()) {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            VisMF::AsyncWrite(*mf[level],</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                              MultiFabFileFullPrefix(level, plotfilename, levelPrefix, mfPrefix),</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                              <span class="keyword">true</span>);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            VisMF::AsyncWrite(*mf_nd[level],</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                              MultiFabFileFullPrefix(level, plotfilename, levelPrefix, mf_nodal_prefix),</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                              <span class="keyword">true</span>);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <span class="keyword">const</span> MultiFab* data;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            std::unique_ptr&lt;MultiFab&gt; mf_tmp;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            <span class="keywordflow">if</span> (mf[level]-&gt;nGrowVect() != 0) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                mf_tmp = std::make_unique&lt;MultiFab&gt;(mf[level]-&gt;boxArray(),</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                                                    mf[level]-&gt;DistributionMap(),</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                                                    mf[level]-&gt;nComp(), 0, MFInfo(),</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                                                    mf[level]-&gt;Factory());</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                MultiFab::Copy(*mf_tmp, *mf[level], 0, 0, mf[level]-&gt;nComp(), 0);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                data = mf_tmp.get();</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                data = mf[level];</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            VisMF::Write(*data       , MultiFabFileFullPrefix(level, plotfilename, levelPrefix, mfPrefix));</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            VisMF::Write(*mf_nd[level], MultiFabFileFullPrefix(level, plotfilename, levelPrefix, mf_nodal_prefix));</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;}</div>
<div class="ttc" id="aclassROMSX_html_a63d0268875b00ab11fad450c2f5a5dfd"><div class="ttname"><a href="classROMSX.html#a63d0268875b00ab11fad450c2f5a5dfd">ROMSX::WriteGenericPlotfileHeaderWithBathymetry</a></div><div class="ttdeci">void WriteGenericPlotfileHeaderWithBathymetry(std::ostream &amp;HeaderFile, int nlevels, const amrex::Vector&lt; amrex::BoxArray &gt; &amp;bArray, const amrex::Vector&lt; std::string &gt; &amp;varnames, amrex::Real time, const amrex::Vector&lt; int &gt; &amp;level_steps, const std::string &amp;versionName, const std::string &amp;levelPrefix, const std::string &amp;mfPrefix) const</div><div class="ttdef"><b>Definition:</b> Plotfile.cpp:417</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0049697ad0398380ac5a058705fece48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0049697ad0398380ac5a058705fece48">&#9670;&nbsp;</a></span>WritePlotFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROMSX::WritePlotFile </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>which</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>plot_var_names</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>write plotfile to disk </p>
<div class="fragment"><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;{</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keyword">const</span> Vector&lt;std::string&gt; varnames = <a class="code" href="classROMSX.html#ae387d14721ffd15c0a57002fdbc150cc">PlotFileVarNames</a>(plot_var_names);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> ncomp_mf = varnames.size();</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> ngrow_vars = IntVect(<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,<a class="code" href="IndexDefines_8H.html#a124da9e47fb1b1f3debaf49368f42e38">NGROW</a>-1,0);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// We fillpatch here because some of the derived quantities require derivatives</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">//     which require ghost cells to be filled</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev], *<a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev], <a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev], *<a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev], <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev], *<a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev], <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <a class="code" href="classROMSX.html#abb9e3a06ecbafa6f4860576cc80db30c">FillPatch</a>(lev, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[lev], *<a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[lev], <a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">if</span> (ncomp_mf == 0)</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    Vector&lt;MultiFab&gt; mf(finest_level+1);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        mf[lev].define(grids[lev], dmap[lev], ncomp_mf, ngrow_vars);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    Vector&lt;MultiFab&gt; mf_nd(finest_level+1);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        BoxArray nodal_grids(grids[lev]); nodal_grids.surroundingNodes();</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        mf_nd[lev].define(nodal_grids, dmap[lev], AMREX_SPACEDIM, 0);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        mf_nd[lev].setVal(0.);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordtype">int</span> mf_comp = 0;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="comment">// First, copy any of the conserved state variables into the output plotfile</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        AMREX_ALWAYS_ASSERT(<a class="code" href="classROMSX.html#afd7f32f1e2d2c5152773534f6f8ab5a0">cons_names</a>.size() == <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>; ++i) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ROMSX_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <a class="code" href="classROMSX.html#afd7f32f1e2d2c5152773534f6f8ab5a0">cons_names</a>[i])) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;              MultiFab::Copy(mf[lev],*<a class="code" href="classROMSX.html#a7f7c60f6b48935de00903f101ffcf412">cons_new</a>[lev],i,mf_comp,1,ngrow_vars);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                mf_comp++;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="comment">// Next, check for velocities and if desired, output them</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ROMSX_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;x_velocity&quot;</span>) ||</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <a class="code" href="ROMSX_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;y_velocity&quot;</span>) ||</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <a class="code" href="ROMSX_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;z_velocity&quot;</span>)) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            amrex::Print()&lt;&lt;<span class="stringliteral">&quot;For now, print faces as if they are at cell centers&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <span class="comment">//            average_face_to_cellcenter(mf[lev],mf_comp,</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <span class="comment">//                Array&lt;const MultiFab*,3&gt;{&amp;xvel_new[lev],&amp;yvel_new[lev],&amp;zvel_new[lev]});</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <span class="comment">// Convert the map-factor-scaled-velocities back to velocities</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            MultiFab dmf(mf[lev], make_alias, mf_comp, AMREX_SPACEDIM);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(dmf, TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.growntilebox();</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt; vel_arr = dmf.array(mfi);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                <span class="keyword">const</span> Array4&lt;const Real&gt; velx_arr = <a class="code" href="classROMSX.html#a2d8d8b238ca3a5ebf4346e4110c82af2">xvel_new</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                <span class="keyword">const</span> Array4&lt;const Real&gt; vely_arr = <a class="code" href="classROMSX.html#aa67ecec73cc05ad8c7af8578faa77b48">yvel_new</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                <span class="keyword">const</span> Array4&lt;const Real&gt; velz_arr = <a class="code" href="classROMSX.html#af4db3a202bf1aa714f1c5a2e9d6174e4">zvel_new</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                    vel_arr(i,j,k,0) = velx_arr(i,j,k);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                    vel_arr(i,j,k,1) = vely_arr(i,j,k);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                    vel_arr(i,j,k,2) = velz_arr(i,j,k);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                });</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            mf_comp += AMREX_SPACEDIM;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="comment">// Fill cell-centered location</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dx = Geom()[lev].CellSizeArray()[0];</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dy = Geom()[lev].CellSizeArray()[1];</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="comment">// Next, check for location names -- if we write one we write all</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ROMSX_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;x_cc&quot;</span>) ||</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <a class="code" href="ROMSX_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;y_cc&quot;</span>) ||</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <a class="code" href="ROMSX_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;z_cc&quot;</span>))</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            MultiFab dmf(mf[lev], make_alias, mf_comp, AMREX_SPACEDIM);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(dmf, TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt; loc_arr = dmf.array(mfi);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt; zp_arr = <a class="code" href="classROMSX.html#a8e887c13b3d23581a26580f4e7e9aef0">vec_z_phys_nd</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                    loc_arr(i,j,k,0) = (i+0.5) * dx;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                    loc_arr(i,j,k,1) = (j+0.5) * dy;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                    loc_arr(i,j,k,2) = <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>(0.125) * (zp_arr(i,j  ,k  ) + zp_arr(i+1,j  ,k  ) +</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                                                      zp_arr(i,j+1,k  ) + zp_arr(i+1,j+1,k  ) +</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                                                      zp_arr(i,j  ,k+1) + zp_arr(i+1,j  ,k+1) +</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                                                      zp_arr(i,j+1,k+1) + zp_arr(i+1,j+1,k+1) );</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                });</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            mf_comp += AMREX_SPACEDIM;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        } <span class="comment">// if containerHasElement</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="preprocessor">#ifdef ROMSX_USE_PARTICLES</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ROMSX_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;tracer_particle_count&quot;</span>))</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            MultiFab temp_dat(mf[lev].boxArray(), mf[lev].DistributionMap(), 1, 0);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            temp_dat.setVal(0);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            particleData.tracer_particles-&gt;Redistribute();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            particleData.tracer_particles-&gt;Increment(temp_dat, lev);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            MultiFab::Copy(mf[lev], temp_dat, 0, mf_comp, 1, 0);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        MultiFab::Copy(mf_nd[lev],*<a class="code" href="classROMSX.html#a8e887c13b3d23581a26580f4e7e9aef0">vec_z_phys_nd</a>[lev],0,2,1,0);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dz = Geom()[lev].CellSizeArray()[2];</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordflow">for</span> (MFIter mfi(mf_nd[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            Array4&lt;Real&gt; mf_arr = mf_nd[lev].array(mfi);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                mf_arr(i,j,k,2) -= k * dz;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            });</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    } <span class="comment">// lev</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    std::string plotfilename;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">if</span> (which == 1)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;       plotfilename = Concatenate(<a class="code" href="classROMSX.html#a05371cb6acdebe55d3aa25bebbaa65e2">plot_file_1</a>, <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[0], 5);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (which == 2)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;       plotfilename = Concatenate(<a class="code" href="classROMSX.html#aa0f18c68a94b27d41e87d49662ec0ac1">plot_file_2</a>, <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>[0], 5);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">if</span> (finest_level == 0)</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a802f6c0afcdf21170461376c39e9701a">plotfile_type</a> == <span class="stringliteral">&quot;amrex&quot;</span>) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Writing plotfile &quot;</span> &lt;&lt; plotfilename &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <a class="code" href="classROMSX.html#a5d697ec8b659282c8b02f559b3eabe34">WriteMultiLevelPlotfileWithBathymetry</a>(plotfilename, finest_level+1,</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                                                  GetVecOfConstPtrs(mf),</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                                                  GetVecOfConstPtrs(mf_nd),</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                                                  varnames,</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                                                  <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[0], <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <a class="code" href="classROMSX.html#ae886b3856fed4fa4d820c5dda7effb7c">writeJobInfo</a>(plotfilename);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="preprocessor">#ifdef ROMSX_USE_PARTICLES</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            particleData.Checkpoint(plotfilename);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="preprocessor">#ifdef ROMSX_USE_HDF5</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a802f6c0afcdf21170461376c39e9701a">plotfile_type</a> == <span class="stringliteral">&quot;hdf5&quot;</span> || <a class="code" href="classROMSX.html#a802f6c0afcdf21170461376c39e9701a">plotfile_type</a> == <span class="stringliteral">&quot;HDF5&quot;</span>) {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Writing plotfile &quot;</span> &lt;&lt; plotfilename+<span class="stringliteral">&quot;d01.h5&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            WriteMultiLevelPlotfileHDF5(plotfilename, finest_level+1,</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                                        GetVecOfConstPtrs(mf),</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                                        varnames,</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                                        Geom(), <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[0], <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>, refRatio());</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="preprocessor">#ifdef ROMSX_USE_NETCDF</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a802f6c0afcdf21170461376c39e9701a">plotfile_type</a> == <span class="stringliteral">&quot;netcdf&quot;</span> || <a class="code" href="classROMSX.html#a802f6c0afcdf21170461376c39e9701a">plotfile_type</a> == <span class="stringliteral">&quot;NetCDF&quot;</span>) {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;             <span class="keywordtype">int</span> lev   = 0;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;             <span class="keywordtype">int</span> which = 0;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;             writeNCPlotFile(lev, which, plotfilename, GetVecOfConstPtrs(mf), varnames, <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[0]);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;             <a class="code" href="classROMSX.html#a07e31a4dec6fc9e9d1ec3f1e96381c53">total_plot_file_step_1</a> += 1;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;User specified plot_filetype = &quot;</span> &lt;&lt; <a class="code" href="classROMSX.html#a802f6c0afcdf21170461376c39e9701a">plotfile_type</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            amrex::Abort(<span class="stringliteral">&quot;Dont know this plot_filetype&quot;</span>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// multilevel</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        Vector&lt;IntVect&gt;   r2(finest_level);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        Vector&lt;Geometry&gt;  g2(finest_level+1);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        Vector&lt;MultiFab&gt; mf2(finest_level+1);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        mf2[0].define(grids[0], dmap[0], ncomp_mf, 0);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="comment">// Copy level 0 as is</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        MultiFab::Copy(mf2[0],mf[0],0,0,mf[0].nComp(),0);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="comment">// Define a new multi-level array of Geometry&#39;s so that we pass the new &quot;domain&quot; at lev &gt; 0</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        Array&lt;int,AMREX_SPACEDIM&gt; periodicity =</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                     {Geom()[0].isPeriodic(0),Geom()[0].isPeriodic(1),Geom()[0].isPeriodic(2)};</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        g2[0].define(Geom()[0].Domain(),&amp;(Geom()[0].ProbDomain()),0,periodicity.data());</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a802f6c0afcdf21170461376c39e9701a">plotfile_type</a> == <span class="stringliteral">&quot;amrex&quot;</span>) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            r2[0] = IntVect(1,1,ref_ratio[0][0]);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                <span class="keywordflow">if</span> (lev &gt; 1) {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                    r2[lev-1][0] = 1;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                    r2[lev-1][1] = 1;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                    r2[lev-1][2] = r2[lev-2][2] * ref_ratio[lev-1][0];</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                mf2[lev].define(refine(grids[lev],r2[lev-1]), dmap[lev], ncomp_mf, 0);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                <span class="comment">// Set the new problem domain</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                Box d2(Geom()[lev].Domain());</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                d2.refine(r2[lev-1]);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                g2[lev].define(d2,&amp;(Geom()[lev].ProbDomain()),0,periodicity.data());</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <span class="comment">// Do piecewise interpolation of mf into mf2</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                <span class="keywordflow">for</span> (MFIter mfi(mf2[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                    <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                    pcinterp_interp(bx,mf2[lev].array(mfi), 0, mf[lev].nComp(), mf[lev].const_array(mfi),0,r2[lev-1]);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="comment">// Define an effective ref_ratio which is isotropic to be passed into WriteMultiLevelPlotfile</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            Vector&lt;IntVect&gt; rr(finest_level);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt; finest_level; ++lev) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                rr[lev] = IntVect(ref_ratio[lev][0],ref_ratio[lev][1],ref_ratio[lev][0]);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            WriteMultiLevelPlotfile(plotfilename, finest_level+1, GetVecOfConstPtrs(mf2), varnames,</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                                    g2, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[0], <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>, rr);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <a class="code" href="classROMSX.html#ae886b3856fed4fa4d820c5dda7effb7c">writeJobInfo</a>(plotfilename);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="preprocessor">#ifdef ROMSX_USE_PARTICLES</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            particleData.Checkpoint(plotfilename);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="preprocessor">#ifdef ROMSX_USE_NETCDF</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classROMSX.html#a802f6c0afcdf21170461376c39e9701a">plotfile_type</a> == <span class="stringliteral">&quot;netcdf&quot;</span> || <a class="code" href="classROMSX.html#a802f6c0afcdf21170461376c39e9701a">plotfile_type</a> == <span class="stringliteral">&quot;NetCDF&quot;</span>) {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> which = 0; which &lt; <a class="code" href="classROMSX.html#a2b67bb92b64c187e9869d8f8726e4e42">num_boxes_at_level</a>[lev]; which++) {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                     writeNCPlotFile(lev, which, plotfilename, GetVecOfConstPtrs(mf), varnames, <a class="code" href="classROMSX.html#a31b7954d302e5fd9474c084078ad4784">istep</a>, <a class="code" href="classROMSX.html#aac116ec30618bbd5641218e7522cdb86">t_new</a>[0]);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                     <a class="code" href="classROMSX.html#a07e31a4dec6fc9e9d1ec3f1e96381c53">total_plot_file_step_1</a> += 1;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                 }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;             }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    } <span class="comment">// end multi-level</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;}</div>
<div class="ttc" id="aclassROMSX_html_a07e31a4dec6fc9e9d1ec3f1e96381c53"><div class="ttname"><a href="classROMSX.html#a07e31a4dec6fc9e9d1ec3f1e96381c53">ROMSX::total_plot_file_step_1</a></div><div class="ttdeci">int total_plot_file_step_1</div><div class="ttdef"><b>Definition:</b> ROMSX.H:768</div></div>
<div class="ttc" id="aclassROMSX_html_a5d697ec8b659282c8b02f559b3eabe34"><div class="ttname"><a href="classROMSX.html#a5d697ec8b659282c8b02f559b3eabe34">ROMSX::WriteMultiLevelPlotfileWithBathymetry</a></div><div class="ttdeci">void WriteMultiLevelPlotfileWithBathymetry(const std::string &amp;plotfilename, int nlevels, const amrex::Vector&lt; const amrex::MultiFab * &gt; &amp;mf, const amrex::Vector&lt; const amrex::MultiFab * &gt; &amp;mf_nd, const amrex::Vector&lt; std::string &gt; &amp;varnames, amrex::Real time, const amrex::Vector&lt; int &gt; &amp;level_steps, const std::string &amp;versionName=&quot;HyperCLaw-V1.1&quot;, const std::string &amp;levelPrefix=&quot;Level_&quot;, const std::string &amp;mfPrefix=&quot;Cell&quot;, const amrex::Vector&lt; std::string &gt; &amp;extra_dirs=amrex::Vector&lt; std::string &gt;()) const</div><div class="ttdef"><b>Definition:</b> Plotfile.cpp:332</div></div>
<div class="ttc" id="aclassROMSX_html_ae387d14721ffd15c0a57002fdbc150cc"><div class="ttname"><a href="classROMSX.html#ae387d14721ffd15c0a57002fdbc150cc">ROMSX::PlotFileVarNames</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; PlotFileVarNames(amrex::Vector&lt; std::string &gt; plot_var_names) const</div><div class="ttdef"><b>Definition:</b> Plotfile.cpp:87</div></div>
<div class="ttc" id="aclassROMSX_html_ae886b3856fed4fa4d820c5dda7effb7c"><div class="ttname"><a href="classROMSX.html#ae886b3856fed4fa4d820c5dda7effb7c">ROMSX::writeJobInfo</a></div><div class="ttdeci">void writeJobInfo(const std::string &amp;dir) const</div><div class="ttdef"><b>Definition:</b> writeJobInfo.cpp:7</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classROMSX_a0049697ad0398380ac5a058705fece48_cgraph.png" border="0" usemap="#aclassROMSX_a0049697ad0398380ac5a058705fece48_cgraph" alt=""/></div>
<map name="aclassROMSX_a0049697ad0398380ac5a058705fece48_cgraph" id="aclassROMSX_a0049697ad0398380ac5a058705fece48_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,167,32"/>
<area shape="rect" href="ROMSX_8H.html#a1f8554e7b211b0acfc202e8a600e7d67" title=" " alt="" coords="215,5,377,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="afc5b78f8bc38863080c02301dba5377f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc5b78f8bc38863080c02301dba5377f">&#9670;&nbsp;</a></span>advflux_reg</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::YAFluxRegister*&gt; ROMSX::advflux_reg</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classROMSX.html#a2b610851883faf8e10f6ac7f660e3e44">getAdvFluxReg()</a>.</p>

</div>
</div>
<a id="a13e740677d31feb5f33e044d1a48c8a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13e740677d31feb5f33e044d1a48c8a4">&#9670;&nbsp;</a></span>bndry_output_planes_interval</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ROMSX::bndry_output_planes_interval</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae7cb5e92951f1b72d818578160d0f993"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7cb5e92951f1b72d818578160d0f993">&#9670;&nbsp;</a></span>bndry_output_planes_per</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ROMSX::bndry_output_planes_per</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa8550f36a6138b1e0679e79b3c84d489"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8550f36a6138b1e0679e79b3c84d489">&#9670;&nbsp;</a></span>bndry_output_planes_start_time</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ROMSX::bndry_output_planes_start_time</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ab8125e3b638f29f6f08872c2cefd5335"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8125e3b638f29f6f08872c2cefd5335">&#9670;&nbsp;</a></span>boxes_at_level</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::Box&gt; &gt; ROMSX::boxes_at_level</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a87dc05168f41e1ad8b45d1030655f6e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87dc05168f41e1ad8b45d1030655f6e7">&#9670;&nbsp;</a></span>cfl</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ROMSX::cfl = 0.8</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="afe5f357fc00e46eb1445f35f84cbdf8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe5f357fc00e46eb1445f35f84cbdf8e">&#9670;&nbsp;</a></span>change_max</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ROMSX::change_max = 1.1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2e6058cb21bf6f6c2b491581fa742828"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e6058cb21bf6f6c2b491581fa742828">&#9670;&nbsp;</a></span>check_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ROMSX::check_file {&quot;chk&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a216e5a3eb30ef276aef23458bd6ebd98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a216e5a3eb30ef276aef23458bd6ebd98">&#9670;&nbsp;</a></span>check_int</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ROMSX::check_int = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a72cbded1c13914c8b88cd81ee1a95824"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72cbded1c13914c8b88cd81ee1a95824">&#9670;&nbsp;</a></span>check_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ROMSX::check_type {&quot;native&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a29488d66fbb560d30a4b5e06b672beeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29488d66fbb560d30a4b5e06b672beeb">&#9670;&nbsp;</a></span>column_file_name</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ROMSX::column_file_name</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aef48ba3f3f3d75f7dfd36560a71ef94f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef48ba3f3f3d75f7dfd36560a71ef94f">&#9670;&nbsp;</a></span>column_interval</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ROMSX::column_interval</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8a4ea92dce7e8d0072b37aa3edd20d9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a4ea92dce7e8d0072b37aa3edd20d9f">&#9670;&nbsp;</a></span>column_loc_x</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ROMSX::column_loc_x</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aeaffc5965ead48d24734ec365b6ee522"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeaffc5965ead48d24734ec365b6ee522">&#9670;&nbsp;</a></span>column_loc_y</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ROMSX::column_loc_y</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a77bb4ecfec25fd3dd2fde5b637f557f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77bb4ecfec25fd3dd2fde5b637f557f2">&#9670;&nbsp;</a></span>column_per</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ROMSX::column_per</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="afd7f32f1e2d2c5152773534f6f8ab5a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd7f32f1e2d2c5152773534f6f8ab5a0">&#9670;&nbsp;</a></span>cons_names</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const amrex::Vector&lt;std::string&gt; ROMSX::cons_names {&quot;temp&quot;, &quot;salt&quot;, &quot;scalar&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7f7c60f6b48935de00903f101ffcf412"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f7c60f6b48935de00903f101ffcf412">&#9670;&nbsp;</a></span>cons_new</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab*&gt; ROMSX::cons_new</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7a14aa971cac1b1ad0eb5d4b46b90343"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a14aa971cac1b1ad0eb5d4b46b90343">&#9670;&nbsp;</a></span>cons_old</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab*&gt; ROMSX::cons_old</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a271306c0bdbc6ac6822bbca35f395d07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a271306c0bdbc6ac6822bbca35f395d07">&#9670;&nbsp;</a></span>d_havg_density</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Gpu::DeviceVector&lt;amrex::Real&gt; ROMSX::d_havg_density</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a09200be1d5d74f87d3679591a850eaef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09200be1d5d74f87d3679591a850eaef">&#9670;&nbsp;</a></span>d_havg_pressure</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Gpu::DeviceVector&lt;amrex::Real&gt; ROMSX::d_havg_pressure</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9af6ccc61c900c2139238378b214ce44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9af6ccc61c900c2139238378b214ce44">&#9670;&nbsp;</a></span>d_havg_temperature</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Gpu::DeviceVector&lt;amrex::Real&gt; ROMSX::d_havg_temperature</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a854a34e778a776e3ca46f7eeac9813e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a854a34e778a776e3ca46f7eeac9813e4">&#9670;&nbsp;</a></span>datalog</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;std::fstream&gt; &gt; ROMSX::datalog</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classROMSX.html#a2cc7343babd4642f2cf727a3d40035f3">DataLog()</a>, <a class="el" href="classROMSX.html#adf6f2e4f8b883d81702ea424d90ff4de">NumDataLogs()</a>, and <a class="el" href="classROMSX.html#abdccbdf27483fa87a7fc769ef6aa16fd">setRecordDataInfo()</a>.</p>

</div>
</div>
<a id="ae308f7068f2eb8e48913fc77d32f9065"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae308f7068f2eb8e48913fc77d32f9065">&#9670;&nbsp;</a></span>datalogname</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::string&gt; ROMSX::datalogname</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classROMSX.html#a34887f38557bf5026acaf46581e05375">DataLogName()</a>.</p>

</div>
</div>
<a id="ab221b060f02f422f90d511e71b5c13d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab221b060f02f422f90d511e71b5c13d6">&#9670;&nbsp;</a></span>derived_names</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const amrex::Vector&lt;std::string&gt; ROMSX::derived_names {&quot;dpdx&quot;, &quot;dpdy&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a116ad0a8fa0753367f3458e5744c8e8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a116ad0a8fa0753367f3458e5744c8e8e">&#9670;&nbsp;</a></span>do_substep</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ROMSX::do_substep</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3ebadda9dbf9fbf5fd040bb1df0f18c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ebadda9dbf9fbf5fd040bb1df0f18c3">&#9670;&nbsp;</a></span>domain_bc_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Array&lt;std::string,2*AMREX_SPACEDIM&gt; ROMSX::domain_bc_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classROMSX.html#ae886b3856fed4fa4d820c5dda7effb7c">writeJobInfo()</a>.</p>

</div>
</div>
<a id="a003d617559e7196bba737b43e23f9fc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a003d617559e7196bba737b43e23f9fc4">&#9670;&nbsp;</a></span>domain_bcs_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::BCRec&gt; ROMSX::domain_bcs_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a04e9242a2702910e640d84f47a7aae3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04e9242a2702910e640d84f47a7aae3c">&#9670;&nbsp;</a></span>domain_bcs_type_d</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Gpu::DeviceVector&lt;amrex::BCRec&gt; ROMSX::domain_bcs_type_d</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa8a469941edd719ce7c6052afc30d067"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8a469941edd719ce7c6052afc30d067">&#9670;&nbsp;</a></span>dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ROMSX::dt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6d17615a53d63c67d12c657c9b5dade5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d17615a53d63c67d12c657c9b5dade5">&#9670;&nbsp;</a></span>fine_mask</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::MultiFab ROMSX::fine_mask</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9f1ff8349f4357e88dc70143f163b392"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f1ff8349f4357e88dc70143f163b392">&#9670;&nbsp;</a></span>fixed_dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ROMSX::fixed_dt = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9b13ff6c8fec8f7ac0eb7330732d9bcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b13ff6c8fec8f7ac0eb7330732d9bcc">&#9670;&nbsp;</a></span>fixed_fast_dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ROMSX::fixed_fast_dt = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a676fc3cc2402734727ca9e04e050d171"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a676fc3cc2402734727ca9e04e050d171">&#9670;&nbsp;</a></span>fixed_ndtfast_ratio</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ROMSX::fixed_ndtfast_ratio = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6efd311333adc503a24d5b3364c4a2d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6efd311333adc503a24d5b3364c4a2d3">&#9670;&nbsp;</a></span>h_havg_density</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ROMSX::h_havg_density</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a82b2332d9dee5db2130ebd0ef2fa0d0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82b2332d9dee5db2130ebd0ef2fa0d0b">&#9670;&nbsp;</a></span>h_havg_pressure</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ROMSX::h_havg_pressure</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa5dcbcc6efc7c4e5fbca45b466b475ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5dcbcc6efc7c4e5fbca45b466b475ac">&#9670;&nbsp;</a></span>h_havg_temperature</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ROMSX::h_havg_temperature</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="afc2d5ca5334b8dc2acb9c6c57febbcf1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc2d5ca5334b8dc2acb9c6c57febbcf1">&#9670;&nbsp;</a></span>init_shrink</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ROMSX::init_shrink = 1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae3894b8be6ddf628ddd718abfc4c36ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3894b8be6ddf628ddd718abfc4c36ad">&#9670;&nbsp;</a></span>input_bndry_planes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ROMSX::input_bndry_planes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="addd7497677393458ec87e5aa1ed1b6c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addd7497677393458ec87e5aa1ed1b6c5">&#9670;&nbsp;</a></span>input_sounding_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ROMSX::input_sounding_file</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a31b7954d302e5fd9474c084078ad4784"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31b7954d302e5fd9474c084078ad4784">&#9670;&nbsp;</a></span>istep</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;int&gt; ROMSX::istep</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a33906f6209da9e2a247b1022f60d24ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33906f6209da9e2a247b1022f60d24ac">&#9670;&nbsp;</a></span>last_check_file_step</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ROMSX::last_check_file_step</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3d94cb5986d9f35bc8becc666cfaea3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d94cb5986d9f35bc8becc666cfaea3d">&#9670;&nbsp;</a></span>last_plot_file_step_1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ROMSX::last_plot_file_step_1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a25ecb4567ed2adbaf9be2fbae65d3640"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25ecb4567ed2adbaf9be2fbae65d3640">&#9670;&nbsp;</a></span>last_plot_file_step_2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ROMSX::last_plot_file_step_2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3e9e683aa14e1ce2cd331cc56e665faa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e9e683aa14e1ce2cd331cc56e665faa">&#9670;&nbsp;</a></span>m_bc_extdir_vals</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Array&lt;amrex::Array&lt;amrex::Real, AMREX_SPACEDIM*2&gt;,AMREX_SPACEDIM+<a class="el" href="IndexDefines_8H.html#ae3f12540307d28407f8d7dd4a169e325">NCONS</a>&gt; ROMSX::m_bc_extdir_vals</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a606d7f526ef409ef78feb8ce127f98c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a606d7f526ef409ef78feb8ce127f98c9">&#9670;&nbsp;</a></span>mapfac_m</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::mapfac_m</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a865698971c9689455573c4b81ecaf26c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a865698971c9689455573c4b81ecaf26c">&#9670;&nbsp;</a></span>mapfac_u</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::mapfac_u</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad96e947b76f50a01928821d3cd2455f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad96e947b76f50a01928821d3cd2455f7">&#9670;&nbsp;</a></span>mapfac_v</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::mapfac_v</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad895c0936e0bd64ca71ec355e5e164b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad895c0936e0bd64ca71ec355e5e164b6">&#9670;&nbsp;</a></span>max_step</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ROMSX::max_step = std::numeric_limits&lt;int&gt;::max()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a067945622be8aeb2bd7a812ae222b031"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a067945622be8aeb2bd7a812ae222b031">&#9670;&nbsp;</a></span>nc_bdy_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ROMSX::nc_bdy_file</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae637f59528ab8ecd6d5780a4b9e667e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae637f59528ab8ecd6d5780a4b9e667e5">&#9670;&nbsp;</a></span>nc_init_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt; amrex::Vector&lt; std::string &gt; &gt; ROMSX::nc_init_file = {{&quot;&quot;}}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac248f5de275736769f83c3e6bfc6b550"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac248f5de275736769f83c3e6bfc6b550">&#9670;&nbsp;</a></span>nfast</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ROMSX::nfast</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ab02aa1c49bf90239a6bce4ca84da985d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab02aa1c49bf90239a6bce4ca84da985d">&#9670;&nbsp;</a></span>nsubsteps</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;int&gt; ROMSX::nsubsteps</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2b67bb92b64c187e9869d8f8726e4e42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b67bb92b64c187e9869d8f8726e4e42">&#9670;&nbsp;</a></span>num_boxes_at_level</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;int&gt; ROMSX::num_boxes_at_level</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="adb84a2eea3c51e9954981176e98341c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb84a2eea3c51e9954981176e98341c3">&#9670;&nbsp;</a></span>num_files_at_level</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;int&gt; ROMSX::num_files_at_level</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9db9e34cdbbb00987f648d9075fa4e3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9db9e34cdbbb00987f648d9075fa4e3e">&#9670;&nbsp;</a></span>output_1d_column</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ROMSX::output_1d_column</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a96d71c96092397cf1a692d490652973e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96d71c96092397cf1a692d490652973e">&#9670;&nbsp;</a></span>output_bndry_planes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ROMSX::output_bndry_planes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a99fc9ef2e303a2fd0cb70225fca95acb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99fc9ef2e303a2fd0cb70225fca95acb">&#9670;&nbsp;</a></span>phys_bc_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::GpuArray&lt;<a class="el" href="IndexDefines_8H.html#a8c2583d7b3aea3f36ba249890cc5e281">ROMSX_BC</a>, AMREX_SPACEDIM*2&gt; ROMSX::phys_bc_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a11e74dcdbeb3670a3f92a614366a7b32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11e74dcdbeb3670a3f92a614366a7b32">&#9670;&nbsp;</a></span>physbcs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;<a class="el" href="classROMSXPhysBCFunct.html">ROMSXPhysBCFunct</a>&gt; &gt; ROMSX::physbcs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a05371cb6acdebe55d3aa25bebbaa65e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05371cb6acdebe55d3aa25bebbaa65e2">&#9670;&nbsp;</a></span>plot_file_1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ROMSX::plot_file_1 {&quot;plt_1_&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa0f18c68a94b27d41e87d49662ec0ac1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0f18c68a94b27d41e87d49662ec0ac1">&#9670;&nbsp;</a></span>plot_file_2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ROMSX::plot_file_2 {&quot;plt_2_&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a90451fd26c3ca52a56982e35d2887214"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90451fd26c3ca52a56982e35d2887214">&#9670;&nbsp;</a></span>plot_file_on_restart</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ROMSX::plot_file_on_restart = 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="abaae04ebda466750a5480506239c6ca7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abaae04ebda466750a5480506239c6ca7">&#9670;&nbsp;</a></span>plot_int_1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ROMSX::plot_int_1 = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa3cd25f16ca7432ac68b7a02a8880226"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3cd25f16ca7432ac68b7a02a8880226">&#9670;&nbsp;</a></span>plot_int_2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ROMSX::plot_int_2 = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6fd2ffd8760dc3b1d68392d18cc728ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fd2ffd8760dc3b1d68392d18cc728ae">&#9670;&nbsp;</a></span>plot_var_names_1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::string&gt; ROMSX::plot_var_names_1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9b9c22ebd57fa77b0bb64f3932acc51c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b9c22ebd57fa77b0bb64f3932acc51c">&#9670;&nbsp;</a></span>plot_var_names_2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::string&gt; ROMSX::plot_var_names_2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a802f6c0afcdf21170461376c39e9701a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a802f6c0afcdf21170461376c39e9701a">&#9670;&nbsp;</a></span>plotfile_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ROMSX::plotfile_type = &quot;amrex&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="afda0f54b3ad1ed8dbb39bbef8ed48c92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afda0f54b3ad1ed8dbb39bbef8ed48c92">&#9670;&nbsp;</a></span>pp_prefix</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string ROMSX::pp_prefix {&quot;romsx&quot;}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afe8d71bf62ec39dc02fb961910a79811"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe8d71bf62ec39dc02fb961910a79811">&#9670;&nbsp;</a></span>previousCPUTimeUsed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ROMSX::previousCPUTimeUsed = 0.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classROMSX.html#a0103d20b9a7008fea63fa553b76726f2">getCPUTime()</a>.</p>

</div>
</div>
<a id="a335a655f6cf611277de2803029419c4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a335a655f6cf611277de2803029419c4c">&#9670;&nbsp;</a></span>ref_tags</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vector&lt; AMRErrorTag &gt; ROMSX::ref_tags</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ab61e1364d5b301c8f727566234b9eb89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab61e1364d5b301c8f727566234b9eb89">&#9670;&nbsp;</a></span>regrid_int</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ROMSX::regrid_int = 2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae2d89ab211dd0d324dda03720b8c4bff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2d89ab211dd0d324dda03720b8c4bff">&#9670;&nbsp;</a></span>restart_chkfile</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ROMSX::restart_chkfile = &quot;&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae866db953617cc0cc4090aeedfd3103c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae866db953617cc0cc4090aeedfd3103c">&#9670;&nbsp;</a></span>restart_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ROMSX::restart_type {&quot;native&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a21df816ace6144ce0ed78d0031eaa946"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21df816ace6144ce0ed78d0031eaa946">&#9670;&nbsp;</a></span>solverChoice</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structSolverChoice.html">SolverChoice</a> ROMSX::solverChoice</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae1071e0c88d861f589184ad86ff14774"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1071e0c88d861f589184ad86ff14774">&#9670;&nbsp;</a></span>sst</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::sst</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ab3e7f280e92f9e5cbdad88a3f222069c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3e7f280e92f9e5cbdad88a3f222069c">&#9670;&nbsp;</a></span>startCPUTime</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ROMSX::startCPUTime = 0.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classROMSX.html#a0103d20b9a7008fea63fa553b76726f2">getCPUTime()</a>.</p>

</div>
</div>
<a id="a22dfd39392c026bd023c8f1d57fd0889"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22dfd39392c026bd023c8f1d57fd0889">&#9670;&nbsp;</a></span>stop_time</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ROMSX::stop_time = std::numeric_limits&lt;amrex::Real&gt;::max()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="afcedb31381fd065fff2ca36196f8da40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcedb31381fd065fff2ca36196f8da40">&#9670;&nbsp;</a></span>sum_interval</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ROMSX::sum_interval = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af638ada4294dcf5b33de335efef61de1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af638ada4294dcf5b33de335efef61de1">&#9670;&nbsp;</a></span>sum_per</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ROMSX::sum_per = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aac116ec30618bbd5641218e7522cdb86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac116ec30618bbd5641218e7522cdb86">&#9670;&nbsp;</a></span>t_new</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ROMSX::t_new</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac395453aa10633a05bb7323b2946101e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac395453aa10633a05bb7323b2946101e">&#9670;&nbsp;</a></span>t_old</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ROMSX::t_old</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a07e31a4dec6fc9e9d1ec3f1e96381c53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07e31a4dec6fc9e9d1ec3f1e96381c53">&#9670;&nbsp;</a></span>total_plot_file_step_1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ROMSX::total_plot_file_step_1 = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1e111db2e680a1a90e4f1ddd37212ba6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e111db2e680a1a90e4f1ddd37212ba6">&#9670;&nbsp;</a></span>use_tracer_particles</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ROMSX::use_tracer_particles</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a63d077c5232d18aa0c31f1824b63b5ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63d077c5232d18aa0c31f1824b63b5ca">&#9670;&nbsp;</a></span>vec_Akt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_Akt</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Vertical diffusion coefficient (3D), set in .in file </p>

</div>
</div>
<a id="aec2c137ce4314357035cbc7ae292338f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec2c137ce4314357035cbc7ae292338f">&#9670;&nbsp;</a></span>vec_Akv</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_Akv</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Vertical viscosity coefficient (3D), set in .in file </p>

</div>
</div>
<a id="a607e27d43f6eaebcf557c4ae17b8039a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a607e27d43f6eaebcf557c4ae17b8039a">&#9670;&nbsp;</a></span>vec_bustr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_bustr</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Bottom stress in the u direction </p>

</div>
</div>
<a id="a5a981dafaf65d2d8d96f16e1e7467eb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a981dafaf65d2d8d96f16e1e7467eb2">&#9670;&nbsp;</a></span>vec_bvstr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_bvstr</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Bottom stress in the v direction </p>

</div>
</div>
<a id="a2f47ec18ca3f2465e3253f92ca493bbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f47ec18ca3f2465e3253f92ca493bbc">&#9670;&nbsp;</a></span>vec_diff2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_diff2</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Harmonic diffusivity for temperature / salinity </p>

</div>
</div>
<a id="a18212e9657c0655cd29e0c6241c1224f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18212e9657c0655cd29e0c6241c1224f">&#9670;&nbsp;</a></span>vec_DU_avg1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_DU_avg1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>time average of barotropic x velocity flux (2D) </p>

</div>
</div>
<a id="a883756f67229729f133b9bdf784c21ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a883756f67229729f133b9bdf784c21ff">&#9670;&nbsp;</a></span>vec_DU_avg2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_DU_avg2</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>correct time average of barotropic x velocity flux for coupling (2D) </p>

</div>
</div>
<a id="aa9738d90727df4f8aba2afb0ffed1e8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9738d90727df4f8aba2afb0ffed1e8f">&#9670;&nbsp;</a></span>vec_DV_avg1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_DV_avg1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>time average of barotropic y velocity flux </p>

</div>
</div>
<a id="a6847259dab9f6118da780bf623a9868a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6847259dab9f6118da780bf623a9868a">&#9670;&nbsp;</a></span>vec_DV_avg2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_DV_avg2</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>correct time average of barotropic y velocity flux for coupling (2D) </p>

</div>
</div>
<a id="a03b79a651abf3dc2bd37fadaca99fd46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03b79a651abf3dc2bd37fadaca99fd46">&#9670;&nbsp;</a></span>vec_hOfTheConfusingName</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_hOfTheConfusingName</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Bathymetry data (2D, positive valued, h in ROMS) </p>

</div>
</div>
<a id="a24f02b944df51884168ab0c08c736c91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24f02b944df51884168ab0c08c736c91">&#9670;&nbsp;</a></span>vec_Huon</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_Huon</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>u-volume flux (3D) </p>

</div>
</div>
<a id="a21dcccced847102e553281c1852ce005"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21dcccced847102e553281c1852ce005">&#9670;&nbsp;</a></span>vec_Hvom</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_Hvom</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>v-volume flux (3D) </p>

</div>
</div>
<a id="aa5461758b528d199101b5ea74f9a6c12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5461758b528d199101b5ea74f9a6c12">&#9670;&nbsp;</a></span>vec_Hz</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_Hz</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Width of cells in the vertical (z-) direction (3D, Hz in ROMS) </p>

</div>
</div>
<a id="ac49463f0fb789402ba8641f289906456"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac49463f0fb789402ba8641f289906456">&#9670;&nbsp;</a></span>vec_rdrag</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_rdrag</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Linear drag coeifficient [m/s], defined at rho points </p>

</div>
</div>
<a id="a0978a71210c5f05a5541002532bd9cd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0978a71210c5f05a5541002532bd9cd2">&#9670;&nbsp;</a></span>vec_rhoA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_rhoA</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a20d43f4b49b92542c1790c1ea01ca19c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20d43f4b49b92542c1790c1ea01ca19c">&#9670;&nbsp;</a></span>vec_rhoS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_rhoS</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab1343869d59f89fd4773bc7fa230aa73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1343869d59f89fd4773bc7fa230aa73">&#9670;&nbsp;</a></span>vec_ru</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_ru</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>u velocity RHS (3D, includes hoirzontal and vertical advection) </p>

</div>
</div>
<a id="ab5d263be53bfdd397f6c64672ee77009"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5d263be53bfdd397f6c64672ee77009">&#9670;&nbsp;</a></span>vec_rubar</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_rubar</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>barotropic x velocity for the RHS (2D) </p>

</div>
</div>
<a id="ab5b7ff78a167e59ae727b22094b39079"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5b7ff78a167e59ae727b22094b39079">&#9670;&nbsp;</a></span>vec_rufrc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_rufrc</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>u velocity RHS, integrated, including advection and bottom/surface stresses (2D) </p>

</div>
</div>
<a id="ab5041f0f370ab1ec4f7f7e16127c9039"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5041f0f370ab1ec4f7f7e16127c9039">&#9670;&nbsp;</a></span>vec_rv</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_rv</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>v velocity RHS (3D, includes hoirzontal and vertical advection) </p>

</div>
</div>
<a id="a83d781ead821f8ed29f6f2b9ef70a9aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83d781ead821f8ed29f6f2b9ef70a9aa">&#9670;&nbsp;</a></span>vec_rvbar</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_rvbar</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>barotropic y velocity for the RHS (2D) </p>

</div>
</div>
<a id="a52a5f265a370595f128046c31b9f31d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52a5f265a370595f128046c31b9f31d5">&#9670;&nbsp;</a></span>vec_rvfrc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_rvfrc</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>v velocity RHS, integrated, including advection and bottom/surface stresses (2D) </p>

</div>
</div>
<a id="ac2324a5a8d5949f83ac7621ef79f8fdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2324a5a8d5949f83ac7621ef79f8fdd">&#9670;&nbsp;</a></span>vec_rzeta</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_rzeta</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>free surface height for the RHS (2D) </p>

</div>
</div>
<a id="a7a3b7fb166ec3acf1b1057f53e08adad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a3b7fb166ec3acf1b1057f53e08adad">&#9670;&nbsp;</a></span>vec_s_r</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_s_r</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Scaled vertical coordinate (range [0,1]) that transforms to z, defined at rho points (cell centers) </p>

</div>
</div>
<a id="a3d747b62e29b6c979763cd243e61a866"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d747b62e29b6c979763cd243e61a866">&#9670;&nbsp;</a></span>vec_sstore</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_sstore</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>saltstore, tempstore, etc </p>

</div>
</div>
<a id="a2082155131b8b7e0dec29068a92cece2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2082155131b8b7e0dec29068a92cece2">&#9670;&nbsp;</a></span>vec_sustr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_sustr</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Surface stress in the u direction </p>

</div>
</div>
<a id="a44a44e4d82bc38d55daa03f281437113"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44a44e4d82bc38d55daa03f281437113">&#9670;&nbsp;</a></span>vec_svstr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_svstr</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Surface stress in the v direction </p>

</div>
</div>
<a id="a047f6faef02a00ced0a6c1766e4c9b5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a047f6faef02a00ced0a6c1766e4c9b5a">&#9670;&nbsp;</a></span>vec_ubar</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_ubar</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>barotropic x velocity (2D) </p>

</div>
</div>
<a id="a2a375f2e83347418b7cf5d4bd812ee55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a375f2e83347418b7cf5d4bd812ee55">&#9670;&nbsp;</a></span>vec_vbar</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_vbar</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>barotropic y velocity (2D) </p>

</div>
</div>
<a id="af83a943f37cd6bbaf25c52fcaceb0930"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af83a943f37cd6bbaf25c52fcaceb0930">&#9670;&nbsp;</a></span>vec_visc2_p</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_visc2_p</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Harmonic viscosity devined on the psi points (corners of horizontal grid cells) </p>

</div>
</div>
<a id="aa8fff925fc76e919ddc53de08b3725e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8fff925fc76e919ddc53de08b3725e9">&#9670;&nbsp;</a></span>vec_visc2_r</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_visc2_r</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Harmonic viscosity devined on the rho points (centers) </p>

</div>
</div>
<a id="a640f040827d96f0b2085a385f0faaa3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a640f040827d96f0b2085a385f0faaa3b">&#9670;&nbsp;</a></span>vec_visc3d_r</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_visc3d_r</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a55d028f9a1e55a035ab877607ac326fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55d028f9a1e55a035ab877607ac326fe">&#9670;&nbsp;</a></span>vec_weight1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ROMSX::vec_weight1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1781a7c54d695e8889f2d394062b85a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1781a7c54d695e8889f2d394062b85a7">&#9670;&nbsp;</a></span>vec_weight2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ROMSX::vec_weight2</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2de6e4298de90faa955d8073a65f7cd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2de6e4298de90faa955d8073a65f7cd9">&#9670;&nbsp;</a></span>vec_x_r</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_x_r</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>x coordinates at rho points (cell centers) </p>

</div>
</div>
<a id="a9a453443ec491d496adbd2cf5ac292d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a453443ec491d496adbd2cf5ac292d8">&#9670;&nbsp;</a></span>vec_y_r</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_y_r</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>y coordinates at rho points (cell centers) </p>

</div>
</div>
<a id="a8e887c13b3d23581a26580f4e7e9aef0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e887c13b3d23581a26580f4e7e9aef0">&#9670;&nbsp;</a></span>vec_z_phys_nd</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_z_phys_nd</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>z coordinates at psi points (cell nodes) </p>

</div>
</div>
<a id="a0a9b1a5cf021018defc82b45cbecb2c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a9b1a5cf021018defc82b45cbecb2c5">&#9670;&nbsp;</a></span>vec_z_r</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_z_r</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>z coordinates at rho points (cell centers) </p>

</div>
</div>
<a id="a7e2a55ae7fb02290e6ead16ec3e658fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e2a55ae7fb02290e6ead16ec3e658fa">&#9670;&nbsp;</a></span>vec_z_w</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_z_w</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>z coordinates at w points (faces between z-cells) </p>

</div>
</div>
<a id="ab026fffd3c4e9a9ef612cbb23132a1f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab026fffd3c4e9a9ef612cbb23132a1f5">&#9670;&nbsp;</a></span>vec_zeta</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_zeta</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>free surface height (2D) </p>

</div>
</div>
<a id="ab962f23dc27b3ce17bb19e3b8c9991f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab962f23dc27b3ce17bb19e3b8c9991f8">&#9670;&nbsp;</a></span>vec_Zt_avg1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ROMSX::vec_Zt_avg1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Average of the free surface, zeta (2D) </p>

</div>
</div>
<a id="ab37afaafcf05a9b10c0fba3180539610"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab37afaafcf05a9b10c0fba3180539610">&#9670;&nbsp;</a></span>verbose</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ROMSX::verbose = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2d8d8b238ca3a5ebf4346e4110c82af2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d8d8b238ca3a5ebf4346e4110c82af2">&#9670;&nbsp;</a></span>xvel_new</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab*&gt; ROMSX::xvel_new</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af0b5074dc426b753beb5511bd63df407"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0b5074dc426b753beb5511bd63df407">&#9670;&nbsp;</a></span>xvel_old</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab*&gt; ROMSX::xvel_old</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa67ecec73cc05ad8c7af8578faa77b48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa67ecec73cc05ad8c7af8578faa77b48">&#9670;&nbsp;</a></span>yvel_new</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab*&gt; ROMSX::yvel_new</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a87f0b7446438b8145bdea79012b985f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87f0b7446438b8145bdea79012b985f5">&#9670;&nbsp;</a></span>yvel_old</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab*&gt; ROMSX::yvel_old</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af4db3a202bf1aa714f1c5a2e9d6174e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4db3a202bf1aa714f1c5a2e9d6174e4">&#9670;&nbsp;</a></span>zvel_new</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab*&gt; ROMSX::zvel_new</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acb72d33af4be09dede2005fa6c901686"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb72d33af4be09dede2005fa6c901686">&#9670;&nbsp;</a></span>zvel_old</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab*&gt; ROMSX::zvel_old</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/runner/work/ROMSX/ROMSX/Source/<a class="el" href="ROMSX_8H_source.html">ROMSX.H</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/BoundaryConditions/<a class="el" href="ROMSX__FillPatch_8cpp.html">ROMSX_FillPatch.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/Initialization/<a class="el" href="ROMSX__init_8cpp.html">ROMSX_init.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/Initialization/<a class="el" href="ROMSX__init__bcs_8cpp.html">ROMSX_init_bcs.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/IO/<a class="el" href="Checkpoint_8cpp.html">Checkpoint.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/IO/<a class="el" href="Plotfile_8cpp.html">Plotfile.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/IO/<a class="el" href="writeJobInfo_8cpp.html">writeJobInfo.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/<a class="el" href="ROMSX_8cpp.html">ROMSX.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/<a class="el" href="ROMSX__make__new__level_8cpp.html">ROMSX_make_new_level.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/<a class="el" href="ROMSX__SumIQ_8cpp.html">ROMSX_SumIQ.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/<a class="el" href="ROMSX__Tagging_8cpp.html">ROMSX_Tagging.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__Advance_8cpp.html">ROMSX_Advance.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__advance__2d_8cpp.html">ROMSX_advance_2d.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__advance__2d__onestep_8cpp.html">ROMSX_advance_2d_onestep.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__advance__3d_8cpp.html">ROMSX_advance_3d.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__advance__3d__ml_8cpp.html">ROMSX_advance_3d_ml.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__ComputeTimestep_8cpp.html">ROMSX_ComputeTimestep.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__coriolis_8cpp.html">ROMSX_coriolis.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__prestep_8cpp.html">ROMSX_prestep.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__prestep__diffusion_8cpp.html">ROMSX_prestep_diffusion.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__prestep__t__advection_8cpp.html">ROMSX_prestep_t_advection.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__prsgrd_8cpp.html">ROMSX_prsgrd.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__rho__eos_8cpp.html">ROMSX_rho_eos.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__rhs__t__3d_8cpp.html">ROMSX_rhs_t_3d.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__rhs__uv__2d_8cpp.html">ROMSX_rhs_uv_2d.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__rhs__uv__3d_8cpp.html">ROMSX_rhs_uv_3d.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__set__massflux__3d_8cpp.html">ROMSX_set_massflux_3d.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__set__weights_8cpp.html">ROMSX_set_weights.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__setup__step_8cpp.html">ROMSX_setup_step.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__t3dmix_8cpp.html">ROMSX_t3dmix.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__TimeStep_8cpp.html">ROMSX_TimeStep.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__TimeStepML_8cpp.html">ROMSX_TimeStepML.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__update__massflux__3d_8cpp.html">ROMSX_update_massflux_3d.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__uv3dmix_8cpp.html">ROMSX_uv3dmix.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__vert__mean__3d_8cpp.html">ROMSX_vert_mean_3d.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/TimeIntegration/<a class="el" href="ROMSX__vert__visc__3d_8cpp.html">ROMSX_vert_visc_3d.cpp</a></li>
<li>/home/runner/work/ROMSX/ROMSX/Source/Utils/<a class="el" href="DepthStretchTransform_8H_source.html">DepthStretchTransform.H</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classROMSX.html">ROMSX</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
